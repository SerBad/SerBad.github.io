{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":1,"renderable":0},{"_id":"source/images/alipay.png","path":"images/alipay.png","modified":1,"renderable":0},{"_id":"source/images/avatar.jpg","path":"images/avatar.jpg","modified":1,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"source/images/WeChatPay.png","path":"images/WeChatPay.png","modified":1,"renderable":0},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1}],"Cache":[{"_id":"source/.DS_Store","hash":"3511ab2b7e4c4474d26bb4b32191e1e711f8f698","modified":1530679905250},{"_id":"source/404.md","hash":"5725c651069d5de8b123c0a97264b4f451977a2e","modified":1482774032000},{"_id":"source/CNAME","hash":"d78294e7d8a4120f6be17683ff62fcba3f5cab09","modified":1482333120000},{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1522452352000},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1522452352000},{"_id":"themes/next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1522452352000},{"_id":"themes/next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1522452352000},{"_id":"themes/next/.travis.yml","hash":"d60d4a5375fea23d53b2156b764a99b2e56fa660","modified":1522452352000},{"_id":"themes/next/.javascript_ignore","hash":"8a224b381155f10e6eb132a4d815c5b52962a9d1","modified":1522452352000},{"_id":"themes/next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1522452352000},{"_id":"themes/next/bower.json","hash":"3f8f416899ab12c48a5cc936265d475fa99ce9fe","modified":1523417261238},{"_id":"themes/next/_config.yml","hash":"503edb8612898d2bdc249f8c40f317c246d7877b","modified":1530686574999},{"_id":"themes/next/crowdin.yml","hash":"fe22a450cc1272b7ac5476e6b33a999f8b8a2034","modified":1522452352000},{"_id":"themes/next/LICENSE.md","hash":"fc7227c508af3351120181cbf2f9b99dc41f063e","modified":1522452352000},{"_id":"themes/next/package.json","hash":"f27fff901d4e34f53cf98cb120d365a8b66c6fd3","modified":1522452352000},{"_id":"themes/next/.gitignore","hash":"a18c2e83bb20991b899b58e6aeadcb87dd8aa16e","modified":1522452352000},{"_id":"themes/next/.gitattributes","hash":"44bd4729c74ccb88110804f41746fec07bf487d4","modified":1522452352000},{"_id":"themes/next/README.md","hash":"81c51e4b0fe5eaab6becfc0d6ef342bdd749a781","modified":1522452352000},{"_id":"themes/next/gulpfile.coffee","hash":"48d2f9fa88a4210308fc41cc7d3f6d53989f71b7","modified":1522452352000},{"_id":"source/_posts/.DS_Store","hash":"7c8ded1a8cfbc1d0fbffe9789745c9285d932d9b","modified":1528820960547},{"_id":"source/_posts/2018-02-27.md","hash":"5d1e77790ce7089b7d294cf313cb0121d86e4c35","modified":1528820990532},{"_id":"source/_posts/2018-02-26.md","hash":"154ae255eb035584407001bbc0644a531aefd657","modified":1528820987043},{"_id":"source/_posts/2018-02-28.md","hash":"617464aedb060e4384377a593ff4feb5e780efa5","modified":1528820994847},{"_id":"source/_posts/INSTALL-FAILED-NO-MATCHING-ABIS.md","hash":"d33f58887e04ebbc39a55b9e1c8ecfc6f8a2c489","modified":1492265147000},{"_id":"source/_posts/ALAYNE.md","hash":"68ba706faa843c5dd1c3b18d2d11058f6c331cd6","modified":1492265137000},{"_id":"source/_posts/ARIANNE.md","hash":"7f908b816cea3818403fec562ac2987f280eb9df","modified":1492265143000},{"_id":"source/_posts/MERCY.md","hash":"76ef49346930c131ba362e4be61fc560cf857e8c","modified":1492265150000},{"_id":"source/_posts/Thinking2.md","hash":"eefeda27244eb1c3147f73d416423f2c95fec1e5","modified":1528821050883},{"_id":"source/_posts/Thinking3.md","hash":"d2fe643ac141db28226b5aede3149b90e206f115","modified":1528821053946},{"_id":"source/_posts/Thinking4.md","hash":"2aa54be2b16e98cff5154dbba184eae8a8f511d5","modified":1528821058139},{"_id":"source/_posts/a-problem-about-sharedPreferencesde.md","hash":"a80d4eafa42520a56f53fcef145de57f4231c6a2","modified":1499671508000},{"_id":"source/_posts/about-technology-selection.md","hash":"4a87a0c296dce13cb080e5a1c6867161712897bd","modified":1492265101000},{"_id":"source/_posts/activity-screenshot-with-dialog.md","hash":"77b33f27488b541032510a862e003ed7c45bbf4e","modified":1492265124000},{"_id":"source/_posts/android-animtion.md","hash":"543c3434de561760cc86fd4957075a17dbb8fb6f","modified":1492265140000},{"_id":"source/_posts/android-proguard-rules.md","hash":"d6c230dd9205454718061c8c2e2bd8ec0f1605bc","modified":1499670080000},{"_id":"source/_posts/docker-install.md","hash":"7a01d45b1871aededc7f3672feed5419070fd8bd","modified":1500346212000},{"_id":"source/_posts/docker-php.md","hash":"5fd1a496817beed67a5f87f53525a0ecfca11fcb","modified":1505719428000},{"_id":"source/_posts/gson-typeadapter.md","hash":"eb2c2565e3d6dd9c68747d0785204acb2e8d5c83","modified":1499669737000},{"_id":"source/_posts/mysql-node-express.md","hash":"b7da8e1dfba9d5a1a9ba19684bb06ddaae16b910","modified":1492265156000},{"_id":"source/_posts/recyclerview.md","hash":"47b7b30ea82f500763689a73daa469eec79cb73d","modified":1492265159000},{"_id":"source/_posts/right-lick-new-md‘file.md","hash":"bedb04a491883dee684545448df65c93d1ab2b27","modified":1499668514000},{"_id":"source/_posts/soft-keyboard-and-9-patch.md","hash":"7a619e787e6d272568d0471ed7136d471ce3c5dd","modified":1492265163000},{"_id":"source/_posts/spring-boot-multi-module.md","hash":"fdf0a240010863e80e6e9acd55b0e7772da25be2","modified":1517812237543},{"_id":"source/_posts/wechatpay.md","hash":"74b21774479d47eef039f977b3ccfd0c8c459082","modified":1492265174000},{"_id":"source/_posts/《数据的本质：无人不是分析师》摘抄.md","hash":"8eb218194e28a26237ddfcdd0811080eb46cd8c0","modified":1528820978307},{"_id":"source/_posts/《知识的错觉》摘抄.md","hash":"ccc6a95b2de6551ecff0d4e51b484540de54a499","modified":1528820981747},{"_id":"source/_posts/相遇.md","hash":"256453a675e7f296ddb52ac96ee31541fcb3b3bd","modified":1528821074025},{"_id":"source/_posts/花开有时，路遇白花.md","hash":"3c8e99c9e98106c85c60cb7bb0451ad5c1f3d793","modified":1528819954315},{"_id":"source/about/index.md","hash":"1a09ce5bd9969a807799dddd2ca9d1b15f3991e1","modified":1522654350400},{"_id":"source/_posts/SharedElement.md","hash":"50f23292718774490b43b2cec69f0d5258570c36","modified":1529900860382},{"_id":"source/images/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1548066609629},{"_id":"source/_posts/Android上的生命周期监控.md","hash":"3667d9e4ad8f886fce9eebbe73bac3459324a617","modified":1532324557054},{"_id":"source/_posts/Thinking1.md","hash":"08c9698cf2a53aa1277c28f56defd59a8806ce5d","modified":1528821046535},{"_id":"source/images/alipay.png","hash":"f1f893c90720af3fcac260c6825238893beda476","modified":1530680680508},{"_id":"source/_drafts/20180126.md","hash":"34618e12b602d6fd201bdd43f255a57e0ae504d5","modified":1516949846191},{"_id":"source/_drafts/Thinking5.md","hash":"ec0e74ad471bdda1959b25ba768062697ee13fa1","modified":1513758515094},{"_id":"source/_drafts/a-developer-prepares.md","hash":"921d4c10d8d8cbf86f81657bd380211bd29923de","modified":1499671995000},{"_id":"source/_drafts/docker-log.md","hash":"b5c11e9c9714dd708853091a926731e9ba615f46","modified":1510554821995},{"_id":"source/_drafts/cognitive-science.md","hash":"4fc1299ed9d69f7442a7c67d34168e08de41038f","modified":1522662016793},{"_id":"source/_drafts/gradle学习.md","hash":"1ebaeb273d5faae30b9b20237b5a972c4310b48f","modified":1523869643878},{"_id":"source/_drafts/plan.md","hash":"169fcded60bd075ab145e356b7457a1838464e12","modified":1510555222052},{"_id":"source/_drafts/spring-boot-actuator.md","hash":"a0632f00d7c3b6a1a6de7ba86a885fae71134149","modified":1508837399165},{"_id":"source/_drafts/位置.md","hash":"545c5019bbad27cfbf42d72a95ddaba3229afca7","modified":1527052815533},{"_id":"source/_drafts/低效人生.md","hash":"7e669ea2ea4ce70caebc7d61eca76f5515602125","modified":1522721345879},{"_id":"source/_drafts/记录思考.md","hash":"8b49fc02ba4ebdd84e1130abb92462a2ee1edad3","modified":1523501903227},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"b63696d41f022525e40d7e7870c3785b6bc7536b","modified":1522452352000},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"476c9bb6616818be9d86567ad4e2e539c0e0da2f","modified":1522452352000},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"7abbb4c8a29b2c14e576a00f53dbc0b4f5669c13","modified":1522452352000},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"00c25366764e6b9ccb40b877c60dc13b2916bbf7","modified":1522452352000},{"_id":"themes/next/.github/browserstack_logo.png","hash":"a6c43887f64a7f48a2814e3714eaa1215e542037","modified":1522452352000},{"_id":"themes/next/.github/stale.yml","hash":"fd0856f6745db8bd0228079ccb92a662830cc4fb","modified":1522452352000},{"_id":"themes/next/docs/AGPL3.md","hash":"0d2b8c5fa8a614723be0767cc3bca39c49578036","modified":1522452352000},{"_id":"themes/next/docs/AUTHORS.md","hash":"7b24be2891167bdedb9284a682c2344ec63e50b5","modified":1522452352000},{"_id":"themes/next/docs/DATA-FILES.md","hash":"8e1962dd3e1b700169b3ae5bba43992f100651ce","modified":1522452352000},{"_id":"themes/next/docs/ALGOLIA-SEARCH.md","hash":"141e989844d0b5ae2e09fb162a280715afb39b0d","modified":1522452352000},{"_id":"themes/next/docs/INSTALLATION.md","hash":"2bbdd6c1751b2b42ce9b9335da420c6026a483e9","modified":1522452352000},{"_id":"themes/next/docs/LICENSE","hash":"fe607fe22fc9308f6434b892a7f2d2c5514b8f0d","modified":1522452352000},{"_id":"themes/next/docs/UPDATE-FROM-5.1.X.md","hash":"ad57c168d12ba01cf144a1ea0627b2ffd1847d3e","modified":1522452352000},{"_id":"themes/next/docs/MATH.md","hash":"d047b8a3d9aa49b478a33e5a326195d460cb4589","modified":1522452352000},{"_id":"themes/next/scripts/merge-configs.js","hash":"ca9845dc76f5710b4c6fba5fe25ff0d2fcf0adaa","modified":1522452352000},{"_id":"themes/next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1522452352000},{"_id":"themes/next/docs/LEANCLOUD-COUNTER-SECURITY.md","hash":"bbd5aa9a79cac0f630b666bc6db87025e08fb1ac","modified":1522452352000},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1522452352000},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1522452352000},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1522452352000},{"_id":"themes/next/layout/_layout.swig","hash":"5803acd1f338db83a3b8d99eebbf163083e02520","modified":1522452352000},{"_id":"themes/next/layout/archive.swig","hash":"833a2213d31be45a12b8e4e5e609073978bd251b","modified":1522452352000},{"_id":"themes/next/layout/category.swig","hash":"4472255f4a3e3dd6d79201523a9526dcabdfbf18","modified":1522452352000},{"_id":"themes/next/layout/index.swig","hash":"783611349c941848a0e26ee2f1dc44dd14879bd1","modified":1522452352000},{"_id":"themes/next/layout/page.swig","hash":"3f9b2444f12251727ebbc28159f02e9e9489742e","modified":1522452352000},{"_id":"themes/next/layout/post.swig","hash":"8e2d079b46076996cc9343213d5bf7da8178d32d","modified":1522452352000},{"_id":"themes/next/layout/schedule.swig","hash":"d86f8de4e118f8c4d778b285c140474084a271db","modified":1522452352000},{"_id":"themes/next/layout/tag.swig","hash":"7e0a7d7d832883eddb1297483ad22c184e4368de","modified":1522452352000},{"_id":"themes/next/languages/_en.yml","hash":"2397256c752276df666c1ff579902abb367b2380","modified":1522452352000},{"_id":"themes/next/languages/bn.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/cs.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/da.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/de.yml","hash":"31022b4e7caa10ad7551919159fb37c820788398","modified":1522452352000},{"_id":"themes/next/languages/el.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/es.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/et.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/ar.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/bg.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/fr.yml","hash":"059d66eea84757a2c330e865262cbf5d22e384ca","modified":1522452352000},{"_id":"themes/next/languages/fa.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/hi.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/hr.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/hu.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/id.yml","hash":"6aedba65605a6b63451767f6ac4359c7ca72b4b5","modified":1522452352000},{"_id":"themes/next/languages/fi.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/he.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/ko.yml","hash":"e8f29cb1684262cc7de8807f70f22ce25b68ae4e","modified":1522452352000},{"_id":"themes/next/languages/it.yml","hash":"2f183ebc0e26c0ce899e57f1b98b0d1727f8ac06","modified":1522452352000},{"_id":"themes/next/languages/ja.yml","hash":"7ff7c14c97291e2e29ad1e10fa96bcab8fe35a18","modified":1522452352000},{"_id":"themes/next/languages/lt.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/lv.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/ms.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/nl.yml","hash":"b9e752c19a2fa8b9b24ab382c903da3fcefb48df","modified":1522452352000},{"_id":"themes/next/languages/no.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/pa.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/pl.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/jv.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/pt-BR.yml","hash":"08a9d21e2ed1c7871ad2e4c14f57cd5d21fecb20","modified":1522452352000},{"_id":"themes/next/languages/ro.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/pt.yml","hash":"bc1e2b1857b3dbf15632950bd3c06971b9eb7b17","modified":1522452352000},{"_id":"themes/next/languages/sl.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/sv.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/sr.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/th.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/tr.yml","hash":"65b9d8ef239de9d449ff47ed9ba543d2b7665885","modified":1522452352000},{"_id":"themes/next/languages/uk.yml","hash":"371331112a7ec4a61991cb12870ca85b7856b43d","modified":1522452352000},{"_id":"themes/next/languages/vi.yml","hash":"946a5cf34dd0595cd5a4f41706dfb742264f4a27","modified":1522452352000},{"_id":"themes/next/languages/zh-CN.yml","hash":"624a07418da55fde9731e63d8e2beaba1148a2ae","modified":1530685255189},{"_id":"themes/next/languages/zh-TW.yml","hash":"475359a40f23133d33da29f161239f180e208ace","modified":1522452352000},{"_id":"themes/next/languages/zh-HK.yml","hash":"40f3543ec83f15d4d6f5af1782a0424c0cd8a009","modified":1522452352000},{"_id":"source/images/avatar.jpg","hash":"dca9ba4984244e3f68f74ea26b3ebdea82b40a59","modified":1482332335000},{"_id":"themes/next/languages/ru.yml","hash":"13af9d32b823628453ac732e888e95b80ba03c0a","modified":1522452352000},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1522452352000},{"_id":"source/_drafts/.DS_Store","hash":"34ea19fc365b4c76922b3d99d915129ddd9af1c0","modified":1529654497924},{"_id":"source/tags/index.md","hash":"0026a07387fccd4ae052050329902220a5496f02","modified":1482332335000},{"_id":"themes/next/docs/ru/DATA-FILES.md","hash":"d6d20f60f77a76c77f8e65d0c9adbd79d0274557","modified":1522452352000},{"_id":"themes/next/scripts/tags/button.js","hash":"5a61c2da25970a4981fbd65f4a57c5e85db4dcda","modified":1522452352000},{"_id":"themes/next/docs/ru/INSTALLATION.md","hash":"6c5d69e94961c793da156217ecf1179e868d7ba1","modified":1522452352000},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"db70a841e7c1708f95ca97b44413b526b267fa9b","modified":1522452352000},{"_id":"themes/next/scripts/tags/exturl.js","hash":"2b3a4dc15dea33972c0b6d46a1483dabbf06fb5b","modified":1522452352000},{"_id":"themes/next/scripts/tags/full-image.js","hash":"a98fc19a90924f2368e1982f8c449cbc09df8439","modified":1522452352000},{"_id":"themes/next/scripts/tags/include-raw.js","hash":"b7600f6b868d8f4f7032126242d9738cd1e6ad71","modified":1522452352000},{"_id":"themes/next/scripts/tags/label.js","hash":"621004f2836040b12c4e8fef77e62cf22c561297","modified":1522452352000},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"1b97b1b5364945b8ab3e50813bef84273055234f","modified":1522452352000},{"_id":"themes/next/scripts/tags/lazy-image.js","hash":"460e5e1f305847dcd4bcab9da2038a85f0a1c273","modified":1522452352000},{"_id":"themes/next/scripts/tags/note.js","hash":"4975d4433e11161b2e9a5744b7287c2d667b3c76","modified":1522452352000},{"_id":"themes/next/docs/ru/UPDATE-FROM-5.1.X.md","hash":"b1dd18d9b890b21718883ea1832e7e02a773104a","modified":1522452352000},{"_id":"themes/next/docs/ru/README.md","hash":"fd2ee8e3f5afed406f11f24b13e3174dd0d40611","modified":1522452352000},{"_id":"themes/next/scripts/tags/tabs.js","hash":"5786545d51c38e8ca38d1bfc7dd9e946fc70a316","modified":1522452352000},{"_id":"themes/next/docs/zh-CN/ALGOLIA-SEARCH.md","hash":"6855402e2ef59aae307e8bd2a990647d3a605eb8","modified":1522452352000},{"_id":"themes/next/source/css/main.styl","hash":"c26ca6e7b5bd910b9046d6722c8e00be672890e0","modified":1522452352000},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"a45a791b49954331390d548ac34169d573ea5922","modified":1522452352000},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"98ef4dc1a7a12320211ffb36d264cd86ffcce0dd","modified":1522452352000},{"_id":"themes/next/docs/zh-CN/DATA-FILES.md","hash":"f3eec572a7d83542e2710a7404082014aaa1a5e7","modified":1522452352000},{"_id":"themes/next/docs/zh-CN/INSTALLATION.md","hash":"b19a6e0ae96eb7c756fb5b1ba03934c7f9cbb3c3","modified":1522452352000},{"_id":"themes/next/docs/zh-CN/LEANCLOUD-COUNTER-SECURITY.md","hash":"0bc0c3eb909f137c859f38c5c66dcb7c29f76ead","modified":1522452352000},{"_id":"themes/next/docs/zh-CN/MATH.md","hash":"1c7df019737656fdfd8d124c7c045a64ac8a2a8d","modified":1522452352000},{"_id":"themes/next/docs/zh-CN/README.md","hash":"c561c6e3ce4d0941d60d1217c597b19eb00095ff","modified":1522452352000},{"_id":"themes/next/docs/zh-CN/UPDATE-FROM-5.1.X.md","hash":"c1ba919f70efe87a39e6217883e1625af0b2c23c","modified":1522452352000},{"_id":"themes/next/layout/_custom/head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1522452352000},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1522452352000},{"_id":"themes/next/layout/_macro/post-copyright.swig","hash":"464082e431ea5b06df782d5f312ee25be9e5f169","modified":1522452352000},{"_id":"themes/next/layout/_macro/post-related.swig","hash":"08fe30ce8909b920540231e36c97e28cfbce62b6","modified":1522452352000},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1522452352000},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"31322a7f57936cf2dc62e824af5490da5354cf02","modified":1522452352000},{"_id":"themes/next/layout/_macro/post.swig","hash":"7b85cd74fe673d1c842e705a18ae2e2e04f5d391","modified":1522452352000},{"_id":"source/images/WeChatPay.png","hash":"851420a1787acfbd277c5094c5263095e7c5fe23","modified":1548066555292},{"_id":"themes/next/layout/_macro/reward.swig","hash":"aa620c582143f43ba1cb1a5e59240041a911185b","modified":1522452352000},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"fea45ab314b9ea23edab25c2b8620f909d856b1d","modified":1522452352000},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"355ddd5b8af696f7bffb183addd7e84c0a4e2123","modified":1522452352000},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1522452352000},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1522452352000},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1522452352000},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1522452352000},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1522452352000},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1522452352000},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1522452352000},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1522452352000},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1522452352000},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1522452352000},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1522452352000},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1522452352000},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1522452352000},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1522452352000},{"_id":"themes/next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1522452352000},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1522452352000},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1522452352000},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1522452352000},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1522452352000},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1522452352000},{"_id":"themes/next/layout/_scripts/noscript.swig","hash":"ac3ad2c0eccdf16edaa48816d111aaf51200a54b","modified":1522452352000},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"e0bdc723d1dc858b41fd66e44e2786e6519f259f","modified":1522452352000},{"_id":"themes/next/layout/_third-party/bookmark.swig","hash":"60001c8e08b21bf3a7afaf029839e1455340e95d","modified":1522452352000},{"_id":"themes/next/layout/_third-party/github-banner.swig","hash":"cabd9640dc3027a0b3ac06f5ebce777e50754065","modified":1522452352000},{"_id":"themes/next/layout/_third-party/exturl.swig","hash":"7c04a42319d728be356746363aff8ea247791d24","modified":1522452352000},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"fc93b1a7e6aed0dddb1f3910142b48d8ab61174e","modified":1522452352000},{"_id":"themes/next/layout/_third-party/pangu.swig","hash":"6b75c5fd76ae7cf0a7b04024510bd5221607eab3","modified":1522452352000},{"_id":"themes/next/layout/_third-party/needsharebutton.swig","hash":"927f19160ae14e7030df306fc7114ba777476282","modified":1522452352000},{"_id":"themes/next/layout/_third-party/scroll-cookie.swig","hash":"1ddb2336a1a19b47af3017047012c01ec5f54529","modified":1522452352000},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1522452352000},{"_id":"themes/next/layout/_partials/breadcrumb.swig","hash":"6994d891e064f10607bce23f6e2997db7994010e","modified":1522452352000},{"_id":"themes/next/layout/_partials/comments.swig","hash":"5df32b286a8265ba82a4ef5e1439ff34751545ad","modified":1522452352000},{"_id":"themes/next/layout/_partials/footer.swig","hash":"f62e6198dcc41b1cb6a1036094e724065d4e4008","modified":1522452352000},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"1aaf32bed57b976c4c1913fd801be34d4838cc72","modified":1522452352000},{"_id":"themes/next/layout/_partials/header.swig","hash":"6bdae92508fb5009b023386341f3b161a4ac6c70","modified":1522452352000},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"dbe321bcf3cf45917cc11a3e3f50d8572bac2c70","modified":1522452352000},{"_id":"themes/next/layout/_partials/search.swig","hash":"9dbd378e94abfcb3f864a5b8dbbf18d212ca2ee0","modified":1522452352000},{"_id":"themes/next/layout/_partials/sub-menu.swig","hash":"9783a9569fe8344ed287013156e52ca1b0a25544","modified":1522452352000},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1522452352000},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1522452352000},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1522452352000},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1522452352000},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1522452352000},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1522452352000},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1522452352000},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1522452352000},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"2aa5b7166a85a8aa34b17792ae4f58a5a96df6cc","modified":1522452352000},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"7a2706304465b9e673d5561b715e7c72a238437c","modified":1522452352000},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"2640a54fa63bdd4c547eab7ce2fc1192cf0ccec8","modified":1522452352000},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"32392d213f5d05bc26b2dc452f2fc6fea9d44f6d","modified":1522452352000},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1522452352000},{"_id":"themes/next/source/css/_variables/base.styl","hash":"cfb03ec629f13883509eac66e561e9dba562333f","modified":1522452352000},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"81ca13d6d0beff8b1a4b542a51e3b0fb68f08efd","modified":1522452352000},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1522452352000},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1522452352000},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1522452352000},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1522452352000},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1522452352000},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1522452352000},{"_id":"themes/next/layout/_macro/menu/menu-badge-1.swig","hash":"7ffc5c159ab566805ceda6b8c7a4149a7e296116","modified":1522452352000},{"_id":"themes/next/layout/_macro/menu/menu-badge-2.swig","hash":"7b96a0e6079e845573338523cea4437817a4b1e1","modified":1522452352000},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1522452352000},{"_id":"themes/next/layout/_macro/menu/menu-item.swig","hash":"6a04cd1ef9ebac103d86b61505fa9b0f26268fdc","modified":1522452352000},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1522452352000},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1522452352000},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1522452352000},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"531cdedd7fbe8cb1dab2e4328774a9f6b15b59da","modified":1522452352000},{"_id":"themes/next/source/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1522452352000},{"_id":"themes/next/source/js/src/motion.js","hash":"50e57f8acb6924c6999cdcc664ddd3f0730d2061","modified":1522452352000},{"_id":"themes/next/source/js/src/post-details.js","hash":"d1333fb588d4521b4d1e9c69aef06e0ad1bf0b12","modified":1522452352000},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1522452352000},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1522452352000},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1522452352000},{"_id":"themes/next/source/js/src/utils.js","hash":"9543f124adba1f6e3c93d61f85e3e6f74ed5fff4","modified":1522452352000},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1522452352000},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1522452352000},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1522452352000},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"98df9d72e37dd071e882f2d5623c9d817815b139","modified":1522452352000},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1522452352000},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1522452352000},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"67f0cb55e6702c492e99a9f697827629da036a0c","modified":1522452352000},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1522452352000},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"a234c5cd1f75ca5731e814d0dbb92fdcf9240d1b","modified":1522452352000},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"94b26dfbcd1cf2eb87dd9752d58213338926af27","modified":1522452352000},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"beb53371c035b62e1a2c7bb76c63afbb595fe6e5","modified":1522452352000},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"5e9bb24c750b49513d9a65799e832f07410002ac","modified":1522452352000},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1522452352000},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"cee047575ae324398025423696b760db64d04e6f","modified":1522452352000},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"0ddc94ed4ba0c19627765fdf1abc4d8efbe53d5a","modified":1522452352000},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"c3971fd154d781088e1cc665035f8561a4098f4c","modified":1522452352000},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"0e3378f7c39b2b0f69638290873ede6b6b6825c0","modified":1522452352000},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"2fbee33a4ccd7c8217c73e85a9a1488170e05629","modified":1522452352000},{"_id":"themes/next/layout/_third-party/comments/gitment.swig","hash":"fe8177e4698df764e470354b6acde8292a3515e0","modified":1522452352000},{"_id":"themes/next/layout/_third-party/comments/hypercomments.swig","hash":"17a54796f6e03fc834880a58efca45c286e40e40","modified":1522452352000},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"40e3cacbd5fa5f2948d0179eff6dd88053e8648e","modified":1522452352000},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"6f340d122a9816ccdf4b45b662880a4b2d087671","modified":1522452352000},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"c0eb6123464d745ac5324ce6deac8ded601f432f","modified":1522452352000},{"_id":"themes/next/layout/_third-party/comments/youyan.swig","hash":"42f62695029834d45934705c619035733762309e","modified":1522452352000},{"_id":"themes/next/layout/_third-party/math/index.swig","hash":"a6fc00ec7f5642aabd66aa1cf51c6acc5b10e012","modified":1522452352000},{"_id":"themes/next/layout/_third-party/math/katex.swig","hash":"97dbc2035bcb5aa7eafb80a4202dc827cce34983","modified":1522452352000},{"_id":"themes/next/layout/_third-party/math/mathjax.swig","hash":"011ae6303afacddabc4ddf570fe3dd227569cd4f","modified":1522452352000},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"c747fb5c6b1f500e8f0c583e44195878b66e4e29","modified":1522452352000},{"_id":"themes/next/layout/_third-party/search/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1522452352000},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"b15e10abe85b4270860a56c970b559baa258b2a8","modified":1522452352000},{"_id":"themes/next/layout/_third-party/seo/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1522452352000},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1522452352000},{"_id":"themes/next/layout/_partials/head/head-unique.swig","hash":"cd7e3331a61939c820e0437bf5d815cb0a42fefb","modified":1522452352000},{"_id":"themes/next/layout/_partials/head/head.swig","hash":"9f7aa33a620aea6ede1fb907b61fd071c018c525","modified":1522452352000},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1522452352000},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1522452352000},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1522452352000},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1522452352000},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1522452352000},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1522452352000},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"048fd5e98149469f8c28c21ba3561a7a67952c9b","modified":1522452352000},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"7e509c7c28c59f905b847304dd3d14d94b6f3b8e","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"31050fc7a25784805b4843550151c93bfa55c9c8","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"4719ce717962663c5c33ef97b1119a0b3a4ecdc3","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"a6bb5256be6195e76addbda12f4ed7c662d65e7a","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"c5d48863f332ff8ce7c88dec2c893f709d7331d3","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1522452352000},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"47a46583a1f3731157a3f53f80ed1ed5e2753e8e","modified":1522452352000},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1522452352000},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"18309b68ff33163a6f76a39437e618bb6ed411f8","modified":1522452352000},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1522452352000},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1522452352000},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"9c25c75311e1bd4d68df031d3f2ae6d141a90766","modified":1522452352000},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"0810e7c43d6c8adc8434a8fa66eabe0436ab8178","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"f43c821ea272f80703862260b140932fe4aa0e1f","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"3b25edfa187d1bbbd0d38b50dd013cef54758abf","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"0bef9f0dc134215bc4d0984ba3a16a1a0b6f87ec","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"f362fbc791dafb378807cabbc58abf03e097af6d","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"5e12572b18846250e016a872a738026478ceef37","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"d5e8ea6336bc2e237d501ed0d5bbcbbfe296c832","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"35f093fe4c1861661ac1542d6e8ea5a9bbfeb659","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"c4ed249798296f60bda02351fe6404fb3ef2126f","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"05a5abf02e84ba8f639b6f9533418359f0ae4ecb","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"41f9cdafa00e256561c50ae0b97ab7fcd7c1d6a2","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"5779cc8086b1cfde9bc4f1afdd85223bdc45f0a0","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"a863f2c8bae1fbccdc181a5d178b808cd80c5b5e","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"ba1842dbeb97e46c6c4d2ae0e7a2ca6d610ada67","modified":1522452352000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1522452352000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1522452352000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1522452352000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1522452352000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1522452352000},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"8050a5b2683d1d77238c5762b6bd89c543daed6e","modified":1522452352000},{"_id":"themes/next/layout/_third-party/search/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1522452352000},{"_id":"themes/next/layout/_third-party/search/algolia-search/dom.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1522452352000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1522452352000},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1522452352000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"7cc3f36222494c9a1325c5347d7eb9ae53755a32","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/header/github-banner.styl","hash":"ee37e6c465b9b2a7e39175fccfcbed14f2db039b","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"8a2421cb9005352905fae9d41a847ae56957247e","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"39dee82d481dd9d44e33658960ec63e47cd0a715","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"f5aa2ba3bfffc15475e7e72a55b5c9d18609fdf5","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"7dd9a0378ccff3e4a2003f486b1a34e74c20dac6","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"fb451dc4cc0355b57849c27d3eb110c73562f794","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"17b95828f9db7f131ec0361a8c0e89b0b5c9bff5","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"10e9bb3392826a5a8f4cabfc14c6d81645f33fe6","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/third-party/gitment.styl","hash":"34935b40237c074be5f5e8818c14ccfd802b7439","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"d4e6d8d7b34dc69994593c208f875ae8f7e8a3ae","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"cce6772e2cdb4db85d35486ae4c6c59367fbdd40","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"a5e3e6b4b4b814a9fe40b34d784fed67d6d977fa","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"d89c4b562b528e4746696b2ad8935764d133bdae","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"76937db9702053d772f6758d9cea4088c2a6e2a3","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"f54367c0feda6986c030cc4d15a0ca6ceea14bcb","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"1c06be422bc41fd35e5c7948cdea2c09961207f6","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"ca89b167d368eac50a4f808fa53ba67e69cbef94","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"0b57ca04dc3998cf70bb90d777b0db05f3928b82","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-reading_progress.styl","hash":"f4e9f870baa56eae423a123062f00e24cc780be1","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"36332c8a91f089f545f3c3e8ea90d08aa4d6e60c","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"a5d8617a24d7cb6c5ad91ea621183ca2c0917331","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"e4055a0d2cd2b0ad9dc55928e2f3e7bd4e499da3","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"d5a4e4fc17f1f7e7c3a61b52d8e2e9677e139de7","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"8bf095377d28881f63a30bd7db97526829103bf2","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"0f7f522cc6bfb3401d5afd62b0fcdf48bb2d604b","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/tags/exturl.styl","hash":"1b3cc9f4e5a7f6e05b4100e9990b37b20d4a2005","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"5d15cc8bbefe44c77a9b9f96bf04a6033a4b35b8","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"32c9156bea5bac9e9ad0b4c08ffbca8b3d9aac4b","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"4a457d265d62f287c63d48764ce45d9bcfc9ec5a","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"4ab5deed8c3b0c338212380f678f8382672e1bcb","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"ead0d0f2321dc71505788c7f689f92257cf14947","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/tags/note-modern.styl","hash":"ee7528900578ef4753effe05b346381c40de5499","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"89dd4f8b1f1cce3ad46cf2256038472712387d02","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"35c0350096921dd8e2222ec41b6c17a4ea6b44f2","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"efa5e5022e205b52786ce495d4879f5e7b8f84b2","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"920343e41c124221a17f050bbb989494d44f7a24","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"4427ed3250483ed5b7baad74fa93474bd1eda729","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"f7784aba0c1cd20d824c918c120012d57a5eaa2a","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1522452352000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"43bc58daa8d35d5d515dc787ceb21dd77633fe49","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1522452352000},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1522452352000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1522452352000}],"Category":[{"name":"随笔","_id":"cjr66wico0004metpr43x0du7"},{"name":"cognitive-science","_id":"cjr66wiee002tmetpjbaxbi9j"}],"Data":[],"Page":[{"title":"404 Not Found：该页无法显示","date":"2016-12-26T17:12:16.000Z","toc":false,"comments":0,"_content":"","source":"404.md","raw":"---\ntitle: 404 Not Found：该页无法显示\ndate: 2016-12-27 01:12:16\ntoc: false\ncomments: false\npermalink: /404\n---\n","updated":"2016-12-26T17:40:32.000Z","path":"/404.html","layout":"page","_id":"cjr66wi9j0000metppii8gdps","content":"","excerpt":"","more":""},{"title":"","date":"2016-04-06T12:17:53.000Z","updated":"2018-04-02T07:32:30.400Z","tags":null,"comments":0,"_content":"{% fullimage /images/avatar.jpg %}\n \n### 说明\n上面的图片，应该有人知道的，冰火里面提利昂，是一个侏儒，受尽了歧视，为了生存和证明自己，不断地学习，是一个很有智慧的人物，拥有很多粉丝，不会那么快领便当的。\n\n其实在这里开通博客来更新，有几点不方便的地方就在于说，不能做到随时随地就来更新，所以，一般都是现在CSDN上面写好的，那边现在也支持markdown了，回到家以后，修改修改就可以直接放出去来。虽然，很多文章，我觉得其实没太多的技术含量，整天思考我要写多少多少含有技术含量的文章，会使自己忘记初心的，干脆就写工作遇到的一些问题好了，这样便于日后来查询，也便于自己思考是否把这块去深入理解一下了。而且，其实相对CSDN，自己建立的博客站，有个好处就是一来可以装逼，二来这边可以选择自己喜欢的主题。对了，CSDN上面的地址：\n<http://blog.csdn.net/ser_bad>\n\n2017年12月19日增加  </br>\nCSDN的网页改版了好多，而且还多了一个和以前人人网一样的功能，那就是必须登录才能查看更多，这绝对是体验最不好的功能，微博之所以敢这么做，是因为微博上充斥着私人的信息，一些共有的信息完全是可以免登录查看的。但是CSDN上最值钱的其实上面的博客内容，如果这些东西都没有一个很好的获取体验的话，那么对于CSDN的好感就会大大降低。就像先前人人网这样做，然后我选择抛弃人人，公有的信息不能随意查看必然导致对于人人网的使用率和好感度下降，最终必然导致人人网的衰落。关于这个都可以专门开一个话题来认真讨论了，找时间开个坑。下面是我的简书地址，以后只更新这两个地方了。\n<http://www.jianshu.com/u/2F2aMX>\n\n图片出处：\n<http://techgnotic.deviantart.com/journal/Watch-The-Throne-The-Wars-To-Come-526718761>\n","source":"about/index.md","raw":"---\ntitle:\ndate: 2016-04-06 20:17:53\nupdated:\ntags:\ncomments: false\n---\n{% fullimage /images/avatar.jpg %}\n \n### 说明\n上面的图片，应该有人知道的，冰火里面提利昂，是一个侏儒，受尽了歧视，为了生存和证明自己，不断地学习，是一个很有智慧的人物，拥有很多粉丝，不会那么快领便当的。\n\n其实在这里开通博客来更新，有几点不方便的地方就在于说，不能做到随时随地就来更新，所以，一般都是现在CSDN上面写好的，那边现在也支持markdown了，回到家以后，修改修改就可以直接放出去来。虽然，很多文章，我觉得其实没太多的技术含量，整天思考我要写多少多少含有技术含量的文章，会使自己忘记初心的，干脆就写工作遇到的一些问题好了，这样便于日后来查询，也便于自己思考是否把这块去深入理解一下了。而且，其实相对CSDN，自己建立的博客站，有个好处就是一来可以装逼，二来这边可以选择自己喜欢的主题。对了，CSDN上面的地址：\n<http://blog.csdn.net/ser_bad>\n\n2017年12月19日增加  </br>\nCSDN的网页改版了好多，而且还多了一个和以前人人网一样的功能，那就是必须登录才能查看更多，这绝对是体验最不好的功能，微博之所以敢这么做，是因为微博上充斥着私人的信息，一些共有的信息完全是可以免登录查看的。但是CSDN上最值钱的其实上面的博客内容，如果这些东西都没有一个很好的获取体验的话，那么对于CSDN的好感就会大大降低。就像先前人人网这样做，然后我选择抛弃人人，公有的信息不能随意查看必然导致对于人人网的使用率和好感度下降，最终必然导致人人网的衰落。关于这个都可以专门开一个话题来认真讨论了，找时间开个坑。下面是我的简书地址，以后只更新这两个地方了。\n<http://www.jianshu.com/u/2F2aMX>\n\n图片出处：\n<http://techgnotic.deviantart.com/journal/Watch-The-Throne-The-Wars-To-Come-526718761>\n","path":"about/index.html","layout":"page","_id":"cjr66wicl0002metp06x4bxjd","content":"<span itemprop=\"image\" itemscope=\"\" itemtype=\"http://schema.org/ImageObject\"><img itemprop=\"url image\" src=\"/images/avatar.jpg\" class=\"full-image\"><meta itemprop=\"width\" content=\"auto\"><meta itemprop=\"height\" content=\"auto\"></span>\n<h3 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h3><p>上面的图片，应该有人知道的，冰火里面提利昂，是一个侏儒，受尽了歧视，为了生存和证明自己，不断地学习，是一个很有智慧的人物，拥有很多粉丝，不会那么快领便当的。</p>\n<p>其实在这里开通博客来更新，有几点不方便的地方就在于说，不能做到随时随地就来更新，所以，一般都是现在CSDN上面写好的，那边现在也支持markdown了，回到家以后，修改修改就可以直接放出去来。虽然，很多文章，我觉得其实没太多的技术含量，整天思考我要写多少多少含有技术含量的文章，会使自己忘记初心的，干脆就写工作遇到的一些问题好了，这样便于日后来查询，也便于自己思考是否把这块去深入理解一下了。而且，其实相对CSDN，自己建立的博客站，有个好处就是一来可以装逼，二来这边可以选择自己喜欢的主题。对了，CSDN上面的地址：<br><a href=\"http://blog.csdn.net/ser_bad\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/ser_bad</a></p>\n<p>2017年12月19日增加  <br><br>CSDN的网页改版了好多，而且还多了一个和以前人人网一样的功能，那就是必须登录才能查看更多，这绝对是体验最不好的功能，微博之所以敢这么做，是因为微博上充斥着私人的信息，一些共有的信息完全是可以免登录查看的。但是CSDN上最值钱的其实上面的博客内容，如果这些东西都没有一个很好的获取体验的话，那么对于CSDN的好感就会大大降低。就像先前人人网这样做，然后我选择抛弃人人，公有的信息不能随意查看必然导致对于人人网的使用率和好感度下降，最终必然导致人人网的衰落。关于这个都可以专门开一个话题来认真讨论了，找时间开个坑。下面是我的简书地址，以后只更新这两个地方了。<br><a href=\"http://www.jianshu.com/u/2F2aMX\" target=\"_blank\" rel=\"external\">http://www.jianshu.com/u/2F2aMX</a></p>\n<p>图片出处：<br><a href=\"http://techgnotic.deviantart.com/journal/Watch-The-Throne-The-Wars-To-Come-526718761\" target=\"_blank\" rel=\"external\">http://techgnotic.deviantart.com/journal/Watch-The-Throne-The-Wars-To-Come-526718761</a></p>\n","excerpt":"","more":"<span itemprop=\"image\" itemscope itemtype=\"http://schema.org/ImageObject\"><img itemprop=\"url image\" src=\"/images/avatar.jpg\" class=\"full-image\" /><meta itemprop=\"width\" content=\"auto\"><meta itemprop=\"height\" content=\"auto\"></span>\n<h3 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h3><p>上面的图片，应该有人知道的，冰火里面提利昂，是一个侏儒，受尽了歧视，为了生存和证明自己，不断地学习，是一个很有智慧的人物，拥有很多粉丝，不会那么快领便当的。</p>\n<p>其实在这里开通博客来更新，有几点不方便的地方就在于说，不能做到随时随地就来更新，所以，一般都是现在CSDN上面写好的，那边现在也支持markdown了，回到家以后，修改修改就可以直接放出去来。虽然，很多文章，我觉得其实没太多的技术含量，整天思考我要写多少多少含有技术含量的文章，会使自己忘记初心的，干脆就写工作遇到的一些问题好了，这样便于日后来查询，也便于自己思考是否把这块去深入理解一下了。而且，其实相对CSDN，自己建立的博客站，有个好处就是一来可以装逼，二来这边可以选择自己喜欢的主题。对了，CSDN上面的地址：<br><a href=\"http://blog.csdn.net/ser_bad\">http://blog.csdn.net/ser_bad</a></p>\n<p>2017年12月19日增加  </br><br>CSDN的网页改版了好多，而且还多了一个和以前人人网一样的功能，那就是必须登录才能查看更多，这绝对是体验最不好的功能，微博之所以敢这么做，是因为微博上充斥着私人的信息，一些共有的信息完全是可以免登录查看的。但是CSDN上最值钱的其实上面的博客内容，如果这些东西都没有一个很好的获取体验的话，那么对于CSDN的好感就会大大降低。就像先前人人网这样做，然后我选择抛弃人人，公有的信息不能随意查看必然导致对于人人网的使用率和好感度下降，最终必然导致人人网的衰落。关于这个都可以专门开一个话题来认真讨论了，找时间开个坑。下面是我的简书地址，以后只更新这两个地方了。<br><a href=\"http://www.jianshu.com/u/2F2aMX\">http://www.jianshu.com/u/2F2aMX</a></p>\n<p>图片出处：<br><a href=\"http://techgnotic.deviantart.com/journal/Watch-The-Throne-The-Wars-To-Come-526718761\">http://techgnotic.deviantart.com/journal/Watch-The-Throne-The-Wars-To-Come-526718761</a></p>\n"},{"title":"tags","date":"2016-04-15T17:12:59.000Z","comments":0,"tags":null,"type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2016-04-16 01:12:59\ncomments: false\ntags:\ntype: \"tags\"\n---\n","updated":"2016-12-21T14:58:55.000Z","path":"tags/index.html","layout":"page","_id":"cjr66wio80035metpw7li7p9s","content":"","excerpt":"","more":""}],"Post":[{"title":"一个小故事","comments":0,"date":"2018-02-27T09:42:40.000Z","_content":"曾经看过这么一个故事。\n<!--more-->\n第一天，男孩儿对女孩儿说，我喜欢你。女孩没有表示什么，远远地走开了。\n第二天，男孩儿对女孩儿说，我喜欢你。女孩说，先请我吃一次我喜欢的那家餐厅吧。\n第三天，男孩儿对女孩儿说，我喜欢你。女孩依然没有答应他，但是她对男孩儿说带我去一次我最喜欢的那个地方吧。\n第四天，男孩儿对女孩儿说，你到底什么时候才会答应做我女朋友。女孩儿低头不语，默默走开了。\n第五天，男孩儿生气地问女孩儿，你到底答不答应做我的女朋友。女孩儿说，明天去我们第一次见面的地方，我告诉你答案。\n第六天，女孩儿早早地来了，可是男孩儿晚了三个小时才到。男孩儿面带愠色地说，怎么样，想好了没。女孩儿说还是不要了吧。然后男孩儿气呼呼地转身离开了，并说了一句，浪费时间。女孩儿默默地丢掉了三天前精心挑选的礼物，擦了擦眼泪，然后回家去了。\n第七天，男孩儿去寻找新的目标了。女孩儿的生活一切照常。\n","source":"_posts/2018-02-27.md","raw":"---\ntitle: '一个小故事'\ntags: 随笔\ncomments: false\ncategories: 随笔\ndate: 2018-02-27 17:42:40\n---\n曾经看过这么一个故事。\n<!--more-->\n第一天，男孩儿对女孩儿说，我喜欢你。女孩没有表示什么，远远地走开了。\n第二天，男孩儿对女孩儿说，我喜欢你。女孩说，先请我吃一次我喜欢的那家餐厅吧。\n第三天，男孩儿对女孩儿说，我喜欢你。女孩依然没有答应他，但是她对男孩儿说带我去一次我最喜欢的那个地方吧。\n第四天，男孩儿对女孩儿说，你到底什么时候才会答应做我女朋友。女孩儿低头不语，默默走开了。\n第五天，男孩儿生气地问女孩儿，你到底答不答应做我的女朋友。女孩儿说，明天去我们第一次见面的地方，我告诉你答案。\n第六天，女孩儿早早地来了，可是男孩儿晚了三个小时才到。男孩儿面带愠色地说，怎么样，想好了没。女孩儿说还是不要了吧。然后男孩儿气呼呼地转身离开了，并说了一句，浪费时间。女孩儿默默地丢掉了三天前精心挑选的礼物，擦了擦眼泪，然后回家去了。\n第七天，男孩儿去寻找新的目标了。女孩儿的生活一切照常。\n","slug":"2018-02-27","published":1,"updated":"2018-06-12T16:29:50.532Z","layout":"post","photos":[],"link":"","_id":"cjr66wicf0001metpalnuf0dq","content":"<p>曾经看过这么一个故事。<br><a id=\"more\"></a><br>第一天，男孩儿对女孩儿说，我喜欢你。女孩没有表示什么，远远地走开了。<br>第二天，男孩儿对女孩儿说，我喜欢你。女孩说，先请我吃一次我喜欢的那家餐厅吧。<br>第三天，男孩儿对女孩儿说，我喜欢你。女孩依然没有答应他，但是她对男孩儿说带我去一次我最喜欢的那个地方吧。<br>第四天，男孩儿对女孩儿说，你到底什么时候才会答应做我女朋友。女孩儿低头不语，默默走开了。<br>第五天，男孩儿生气地问女孩儿，你到底答不答应做我的女朋友。女孩儿说，明天去我们第一次见面的地方，我告诉你答案。<br>第六天，女孩儿早早地来了，可是男孩儿晚了三个小时才到。男孩儿面带愠色地说，怎么样，想好了没。女孩儿说还是不要了吧。然后男孩儿气呼呼地转身离开了，并说了一句，浪费时间。女孩儿默默地丢掉了三天前精心挑选的礼物，擦了擦眼泪，然后回家去了。<br>第七天，男孩儿去寻找新的目标了。女孩儿的生活一切照常。</p>\n","excerpt":"<p>曾经看过这么一个故事。<br>","more":"<br>第一天，男孩儿对女孩儿说，我喜欢你。女孩没有表示什么，远远地走开了。<br>第二天，男孩儿对女孩儿说，我喜欢你。女孩说，先请我吃一次我喜欢的那家餐厅吧。<br>第三天，男孩儿对女孩儿说，我喜欢你。女孩依然没有答应他，但是她对男孩儿说带我去一次我最喜欢的那个地方吧。<br>第四天，男孩儿对女孩儿说，你到底什么时候才会答应做我女朋友。女孩儿低头不语，默默走开了。<br>第五天，男孩儿生气地问女孩儿，你到底答不答应做我的女朋友。女孩儿说，明天去我们第一次见面的地方，我告诉你答案。<br>第六天，女孩儿早早地来了，可是男孩儿晚了三个小时才到。男孩儿面带愠色地说，怎么样，想好了没。女孩儿说还是不要了吧。然后男孩儿气呼呼地转身离开了，并说了一句，浪费时间。女孩儿默默地丢掉了三天前精心挑选的礼物，擦了擦眼泪，然后回家去了。<br>第七天，男孩儿去寻找新的目标了。女孩儿的生活一切照常。</p>"},{"title":"知识的边界","date":"2018-02-26T12:50:22.000Z","comments":0,"_content":"知识是否有边界呢？这需要是一个问题吗？对于很多人来说，这的确不是一个问题，也许是因为无知，也许是因为无所谓，也许是看不到尽头的无奈。但是对于我来说，知识有边界吗？知识本身就是一个定义相当宽泛的定义，大到宇宙的真谛，小到思考的本质，这些都是可以称之为知识，“吾生有涯，而知也无涯”，如果以生命来衡量的话，我们一生都无法追求尽知识的力量，于是对知识怀有敬畏便是一件很好的事情。\n<!--more-->\n`人类的心智并不是一台计算机，生来就是用于储藏海量信息的。我们的心智经过演化成为一个懂得灵活变通的问题解决专家，学会只提取最有用的信息并举一反三地应用于新情势，引导我们做出决定。于是，个人极少耗费大脑资源储存细枝末节的信息。 --《知识的错觉-为什么我们从未独立思考》`\n\n这是最近看的一本书里面的一段，回顾过往时光中，我是如何学习的呢？我从来只关注学习过程中思想过程以及学习结果中的思想方法，也不关注学到的知识里面的细枝末节，好处是，我可以把学过的东西变成自己的内容然后从新演算一边，坏处是，我无法去向别人论证我的方法，因为这些是我的，我表述的方式也是我的，哪怕这些东西是对的，但是我依然没有办法去证明我是对的。这就是一个问题，这个问题，在总是自己一个人探索的时候是可以走下去的，但是一旦当我不再是一个人，一旦当我需要拓展知识的时候，我尽然无从去清洗地建立一个良好的知识体系，过去的傲慢终究还是打击到了我。于是，当我意识到这个现象对我造成的困扰之后，我就不得不做出一些改变来，否则继续走下去，难关会越来越多。\n\n# 过去几个月的阅读内容\n本来在去年年底（即2017年）的时候，打算写一篇过去一年的总结的，但是写了一半，戛然而止，写不下去，这就是对那段时间自己心态的完美总结，在仔细思索了两个月后，虽然中间也让自己放纵了一段时间，我决定在年后（今天是2018年2月26，节后正式上班的第一天）写点儿什么东西，否则郁积在心中又会被我拖延下去，了无尽头。本来打算分好几篇文章来写的，但是最近两个月读的几本书，都没有足够的精力去把他们变成一篇很长的文章，所以就简短地介绍一些自己看完这几本书之后想到的一些问题吧，后面想到了不错的主题再单独另开一篇文章吧。\n\n今年1月份，看了两本书，一本书是《繁荣的代价》，一本书是《以读攻读》。\n\n第一本举了一些例子来证明繁荣所导致的通病，通篇提供的都是描述繁荣所引发的现象，我原本以为，我会在这本书中看到关于儒家文化的思考，但是很遗憾，他只举了一个日本明治维新的例子，日本在明治维新之后，依然保存了大娘原本的文化，观察现象本来就是好的，虽然本书没有提供关于这些现象很深入的探究，但是总结观察到的现象也的确是能够帮我们去引发思考。繁荣的通病总是有那么多，比如繁荣导致低生育率，低生育率导致人口减少，人口减少之后就需要移民来填充，移民多了之后就无法保持国家民族的向心力，虽然这个现象貌似在我们过往的岁月里出现的少，但是这就是繁荣有可能导致，比如日本现在的人口就在减少，但是他们没有奔溃，有关键的一点，觉得应该是因为移民少，所以民族的向心力还在，虽然青壮年的劳动力减少，但是经济增长的点依然存在，所以他们现在依然是GDP第三。所以关于我们自己今后的走向，是否有所启迪呢？再看。\n\n第二本书是一个英文教授[但汉松](https://weibo.com/p/1005051769741763)写过的一些书评，然后出了一个总的合集，写的蛮不错的，关于文学理论方面于我而言可能也就是稍稍涉足一下吧。\n\n2月，很遗憾，只读完了一本书《春之祭-第一次世界大战和现代的开端》，因为过年回家，所以补了很多旧番，比如《少女终末旅行》、《狂赌之渊》、《东京食尸鬼》、《野良神》，不再次赘述。\n\n《春之祭》，原本是一部芭蕾舞剧，首演于1913年（也就是第一次大战的前一年），当即引发了巨大的争议和褒奖，批判与内省就成了一个现代艺术的一个巨大引子，德国的宣战也不是为了侵犯别人的土地，只是为了防御别人的进攻，并且打击英法（是那种瞧不起的争斗，而不是为了攫取利益），他们相互鄙视，但是也会有在开战后相互跑到对方的阵地去庆祝圣诞节。这就是一战，存在主义，虚无主义，达达主义，一切关于现代主义的开始都来自那个时代的斗争中，一战结束后，英国的工党开始强大起来，很多我们现在所熟悉观念开始诞生与演化，德国极权下的无政府主义开始生根发芽，开始有了法西斯主义，开始有了二战。历史总是有迹可循的，历史总是背离我们，也总是在影响我们，我们究竟是不是还要走一样的路呢？我们现在这个国家不是和二战后的德国的政府形式很像吗，也许只是我才疏学浅，看不透吧。\n\n# 关于职业发展的问题\n除此之外，便是关于现在自己的职业生涯路怎么走的问题。我究竟要做什么，如何做，没人会给我一个良好的回答，这个回答究竟是什么，每每想到这里我就宁愿停笔不写，可是问题依然还是存在的，并不会因为我不作为就不存在了。\n\n互联网是什么呢？在我的理解中，互联网本质上是人的连接，打破这种连接，缔结新的连接，这就是互联网。要做好一个互联网产品，产品、技术、运营、交互设计，缺一不可，现在已经过了随随便便就能获取大量用户的时代了，这些东西就显得尤为重要了。如果做好一个公司呢？公司的组织架构、薪酬体系、舵手的魄力与远见、合适的工作氛围，这些东西能够帮助公司走的很远，做的很大，究竟该如何去做，做到何种程度，依然没有一个思考的结果，坐而论道不如起而远行。如何才是一个良好的做事方式呢？期望管理、问题分析方法等等，又有那些是适合我自己的呢？说到底，于我而言，这些东西还是不存在一个是否合适的问题，因为能够完全由我决定的东西还是太少了，如论如何，走下去，也便只能言尽于此了。\n","source":"_posts/2018-02-26.md","raw":"---\ntitle: 知识的边界\ndate: 2018-02-26 20:50:22\ntags: 随笔\ncategories: 随笔\ncomments: false\n---\n知识是否有边界呢？这需要是一个问题吗？对于很多人来说，这的确不是一个问题，也许是因为无知，也许是因为无所谓，也许是看不到尽头的无奈。但是对于我来说，知识有边界吗？知识本身就是一个定义相当宽泛的定义，大到宇宙的真谛，小到思考的本质，这些都是可以称之为知识，“吾生有涯，而知也无涯”，如果以生命来衡量的话，我们一生都无法追求尽知识的力量，于是对知识怀有敬畏便是一件很好的事情。\n<!--more-->\n`人类的心智并不是一台计算机，生来就是用于储藏海量信息的。我们的心智经过演化成为一个懂得灵活变通的问题解决专家，学会只提取最有用的信息并举一反三地应用于新情势，引导我们做出决定。于是，个人极少耗费大脑资源储存细枝末节的信息。 --《知识的错觉-为什么我们从未独立思考》`\n\n这是最近看的一本书里面的一段，回顾过往时光中，我是如何学习的呢？我从来只关注学习过程中思想过程以及学习结果中的思想方法，也不关注学到的知识里面的细枝末节，好处是，我可以把学过的东西变成自己的内容然后从新演算一边，坏处是，我无法去向别人论证我的方法，因为这些是我的，我表述的方式也是我的，哪怕这些东西是对的，但是我依然没有办法去证明我是对的。这就是一个问题，这个问题，在总是自己一个人探索的时候是可以走下去的，但是一旦当我不再是一个人，一旦当我需要拓展知识的时候，我尽然无从去清洗地建立一个良好的知识体系，过去的傲慢终究还是打击到了我。于是，当我意识到这个现象对我造成的困扰之后，我就不得不做出一些改变来，否则继续走下去，难关会越来越多。\n\n# 过去几个月的阅读内容\n本来在去年年底（即2017年）的时候，打算写一篇过去一年的总结的，但是写了一半，戛然而止，写不下去，这就是对那段时间自己心态的完美总结，在仔细思索了两个月后，虽然中间也让自己放纵了一段时间，我决定在年后（今天是2018年2月26，节后正式上班的第一天）写点儿什么东西，否则郁积在心中又会被我拖延下去，了无尽头。本来打算分好几篇文章来写的，但是最近两个月读的几本书，都没有足够的精力去把他们变成一篇很长的文章，所以就简短地介绍一些自己看完这几本书之后想到的一些问题吧，后面想到了不错的主题再单独另开一篇文章吧。\n\n今年1月份，看了两本书，一本书是《繁荣的代价》，一本书是《以读攻读》。\n\n第一本举了一些例子来证明繁荣所导致的通病，通篇提供的都是描述繁荣所引发的现象，我原本以为，我会在这本书中看到关于儒家文化的思考，但是很遗憾，他只举了一个日本明治维新的例子，日本在明治维新之后，依然保存了大娘原本的文化，观察现象本来就是好的，虽然本书没有提供关于这些现象很深入的探究，但是总结观察到的现象也的确是能够帮我们去引发思考。繁荣的通病总是有那么多，比如繁荣导致低生育率，低生育率导致人口减少，人口减少之后就需要移民来填充，移民多了之后就无法保持国家民族的向心力，虽然这个现象貌似在我们过往的岁月里出现的少，但是这就是繁荣有可能导致，比如日本现在的人口就在减少，但是他们没有奔溃，有关键的一点，觉得应该是因为移民少，所以民族的向心力还在，虽然青壮年的劳动力减少，但是经济增长的点依然存在，所以他们现在依然是GDP第三。所以关于我们自己今后的走向，是否有所启迪呢？再看。\n\n第二本书是一个英文教授[但汉松](https://weibo.com/p/1005051769741763)写过的一些书评，然后出了一个总的合集，写的蛮不错的，关于文学理论方面于我而言可能也就是稍稍涉足一下吧。\n\n2月，很遗憾，只读完了一本书《春之祭-第一次世界大战和现代的开端》，因为过年回家，所以补了很多旧番，比如《少女终末旅行》、《狂赌之渊》、《东京食尸鬼》、《野良神》，不再次赘述。\n\n《春之祭》，原本是一部芭蕾舞剧，首演于1913年（也就是第一次大战的前一年），当即引发了巨大的争议和褒奖，批判与内省就成了一个现代艺术的一个巨大引子，德国的宣战也不是为了侵犯别人的土地，只是为了防御别人的进攻，并且打击英法（是那种瞧不起的争斗，而不是为了攫取利益），他们相互鄙视，但是也会有在开战后相互跑到对方的阵地去庆祝圣诞节。这就是一战，存在主义，虚无主义，达达主义，一切关于现代主义的开始都来自那个时代的斗争中，一战结束后，英国的工党开始强大起来，很多我们现在所熟悉观念开始诞生与演化，德国极权下的无政府主义开始生根发芽，开始有了法西斯主义，开始有了二战。历史总是有迹可循的，历史总是背离我们，也总是在影响我们，我们究竟是不是还要走一样的路呢？我们现在这个国家不是和二战后的德国的政府形式很像吗，也许只是我才疏学浅，看不透吧。\n\n# 关于职业发展的问题\n除此之外，便是关于现在自己的职业生涯路怎么走的问题。我究竟要做什么，如何做，没人会给我一个良好的回答，这个回答究竟是什么，每每想到这里我就宁愿停笔不写，可是问题依然还是存在的，并不会因为我不作为就不存在了。\n\n互联网是什么呢？在我的理解中，互联网本质上是人的连接，打破这种连接，缔结新的连接，这就是互联网。要做好一个互联网产品，产品、技术、运营、交互设计，缺一不可，现在已经过了随随便便就能获取大量用户的时代了，这些东西就显得尤为重要了。如果做好一个公司呢？公司的组织架构、薪酬体系、舵手的魄力与远见、合适的工作氛围，这些东西能够帮助公司走的很远，做的很大，究竟该如何去做，做到何种程度，依然没有一个思考的结果，坐而论道不如起而远行。如何才是一个良好的做事方式呢？期望管理、问题分析方法等等，又有那些是适合我自己的呢？说到底，于我而言，这些东西还是不存在一个是否合适的问题，因为能够完全由我决定的东西还是太少了，如论如何，走下去，也便只能言尽于此了。\n","slug":"2018-02-26","published":1,"updated":"2018-06-12T16:29:47.043Z","layout":"post","photos":[],"link":"","_id":"cjr66wicm0003metpfu458ppx","content":"<p>知识是否有边界呢？这需要是一个问题吗？对于很多人来说，这的确不是一个问题，也许是因为无知，也许是因为无所谓，也许是看不到尽头的无奈。但是对于我来说，知识有边界吗？知识本身就是一个定义相当宽泛的定义，大到宇宙的真谛，小到思考的本质，这些都是可以称之为知识，“吾生有涯，而知也无涯”，如果以生命来衡量的话，我们一生都无法追求尽知识的力量，于是对知识怀有敬畏便是一件很好的事情。<br><a id=\"more\"></a><br><code>人类的心智并不是一台计算机，生来就是用于储藏海量信息的。我们的心智经过演化成为一个懂得灵活变通的问题解决专家，学会只提取最有用的信息并举一反三地应用于新情势，引导我们做出决定。于是，个人极少耗费大脑资源储存细枝末节的信息。 --《知识的错觉-为什么我们从未独立思考》</code></p>\n<p>这是最近看的一本书里面的一段，回顾过往时光中，我是如何学习的呢？我从来只关注学习过程中思想过程以及学习结果中的思想方法，也不关注学到的知识里面的细枝末节，好处是，我可以把学过的东西变成自己的内容然后从新演算一边，坏处是，我无法去向别人论证我的方法，因为这些是我的，我表述的方式也是我的，哪怕这些东西是对的，但是我依然没有办法去证明我是对的。这就是一个问题，这个问题，在总是自己一个人探索的时候是可以走下去的，但是一旦当我不再是一个人，一旦当我需要拓展知识的时候，我尽然无从去清洗地建立一个良好的知识体系，过去的傲慢终究还是打击到了我。于是，当我意识到这个现象对我造成的困扰之后，我就不得不做出一些改变来，否则继续走下去，难关会越来越多。</p>\n<h1 id=\"过去几个月的阅读内容\"><a href=\"#过去几个月的阅读内容\" class=\"headerlink\" title=\"过去几个月的阅读内容\"></a>过去几个月的阅读内容</h1><p>本来在去年年底（即2017年）的时候，打算写一篇过去一年的总结的，但是写了一半，戛然而止，写不下去，这就是对那段时间自己心态的完美总结，在仔细思索了两个月后，虽然中间也让自己放纵了一段时间，我决定在年后（今天是2018年2月26，节后正式上班的第一天）写点儿什么东西，否则郁积在心中又会被我拖延下去，了无尽头。本来打算分好几篇文章来写的，但是最近两个月读的几本书，都没有足够的精力去把他们变成一篇很长的文章，所以就简短地介绍一些自己看完这几本书之后想到的一些问题吧，后面想到了不错的主题再单独另开一篇文章吧。</p>\n<p>今年1月份，看了两本书，一本书是《繁荣的代价》，一本书是《以读攻读》。</p>\n<p>第一本举了一些例子来证明繁荣所导致的通病，通篇提供的都是描述繁荣所引发的现象，我原本以为，我会在这本书中看到关于儒家文化的思考，但是很遗憾，他只举了一个日本明治维新的例子，日本在明治维新之后，依然保存了大娘原本的文化，观察现象本来就是好的，虽然本书没有提供关于这些现象很深入的探究，但是总结观察到的现象也的确是能够帮我们去引发思考。繁荣的通病总是有那么多，比如繁荣导致低生育率，低生育率导致人口减少，人口减少之后就需要移民来填充，移民多了之后就无法保持国家民族的向心力，虽然这个现象貌似在我们过往的岁月里出现的少，但是这就是繁荣有可能导致，比如日本现在的人口就在减少，但是他们没有奔溃，有关键的一点，觉得应该是因为移民少，所以民族的向心力还在，虽然青壮年的劳动力减少，但是经济增长的点依然存在，所以他们现在依然是GDP第三。所以关于我们自己今后的走向，是否有所启迪呢？再看。</p>\n<p>第二本书是一个英文教授<a href=\"https://weibo.com/p/1005051769741763\" target=\"_blank\" rel=\"external\">但汉松</a>写过的一些书评，然后出了一个总的合集，写的蛮不错的，关于文学理论方面于我而言可能也就是稍稍涉足一下吧。</p>\n<p>2月，很遗憾，只读完了一本书《春之祭-第一次世界大战和现代的开端》，因为过年回家，所以补了很多旧番，比如《少女终末旅行》、《狂赌之渊》、《东京食尸鬼》、《野良神》，不再次赘述。</p>\n<p>《春之祭》，原本是一部芭蕾舞剧，首演于1913年（也就是第一次大战的前一年），当即引发了巨大的争议和褒奖，批判与内省就成了一个现代艺术的一个巨大引子，德国的宣战也不是为了侵犯别人的土地，只是为了防御别人的进攻，并且打击英法（是那种瞧不起的争斗，而不是为了攫取利益），他们相互鄙视，但是也会有在开战后相互跑到对方的阵地去庆祝圣诞节。这就是一战，存在主义，虚无主义，达达主义，一切关于现代主义的开始都来自那个时代的斗争中，一战结束后，英国的工党开始强大起来，很多我们现在所熟悉观念开始诞生与演化，德国极权下的无政府主义开始生根发芽，开始有了法西斯主义，开始有了二战。历史总是有迹可循的，历史总是背离我们，也总是在影响我们，我们究竟是不是还要走一样的路呢？我们现在这个国家不是和二战后的德国的政府形式很像吗，也许只是我才疏学浅，看不透吧。</p>\n<h1 id=\"关于职业发展的问题\"><a href=\"#关于职业发展的问题\" class=\"headerlink\" title=\"关于职业发展的问题\"></a>关于职业发展的问题</h1><p>除此之外，便是关于现在自己的职业生涯路怎么走的问题。我究竟要做什么，如何做，没人会给我一个良好的回答，这个回答究竟是什么，每每想到这里我就宁愿停笔不写，可是问题依然还是存在的，并不会因为我不作为就不存在了。</p>\n<p>互联网是什么呢？在我的理解中，互联网本质上是人的连接，打破这种连接，缔结新的连接，这就是互联网。要做好一个互联网产品，产品、技术、运营、交互设计，缺一不可，现在已经过了随随便便就能获取大量用户的时代了，这些东西就显得尤为重要了。如果做好一个公司呢？公司的组织架构、薪酬体系、舵手的魄力与远见、合适的工作氛围，这些东西能够帮助公司走的很远，做的很大，究竟该如何去做，做到何种程度，依然没有一个思考的结果，坐而论道不如起而远行。如何才是一个良好的做事方式呢？期望管理、问题分析方法等等，又有那些是适合我自己的呢？说到底，于我而言，这些东西还是不存在一个是否合适的问题，因为能够完全由我决定的东西还是太少了，如论如何，走下去，也便只能言尽于此了。</p>\n","excerpt":"<p>知识是否有边界呢？这需要是一个问题吗？对于很多人来说，这的确不是一个问题，也许是因为无知，也许是因为无所谓，也许是看不到尽头的无奈。但是对于我来说，知识有边界吗？知识本身就是一个定义相当宽泛的定义，大到宇宙的真谛，小到思考的本质，这些都是可以称之为知识，“吾生有涯，而知也无涯”，如果以生命来衡量的话，我们一生都无法追求尽知识的力量，于是对知识怀有敬畏便是一件很好的事情。<br>","more":"<br><code>人类的心智并不是一台计算机，生来就是用于储藏海量信息的。我们的心智经过演化成为一个懂得灵活变通的问题解决专家，学会只提取最有用的信息并举一反三地应用于新情势，引导我们做出决定。于是，个人极少耗费大脑资源储存细枝末节的信息。 --《知识的错觉-为什么我们从未独立思考》</code></p>\n<p>这是最近看的一本书里面的一段，回顾过往时光中，我是如何学习的呢？我从来只关注学习过程中思想过程以及学习结果中的思想方法，也不关注学到的知识里面的细枝末节，好处是，我可以把学过的东西变成自己的内容然后从新演算一边，坏处是，我无法去向别人论证我的方法，因为这些是我的，我表述的方式也是我的，哪怕这些东西是对的，但是我依然没有办法去证明我是对的。这就是一个问题，这个问题，在总是自己一个人探索的时候是可以走下去的，但是一旦当我不再是一个人，一旦当我需要拓展知识的时候，我尽然无从去清洗地建立一个良好的知识体系，过去的傲慢终究还是打击到了我。于是，当我意识到这个现象对我造成的困扰之后，我就不得不做出一些改变来，否则继续走下去，难关会越来越多。</p>\n<h1 id=\"过去几个月的阅读内容\"><a href=\"#过去几个月的阅读内容\" class=\"headerlink\" title=\"过去几个月的阅读内容\"></a>过去几个月的阅读内容</h1><p>本来在去年年底（即2017年）的时候，打算写一篇过去一年的总结的，但是写了一半，戛然而止，写不下去，这就是对那段时间自己心态的完美总结，在仔细思索了两个月后，虽然中间也让自己放纵了一段时间，我决定在年后（今天是2018年2月26，节后正式上班的第一天）写点儿什么东西，否则郁积在心中又会被我拖延下去，了无尽头。本来打算分好几篇文章来写的，但是最近两个月读的几本书，都没有足够的精力去把他们变成一篇很长的文章，所以就简短地介绍一些自己看完这几本书之后想到的一些问题吧，后面想到了不错的主题再单独另开一篇文章吧。</p>\n<p>今年1月份，看了两本书，一本书是《繁荣的代价》，一本书是《以读攻读》。</p>\n<p>第一本举了一些例子来证明繁荣所导致的通病，通篇提供的都是描述繁荣所引发的现象，我原本以为，我会在这本书中看到关于儒家文化的思考，但是很遗憾，他只举了一个日本明治维新的例子，日本在明治维新之后，依然保存了大娘原本的文化，观察现象本来就是好的，虽然本书没有提供关于这些现象很深入的探究，但是总结观察到的现象也的确是能够帮我们去引发思考。繁荣的通病总是有那么多，比如繁荣导致低生育率，低生育率导致人口减少，人口减少之后就需要移民来填充，移民多了之后就无法保持国家民族的向心力，虽然这个现象貌似在我们过往的岁月里出现的少，但是这就是繁荣有可能导致，比如日本现在的人口就在减少，但是他们没有奔溃，有关键的一点，觉得应该是因为移民少，所以民族的向心力还在，虽然青壮年的劳动力减少，但是经济增长的点依然存在，所以他们现在依然是GDP第三。所以关于我们自己今后的走向，是否有所启迪呢？再看。</p>\n<p>第二本书是一个英文教授<a href=\"https://weibo.com/p/1005051769741763\">但汉松</a>写过的一些书评，然后出了一个总的合集，写的蛮不错的，关于文学理论方面于我而言可能也就是稍稍涉足一下吧。</p>\n<p>2月，很遗憾，只读完了一本书《春之祭-第一次世界大战和现代的开端》，因为过年回家，所以补了很多旧番，比如《少女终末旅行》、《狂赌之渊》、《东京食尸鬼》、《野良神》，不再次赘述。</p>\n<p>《春之祭》，原本是一部芭蕾舞剧，首演于1913年（也就是第一次大战的前一年），当即引发了巨大的争议和褒奖，批判与内省就成了一个现代艺术的一个巨大引子，德国的宣战也不是为了侵犯别人的土地，只是为了防御别人的进攻，并且打击英法（是那种瞧不起的争斗，而不是为了攫取利益），他们相互鄙视，但是也会有在开战后相互跑到对方的阵地去庆祝圣诞节。这就是一战，存在主义，虚无主义，达达主义，一切关于现代主义的开始都来自那个时代的斗争中，一战结束后，英国的工党开始强大起来，很多我们现在所熟悉观念开始诞生与演化，德国极权下的无政府主义开始生根发芽，开始有了法西斯主义，开始有了二战。历史总是有迹可循的，历史总是背离我们，也总是在影响我们，我们究竟是不是还要走一样的路呢？我们现在这个国家不是和二战后的德国的政府形式很像吗，也许只是我才疏学浅，看不透吧。</p>\n<h1 id=\"关于职业发展的问题\"><a href=\"#关于职业发展的问题\" class=\"headerlink\" title=\"关于职业发展的问题\"></a>关于职业发展的问题</h1><p>除此之外，便是关于现在自己的职业生涯路怎么走的问题。我究竟要做什么，如何做，没人会给我一个良好的回答，这个回答究竟是什么，每每想到这里我就宁愿停笔不写，可是问题依然还是存在的，并不会因为我不作为就不存在了。</p>\n<p>互联网是什么呢？在我的理解中，互联网本质上是人的连接，打破这种连接，缔结新的连接，这就是互联网。要做好一个互联网产品，产品、技术、运营、交互设计，缺一不可，现在已经过了随随便便就能获取大量用户的时代了，这些东西就显得尤为重要了。如果做好一个公司呢？公司的组织架构、薪酬体系、舵手的魄力与远见、合适的工作氛围，这些东西能够帮助公司走的很远，做的很大，究竟该如何去做，做到何种程度，依然没有一个思考的结果，坐而论道不如起而远行。如何才是一个良好的做事方式呢？期望管理、问题分析方法等等，又有那些是适合我自己的呢？说到底，于我而言，这些东西还是不存在一个是否合适的问题，因为能够完全由我决定的东西还是太少了，如论如何，走下去，也便只能言尽于此了。</p>"},{"title":"一个架构师该知道的","comments":0,"date":"2018-02-28T07:47:41.000Z","_content":"架构师是什么呢？在我的认知里面，应该是一个技术的统筹和规划者，这个职位存在的意义，就是为了统筹现有的技术架构，规划未来的技术发展。一个优良的架构师需要掌握的知识量是很庞大的，但，说到底这也就是一个职位的名称，最终的目标依然是为了解决问题而存在的（虽然这是一句废话，但是这就是工作的本质，为了解决某些问题才会设置具体的岗位名称的，只是架构师是为了解决更大的技术难题而存在的）。\n<!--more-->\n一个良好的架构师需要具备那些技能，这就是一个见仁见智的问题，因为岗位的职责就是不一样的，架构师也总会遇到一些完全没有接触过的东西，这个时候就体现出架构师最大价值的时候了。即便如此，有些东西依然是一个架构师应该了解并且非常清楚的内容。现在花点儿时间把过往的内容总结一下，先写一篇总的思考，后面会陆续写出来的，希望不是一个坑。\n\n现代的技术架构技术栈，从本质上来说就是  `数据`- `应用`-`前端` 的组合，然后根据具体的业务场景和经验来选择就可以了。\n\n#数据端\n数据端，简单来说就是存储数据的，也就是数据库，当然不仅限于数据库，还可以使用其他的东西来存储数据，比如可以使用文件、内存等存放数据，但是如果考虑高效读取或者永久化存储数据，选择一个合适的数据库就显得很重要了。现在常用的数据库主要有两类，一类是关系型数据库，比如mysql、oracle、sql server等常见的数据库；一类是非关系型数据库（即nosql），比如mongodb、redis、cassandra等数据库。具体选择那种数据库就需要根据具体的业务场景来分析处理，每一种数据库都有其适合的应用场景。如果是业务刚刚开始的情况下，一般都是直接选择关系型数据库，因为从关系型数据库转到nosql比从nosql转到关系型数据库相对容易的多。\n\n#应用\n应用，一般都是代指后端应用，完成数据的读取和处理，接受和反馈给前端处理过的数据内容，当然不一定非要有后端应用，在有些场景下前端也可以处理数据。这是一个技术喷薄的时代，现在的后端应用有很多，比如Go、Java、node、PHP、Python等等，目前，主要的使用场景还是偏Java，其他的都只是了解，后面会单独抽一篇文章来详细介绍这个。综合来说，不管是设计高并发高负载的系统来说，瓶颈其实并不仅仅在后端应用上，而在于后端的整体架构上，这个才是真正限制的地方。后端应用因为选择多，所以在考虑的时候就会考虑很多，比如团队的主要主要技术语言是什么，该语言的社区支持等等，比如你的团队主要的技术能力是Java，你就不可能选择PHP。\n\n#前端\n前端负责的是数据的采集和展示，包括web端、Android、iOS等等，虽然我知道还有其他的端，但是我只接触过上面的三种，目前我的技术栈也就仅限于上面的三种。随着无线应用的发展，前端在过去的时间里同样经历了蓬勃，比如web端的Vue、React、Angular，现在的web已经不再仅仅局限于简单地html了，现在的web开发也不再仅仅局限于展示在pc端了。混合开发、Weex、React Native、hybrid，针对移动端的发展也有很多，但是原生应用依然是最佳的选择，这是无可置疑的。\n\n#架构\n上面只是说了，关于各种关于技术栈最基础的东西。现在说说如何把上面提到的东西整合起来的架构方法，这就是一个架构师该做的事情，上面的技术栈选好之后，就可以进行开发，但是这三者之间如何配合呢？当设计好数据库表时，对于Java而言，可选的数据库连接池就有很多，目前最高效的应该是HikariCP，目前Spring boot2.0就默认集成了HikariCP，其实对于整体架构而言，整个系统最大的限制其实是在对于数据库的增删改查上，增加CPU、内存，创建数据库集群等等都是增加数据库性能的办法。\n\n然后后端应用和前端配合之间，现在更多的使用Restful风格来设计API的，使用的SOA、SOAP、RPC等等还有很多，除了restful之外，与我而言都是需要增长知识点的东西。\n\n#运维\n高可用，易拓展，是一个系统有着良好发展以及可维护性的很重要的一点。对于一个不稳定的东西，是没有办法去使用的，持续集成和持续交付的设计，就关乎一个系统能够有多稳定的运行下去。\n\n上面其实说了很多，但都是一些很基础的内容，也是自己的一点儿思考，当然也还有很多不足的地方。虽然，我现在主要想往Java架构的能力上走，但是需要学习的东西依然还有很多，后面会一一补上来的。以及，最近自己的阅读计划《知识的错觉》、《数据的本质：无人不是分析师》、《靠谱》，不得不感慨，时间总是那么少。\n","source":"_posts/2018-02-28.md","raw":"---\ntitle: '一个架构师该知道的'\ntags: 随笔\ncomments: false\ncategories: 随笔\ndate: 2018-02-28 15:47:41\n---\n架构师是什么呢？在我的认知里面，应该是一个技术的统筹和规划者，这个职位存在的意义，就是为了统筹现有的技术架构，规划未来的技术发展。一个优良的架构师需要掌握的知识量是很庞大的，但，说到底这也就是一个职位的名称，最终的目标依然是为了解决问题而存在的（虽然这是一句废话，但是这就是工作的本质，为了解决某些问题才会设置具体的岗位名称的，只是架构师是为了解决更大的技术难题而存在的）。\n<!--more-->\n一个良好的架构师需要具备那些技能，这就是一个见仁见智的问题，因为岗位的职责就是不一样的，架构师也总会遇到一些完全没有接触过的东西，这个时候就体现出架构师最大价值的时候了。即便如此，有些东西依然是一个架构师应该了解并且非常清楚的内容。现在花点儿时间把过往的内容总结一下，先写一篇总的思考，后面会陆续写出来的，希望不是一个坑。\n\n现代的技术架构技术栈，从本质上来说就是  `数据`- `应用`-`前端` 的组合，然后根据具体的业务场景和经验来选择就可以了。\n\n#数据端\n数据端，简单来说就是存储数据的，也就是数据库，当然不仅限于数据库，还可以使用其他的东西来存储数据，比如可以使用文件、内存等存放数据，但是如果考虑高效读取或者永久化存储数据，选择一个合适的数据库就显得很重要了。现在常用的数据库主要有两类，一类是关系型数据库，比如mysql、oracle、sql server等常见的数据库；一类是非关系型数据库（即nosql），比如mongodb、redis、cassandra等数据库。具体选择那种数据库就需要根据具体的业务场景来分析处理，每一种数据库都有其适合的应用场景。如果是业务刚刚开始的情况下，一般都是直接选择关系型数据库，因为从关系型数据库转到nosql比从nosql转到关系型数据库相对容易的多。\n\n#应用\n应用，一般都是代指后端应用，完成数据的读取和处理，接受和反馈给前端处理过的数据内容，当然不一定非要有后端应用，在有些场景下前端也可以处理数据。这是一个技术喷薄的时代，现在的后端应用有很多，比如Go、Java、node、PHP、Python等等，目前，主要的使用场景还是偏Java，其他的都只是了解，后面会单独抽一篇文章来详细介绍这个。综合来说，不管是设计高并发高负载的系统来说，瓶颈其实并不仅仅在后端应用上，而在于后端的整体架构上，这个才是真正限制的地方。后端应用因为选择多，所以在考虑的时候就会考虑很多，比如团队的主要主要技术语言是什么，该语言的社区支持等等，比如你的团队主要的技术能力是Java，你就不可能选择PHP。\n\n#前端\n前端负责的是数据的采集和展示，包括web端、Android、iOS等等，虽然我知道还有其他的端，但是我只接触过上面的三种，目前我的技术栈也就仅限于上面的三种。随着无线应用的发展，前端在过去的时间里同样经历了蓬勃，比如web端的Vue、React、Angular，现在的web已经不再仅仅局限于简单地html了，现在的web开发也不再仅仅局限于展示在pc端了。混合开发、Weex、React Native、hybrid，针对移动端的发展也有很多，但是原生应用依然是最佳的选择，这是无可置疑的。\n\n#架构\n上面只是说了，关于各种关于技术栈最基础的东西。现在说说如何把上面提到的东西整合起来的架构方法，这就是一个架构师该做的事情，上面的技术栈选好之后，就可以进行开发，但是这三者之间如何配合呢？当设计好数据库表时，对于Java而言，可选的数据库连接池就有很多，目前最高效的应该是HikariCP，目前Spring boot2.0就默认集成了HikariCP，其实对于整体架构而言，整个系统最大的限制其实是在对于数据库的增删改查上，增加CPU、内存，创建数据库集群等等都是增加数据库性能的办法。\n\n然后后端应用和前端配合之间，现在更多的使用Restful风格来设计API的，使用的SOA、SOAP、RPC等等还有很多，除了restful之外，与我而言都是需要增长知识点的东西。\n\n#运维\n高可用，易拓展，是一个系统有着良好发展以及可维护性的很重要的一点。对于一个不稳定的东西，是没有办法去使用的，持续集成和持续交付的设计，就关乎一个系统能够有多稳定的运行下去。\n\n上面其实说了很多，但都是一些很基础的内容，也是自己的一点儿思考，当然也还有很多不足的地方。虽然，我现在主要想往Java架构的能力上走，但是需要学习的东西依然还有很多，后面会一一补上来的。以及，最近自己的阅读计划《知识的错觉》、《数据的本质：无人不是分析师》、《靠谱》，不得不感慨，时间总是那么少。\n","slug":"2018-02-28","published":1,"updated":"2018-06-12T16:29:54.847Z","layout":"post","photos":[],"link":"","_id":"cjr66wicq0006metp7usrim7o","content":"<p>架构师是什么呢？在我的认知里面，应该是一个技术的统筹和规划者，这个职位存在的意义，就是为了统筹现有的技术架构，规划未来的技术发展。一个优良的架构师需要掌握的知识量是很庞大的，但，说到底这也就是一个职位的名称，最终的目标依然是为了解决问题而存在的（虽然这是一句废话，但是这就是工作的本质，为了解决某些问题才会设置具体的岗位名称的，只是架构师是为了解决更大的技术难题而存在的）。<br><a id=\"more\"></a><br>一个良好的架构师需要具备那些技能，这就是一个见仁见智的问题，因为岗位的职责就是不一样的，架构师也总会遇到一些完全没有接触过的东西，这个时候就体现出架构师最大价值的时候了。即便如此，有些东西依然是一个架构师应该了解并且非常清楚的内容。现在花点儿时间把过往的内容总结一下，先写一篇总的思考，后面会陆续写出来的，希望不是一个坑。</p>\n<p>现代的技术架构技术栈，从本质上来说就是  <code>数据</code>- <code>应用</code>-<code>前端</code> 的组合，然后根据具体的业务场景和经验来选择就可以了。</p>\n<p>#数据端<br>数据端，简单来说就是存储数据的，也就是数据库，当然不仅限于数据库，还可以使用其他的东西来存储数据，比如可以使用文件、内存等存放数据，但是如果考虑高效读取或者永久化存储数据，选择一个合适的数据库就显得很重要了。现在常用的数据库主要有两类，一类是关系型数据库，比如mysql、oracle、sql server等常见的数据库；一类是非关系型数据库（即nosql），比如mongodb、redis、cassandra等数据库。具体选择那种数据库就需要根据具体的业务场景来分析处理，每一种数据库都有其适合的应用场景。如果是业务刚刚开始的情况下，一般都是直接选择关系型数据库，因为从关系型数据库转到nosql比从nosql转到关系型数据库相对容易的多。</p>\n<p>#应用<br>应用，一般都是代指后端应用，完成数据的读取和处理，接受和反馈给前端处理过的数据内容，当然不一定非要有后端应用，在有些场景下前端也可以处理数据。这是一个技术喷薄的时代，现在的后端应用有很多，比如Go、Java、node、PHP、Python等等，目前，主要的使用场景还是偏Java，其他的都只是了解，后面会单独抽一篇文章来详细介绍这个。综合来说，不管是设计高并发高负载的系统来说，瓶颈其实并不仅仅在后端应用上，而在于后端的整体架构上，这个才是真正限制的地方。后端应用因为选择多，所以在考虑的时候就会考虑很多，比如团队的主要主要技术语言是什么，该语言的社区支持等等，比如你的团队主要的技术能力是Java，你就不可能选择PHP。</p>\n<p>#前端<br>前端负责的是数据的采集和展示，包括web端、Android、iOS等等，虽然我知道还有其他的端，但是我只接触过上面的三种，目前我的技术栈也就仅限于上面的三种。随着无线应用的发展，前端在过去的时间里同样经历了蓬勃，比如web端的Vue、React、Angular，现在的web已经不再仅仅局限于简单地html了，现在的web开发也不再仅仅局限于展示在pc端了。混合开发、Weex、React Native、hybrid，针对移动端的发展也有很多，但是原生应用依然是最佳的选择，这是无可置疑的。</p>\n<p>#架构<br>上面只是说了，关于各种关于技术栈最基础的东西。现在说说如何把上面提到的东西整合起来的架构方法，这就是一个架构师该做的事情，上面的技术栈选好之后，就可以进行开发，但是这三者之间如何配合呢？当设计好数据库表时，对于Java而言，可选的数据库连接池就有很多，目前最高效的应该是HikariCP，目前Spring boot2.0就默认集成了HikariCP，其实对于整体架构而言，整个系统最大的限制其实是在对于数据库的增删改查上，增加CPU、内存，创建数据库集群等等都是增加数据库性能的办法。</p>\n<p>然后后端应用和前端配合之间，现在更多的使用Restful风格来设计API的，使用的SOA、SOAP、RPC等等还有很多，除了restful之外，与我而言都是需要增长知识点的东西。</p>\n<p>#运维<br>高可用，易拓展，是一个系统有着良好发展以及可维护性的很重要的一点。对于一个不稳定的东西，是没有办法去使用的，持续集成和持续交付的设计，就关乎一个系统能够有多稳定的运行下去。</p>\n<p>上面其实说了很多，但都是一些很基础的内容，也是自己的一点儿思考，当然也还有很多不足的地方。虽然，我现在主要想往Java架构的能力上走，但是需要学习的东西依然还有很多，后面会一一补上来的。以及，最近自己的阅读计划《知识的错觉》、《数据的本质：无人不是分析师》、《靠谱》，不得不感慨，时间总是那么少。</p>\n","excerpt":"<p>架构师是什么呢？在我的认知里面，应该是一个技术的统筹和规划者，这个职位存在的意义，就是为了统筹现有的技术架构，规划未来的技术发展。一个优良的架构师需要掌握的知识量是很庞大的，但，说到底这也就是一个职位的名称，最终的目标依然是为了解决问题而存在的（虽然这是一句废话，但是这就是工作的本质，为了解决某些问题才会设置具体的岗位名称的，只是架构师是为了解决更大的技术难题而存在的）。<br>","more":"<br>一个良好的架构师需要具备那些技能，这就是一个见仁见智的问题，因为岗位的职责就是不一样的，架构师也总会遇到一些完全没有接触过的东西，这个时候就体现出架构师最大价值的时候了。即便如此，有些东西依然是一个架构师应该了解并且非常清楚的内容。现在花点儿时间把过往的内容总结一下，先写一篇总的思考，后面会陆续写出来的，希望不是一个坑。</p>\n<p>现代的技术架构技术栈，从本质上来说就是  <code>数据</code>- <code>应用</code>-<code>前端</code> 的组合，然后根据具体的业务场景和经验来选择就可以了。</p>\n<p>#数据端<br>数据端，简单来说就是存储数据的，也就是数据库，当然不仅限于数据库，还可以使用其他的东西来存储数据，比如可以使用文件、内存等存放数据，但是如果考虑高效读取或者永久化存储数据，选择一个合适的数据库就显得很重要了。现在常用的数据库主要有两类，一类是关系型数据库，比如mysql、oracle、sql server等常见的数据库；一类是非关系型数据库（即nosql），比如mongodb、redis、cassandra等数据库。具体选择那种数据库就需要根据具体的业务场景来分析处理，每一种数据库都有其适合的应用场景。如果是业务刚刚开始的情况下，一般都是直接选择关系型数据库，因为从关系型数据库转到nosql比从nosql转到关系型数据库相对容易的多。</p>\n<p>#应用<br>应用，一般都是代指后端应用，完成数据的读取和处理，接受和反馈给前端处理过的数据内容，当然不一定非要有后端应用，在有些场景下前端也可以处理数据。这是一个技术喷薄的时代，现在的后端应用有很多，比如Go、Java、node、PHP、Python等等，目前，主要的使用场景还是偏Java，其他的都只是了解，后面会单独抽一篇文章来详细介绍这个。综合来说，不管是设计高并发高负载的系统来说，瓶颈其实并不仅仅在后端应用上，而在于后端的整体架构上，这个才是真正限制的地方。后端应用因为选择多，所以在考虑的时候就会考虑很多，比如团队的主要主要技术语言是什么，该语言的社区支持等等，比如你的团队主要的技术能力是Java，你就不可能选择PHP。</p>\n<p>#前端<br>前端负责的是数据的采集和展示，包括web端、Android、iOS等等，虽然我知道还有其他的端，但是我只接触过上面的三种，目前我的技术栈也就仅限于上面的三种。随着无线应用的发展，前端在过去的时间里同样经历了蓬勃，比如web端的Vue、React、Angular，现在的web已经不再仅仅局限于简单地html了，现在的web开发也不再仅仅局限于展示在pc端了。混合开发、Weex、React Native、hybrid，针对移动端的发展也有很多，但是原生应用依然是最佳的选择，这是无可置疑的。</p>\n<p>#架构<br>上面只是说了，关于各种关于技术栈最基础的东西。现在说说如何把上面提到的东西整合起来的架构方法，这就是一个架构师该做的事情，上面的技术栈选好之后，就可以进行开发，但是这三者之间如何配合呢？当设计好数据库表时，对于Java而言，可选的数据库连接池就有很多，目前最高效的应该是HikariCP，目前Spring boot2.0就默认集成了HikariCP，其实对于整体架构而言，整个系统最大的限制其实是在对于数据库的增删改查上，增加CPU、内存，创建数据库集群等等都是增加数据库性能的办法。</p>\n<p>然后后端应用和前端配合之间，现在更多的使用Restful风格来设计API的，使用的SOA、SOAP、RPC等等还有很多，除了restful之外，与我而言都是需要增长知识点的东西。</p>\n<p>#运维<br>高可用，易拓展，是一个系统有着良好发展以及可维护性的很重要的一点。对于一个不稳定的东西，是没有办法去使用的，持续集成和持续交付的设计，就关乎一个系统能够有多稳定的运行下去。</p>\n<p>上面其实说了很多，但都是一些很基础的内容，也是自己的一点儿思考，当然也还有很多不足的地方。虽然，我现在主要想往Java架构的能力上走，但是需要学习的东西依然还有很多，后面会一一补上来的。以及，最近自己的阅读计划《知识的错觉》、《数据的本质：无人不是分析师》、《靠谱》，不得不感慨，时间总是那么少。</p>"},{"title":"关于错误INSTALL_FAILED_NO_MATCHING_ABIS","date":"2016-06-02T12:44:09.000Z","comments":0,"_content":"故事的起因就是因为在往genymotion安装的应用的时候，出现了`INSTALL_FAILED_NO_MATCHING_ABIS`。\n![错误](http://img.blog.csdn.net/20160428170835800)\n\n<!--more-->\n\n因为android平台的多样性，针对不同的CPU架构于是就有了[**ABI**](http://developer.android.com/ndk/guides/abis.html)（Application Binary Interface,）。\n\n目前android支持的ABI有：`armeabi`、`armeabi-v7a`、`arm64-v8a`、`x86`、`x86_64`、`mips`、`mips64`。\n\n在打包的时候可以使用[`Splits`](http://tools.android.com/tech-docs/new-build-system/user-guide/apk-splits)生成不同架构的apk。在`build.gradle`配置的方法就是：\n```gradle\nandroid {\n  ...\n  splits {\n    abi {\n      enable true\n      reset()\n      include 'armeabi','armeabi-v7a','arm64-v8a','x86','x86_64','mips','mips64'\n      universalApk true\n    }\n  }\n}\n```\n效果就是：\n![这里写图片描述](http://img.blog.csdn.net/20160428170922441)\n\n通过这种方法就可以针对不同的CPU架构来分开打包了。\n\n使用[`Splits`](http://tools.android.com/tech-docs/new-build-system/user-guide/apk-splits) 还可以针对不同的分辨率来打包：\n```gradle\nandroid {\n  ...\n  splits {\n    density {\n      enable true\n      exclude \"ldpi\", \"tvdpi\", \"xxxhdpi\"\n      compatibleScreens 'small', 'normal', 'large', 'xlarge'\n    }\n  }\n```\n\n因为都是一些学习总结的文章，还是贴一篇其他人写的不错的文章来参考：\n1. <http://blog.chengyunfeng.com/?p=889&utm_source=tuicool&utm_medium=referral>\n2.  <http://www.jianshu.com/p/cb05698a1968>\n","source":"_posts/INSTALL-FAILED-NO-MATCHING-ABIS.md","raw":"---\ntitle: 关于错误INSTALL_FAILED_NO_MATCHING_ABIS\ndate: 2016-06-02 20:44:09\ntags: android\ncomments: false\n---\n故事的起因就是因为在往genymotion安装的应用的时候，出现了`INSTALL_FAILED_NO_MATCHING_ABIS`。\n![错误](http://img.blog.csdn.net/20160428170835800)\n\n<!--more-->\n\n因为android平台的多样性，针对不同的CPU架构于是就有了[**ABI**](http://developer.android.com/ndk/guides/abis.html)（Application Binary Interface,）。\n\n目前android支持的ABI有：`armeabi`、`armeabi-v7a`、`arm64-v8a`、`x86`、`x86_64`、`mips`、`mips64`。\n\n在打包的时候可以使用[`Splits`](http://tools.android.com/tech-docs/new-build-system/user-guide/apk-splits)生成不同架构的apk。在`build.gradle`配置的方法就是：\n```gradle\nandroid {\n  ...\n  splits {\n    abi {\n      enable true\n      reset()\n      include 'armeabi','armeabi-v7a','arm64-v8a','x86','x86_64','mips','mips64'\n      universalApk true\n    }\n  }\n}\n```\n效果就是：\n![这里写图片描述](http://img.blog.csdn.net/20160428170922441)\n\n通过这种方法就可以针对不同的CPU架构来分开打包了。\n\n使用[`Splits`](http://tools.android.com/tech-docs/new-build-system/user-guide/apk-splits) 还可以针对不同的分辨率来打包：\n```gradle\nandroid {\n  ...\n  splits {\n    density {\n      enable true\n      exclude \"ldpi\", \"tvdpi\", \"xxxhdpi\"\n      compatibleScreens 'small', 'normal', 'large', 'xlarge'\n    }\n  }\n```\n\n因为都是一些学习总结的文章，还是贴一篇其他人写的不错的文章来参考：\n1. <http://blog.chengyunfeng.com/?p=889&utm_source=tuicool&utm_medium=referral>\n2.  <http://www.jianshu.com/p/cb05698a1968>\n","slug":"INSTALL-FAILED-NO-MATCHING-ABIS","published":1,"updated":"2017-04-15T14:05:47.000Z","layout":"post","photos":[],"link":"","_id":"cjr66wics0007metpe81i2u10","content":"<p>故事的起因就是因为在往genymotion安装的应用的时候，出现了<code>INSTALL_FAILED_NO_MATCHING_ABIS</code>。<br><img src=\"http://img.blog.csdn.net/20160428170835800\" alt=\"错误\"></p>\n<a id=\"more\"></a>\n<p>因为android平台的多样性，针对不同的CPU架构于是就有了<a href=\"http://developer.android.com/ndk/guides/abis.html\" target=\"_blank\" rel=\"external\"><strong>ABI</strong></a>（Application Binary Interface,）。</p>\n<p>目前android支持的ABI有：<code>armeabi</code>、<code>armeabi-v7a</code>、<code>arm64-v8a</code>、<code>x86</code>、<code>x86_64</code>、<code>mips</code>、<code>mips64</code>。</p>\n<p>在打包的时候可以使用<a href=\"http://tools.android.com/tech-docs/new-build-system/user-guide/apk-splits\" target=\"_blank\" rel=\"external\"><code>Splits</code></a>生成不同架构的apk。在<code>build.gradle</code>配置的方法就是：<br><figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">android &#123;</div><div class=\"line\">  ...</div><div class=\"line\">  splits &#123;</div><div class=\"line\">    abi &#123;</div><div class=\"line\">      enable <span class=\"keyword\">true</span></div><div class=\"line\">      reset()</div><div class=\"line\">      <span class=\"keyword\">include</span> <span class=\"string\">'armeabi'</span>,<span class=\"string\">'armeabi-v7a'</span>,<span class=\"string\">'arm64-v8a'</span>,<span class=\"string\">'x86'</span>,<span class=\"string\">'x86_64'</span>,<span class=\"string\">'mips'</span>,<span class=\"string\">'mips64'</span></div><div class=\"line\">      universalApk <span class=\"keyword\">true</span></div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>效果就是：<br><img src=\"http://img.blog.csdn.net/20160428170922441\" alt=\"这里写图片描述\"></p>\n<p>通过这种方法就可以针对不同的CPU架构来分开打包了。</p>\n<p>使用<a href=\"http://tools.android.com/tech-docs/new-build-system/user-guide/apk-splits\" target=\"_blank\" rel=\"external\"><code>Splits</code></a> 还可以针对不同的分辨率来打包：<br><figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">android &#123;</div><div class=\"line\">  ...</div><div class=\"line\">  splits &#123;</div><div class=\"line\">    density &#123;</div><div class=\"line\">      enable <span class=\"keyword\">true</span></div><div class=\"line\">      <span class=\"keyword\">exclude</span> <span class=\"string\">\"ldpi\"</span>, <span class=\"string\">\"tvdpi\"</span>, <span class=\"string\">\"xxxhdpi\"</span></div><div class=\"line\">      compatibleScreens <span class=\"string\">'small'</span>, <span class=\"string\">'normal'</span>, <span class=\"string\">'large'</span>, <span class=\"string\">'xlarge'</span></div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;</div></pre></td></tr></table></figure></p>\n<p>因为都是一些学习总结的文章，还是贴一篇其他人写的不错的文章来参考：</p>\n<ol>\n<li><a href=\"http://blog.chengyunfeng.com/?p=889&amp;utm_source=tuicool&amp;utm_medium=referral\" target=\"_blank\" rel=\"external\">http://blog.chengyunfeng.com/?p=889&amp;utm_source=tuicool&amp;utm_medium=referral</a></li>\n<li><a href=\"http://www.jianshu.com/p/cb05698a1968\" target=\"_blank\" rel=\"external\">http://www.jianshu.com/p/cb05698a1968</a></li>\n</ol>\n","excerpt":"<p>故事的起因就是因为在往genymotion安装的应用的时候，出现了<code>INSTALL_FAILED_NO_MATCHING_ABIS</code>。<br><img src=\"http://img.blog.csdn.net/20160428170835800\" alt=\"错误\"></p>","more":"<p>因为android平台的多样性，针对不同的CPU架构于是就有了<a href=\"http://developer.android.com/ndk/guides/abis.html\"><strong>ABI</strong></a>（Application Binary Interface,）。</p>\n<p>目前android支持的ABI有：<code>armeabi</code>、<code>armeabi-v7a</code>、<code>arm64-v8a</code>、<code>x86</code>、<code>x86_64</code>、<code>mips</code>、<code>mips64</code>。</p>\n<p>在打包的时候可以使用<a href=\"http://tools.android.com/tech-docs/new-build-system/user-guide/apk-splits\"><code>Splits</code></a>生成不同架构的apk。在<code>build.gradle</code>配置的方法就是：<br><figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">android &#123;</div><div class=\"line\">  ...</div><div class=\"line\">  splits &#123;</div><div class=\"line\">    abi &#123;</div><div class=\"line\">      enable <span class=\"keyword\">true</span></div><div class=\"line\">      reset()</div><div class=\"line\">      <span class=\"keyword\">include</span> <span class=\"string\">'armeabi'</span>,<span class=\"string\">'armeabi-v7a'</span>,<span class=\"string\">'arm64-v8a'</span>,<span class=\"string\">'x86'</span>,<span class=\"string\">'x86_64'</span>,<span class=\"string\">'mips'</span>,<span class=\"string\">'mips64'</span></div><div class=\"line\">      universalApk <span class=\"keyword\">true</span></div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>效果就是：<br><img src=\"http://img.blog.csdn.net/20160428170922441\" alt=\"这里写图片描述\"></p>\n<p>通过这种方法就可以针对不同的CPU架构来分开打包了。</p>\n<p>使用<a href=\"http://tools.android.com/tech-docs/new-build-system/user-guide/apk-splits\"><code>Splits</code></a> 还可以针对不同的分辨率来打包：<br><figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">android &#123;</div><div class=\"line\">  ...</div><div class=\"line\">  splits &#123;</div><div class=\"line\">    density &#123;</div><div class=\"line\">      enable <span class=\"keyword\">true</span></div><div class=\"line\">      <span class=\"keyword\">exclude</span> <span class=\"string\">\"ldpi\"</span>, <span class=\"string\">\"tvdpi\"</span>, <span class=\"string\">\"xxxhdpi\"</span></div><div class=\"line\">      compatibleScreens <span class=\"string\">'small'</span>, <span class=\"string\">'normal'</span>, <span class=\"string\">'large'</span>, <span class=\"string\">'xlarge'</span></div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;</div></pre></td></tr></table></figure></p>\n<p>因为都是一些学习总结的文章，还是贴一篇其他人写的不错的文章来参考：</p>\n<ol>\n<li><a href=\"http://blog.chengyunfeng.com/?p=889&amp;utm_source=tuicool&amp;utm_medium=referral\">http://blog.chengyunfeng.com/?p=889&amp;utm_source=tuicool&amp;utm_medium=referral</a></li>\n<li><a href=\"http://www.jianshu.com/p/cb05698a1968\">http://www.jianshu.com/p/cb05698a1968</a></li>\n</ol>"},{"title":"ARIANNE","date":"2016-03-31T15:07:07.000Z","comments":0,"_content":"## ARIANNEE\\--EXCERPT FROM THE WINDS OF WINTER\n\nThey struck out north by northwest, across drylands and parched plains and pale sands toward Ghost Hill, the stronghold of House Toland, where the ship that would take them across the Sea of Dorne awaited them.  \"Send a raven whenever you have news,\" Prince Doran told her, \"but report only what you know to be true.  We are lost in fog here, besieged by rumors, falsehoods, and traveler’s tales.  I dare not act until I know for a certainty what is happening.\"\n\nWar is happening, though Arianne, and this time Dorne will not be spared.  \"Doom and death are coming,\" Ellaria Sand had warned them, before she took her own leave from Prince Doran.  \"It is time for my little snakes to scatter, the better to survive the carnage.\"  Ellaria was returning to her father’s seat at Hellholt.  With her went her daughter Loreza, who had just turned seven.  Dorea remained at the Water Gardens, one child amongst a hundred.Obella was to be dispatched to Sunspear, to serve as a cupbearer to the wife of the castellan, Manfrey Martell.\n<!-- more -->\nAnd Elia Sand, oldest of the four girls that Prince Oberyn had fathered on Ellaria, would cross the Sea of Dorne with Arianne.  \"As a lady, not a lance,\" her mother said firmly, but like all the Sand Snakes, Elia had her own mind.\n\nThey crossed the sands in two long days and the better part of two nights, stopping thrice to change their horses.  It was a lonely time for Arianne, surrounded by so many strangers.  Elia was her cousin, but half a child, and Daemon Sand… things had never been the same between her and the Bastard of Godsgrace after her father refused his offer for her hand.  He was a boy then, and bastard born, no fit consort for a princess of Dorne, he should have known better.  And it was my father’s will, not mine.  The rest of her companions she hardly knew at all.    \n\nArianne missed her friends.  Drey and Garin and her sweet Spotted Slyva had been a part of her since she was little, trusted confidants who had shared her dreams and secrets, cheered her when she was sad, helped her face her fears.  One of them had betrayed her, but she missed them all the same.  It was my own fault.  Arianne had made them part of her plot to steal off with Myrcella Baratheon and crown her queen, an act of rebellion meant to force her father’s hand, but someone’s loose tongue had undone her.  The clumsy conspiracy had accomplished nothing, except to cost poor Myrcella part of her face, and Ser Arys Oakheart his life.\n\nArianne missed Ser Arys too, more than she ever would have thought.  He loved me madly, she told herself, yet I was never more than fond of him.  I made use of him in mybed and in my plot, took his love and took his honor, gave him nothing but my body.  In the end he could not live with what we’d done.  Why else would her white knight have charged right into Areo Hotah’s longaxe, to die the way he did?  I was a foolish willful girl, playing at the game of thrones like a drunkard rolling dice.  \n\nThe cost of her folly had been dear.  Drey had been sent across the world to Norvos, Garin exiled to Tyrosh for two years, her sweet silly smiling Slyva married off to Eldon Estermont, a man old enough to be her grandsire.  Ser Arys had paid with his life’s blood, Myrcella with an ear.  \n\nOnly Ser Gerold Dayne had escaped unscathed.  Darkstar.  If Myrcella’s horse had not shied at the last instant, his longsword would have opened her from chest to waist instead just taking off her ear.  Dayne was her most grievous sin, the one that Arianne most regretted.  With one stroke of his sword, he had changed her botched plot into something foul and bloody.  If the gods were good, by now Obara Sand had treed him in his mountain fastness and put an end to him.\n\nShe said as much to Daemon Sand that first night, as they made camp.  \"Be careful what you pray for, princess,\" he replied.  \"Darkstar could put an end to Lady Obara just as easily.\"\n\n\"She has Areo Hotah with her.\"  Prince Doran’s captain of guards had dispatched Ser Arys Oakheart with a single blow, though the Kingsguard were supposed to be the finest knights in all the realm.  \"No man can stand against Hotah.\"\n\n\"Is that what Darkstar is?  A man?\"  Ser Daemon grimaced.  \"A man would not have done what he did to Princess Myrcella.  Ser Gerold is more a viper than your uncle ever was.  Prince Oberyn could see that he was poison, he said so more than once.  It’s just a pity that he never got around to killing him.\"\n\nPoison, thought Arianne.  Yes.  Pretty poison, though.  That was how he’d fooled her.  Gerold Dayne was hard and cruel, but so fair to look upon that the princess had not believed half the tales she’d heard of him.  Pretty boys had ever been her weakness, particularly the ones who were dark and dangerous as well.  That was before, when I was just a girl, she told herself.  I am a woman now, my father’s daughter.  I have learned that lesson.\n\nCome break of day, they were off again.  Elia Sand led the way, her black braid flying behind her as she raced across the dry, cracked plains and up into the hills.  The girl was mad for horses, which might be why she often smelled like one, to the despair of her mother.  Sometimes Arianne felt sorry for Ellaria.  Four girls, and every one of them her father’s daughter.  \n\nThe rest of the party kept a more sedate pace.  The princess found herself riding beside Ser Daemon, remembering other rides when they were younger, rides that often ended in embraces.  When she found herself stealing glances at him, tall and gallant in the saddle, Arianne reminded herself that she was heir to Dorne, and him no more than her shield.  \"Tell me what you know of this Jon Connington,\" she commanded.\n\n\"He’s dead,\" said Daemon Sand.  \"He died in the Disputed Lands.  Of drink, I’ve heard it said.\"      \n\n\"So a dead drunk leads this army?\"\n\n\"Perhaps this Jon Connington is a son of that one.  Or just some clever sellsword who has taken on a dead man’s name.\"\n\n\"Or he never died at all.\"  Could Connington have been pretending to be dead for all these years?  That would require patience worthy of her father.  The thought made Arianne uneasy.  Treating with a man that subtle could be perilous.  \"What was he like before he… before he died?\"\n\n\"I was a boy at Godsgrace when he was sent into exile.  I never knew the man.\"\n\n\"Then tell me what you’ve heard of him from others.\"\n\n\"As my princess commands.  Connington was Lord of Griffin’s Roost when Griffin’s Roost was still a lordship worth the having.  Prince Rhaegar’s squire, or one of them.  Later Prince Rhaegar’s friend and companion.  The Mad King named him Hand during Robert’s Rebellion, but he was defeated at Stoney Sept in the Battle of the Bells, and Robert slipped away.  King Aerys was wroth, and sent Connington into exile.  There he died.\"\n\n\"Or not.\"  Prince Doran had told her all of that.  There must be more.  \"Those are just the things he did.  I know all that.  What sort of man was he?  Honest and honorable, venal and grasping, proud?\"\n\n\"Proud, for a certainty.  Even arrogant.  A faithful friend to Rhaegar, but prickly with others.  Robert was his liege, but I’ve heard it said that Connington chafed at serving such a lord.  Even then, Robert was known to be fond of wine and whores.\"\n\n\"No whores for Lord Jon, then?\"\n\n\"I could not say.  Some men keep their whoring secret.\"\n\n\"Did he have a wife?  A paramour?\"\n\nSer Daemon shrugged.  \"Not that I have ever heard.\"\n\nThat was troubling too.  Ser Arys Oakheart had broken his vows for her, but it did not sound as if Jon Connington could be similarly swayed.  Can I match such a man with words alone?\n\nThe princess lapsed into silence, all the while pondering what she would find at journey’s end.  That night when they made camp, she crept into the tent she shared with Jayne Ladybright and Elia Sand and slipped the bit of parchment out of her sleeve to read the words again.\n\n>*To Prince Doran of House Martell,*  \n{% centerquote %}\nYou will remember me, I pray.I knew your sister well,and was a leal servant of your good-brother.I grieve for them as you do.I did not die, no more than did your sister’s son.To save his life we kept him hidden,but the time for hiding is done.  A dragon has returned to Westeros to claim his birthright and seek vengeance for his father, and for the princess Elia, his mother.In her name I turn to Dorne.Do not forsake us.{% endcenterquote %}\n>Jon Connington  \n>Lord of Griffin’s Roost  \n>Hand of the True King\n\n\nArianne read the letter thrice, then rolled it up and tucked it back into her sleeve.  A dragon has returned to Westeros, but not the dragon my father was expecting.  Nowhere in the words was there a mention of Daenerys Stormborn… nor of Prince Quentyn, her brother, who had been sent to seek the dragon queen.  The princess remembered how her father had pressed the onyx cyvasse piece into her palm, his voice hoarse and low as he confessed his plan.  A long and perilous voyage, with an uncertain welcome at its end, he had said.  He has gone to bring us back our heart’s desire.  Vengeance.  Justice.  Fire and blood.\n\nFire and blood was what Jon Connington (if indeed it was him) was offering as well.  Or was it?  \"He comes with sellswords, but no dragons,\" Prince Doran had told her, the night the raven came.  \"The Golden Company is the best and largest of the free companies, but ten thousand mercenaries cannot hope to win the Seven Kingdoms.  Elia’s son… I would weep for joy if some part of my sister had survived, but what proof do we have that this is Aegon?\"  His voice broke when he said that.  \"Where are the dragons?\" he asked.  \"Where is Daenerys?\" and Arianne knew that he was really saying, \"Where is my son?\"\n\nIn the Boneway and the Prince’s Pass, two Dornish hosts had massed, and there they sat, sharpening their spears, polishing their armor, dicing, drinking, quarreling, their numbers dwindling by the day, waiting, waiting, waiting for the Prince of Dorne to loose them on the enemies of House Martell.  Waiting for the dragons.  For fire and blood.  For me.  One word from Arianne and those armies would march… so long as that word wasdragon.  If instead the word she sent was war, Lord Yronwood and Lord Fowler and their armies would remain in place.  The Prince of Dorne was nothing if not subtle; here warmeant wait.  \n\nAt mid-morning on the third day Ghost Hill loomed up before them, its chalk-white walls shining against the deep blue of the Sea of Dorne.  From the square towers at the castle’s corners flew the banners of House Toland; a green dragon biting its own tail, upon a golden field.  The sun-and-spear of House Martell streamed atop the great central keep, gold and red and orange, defiant.\n\nRavens had flown ahead to warn Lady Toland of their coming, so the castle gates were open, and Nymella’s eldest daughter rode forth with her steward to meet them near the bottom of the hill.  Tall and fierce, with a blaze of bright red hair tumbling about her shoulders, Valena Toland greeted Arianne with a shout of, \"Come at last, have you?  How slow are those horses?\"\n\n\"Swift enough to outrun yours to the castle gates.\"    \n\n\"We will see about that.\"  Valena wheeled her big red around and put her heels into him, and the race was on, through the dusty lanes of the village at the bottom of the hill, as chickens and villagers alike scrambled out of their path.  Arianne was three horse lengths behind by the time she got her mare up to a gallop, but had closed to one halfway up the slope.  The two of them were side-by-side as they thundered towards the gatehouse, but five yards from the gates Elia Sand came flying from the cloud of dust behind them to rush past both of them on her black filly.\n\n\"Are you half horse, child?\" Valena asked, laughing, in the yard.  \"Princess, did you bring a stable girl?\"\n\n\"I’m Elia,\" the girl announced.  \"Lady Lance.\"\n\nWhoever hung that name on her has much to answer for.  Like as not it had been Prince Oberyn, though, and the Red Viper had never answered to anyone but himself.\n\n\"The girl jouster,\" Valena said.  \"Yes, I’ve heard of you.  Since you were the first to the yard, you’ve won the honor of watering and bridling the horses.\"\n\n\"And after that find the bath house,\" said Princess Arianne.  Elia was chalk and dust from heels to hair.  \n\nThat night Arianne and her knights supped with Lady Nymella and her daughters in the great hall of the castle.  Teora, the younger girl, had the same red hair as her sister, but elsewise could not have been more different.  Short, plump, and so shy she might have passed for a mute, she displayed more interest in the spiced beef and honeyed duck than in the comely young knights at the table, and seemed content to let her lady mother and her sister speak for House Toland.  \n\n\"We have heard the same tales here that you have heard at Sunspear,\" Lady Nymella told them as her serving man poured the wine.  \"Sellswords landing on Cape Wrath, castles under siege or being taken, crops seized or burned.  Where these men come from and who they are, no one is certain.\"\n\n\"Pirates and adventurers, we heard at first,\" said Valena.  \"Then it was supposed to be the Golden Company.  Now it’s said to be Jon Connington, the Mad King’s Hand, come back from the grave to reclaim his birthright.  Whoever it is, Griffin’s Roost has fallen to them.  Rain House, Crow’s Nest, Mistwood, even Greenstone on its island.  All taken.\"\n\nArianne’s thoughts went at once to her sweet Spotted Slyva.  \"Who would want Greenstone?  Was there a battle?\"\n\n\"Not as we have heard, but all the tales are garbled.\"\n\n\"Tarth has fallen too, some fisherfolk will tell you,\" said Valena.  \"These sellswords now hold most of Cape Wrath and half the Stepstones.  We hear talk of elephants in the rainwood.\"\n\n\"Elephants?\"  Arianne did not know what to think of that.  \"Are you certain?  Not dragons?\"\n\n\"Elephants,\" Lady Nymella said firmly.\n\n\"And krakens off the Broken Arm, pulling under crippled galleys,\" said Valena.  \"The blood draws them to the surface, our maester claims.  There are bodies in the water.  A few have washed up on our shores.  And that’s not half of it.  A new pirate king has set up on Torturer’s Deep.  The Lord of the Waters, he styles himself.  This one has real warships, three-deckers, monstrous large.  You were wise not to come by sea.  Since the Redwyne fleet passed through the Stepstones, those waters are crawling with strange sails, all the way north to the Straights of Tarth and Shipbreaker’s Bay.  Myrmen, Volantenes, Lyseni, even reavers from the Iron Islands.  Some have entered the Sea of Dorne to land men on the south shore of Cape Wrath.  We found a good fast ship for you, as your father commanded, but even so… be careful.\"\n\nIt is true, then.  Arianne wanted to ask after her brother, but her father had urged her to watch every word.  If these ships had not brought Quentyn home again with his dragon queen, best not to mention him.  Only her father and a few of his most trusted men knew about her brother’s mission to Slaver’s Bay.  Lady Toland and her daughters were not amongst them.  If it were Quentyn, he would have brought Daenerys back to Dorne, surely.  Why would he risk a landing on Cape Wrath, amongst the stormlords?  \n\n\"Is Dorne at risk?\" Lady Nymella asked.  \"I confess, each time I see a strange sail my heart leaps to my throat.  What if these ships turn south?  The best part of the Toland strength is with Lord Yronwood in the Boneway.  Who will defend Ghost Hill if these strangers land upon our shores?  Should I call my men home?\"\n\n\"Your men are needed where they are, my lady,\" Daemon Sand assured her.  Arianne was quick to nod.  Any other counsel could well lead to Lord Yronwood’s host unravelling like an old tapestry as each man rushed home to defend his own lands against supposed enemies who might or might not ever come.  \"Once we know beyond a doubt whether these be friends or foes, my father will know what to do,\" the princess said.\n\nIt was then that pasty, pudgy Teora raised her eyes from the creamcakes on her plate.  \"It is dragons.\"      \n\n\"Dragons?\"  said her mother.  \"Teora, don’t be mad.\"\n\n\"I’m not.  They’re coming.\"\n\n\"How could you possibly know that?\" her sister asked, with a note of scorn in her voice.\n\n\"One of your little dreams?\"\n\nTeora gave a tiny nod, chin trembling.  \"They were dancing.  In my dream.  And everywhere the dragons danced the people died.\"\n\n\"Seven save us.\"  Lady Nymella gave an exasperated sigh.\n\n\"If you did not eat so many creamcakes you would not have such dreams.  Rich foods are not for girls your age, when your humors are so unbalanced.  Maester Toman says — \"\n\n\"I hate Maester Toman,\" Teora said.  Then she bolted from the table, leaving her lady mother to make apologies for her.\n\n\"Be gentle with her, my lady,\" Arianne said.  \"I remember when I was her age.  My father despaired of me, I’m sure.\"  \n\n\"I can attest to that.\"  Ser Daemon took a sip of wine and said, \"House Toland has a dragon on its banners.\"  \n\n\"A dragon eating its own tail, aye,\" Valena said.  \"From the days of Aegon’s Conquest.  He did not conquer here.  Elsewhere he burned his foes, him and his sisters, but here we melted away before them, leaving only stone and sand for them to burn.  And round and round the dragons went, snapping at their tails for want of any other food, till they were tied in knots.\"\n\n\"Our forebears played their part in that,\" Lady Nymella said proudly.  \"Bold deeds were done, and brave men died.  All of it was written down by the maesters who served us.  We have books, if my princess would like to know more.\"\n\n\"Some other time, perhaps,\" said Arianne.\n\nAs Ghost Hill slept that night, the princess donned a hooded cloak against the chill and and walked the castle battlements to clear her thoughts.  Daemon Sand found her leaning on a parapet and gazing out to sea, where the moon was dancing on the water.  \"Princess,\" he said.  \"You ought to be abed.\"\n\n\"I could say the same of you.\"  Arianne turned to gaze upon his face.  A good face, she decided.  The boy I knew has become a handsome man.  His eyes were as blue as a desert sky, his hair the light brown of the sands they had just crossed.  A close-cropped beard followed the thin of a strong jaw, but could not quite hide the dimples when he smiled.  I always loved his smile.\n\nThe Bastard of Godsgrace was one of Dorne’s finest swords as well, as might be expected from one who had been Prince Oberyn’s squire and had received his knighthood from the Red Viper himself.  Some said that he had been her uncle’s lover too, though seldom to his face.  Arianne did not know the truth of that.  He had been her lover, though.  At fourteen she had given him her maidenhead.  Daemon had not been much older, so their couplings had been as clumsy as they were ardent.  Still, it had been sweet.  \n\nArianne gave him her most seductive smile.  \"We might share a bed together.\"\n\nSer Daemon’s face was stone.  \"Have you forgotten, princess?  I am bastard born.\"  He took her hand in his.  \"If I am unworthy of this hand, how can I be worthy of your cunt?\"\n\nShe snatched her hand away.  \"You deserve a slap for that.\"  \n\n\"My face is yours.  Do what you will.\"\n\n\"What I will you will not, it seems.  So be it.  Talk with me instead.  Could this truly be Prince Aegon?\"\n\n\"Gregor Clegane ripped Aegon out of Elia’s arms and smashed his head against a wall,\" Ser Daemon said.  \"If Lord Connington’s prince has a crushed skull, I will believe that Aegon Targaryen has returned from the grave.  Elsewise, no.  This is some feigned boy, no more.  A sellsword’s ploy to win support.\"\n\nMy father fears the same.  \"If not, though… if this truly is Jon Connington, if the boy is Rhaegar’s son… \"\n\n\"Are you hoping that he is, or that he’s not?\"\n\n\"I… it would give great joy to my father if Elia’s son were still alive.  He loved his sister well.\"\n\n\"It was you I asked about, not your father.\"\n\nSo it was.  \"I was seven when Elia died.  They say I held her daughter Rhaenys once, when I was too young to remember.  Aegon will be a stranger to me, whether true or false.\"  The princess paused.  \"We looked for Rhaegar’s sister, not his son.\"  Her father had confided in Ser Daemon when he chose him as his daughter’s shield; with him at least she could speak freely.  \"I would sooner it were Quentyn who’d returned.\"\n\n\"Or so you say,\" said Daemon Sand.  \"Good night, princess.\"  He bowed to her, and left her standing there.\n\nWhat did he mean by that?  Arianne watched him walk away.  What sort of sister would I be, if I did not want my brother back?  It was true, she had resented Quentyn for all those years that she had thought their father meant to name him as his heir in place of her, but that had turned out to be just a misunderstanding.  She was the heir to Dorne, she had her father’s word on that.  Quentyn would have his dragon queen, Daenerys.\n\nIn Sunspear hung a portrait of the Princess Daenerys who had come to Dorne to marry one of Arianne’s forebears.  In her younger days Arianne had spent hours gazing at it, back when she was just a pudgy flat-chested girl on the cusp of maidenhood who prayed every night for the gods to make her pretty.  A hundred years ago, Daenerys Targaryen came to Dorne to make a peace.  Now another comes to make a war, and my brother will be her king and consort.King Quentyn.  Why did that sound so silly?  \n\nAlmost as silly as Quentyn riding on a dragon.  Her brother was an earnest boy,well-behaved and dutiful, but dull.  And plain, so plain.  The gods had given Arianne the beauty she had prayed for, but Quentyn must have prayed for something else.  His head was overlarge and sort of square, his hair the color of dried mud.  His shoulders slumped as well, and he was too thick about the middle.  He looks too much like Father.\n\n\"I love my brother,\" said Arianne, though only the moon could hear her.  Though if truth be told, she scarcely knew him.  Quentyn had been fostered by Lord Anders of House Yronwood, the Bloodroyal, the son of Lord Ormond Yronwood and grandson of Lord Edgar.  In his youth her uncle Oberyn had fought a duel with Edgar, had given him a wound that mortified and killed him.  Afterward men called him ‘the Red Viper,’ and spoke of poison on his blade.  The Yronwoods were an ancient house, proud and powerful.  Before the coming of the Rhoynar they had been kings over half of Dorne, with domains that dwarfed those of House Martell.  Blood feud and rebellion would surely have followed Lord Edgar’s death, had not her father acted at once.  The Red Viper went to Oldtown, thence across to the narrow sea to Lys, though none dared call it exile.  And in due time, Quentyn was given to Lord Anders to foster as a sign of trust.  That helped to heal the breach between Sunspear and the Yronwoods, but it had opened new ones between Quentyn and the Sand Snakes… and Arianne had always been closer to her cousins than to her distant brother.\n\n\"We are still the same blood, though,\" she whispered.  \"Of course I want my brother home.  I do.\"  The wind off the sea was raising gooseprickles all up and down her arms.  Arianne pulled her cloak about herself, and went off to seek her bed.\n\nTheir ship was called the Peregrine.  They sailed upon the morning tide.  The gods were good to them, the sea calm.  Even with good winds, the crossing took a day and a night.  Jayne Ladybright grew greensick and spent most of the voyage spewing, which Elia Sand seemed to find hilarious.  \"Someone needs to spank that child,\" Joss Hood was heard to say… but Elia was amongst those who heard him say it.\n\n\"I am almost a woman grown, ser,\" she responded haughtily.  \"I’ll let you spank me, though…  but first you’ll need to tilt with me, and knock me off my horse.\"\n\n\"We are on a ship, and without horses,\" Joss replied.\n\n\"And ladies do not joust,\" insisted Ser Garibald Shells, a far more serious and proper young man than his companion.\n\n\"I do.  I’m Lady Lance.\"\n\nArianne had heard enough.  \"You may be a lance, but you are no lady.  Go below and stay there till we reach land.\"\n\nElsewise the crossing was uneventful.  At dusk they spied a galley in the distance, her oars rising and falling against the evening stars, but she was moving away from them, and soon dwindled and was gone.  Arianne played a game of cyvasse with Ser Daemon, and another one with Garibald Shells, and somehow managed to lose both.  Ser Garibald was kind enough to say that she played a gallant game, but Daemon mocked her.  \"You have other pieces beside the dragon, princess.  Try moving them sometime.\"\n\n\"I like the dragon.\"  She wanted to slap the smile off his face.  Or kiss it off, perhaps.  The man was as smug as he was comely.  Of all the knights in Dorne, why did my father chose this one to be my shield?  He knows our history.  \"It is just a game.  Tell me of Prince Viserys.\"\n\n\"The Beggar King?\"  Ser Daemon seemed surprised.  \n\n\"Everyone says that Prince Rhaegar was beautiful.  Was Viserys beautiful as well?\"\n\n\"I suppose.  He was Targaryen.  I never saw the man.\"\n\nThe secret pact that Prince Doran had made all those years called for Arianne to be wed to Prince Viserys, not Quentyn to Daenerys.  It had all come undone on the Dothraki sea, when he was murdered.  Crowned with a pot of molten gold.  \"He was killed by a Dothraki khal,\" said Arianne.  \"The dragon queen’s own husband.\"\n\n\"So I’ve heard.  What of it?\"      \n\n\"Just… why did Daenerys let it happen?  Viserys was her brother.  All that remained of her own blood.\"\n\n\"The Dothraki are a savage folk.  Who can know why they kill?  Perhaps Viserys wiped his arse with the wrong hand.\"\n\nPerhaps, thought Arianne, or perhaps Daenerys realized that once her brother was crowned and wed to me, she would be doomed to spend the rest of her life sleeping in a tent and smelling like a horse.  \"She is the Mad King’s daughter,\" the princess said.  \"How do we do know — \"\n\n\"We cannot know,\" Ser Daemon said.  \"We can only hope.\"\n","source":"_posts/ARIANNE.md","raw":"---\ntitle: ARIANNE\ndate: 2016-03-31 23:07:07\ntags: 冰与火之歌\ncomments: false\n---\n## ARIANNEE\\--EXCERPT FROM THE WINDS OF WINTER\n\nThey struck out north by northwest, across drylands and parched plains and pale sands toward Ghost Hill, the stronghold of House Toland, where the ship that would take them across the Sea of Dorne awaited them.  \"Send a raven whenever you have news,\" Prince Doran told her, \"but report only what you know to be true.  We are lost in fog here, besieged by rumors, falsehoods, and traveler’s tales.  I dare not act until I know for a certainty what is happening.\"\n\nWar is happening, though Arianne, and this time Dorne will not be spared.  \"Doom and death are coming,\" Ellaria Sand had warned them, before she took her own leave from Prince Doran.  \"It is time for my little snakes to scatter, the better to survive the carnage.\"  Ellaria was returning to her father’s seat at Hellholt.  With her went her daughter Loreza, who had just turned seven.  Dorea remained at the Water Gardens, one child amongst a hundred.Obella was to be dispatched to Sunspear, to serve as a cupbearer to the wife of the castellan, Manfrey Martell.\n<!-- more -->\nAnd Elia Sand, oldest of the four girls that Prince Oberyn had fathered on Ellaria, would cross the Sea of Dorne with Arianne.  \"As a lady, not a lance,\" her mother said firmly, but like all the Sand Snakes, Elia had her own mind.\n\nThey crossed the sands in two long days and the better part of two nights, stopping thrice to change their horses.  It was a lonely time for Arianne, surrounded by so many strangers.  Elia was her cousin, but half a child, and Daemon Sand… things had never been the same between her and the Bastard of Godsgrace after her father refused his offer for her hand.  He was a boy then, and bastard born, no fit consort for a princess of Dorne, he should have known better.  And it was my father’s will, not mine.  The rest of her companions she hardly knew at all.    \n\nArianne missed her friends.  Drey and Garin and her sweet Spotted Slyva had been a part of her since she was little, trusted confidants who had shared her dreams and secrets, cheered her when she was sad, helped her face her fears.  One of them had betrayed her, but she missed them all the same.  It was my own fault.  Arianne had made them part of her plot to steal off with Myrcella Baratheon and crown her queen, an act of rebellion meant to force her father’s hand, but someone’s loose tongue had undone her.  The clumsy conspiracy had accomplished nothing, except to cost poor Myrcella part of her face, and Ser Arys Oakheart his life.\n\nArianne missed Ser Arys too, more than she ever would have thought.  He loved me madly, she told herself, yet I was never more than fond of him.  I made use of him in mybed and in my plot, took his love and took his honor, gave him nothing but my body.  In the end he could not live with what we’d done.  Why else would her white knight have charged right into Areo Hotah’s longaxe, to die the way he did?  I was a foolish willful girl, playing at the game of thrones like a drunkard rolling dice.  \n\nThe cost of her folly had been dear.  Drey had been sent across the world to Norvos, Garin exiled to Tyrosh for two years, her sweet silly smiling Slyva married off to Eldon Estermont, a man old enough to be her grandsire.  Ser Arys had paid with his life’s blood, Myrcella with an ear.  \n\nOnly Ser Gerold Dayne had escaped unscathed.  Darkstar.  If Myrcella’s horse had not shied at the last instant, his longsword would have opened her from chest to waist instead just taking off her ear.  Dayne was her most grievous sin, the one that Arianne most regretted.  With one stroke of his sword, he had changed her botched plot into something foul and bloody.  If the gods were good, by now Obara Sand had treed him in his mountain fastness and put an end to him.\n\nShe said as much to Daemon Sand that first night, as they made camp.  \"Be careful what you pray for, princess,\" he replied.  \"Darkstar could put an end to Lady Obara just as easily.\"\n\n\"She has Areo Hotah with her.\"  Prince Doran’s captain of guards had dispatched Ser Arys Oakheart with a single blow, though the Kingsguard were supposed to be the finest knights in all the realm.  \"No man can stand against Hotah.\"\n\n\"Is that what Darkstar is?  A man?\"  Ser Daemon grimaced.  \"A man would not have done what he did to Princess Myrcella.  Ser Gerold is more a viper than your uncle ever was.  Prince Oberyn could see that he was poison, he said so more than once.  It’s just a pity that he never got around to killing him.\"\n\nPoison, thought Arianne.  Yes.  Pretty poison, though.  That was how he’d fooled her.  Gerold Dayne was hard and cruel, but so fair to look upon that the princess had not believed half the tales she’d heard of him.  Pretty boys had ever been her weakness, particularly the ones who were dark and dangerous as well.  That was before, when I was just a girl, she told herself.  I am a woman now, my father’s daughter.  I have learned that lesson.\n\nCome break of day, they were off again.  Elia Sand led the way, her black braid flying behind her as she raced across the dry, cracked plains and up into the hills.  The girl was mad for horses, which might be why she often smelled like one, to the despair of her mother.  Sometimes Arianne felt sorry for Ellaria.  Four girls, and every one of them her father’s daughter.  \n\nThe rest of the party kept a more sedate pace.  The princess found herself riding beside Ser Daemon, remembering other rides when they were younger, rides that often ended in embraces.  When she found herself stealing glances at him, tall and gallant in the saddle, Arianne reminded herself that she was heir to Dorne, and him no more than her shield.  \"Tell me what you know of this Jon Connington,\" she commanded.\n\n\"He’s dead,\" said Daemon Sand.  \"He died in the Disputed Lands.  Of drink, I’ve heard it said.\"      \n\n\"So a dead drunk leads this army?\"\n\n\"Perhaps this Jon Connington is a son of that one.  Or just some clever sellsword who has taken on a dead man’s name.\"\n\n\"Or he never died at all.\"  Could Connington have been pretending to be dead for all these years?  That would require patience worthy of her father.  The thought made Arianne uneasy.  Treating with a man that subtle could be perilous.  \"What was he like before he… before he died?\"\n\n\"I was a boy at Godsgrace when he was sent into exile.  I never knew the man.\"\n\n\"Then tell me what you’ve heard of him from others.\"\n\n\"As my princess commands.  Connington was Lord of Griffin’s Roost when Griffin’s Roost was still a lordship worth the having.  Prince Rhaegar’s squire, or one of them.  Later Prince Rhaegar’s friend and companion.  The Mad King named him Hand during Robert’s Rebellion, but he was defeated at Stoney Sept in the Battle of the Bells, and Robert slipped away.  King Aerys was wroth, and sent Connington into exile.  There he died.\"\n\n\"Or not.\"  Prince Doran had told her all of that.  There must be more.  \"Those are just the things he did.  I know all that.  What sort of man was he?  Honest and honorable, venal and grasping, proud?\"\n\n\"Proud, for a certainty.  Even arrogant.  A faithful friend to Rhaegar, but prickly with others.  Robert was his liege, but I’ve heard it said that Connington chafed at serving such a lord.  Even then, Robert was known to be fond of wine and whores.\"\n\n\"No whores for Lord Jon, then?\"\n\n\"I could not say.  Some men keep their whoring secret.\"\n\n\"Did he have a wife?  A paramour?\"\n\nSer Daemon shrugged.  \"Not that I have ever heard.\"\n\nThat was troubling too.  Ser Arys Oakheart had broken his vows for her, but it did not sound as if Jon Connington could be similarly swayed.  Can I match such a man with words alone?\n\nThe princess lapsed into silence, all the while pondering what she would find at journey’s end.  That night when they made camp, she crept into the tent she shared with Jayne Ladybright and Elia Sand and slipped the bit of parchment out of her sleeve to read the words again.\n\n>*To Prince Doran of House Martell,*  \n{% centerquote %}\nYou will remember me, I pray.I knew your sister well,and was a leal servant of your good-brother.I grieve for them as you do.I did not die, no more than did your sister’s son.To save his life we kept him hidden,but the time for hiding is done.  A dragon has returned to Westeros to claim his birthright and seek vengeance for his father, and for the princess Elia, his mother.In her name I turn to Dorne.Do not forsake us.{% endcenterquote %}\n>Jon Connington  \n>Lord of Griffin’s Roost  \n>Hand of the True King\n\n\nArianne read the letter thrice, then rolled it up and tucked it back into her sleeve.  A dragon has returned to Westeros, but not the dragon my father was expecting.  Nowhere in the words was there a mention of Daenerys Stormborn… nor of Prince Quentyn, her brother, who had been sent to seek the dragon queen.  The princess remembered how her father had pressed the onyx cyvasse piece into her palm, his voice hoarse and low as he confessed his plan.  A long and perilous voyage, with an uncertain welcome at its end, he had said.  He has gone to bring us back our heart’s desire.  Vengeance.  Justice.  Fire and blood.\n\nFire and blood was what Jon Connington (if indeed it was him) was offering as well.  Or was it?  \"He comes with sellswords, but no dragons,\" Prince Doran had told her, the night the raven came.  \"The Golden Company is the best and largest of the free companies, but ten thousand mercenaries cannot hope to win the Seven Kingdoms.  Elia’s son… I would weep for joy if some part of my sister had survived, but what proof do we have that this is Aegon?\"  His voice broke when he said that.  \"Where are the dragons?\" he asked.  \"Where is Daenerys?\" and Arianne knew that he was really saying, \"Where is my son?\"\n\nIn the Boneway and the Prince’s Pass, two Dornish hosts had massed, and there they sat, sharpening their spears, polishing their armor, dicing, drinking, quarreling, their numbers dwindling by the day, waiting, waiting, waiting for the Prince of Dorne to loose them on the enemies of House Martell.  Waiting for the dragons.  For fire and blood.  For me.  One word from Arianne and those armies would march… so long as that word wasdragon.  If instead the word she sent was war, Lord Yronwood and Lord Fowler and their armies would remain in place.  The Prince of Dorne was nothing if not subtle; here warmeant wait.  \n\nAt mid-morning on the third day Ghost Hill loomed up before them, its chalk-white walls shining against the deep blue of the Sea of Dorne.  From the square towers at the castle’s corners flew the banners of House Toland; a green dragon biting its own tail, upon a golden field.  The sun-and-spear of House Martell streamed atop the great central keep, gold and red and orange, defiant.\n\nRavens had flown ahead to warn Lady Toland of their coming, so the castle gates were open, and Nymella’s eldest daughter rode forth with her steward to meet them near the bottom of the hill.  Tall and fierce, with a blaze of bright red hair tumbling about her shoulders, Valena Toland greeted Arianne with a shout of, \"Come at last, have you?  How slow are those horses?\"\n\n\"Swift enough to outrun yours to the castle gates.\"    \n\n\"We will see about that.\"  Valena wheeled her big red around and put her heels into him, and the race was on, through the dusty lanes of the village at the bottom of the hill, as chickens and villagers alike scrambled out of their path.  Arianne was three horse lengths behind by the time she got her mare up to a gallop, but had closed to one halfway up the slope.  The two of them were side-by-side as they thundered towards the gatehouse, but five yards from the gates Elia Sand came flying from the cloud of dust behind them to rush past both of them on her black filly.\n\n\"Are you half horse, child?\" Valena asked, laughing, in the yard.  \"Princess, did you bring a stable girl?\"\n\n\"I’m Elia,\" the girl announced.  \"Lady Lance.\"\n\nWhoever hung that name on her has much to answer for.  Like as not it had been Prince Oberyn, though, and the Red Viper had never answered to anyone but himself.\n\n\"The girl jouster,\" Valena said.  \"Yes, I’ve heard of you.  Since you were the first to the yard, you’ve won the honor of watering and bridling the horses.\"\n\n\"And after that find the bath house,\" said Princess Arianne.  Elia was chalk and dust from heels to hair.  \n\nThat night Arianne and her knights supped with Lady Nymella and her daughters in the great hall of the castle.  Teora, the younger girl, had the same red hair as her sister, but elsewise could not have been more different.  Short, plump, and so shy she might have passed for a mute, she displayed more interest in the spiced beef and honeyed duck than in the comely young knights at the table, and seemed content to let her lady mother and her sister speak for House Toland.  \n\n\"We have heard the same tales here that you have heard at Sunspear,\" Lady Nymella told them as her serving man poured the wine.  \"Sellswords landing on Cape Wrath, castles under siege or being taken, crops seized or burned.  Where these men come from and who they are, no one is certain.\"\n\n\"Pirates and adventurers, we heard at first,\" said Valena.  \"Then it was supposed to be the Golden Company.  Now it’s said to be Jon Connington, the Mad King’s Hand, come back from the grave to reclaim his birthright.  Whoever it is, Griffin’s Roost has fallen to them.  Rain House, Crow’s Nest, Mistwood, even Greenstone on its island.  All taken.\"\n\nArianne’s thoughts went at once to her sweet Spotted Slyva.  \"Who would want Greenstone?  Was there a battle?\"\n\n\"Not as we have heard, but all the tales are garbled.\"\n\n\"Tarth has fallen too, some fisherfolk will tell you,\" said Valena.  \"These sellswords now hold most of Cape Wrath and half the Stepstones.  We hear talk of elephants in the rainwood.\"\n\n\"Elephants?\"  Arianne did not know what to think of that.  \"Are you certain?  Not dragons?\"\n\n\"Elephants,\" Lady Nymella said firmly.\n\n\"And krakens off the Broken Arm, pulling under crippled galleys,\" said Valena.  \"The blood draws them to the surface, our maester claims.  There are bodies in the water.  A few have washed up on our shores.  And that’s not half of it.  A new pirate king has set up on Torturer’s Deep.  The Lord of the Waters, he styles himself.  This one has real warships, three-deckers, monstrous large.  You were wise not to come by sea.  Since the Redwyne fleet passed through the Stepstones, those waters are crawling with strange sails, all the way north to the Straights of Tarth and Shipbreaker’s Bay.  Myrmen, Volantenes, Lyseni, even reavers from the Iron Islands.  Some have entered the Sea of Dorne to land men on the south shore of Cape Wrath.  We found a good fast ship for you, as your father commanded, but even so… be careful.\"\n\nIt is true, then.  Arianne wanted to ask after her brother, but her father had urged her to watch every word.  If these ships had not brought Quentyn home again with his dragon queen, best not to mention him.  Only her father and a few of his most trusted men knew about her brother’s mission to Slaver’s Bay.  Lady Toland and her daughters were not amongst them.  If it were Quentyn, he would have brought Daenerys back to Dorne, surely.  Why would he risk a landing on Cape Wrath, amongst the stormlords?  \n\n\"Is Dorne at risk?\" Lady Nymella asked.  \"I confess, each time I see a strange sail my heart leaps to my throat.  What if these ships turn south?  The best part of the Toland strength is with Lord Yronwood in the Boneway.  Who will defend Ghost Hill if these strangers land upon our shores?  Should I call my men home?\"\n\n\"Your men are needed where they are, my lady,\" Daemon Sand assured her.  Arianne was quick to nod.  Any other counsel could well lead to Lord Yronwood’s host unravelling like an old tapestry as each man rushed home to defend his own lands against supposed enemies who might or might not ever come.  \"Once we know beyond a doubt whether these be friends or foes, my father will know what to do,\" the princess said.\n\nIt was then that pasty, pudgy Teora raised her eyes from the creamcakes on her plate.  \"It is dragons.\"      \n\n\"Dragons?\"  said her mother.  \"Teora, don’t be mad.\"\n\n\"I’m not.  They’re coming.\"\n\n\"How could you possibly know that?\" her sister asked, with a note of scorn in her voice.\n\n\"One of your little dreams?\"\n\nTeora gave a tiny nod, chin trembling.  \"They were dancing.  In my dream.  And everywhere the dragons danced the people died.\"\n\n\"Seven save us.\"  Lady Nymella gave an exasperated sigh.\n\n\"If you did not eat so many creamcakes you would not have such dreams.  Rich foods are not for girls your age, when your humors are so unbalanced.  Maester Toman says — \"\n\n\"I hate Maester Toman,\" Teora said.  Then she bolted from the table, leaving her lady mother to make apologies for her.\n\n\"Be gentle with her, my lady,\" Arianne said.  \"I remember when I was her age.  My father despaired of me, I’m sure.\"  \n\n\"I can attest to that.\"  Ser Daemon took a sip of wine and said, \"House Toland has a dragon on its banners.\"  \n\n\"A dragon eating its own tail, aye,\" Valena said.  \"From the days of Aegon’s Conquest.  He did not conquer here.  Elsewhere he burned his foes, him and his sisters, but here we melted away before them, leaving only stone and sand for them to burn.  And round and round the dragons went, snapping at their tails for want of any other food, till they were tied in knots.\"\n\n\"Our forebears played their part in that,\" Lady Nymella said proudly.  \"Bold deeds were done, and brave men died.  All of it was written down by the maesters who served us.  We have books, if my princess would like to know more.\"\n\n\"Some other time, perhaps,\" said Arianne.\n\nAs Ghost Hill slept that night, the princess donned a hooded cloak against the chill and and walked the castle battlements to clear her thoughts.  Daemon Sand found her leaning on a parapet and gazing out to sea, where the moon was dancing on the water.  \"Princess,\" he said.  \"You ought to be abed.\"\n\n\"I could say the same of you.\"  Arianne turned to gaze upon his face.  A good face, she decided.  The boy I knew has become a handsome man.  His eyes were as blue as a desert sky, his hair the light brown of the sands they had just crossed.  A close-cropped beard followed the thin of a strong jaw, but could not quite hide the dimples when he smiled.  I always loved his smile.\n\nThe Bastard of Godsgrace was one of Dorne’s finest swords as well, as might be expected from one who had been Prince Oberyn’s squire and had received his knighthood from the Red Viper himself.  Some said that he had been her uncle’s lover too, though seldom to his face.  Arianne did not know the truth of that.  He had been her lover, though.  At fourteen she had given him her maidenhead.  Daemon had not been much older, so their couplings had been as clumsy as they were ardent.  Still, it had been sweet.  \n\nArianne gave him her most seductive smile.  \"We might share a bed together.\"\n\nSer Daemon’s face was stone.  \"Have you forgotten, princess?  I am bastard born.\"  He took her hand in his.  \"If I am unworthy of this hand, how can I be worthy of your cunt?\"\n\nShe snatched her hand away.  \"You deserve a slap for that.\"  \n\n\"My face is yours.  Do what you will.\"\n\n\"What I will you will not, it seems.  So be it.  Talk with me instead.  Could this truly be Prince Aegon?\"\n\n\"Gregor Clegane ripped Aegon out of Elia’s arms and smashed his head against a wall,\" Ser Daemon said.  \"If Lord Connington’s prince has a crushed skull, I will believe that Aegon Targaryen has returned from the grave.  Elsewise, no.  This is some feigned boy, no more.  A sellsword’s ploy to win support.\"\n\nMy father fears the same.  \"If not, though… if this truly is Jon Connington, if the boy is Rhaegar’s son… \"\n\n\"Are you hoping that he is, or that he’s not?\"\n\n\"I… it would give great joy to my father if Elia’s son were still alive.  He loved his sister well.\"\n\n\"It was you I asked about, not your father.\"\n\nSo it was.  \"I was seven when Elia died.  They say I held her daughter Rhaenys once, when I was too young to remember.  Aegon will be a stranger to me, whether true or false.\"  The princess paused.  \"We looked for Rhaegar’s sister, not his son.\"  Her father had confided in Ser Daemon when he chose him as his daughter’s shield; with him at least she could speak freely.  \"I would sooner it were Quentyn who’d returned.\"\n\n\"Or so you say,\" said Daemon Sand.  \"Good night, princess.\"  He bowed to her, and left her standing there.\n\nWhat did he mean by that?  Arianne watched him walk away.  What sort of sister would I be, if I did not want my brother back?  It was true, she had resented Quentyn for all those years that she had thought their father meant to name him as his heir in place of her, but that had turned out to be just a misunderstanding.  She was the heir to Dorne, she had her father’s word on that.  Quentyn would have his dragon queen, Daenerys.\n\nIn Sunspear hung a portrait of the Princess Daenerys who had come to Dorne to marry one of Arianne’s forebears.  In her younger days Arianne had spent hours gazing at it, back when she was just a pudgy flat-chested girl on the cusp of maidenhood who prayed every night for the gods to make her pretty.  A hundred years ago, Daenerys Targaryen came to Dorne to make a peace.  Now another comes to make a war, and my brother will be her king and consort.King Quentyn.  Why did that sound so silly?  \n\nAlmost as silly as Quentyn riding on a dragon.  Her brother was an earnest boy,well-behaved and dutiful, but dull.  And plain, so plain.  The gods had given Arianne the beauty she had prayed for, but Quentyn must have prayed for something else.  His head was overlarge and sort of square, his hair the color of dried mud.  His shoulders slumped as well, and he was too thick about the middle.  He looks too much like Father.\n\n\"I love my brother,\" said Arianne, though only the moon could hear her.  Though if truth be told, she scarcely knew him.  Quentyn had been fostered by Lord Anders of House Yronwood, the Bloodroyal, the son of Lord Ormond Yronwood and grandson of Lord Edgar.  In his youth her uncle Oberyn had fought a duel with Edgar, had given him a wound that mortified and killed him.  Afterward men called him ‘the Red Viper,’ and spoke of poison on his blade.  The Yronwoods were an ancient house, proud and powerful.  Before the coming of the Rhoynar they had been kings over half of Dorne, with domains that dwarfed those of House Martell.  Blood feud and rebellion would surely have followed Lord Edgar’s death, had not her father acted at once.  The Red Viper went to Oldtown, thence across to the narrow sea to Lys, though none dared call it exile.  And in due time, Quentyn was given to Lord Anders to foster as a sign of trust.  That helped to heal the breach between Sunspear and the Yronwoods, but it had opened new ones between Quentyn and the Sand Snakes… and Arianne had always been closer to her cousins than to her distant brother.\n\n\"We are still the same blood, though,\" she whispered.  \"Of course I want my brother home.  I do.\"  The wind off the sea was raising gooseprickles all up and down her arms.  Arianne pulled her cloak about herself, and went off to seek her bed.\n\nTheir ship was called the Peregrine.  They sailed upon the morning tide.  The gods were good to them, the sea calm.  Even with good winds, the crossing took a day and a night.  Jayne Ladybright grew greensick and spent most of the voyage spewing, which Elia Sand seemed to find hilarious.  \"Someone needs to spank that child,\" Joss Hood was heard to say… but Elia was amongst those who heard him say it.\n\n\"I am almost a woman grown, ser,\" she responded haughtily.  \"I’ll let you spank me, though…  but first you’ll need to tilt with me, and knock me off my horse.\"\n\n\"We are on a ship, and without horses,\" Joss replied.\n\n\"And ladies do not joust,\" insisted Ser Garibald Shells, a far more serious and proper young man than his companion.\n\n\"I do.  I’m Lady Lance.\"\n\nArianne had heard enough.  \"You may be a lance, but you are no lady.  Go below and stay there till we reach land.\"\n\nElsewise the crossing was uneventful.  At dusk they spied a galley in the distance, her oars rising and falling against the evening stars, but she was moving away from them, and soon dwindled and was gone.  Arianne played a game of cyvasse with Ser Daemon, and another one with Garibald Shells, and somehow managed to lose both.  Ser Garibald was kind enough to say that she played a gallant game, but Daemon mocked her.  \"You have other pieces beside the dragon, princess.  Try moving them sometime.\"\n\n\"I like the dragon.\"  She wanted to slap the smile off his face.  Or kiss it off, perhaps.  The man was as smug as he was comely.  Of all the knights in Dorne, why did my father chose this one to be my shield?  He knows our history.  \"It is just a game.  Tell me of Prince Viserys.\"\n\n\"The Beggar King?\"  Ser Daemon seemed surprised.  \n\n\"Everyone says that Prince Rhaegar was beautiful.  Was Viserys beautiful as well?\"\n\n\"I suppose.  He was Targaryen.  I never saw the man.\"\n\nThe secret pact that Prince Doran had made all those years called for Arianne to be wed to Prince Viserys, not Quentyn to Daenerys.  It had all come undone on the Dothraki sea, when he was murdered.  Crowned with a pot of molten gold.  \"He was killed by a Dothraki khal,\" said Arianne.  \"The dragon queen’s own husband.\"\n\n\"So I’ve heard.  What of it?\"      \n\n\"Just… why did Daenerys let it happen?  Viserys was her brother.  All that remained of her own blood.\"\n\n\"The Dothraki are a savage folk.  Who can know why they kill?  Perhaps Viserys wiped his arse with the wrong hand.\"\n\nPerhaps, thought Arianne, or perhaps Daenerys realized that once her brother was crowned and wed to me, she would be doomed to spend the rest of her life sleeping in a tent and smelling like a horse.  \"She is the Mad King’s daughter,\" the princess said.  \"How do we do know — \"\n\n\"We cannot know,\" Ser Daemon said.  \"We can only hope.\"\n","slug":"ARIANNE","published":1,"updated":"2017-04-15T14:05:43.000Z","layout":"post","photos":[],"link":"","_id":"cjr66wics0008metpax2f0pg2","content":"<h2 id=\"ARIANNEE-EXCERPT-FROM-THE-WINDS-OF-WINTER\"><a href=\"#ARIANNEE-EXCERPT-FROM-THE-WINDS-OF-WINTER\" class=\"headerlink\" title=\"ARIANNEE--EXCERPT FROM THE WINDS OF WINTER\"></a>ARIANNEE--EXCERPT FROM THE WINDS OF WINTER</h2><p>They struck out north by northwest, across drylands and parched plains and pale sands toward Ghost Hill, the stronghold of House Toland, where the ship that would take them across the Sea of Dorne awaited them.  “Send a raven whenever you have news,” Prince Doran told her, “but report only what you know to be true.  We are lost in fog here, besieged by rumors, falsehoods, and traveler’s tales.  I dare not act until I know for a certainty what is happening.”</p>\n<p>War is happening, though Arianne, and this time Dorne will not be spared.  “Doom and death are coming,” Ellaria Sand had warned them, before she took her own leave from Prince Doran.  “It is time for my little snakes to scatter, the better to survive the carnage.”  Ellaria was returning to her father’s seat at Hellholt.  With her went her daughter Loreza, who had just turned seven.  Dorea remained at the Water Gardens, one child amongst a hundred.Obella was to be dispatched to Sunspear, to serve as a cupbearer to the wife of the castellan, Manfrey Martell.<br><a id=\"more\"></a><br>And Elia Sand, oldest of the four girls that Prince Oberyn had fathered on Ellaria, would cross the Sea of Dorne with Arianne.  “As a lady, not a lance,” her mother said firmly, but like all the Sand Snakes, Elia had her own mind.</p>\n<p>They crossed the sands in two long days and the better part of two nights, stopping thrice to change their horses.  It was a lonely time for Arianne, surrounded by so many strangers.  Elia was her cousin, but half a child, and Daemon Sand… things had never been the same between her and the Bastard of Godsgrace after her father refused his offer for her hand.  He was a boy then, and bastard born, no fit consort for a princess of Dorne, he should have known better.  And it was my father’s will, not mine.  The rest of her companions she hardly knew at all.    </p>\n<p>Arianne missed her friends.  Drey and Garin and her sweet Spotted Slyva had been a part of her since she was little, trusted confidants who had shared her dreams and secrets, cheered her when she was sad, helped her face her fears.  One of them had betrayed her, but she missed them all the same.  It was my own fault.  Arianne had made them part of her plot to steal off with Myrcella Baratheon and crown her queen, an act of rebellion meant to force her father’s hand, but someone’s loose tongue had undone her.  The clumsy conspiracy had accomplished nothing, except to cost poor Myrcella part of her face, and Ser Arys Oakheart his life.</p>\n<p>Arianne missed Ser Arys too, more than she ever would have thought.  He loved me madly, she told herself, yet I was never more than fond of him.  I made use of him in mybed and in my plot, took his love and took his honor, gave him nothing but my body.  In the end he could not live with what we’d done.  Why else would her white knight have charged right into Areo Hotah’s longaxe, to die the way he did?  I was a foolish willful girl, playing at the game of thrones like a drunkard rolling dice.  </p>\n<p>The cost of her folly had been dear.  Drey had been sent across the world to Norvos, Garin exiled to Tyrosh for two years, her sweet silly smiling Slyva married off to Eldon Estermont, a man old enough to be her grandsire.  Ser Arys had paid with his life’s blood, Myrcella with an ear.  </p>\n<p>Only Ser Gerold Dayne had escaped unscathed.  Darkstar.  If Myrcella’s horse had not shied at the last instant, his longsword would have opened her from chest to waist instead just taking off her ear.  Dayne was her most grievous sin, the one that Arianne most regretted.  With one stroke of his sword, he had changed her botched plot into something foul and bloody.  If the gods were good, by now Obara Sand had treed him in his mountain fastness and put an end to him.</p>\n<p>She said as much to Daemon Sand that first night, as they made camp.  “Be careful what you pray for, princess,” he replied.  “Darkstar could put an end to Lady Obara just as easily.”</p>\n<p>“She has Areo Hotah with her.”  Prince Doran’s captain of guards had dispatched Ser Arys Oakheart with a single blow, though the Kingsguard were supposed to be the finest knights in all the realm.  “No man can stand against Hotah.”</p>\n<p>“Is that what Darkstar is?  A man?”  Ser Daemon grimaced.  “A man would not have done what he did to Princess Myrcella.  Ser Gerold is more a viper than your uncle ever was.  Prince Oberyn could see that he was poison, he said so more than once.  It’s just a pity that he never got around to killing him.”</p>\n<p>Poison, thought Arianne.  Yes.  Pretty poison, though.  That was how he’d fooled her.  Gerold Dayne was hard and cruel, but so fair to look upon that the princess had not believed half the tales she’d heard of him.  Pretty boys had ever been her weakness, particularly the ones who were dark and dangerous as well.  That was before, when I was just a girl, she told herself.  I am a woman now, my father’s daughter.  I have learned that lesson.</p>\n<p>Come break of day, they were off again.  Elia Sand led the way, her black braid flying behind her as she raced across the dry, cracked plains and up into the hills.  The girl was mad for horses, which might be why she often smelled like one, to the despair of her mother.  Sometimes Arianne felt sorry for Ellaria.  Four girls, and every one of them her father’s daughter.  </p>\n<p>The rest of the party kept a more sedate pace.  The princess found herself riding beside Ser Daemon, remembering other rides when they were younger, rides that often ended in embraces.  When she found herself stealing glances at him, tall and gallant in the saddle, Arianne reminded herself that she was heir to Dorne, and him no more than her shield.  “Tell me what you know of this Jon Connington,” she commanded.</p>\n<p>“He’s dead,” said Daemon Sand.  “He died in the Disputed Lands.  Of drink, I’ve heard it said.”      </p>\n<p>“So a dead drunk leads this army?”</p>\n<p>“Perhaps this Jon Connington is a son of that one.  Or just some clever sellsword who has taken on a dead man’s name.”</p>\n<p>“Or he never died at all.”  Could Connington have been pretending to be dead for all these years?  That would require patience worthy of her father.  The thought made Arianne uneasy.  Treating with a man that subtle could be perilous.  “What was he like before he… before he died?”</p>\n<p>“I was a boy at Godsgrace when he was sent into exile.  I never knew the man.”</p>\n<p>“Then tell me what you’ve heard of him from others.”</p>\n<p>“As my princess commands.  Connington was Lord of Griffin’s Roost when Griffin’s Roost was still a lordship worth the having.  Prince Rhaegar’s squire, or one of them.  Later Prince Rhaegar’s friend and companion.  The Mad King named him Hand during Robert’s Rebellion, but he was defeated at Stoney Sept in the Battle of the Bells, and Robert slipped away.  King Aerys was wroth, and sent Connington into exile.  There he died.”</p>\n<p>“Or not.”  Prince Doran had told her all of that.  There must be more.  “Those are just the things he did.  I know all that.  What sort of man was he?  Honest and honorable, venal and grasping, proud?”</p>\n<p>“Proud, for a certainty.  Even arrogant.  A faithful friend to Rhaegar, but prickly with others.  Robert was his liege, but I’ve heard it said that Connington chafed at serving such a lord.  Even then, Robert was known to be fond of wine and whores.”</p>\n<p>“No whores for Lord Jon, then?”</p>\n<p>“I could not say.  Some men keep their whoring secret.”</p>\n<p>“Did he have a wife?  A paramour?”</p>\n<p>Ser Daemon shrugged.  “Not that I have ever heard.”</p>\n<p>That was troubling too.  Ser Arys Oakheart had broken his vows for her, but it did not sound as if Jon Connington could be similarly swayed.  Can I match such a man with words alone?</p>\n<p>The princess lapsed into silence, all the while pondering what she would find at journey’s end.  That night when they made camp, she crept into the tent she shared with Jayne Ladybright and Elia Sand and slipped the bit of parchment out of her sleeve to read the words again.</p>\n<blockquote>\n<p><em>To Prince Doran of House Martell,</em><br><blockquote class=\"blockquote-center\"><p>You will remember me, I pray.I knew your sister well,and was a leal servant of your good-brother.I grieve for them as you do.I did not die, no more than did your sister’s son.To save his life we kept him hidden,but the time for hiding is done.  A dragon has returned to Westeros to claim his birthright and seek vengeance for his father, and for the princess Elia, his mother.In her name I turn to Dorne.Do not forsake us.</p>\n</blockquote><br>Jon Connington<br>Lord of Griffin’s Roost<br>Hand of the True King</p>\n</blockquote>\n<p>Arianne read the letter thrice, then rolled it up and tucked it back into her sleeve.  A dragon has returned to Westeros, but not the dragon my father was expecting.  Nowhere in the words was there a mention of Daenerys Stormborn… nor of Prince Quentyn, her brother, who had been sent to seek the dragon queen.  The princess remembered how her father had pressed the onyx cyvasse piece into her palm, his voice hoarse and low as he confessed his plan.  A long and perilous voyage, with an uncertain welcome at its end, he had said.  He has gone to bring us back our heart’s desire.  Vengeance.  Justice.  Fire and blood.</p>\n<p>Fire and blood was what Jon Connington (if indeed it was him) was offering as well.  Or was it?  “He comes with sellswords, but no dragons,” Prince Doran had told her, the night the raven came.  “The Golden Company is the best and largest of the free companies, but ten thousand mercenaries cannot hope to win the Seven Kingdoms.  Elia’s son… I would weep for joy if some part of my sister had survived, but what proof do we have that this is Aegon?”  His voice broke when he said that.  “Where are the dragons?” he asked.  “Where is Daenerys?” and Arianne knew that he was really saying, “Where is my son?”</p>\n<p>In the Boneway and the Prince’s Pass, two Dornish hosts had massed, and there they sat, sharpening their spears, polishing their armor, dicing, drinking, quarreling, their numbers dwindling by the day, waiting, waiting, waiting for the Prince of Dorne to loose them on the enemies of House Martell.  Waiting for the dragons.  For fire and blood.  For me.  One word from Arianne and those armies would march… so long as that word wasdragon.  If instead the word she sent was war, Lord Yronwood and Lord Fowler and their armies would remain in place.  The Prince of Dorne was nothing if not subtle; here warmeant wait.  </p>\n<p>At mid-morning on the third day Ghost Hill loomed up before them, its chalk-white walls shining against the deep blue of the Sea of Dorne.  From the square towers at the castle’s corners flew the banners of House Toland; a green dragon biting its own tail, upon a golden field.  The sun-and-spear of House Martell streamed atop the great central keep, gold and red and orange, defiant.</p>\n<p>Ravens had flown ahead to warn Lady Toland of their coming, so the castle gates were open, and Nymella’s eldest daughter rode forth with her steward to meet them near the bottom of the hill.  Tall and fierce, with a blaze of bright red hair tumbling about her shoulders, Valena Toland greeted Arianne with a shout of, “Come at last, have you?  How slow are those horses?”</p>\n<p>“Swift enough to outrun yours to the castle gates.”    </p>\n<p>“We will see about that.”  Valena wheeled her big red around and put her heels into him, and the race was on, through the dusty lanes of the village at the bottom of the hill, as chickens and villagers alike scrambled out of their path.  Arianne was three horse lengths behind by the time she got her mare up to a gallop, but had closed to one halfway up the slope.  The two of them were side-by-side as they thundered towards the gatehouse, but five yards from the gates Elia Sand came flying from the cloud of dust behind them to rush past both of them on her black filly.</p>\n<p>“Are you half horse, child?” Valena asked, laughing, in the yard.  “Princess, did you bring a stable girl?”</p>\n<p>“I’m Elia,” the girl announced.  “Lady Lance.”</p>\n<p>Whoever hung that name on her has much to answer for.  Like as not it had been Prince Oberyn, though, and the Red Viper had never answered to anyone but himself.</p>\n<p>“The girl jouster,” Valena said.  “Yes, I’ve heard of you.  Since you were the first to the yard, you’ve won the honor of watering and bridling the horses.”</p>\n<p>“And after that find the bath house,” said Princess Arianne.  Elia was chalk and dust from heels to hair.  </p>\n<p>That night Arianne and her knights supped with Lady Nymella and her daughters in the great hall of the castle.  Teora, the younger girl, had the same red hair as her sister, but elsewise could not have been more different.  Short, plump, and so shy she might have passed for a mute, she displayed more interest in the spiced beef and honeyed duck than in the comely young knights at the table, and seemed content to let her lady mother and her sister speak for House Toland.  </p>\n<p>“We have heard the same tales here that you have heard at Sunspear,” Lady Nymella told them as her serving man poured the wine.  “Sellswords landing on Cape Wrath, castles under siege or being taken, crops seized or burned.  Where these men come from and who they are, no one is certain.”</p>\n<p>“Pirates and adventurers, we heard at first,” said Valena.  “Then it was supposed to be the Golden Company.  Now it’s said to be Jon Connington, the Mad King’s Hand, come back from the grave to reclaim his birthright.  Whoever it is, Griffin’s Roost has fallen to them.  Rain House, Crow’s Nest, Mistwood, even Greenstone on its island.  All taken.”</p>\n<p>Arianne’s thoughts went at once to her sweet Spotted Slyva.  “Who would want Greenstone?  Was there a battle?”</p>\n<p>“Not as we have heard, but all the tales are garbled.”</p>\n<p>“Tarth has fallen too, some fisherfolk will tell you,” said Valena.  “These sellswords now hold most of Cape Wrath and half the Stepstones.  We hear talk of elephants in the rainwood.”</p>\n<p>“Elephants?”  Arianne did not know what to think of that.  “Are you certain?  Not dragons?”</p>\n<p>“Elephants,” Lady Nymella said firmly.</p>\n<p>“And krakens off the Broken Arm, pulling under crippled galleys,” said Valena.  “The blood draws them to the surface, our maester claims.  There are bodies in the water.  A few have washed up on our shores.  And that’s not half of it.  A new pirate king has set up on Torturer’s Deep.  The Lord of the Waters, he styles himself.  This one has real warships, three-deckers, monstrous large.  You were wise not to come by sea.  Since the Redwyne fleet passed through the Stepstones, those waters are crawling with strange sails, all the way north to the Straights of Tarth and Shipbreaker’s Bay.  Myrmen, Volantenes, Lyseni, even reavers from the Iron Islands.  Some have entered the Sea of Dorne to land men on the south shore of Cape Wrath.  We found a good fast ship for you, as your father commanded, but even so… be careful.”</p>\n<p>It is true, then.  Arianne wanted to ask after her brother, but her father had urged her to watch every word.  If these ships had not brought Quentyn home again with his dragon queen, best not to mention him.  Only her father and a few of his most trusted men knew about her brother’s mission to Slaver’s Bay.  Lady Toland and her daughters were not amongst them.  If it were Quentyn, he would have brought Daenerys back to Dorne, surely.  Why would he risk a landing on Cape Wrath, amongst the stormlords?  </p>\n<p>“Is Dorne at risk?” Lady Nymella asked.  “I confess, each time I see a strange sail my heart leaps to my throat.  What if these ships turn south?  The best part of the Toland strength is with Lord Yronwood in the Boneway.  Who will defend Ghost Hill if these strangers land upon our shores?  Should I call my men home?”</p>\n<p>“Your men are needed where they are, my lady,” Daemon Sand assured her.  Arianne was quick to nod.  Any other counsel could well lead to Lord Yronwood’s host unravelling like an old tapestry as each man rushed home to defend his own lands against supposed enemies who might or might not ever come.  “Once we know beyond a doubt whether these be friends or foes, my father will know what to do,” the princess said.</p>\n<p>It was then that pasty, pudgy Teora raised her eyes from the creamcakes on her plate.  “It is dragons.”      </p>\n<p>“Dragons?”  said her mother.  “Teora, don’t be mad.”</p>\n<p>“I’m not.  They’re coming.”</p>\n<p>“How could you possibly know that?” her sister asked, with a note of scorn in her voice.</p>\n<p>“One of your little dreams?”</p>\n<p>Teora gave a tiny nod, chin trembling.  “They were dancing.  In my dream.  And everywhere the dragons danced the people died.”</p>\n<p>“Seven save us.”  Lady Nymella gave an exasperated sigh.</p>\n<p>“If you did not eat so many creamcakes you would not have such dreams.  Rich foods are not for girls your age, when your humors are so unbalanced.  Maester Toman says — “</p>\n<p>“I hate Maester Toman,” Teora said.  Then she bolted from the table, leaving her lady mother to make apologies for her.</p>\n<p>“Be gentle with her, my lady,” Arianne said.  “I remember when I was her age.  My father despaired of me, I’m sure.”  </p>\n<p>“I can attest to that.”  Ser Daemon took a sip of wine and said, “House Toland has a dragon on its banners.”  </p>\n<p>“A dragon eating its own tail, aye,” Valena said.  “From the days of Aegon’s Conquest.  He did not conquer here.  Elsewhere he burned his foes, him and his sisters, but here we melted away before them, leaving only stone and sand for them to burn.  And round and round the dragons went, snapping at their tails for want of any other food, till they were tied in knots.”</p>\n<p>“Our forebears played their part in that,” Lady Nymella said proudly.  “Bold deeds were done, and brave men died.  All of it was written down by the maesters who served us.  We have books, if my princess would like to know more.”</p>\n<p>“Some other time, perhaps,” said Arianne.</p>\n<p>As Ghost Hill slept that night, the princess donned a hooded cloak against the chill and and walked the castle battlements to clear her thoughts.  Daemon Sand found her leaning on a parapet and gazing out to sea, where the moon was dancing on the water.  “Princess,” he said.  “You ought to be abed.”</p>\n<p>“I could say the same of you.”  Arianne turned to gaze upon his face.  A good face, she decided.  The boy I knew has become a handsome man.  His eyes were as blue as a desert sky, his hair the light brown of the sands they had just crossed.  A close-cropped beard followed the thin of a strong jaw, but could not quite hide the dimples when he smiled.  I always loved his smile.</p>\n<p>The Bastard of Godsgrace was one of Dorne’s finest swords as well, as might be expected from one who had been Prince Oberyn’s squire and had received his knighthood from the Red Viper himself.  Some said that he had been her uncle’s lover too, though seldom to his face.  Arianne did not know the truth of that.  He had been her lover, though.  At fourteen she had given him her maidenhead.  Daemon had not been much older, so their couplings had been as clumsy as they were ardent.  Still, it had been sweet.  </p>\n<p>Arianne gave him her most seductive smile.  “We might share a bed together.”</p>\n<p>Ser Daemon’s face was stone.  “Have you forgotten, princess?  I am bastard born.”  He took her hand in his.  “If I am unworthy of this hand, how can I be worthy of your cunt?”</p>\n<p>She snatched her hand away.  “You deserve a slap for that.”  </p>\n<p>“My face is yours.  Do what you will.”</p>\n<p>“What I will you will not, it seems.  So be it.  Talk with me instead.  Could this truly be Prince Aegon?”</p>\n<p>“Gregor Clegane ripped Aegon out of Elia’s arms and smashed his head against a wall,” Ser Daemon said.  “If Lord Connington’s prince has a crushed skull, I will believe that Aegon Targaryen has returned from the grave.  Elsewise, no.  This is some feigned boy, no more.  A sellsword’s ploy to win support.”</p>\n<p>My father fears the same.  “If not, though… if this truly is Jon Connington, if the boy is Rhaegar’s son… “</p>\n<p>“Are you hoping that he is, or that he’s not?”</p>\n<p>“I… it would give great joy to my father if Elia’s son were still alive.  He loved his sister well.”</p>\n<p>“It was you I asked about, not your father.”</p>\n<p>So it was.  “I was seven when Elia died.  They say I held her daughter Rhaenys once, when I was too young to remember.  Aegon will be a stranger to me, whether true or false.”  The princess paused.  “We looked for Rhaegar’s sister, not his son.”  Her father had confided in Ser Daemon when he chose him as his daughter’s shield; with him at least she could speak freely.  “I would sooner it were Quentyn who’d returned.”</p>\n<p>“Or so you say,” said Daemon Sand.  “Good night, princess.”  He bowed to her, and left her standing there.</p>\n<p>What did he mean by that?  Arianne watched him walk away.  What sort of sister would I be, if I did not want my brother back?  It was true, she had resented Quentyn for all those years that she had thought their father meant to name him as his heir in place of her, but that had turned out to be just a misunderstanding.  She was the heir to Dorne, she had her father’s word on that.  Quentyn would have his dragon queen, Daenerys.</p>\n<p>In Sunspear hung a portrait of the Princess Daenerys who had come to Dorne to marry one of Arianne’s forebears.  In her younger days Arianne had spent hours gazing at it, back when she was just a pudgy flat-chested girl on the cusp of maidenhood who prayed every night for the gods to make her pretty.  A hundred years ago, Daenerys Targaryen came to Dorne to make a peace.  Now another comes to make a war, and my brother will be her king and consort.King Quentyn.  Why did that sound so silly?  </p>\n<p>Almost as silly as Quentyn riding on a dragon.  Her brother was an earnest boy,well-behaved and dutiful, but dull.  And plain, so plain.  The gods had given Arianne the beauty she had prayed for, but Quentyn must have prayed for something else.  His head was overlarge and sort of square, his hair the color of dried mud.  His shoulders slumped as well, and he was too thick about the middle.  He looks too much like Father.</p>\n<p>“I love my brother,” said Arianne, though only the moon could hear her.  Though if truth be told, she scarcely knew him.  Quentyn had been fostered by Lord Anders of House Yronwood, the Bloodroyal, the son of Lord Ormond Yronwood and grandson of Lord Edgar.  In his youth her uncle Oberyn had fought a duel with Edgar, had given him a wound that mortified and killed him.  Afterward men called him ‘the Red Viper,’ and spoke of poison on his blade.  The Yronwoods were an ancient house, proud and powerful.  Before the coming of the Rhoynar they had been kings over half of Dorne, with domains that dwarfed those of House Martell.  Blood feud and rebellion would surely have followed Lord Edgar’s death, had not her father acted at once.  The Red Viper went to Oldtown, thence across to the narrow sea to Lys, though none dared call it exile.  And in due time, Quentyn was given to Lord Anders to foster as a sign of trust.  That helped to heal the breach between Sunspear and the Yronwoods, but it had opened new ones between Quentyn and the Sand Snakes… and Arianne had always been closer to her cousins than to her distant brother.</p>\n<p>“We are still the same blood, though,” she whispered.  “Of course I want my brother home.  I do.”  The wind off the sea was raising gooseprickles all up and down her arms.  Arianne pulled her cloak about herself, and went off to seek her bed.</p>\n<p>Their ship was called the Peregrine.  They sailed upon the morning tide.  The gods were good to them, the sea calm.  Even with good winds, the crossing took a day and a night.  Jayne Ladybright grew greensick and spent most of the voyage spewing, which Elia Sand seemed to find hilarious.  “Someone needs to spank that child,” Joss Hood was heard to say… but Elia was amongst those who heard him say it.</p>\n<p>“I am almost a woman grown, ser,” she responded haughtily.  “I’ll let you spank me, though…  but first you’ll need to tilt with me, and knock me off my horse.”</p>\n<p>“We are on a ship, and without horses,” Joss replied.</p>\n<p>“And ladies do not joust,” insisted Ser Garibald Shells, a far more serious and proper young man than his companion.</p>\n<p>“I do.  I’m Lady Lance.”</p>\n<p>Arianne had heard enough.  “You may be a lance, but you are no lady.  Go below and stay there till we reach land.”</p>\n<p>Elsewise the crossing was uneventful.  At dusk they spied a galley in the distance, her oars rising and falling against the evening stars, but she was moving away from them, and soon dwindled and was gone.  Arianne played a game of cyvasse with Ser Daemon, and another one with Garibald Shells, and somehow managed to lose both.  Ser Garibald was kind enough to say that she played a gallant game, but Daemon mocked her.  “You have other pieces beside the dragon, princess.  Try moving them sometime.”</p>\n<p>“I like the dragon.”  She wanted to slap the smile off his face.  Or kiss it off, perhaps.  The man was as smug as he was comely.  Of all the knights in Dorne, why did my father chose this one to be my shield?  He knows our history.  “It is just a game.  Tell me of Prince Viserys.”</p>\n<p>“The Beggar King?”  Ser Daemon seemed surprised.  </p>\n<p>“Everyone says that Prince Rhaegar was beautiful.  Was Viserys beautiful as well?”</p>\n<p>“I suppose.  He was Targaryen.  I never saw the man.”</p>\n<p>The secret pact that Prince Doran had made all those years called for Arianne to be wed to Prince Viserys, not Quentyn to Daenerys.  It had all come undone on the Dothraki sea, when he was murdered.  Crowned with a pot of molten gold.  “He was killed by a Dothraki khal,” said Arianne.  “The dragon queen’s own husband.”</p>\n<p>“So I’ve heard.  What of it?”      </p>\n<p>“Just… why did Daenerys let it happen?  Viserys was her brother.  All that remained of her own blood.”</p>\n<p>“The Dothraki are a savage folk.  Who can know why they kill?  Perhaps Viserys wiped his arse with the wrong hand.”</p>\n<p>Perhaps, thought Arianne, or perhaps Daenerys realized that once her brother was crowned and wed to me, she would be doomed to spend the rest of her life sleeping in a tent and smelling like a horse.  “She is the Mad King’s daughter,” the princess said.  “How do we do know — “</p>\n<p>“We cannot know,” Ser Daemon said.  “We can only hope.”</p>\n","excerpt":"<h2 id=\"ARIANNEE-EXCERPT-FROM-THE-WINDS-OF-WINTER\"><a href=\"#ARIANNEE-EXCERPT-FROM-THE-WINDS-OF-WINTER\" class=\"headerlink\" title=\"ARIANNEE--EXCERPT FROM THE WINDS OF WINTER\"></a>ARIANNEE--EXCERPT FROM THE WINDS OF WINTER</h2><p>They struck out north by northwest, across drylands and parched plains and pale sands toward Ghost Hill, the stronghold of House Toland, where the ship that would take them across the Sea of Dorne awaited them.  “Send a raven whenever you have news,” Prince Doran told her, “but report only what you know to be true.  We are lost in fog here, besieged by rumors, falsehoods, and traveler’s tales.  I dare not act until I know for a certainty what is happening.”</p>\n<p>War is happening, though Arianne, and this time Dorne will not be spared.  “Doom and death are coming,” Ellaria Sand had warned them, before she took her own leave from Prince Doran.  “It is time for my little snakes to scatter, the better to survive the carnage.”  Ellaria was returning to her father’s seat at Hellholt.  With her went her daughter Loreza, who had just turned seven.  Dorea remained at the Water Gardens, one child amongst a hundred.Obella was to be dispatched to Sunspear, to serve as a cupbearer to the wife of the castellan, Manfrey Martell.<br>","more":"<br>And Elia Sand, oldest of the four girls that Prince Oberyn had fathered on Ellaria, would cross the Sea of Dorne with Arianne.  “As a lady, not a lance,” her mother said firmly, but like all the Sand Snakes, Elia had her own mind.</p>\n<p>They crossed the sands in two long days and the better part of two nights, stopping thrice to change their horses.  It was a lonely time for Arianne, surrounded by so many strangers.  Elia was her cousin, but half a child, and Daemon Sand… things had never been the same between her and the Bastard of Godsgrace after her father refused his offer for her hand.  He was a boy then, and bastard born, no fit consort for a princess of Dorne, he should have known better.  And it was my father’s will, not mine.  The rest of her companions she hardly knew at all.    </p>\n<p>Arianne missed her friends.  Drey and Garin and her sweet Spotted Slyva had been a part of her since she was little, trusted confidants who had shared her dreams and secrets, cheered her when she was sad, helped her face her fears.  One of them had betrayed her, but she missed them all the same.  It was my own fault.  Arianne had made them part of her plot to steal off with Myrcella Baratheon and crown her queen, an act of rebellion meant to force her father’s hand, but someone’s loose tongue had undone her.  The clumsy conspiracy had accomplished nothing, except to cost poor Myrcella part of her face, and Ser Arys Oakheart his life.</p>\n<p>Arianne missed Ser Arys too, more than she ever would have thought.  He loved me madly, she told herself, yet I was never more than fond of him.  I made use of him in mybed and in my plot, took his love and took his honor, gave him nothing but my body.  In the end he could not live with what we’d done.  Why else would her white knight have charged right into Areo Hotah’s longaxe, to die the way he did?  I was a foolish willful girl, playing at the game of thrones like a drunkard rolling dice.  </p>\n<p>The cost of her folly had been dear.  Drey had been sent across the world to Norvos, Garin exiled to Tyrosh for two years, her sweet silly smiling Slyva married off to Eldon Estermont, a man old enough to be her grandsire.  Ser Arys had paid with his life’s blood, Myrcella with an ear.  </p>\n<p>Only Ser Gerold Dayne had escaped unscathed.  Darkstar.  If Myrcella’s horse had not shied at the last instant, his longsword would have opened her from chest to waist instead just taking off her ear.  Dayne was her most grievous sin, the one that Arianne most regretted.  With one stroke of his sword, he had changed her botched plot into something foul and bloody.  If the gods were good, by now Obara Sand had treed him in his mountain fastness and put an end to him.</p>\n<p>She said as much to Daemon Sand that first night, as they made camp.  “Be careful what you pray for, princess,” he replied.  “Darkstar could put an end to Lady Obara just as easily.”</p>\n<p>“She has Areo Hotah with her.”  Prince Doran’s captain of guards had dispatched Ser Arys Oakheart with a single blow, though the Kingsguard were supposed to be the finest knights in all the realm.  “No man can stand against Hotah.”</p>\n<p>“Is that what Darkstar is?  A man?”  Ser Daemon grimaced.  “A man would not have done what he did to Princess Myrcella.  Ser Gerold is more a viper than your uncle ever was.  Prince Oberyn could see that he was poison, he said so more than once.  It’s just a pity that he never got around to killing him.”</p>\n<p>Poison, thought Arianne.  Yes.  Pretty poison, though.  That was how he’d fooled her.  Gerold Dayne was hard and cruel, but so fair to look upon that the princess had not believed half the tales she’d heard of him.  Pretty boys had ever been her weakness, particularly the ones who were dark and dangerous as well.  That was before, when I was just a girl, she told herself.  I am a woman now, my father’s daughter.  I have learned that lesson.</p>\n<p>Come break of day, they were off again.  Elia Sand led the way, her black braid flying behind her as she raced across the dry, cracked plains and up into the hills.  The girl was mad for horses, which might be why she often smelled like one, to the despair of her mother.  Sometimes Arianne felt sorry for Ellaria.  Four girls, and every one of them her father’s daughter.  </p>\n<p>The rest of the party kept a more sedate pace.  The princess found herself riding beside Ser Daemon, remembering other rides when they were younger, rides that often ended in embraces.  When she found herself stealing glances at him, tall and gallant in the saddle, Arianne reminded herself that she was heir to Dorne, and him no more than her shield.  “Tell me what you know of this Jon Connington,” she commanded.</p>\n<p>“He’s dead,” said Daemon Sand.  “He died in the Disputed Lands.  Of drink, I’ve heard it said.”      </p>\n<p>“So a dead drunk leads this army?”</p>\n<p>“Perhaps this Jon Connington is a son of that one.  Or just some clever sellsword who has taken on a dead man’s name.”</p>\n<p>“Or he never died at all.”  Could Connington have been pretending to be dead for all these years?  That would require patience worthy of her father.  The thought made Arianne uneasy.  Treating with a man that subtle could be perilous.  “What was he like before he… before he died?”</p>\n<p>“I was a boy at Godsgrace when he was sent into exile.  I never knew the man.”</p>\n<p>“Then tell me what you’ve heard of him from others.”</p>\n<p>“As my princess commands.  Connington was Lord of Griffin’s Roost when Griffin’s Roost was still a lordship worth the having.  Prince Rhaegar’s squire, or one of them.  Later Prince Rhaegar’s friend and companion.  The Mad King named him Hand during Robert’s Rebellion, but he was defeated at Stoney Sept in the Battle of the Bells, and Robert slipped away.  King Aerys was wroth, and sent Connington into exile.  There he died.”</p>\n<p>“Or not.”  Prince Doran had told her all of that.  There must be more.  “Those are just the things he did.  I know all that.  What sort of man was he?  Honest and honorable, venal and grasping, proud?”</p>\n<p>“Proud, for a certainty.  Even arrogant.  A faithful friend to Rhaegar, but prickly with others.  Robert was his liege, but I’ve heard it said that Connington chafed at serving such a lord.  Even then, Robert was known to be fond of wine and whores.”</p>\n<p>“No whores for Lord Jon, then?”</p>\n<p>“I could not say.  Some men keep their whoring secret.”</p>\n<p>“Did he have a wife?  A paramour?”</p>\n<p>Ser Daemon shrugged.  “Not that I have ever heard.”</p>\n<p>That was troubling too.  Ser Arys Oakheart had broken his vows for her, but it did not sound as if Jon Connington could be similarly swayed.  Can I match such a man with words alone?</p>\n<p>The princess lapsed into silence, all the while pondering what she would find at journey’s end.  That night when they made camp, she crept into the tent she shared with Jayne Ladybright and Elia Sand and slipped the bit of parchment out of her sleeve to read the words again.</p>\n<blockquote>\n<p><em>To Prince Doran of House Martell,</em><br><blockquote class=\"blockquote-center\"><p>You will remember me, I pray.I knew your sister well,and was a leal servant of your good-brother.I grieve for them as you do.I did not die, no more than did your sister’s son.To save his life we kept him hidden,but the time for hiding is done.  A dragon has returned to Westeros to claim his birthright and seek vengeance for his father, and for the princess Elia, his mother.In her name I turn to Dorne.Do not forsake us.</p>\n</blockquote><br>Jon Connington<br>Lord of Griffin’s Roost<br>Hand of the True King</p>\n</blockquote>\n<p>Arianne read the letter thrice, then rolled it up and tucked it back into her sleeve.  A dragon has returned to Westeros, but not the dragon my father was expecting.  Nowhere in the words was there a mention of Daenerys Stormborn… nor of Prince Quentyn, her brother, who had been sent to seek the dragon queen.  The princess remembered how her father had pressed the onyx cyvasse piece into her palm, his voice hoarse and low as he confessed his plan.  A long and perilous voyage, with an uncertain welcome at its end, he had said.  He has gone to bring us back our heart’s desire.  Vengeance.  Justice.  Fire and blood.</p>\n<p>Fire and blood was what Jon Connington (if indeed it was him) was offering as well.  Or was it?  “He comes with sellswords, but no dragons,” Prince Doran had told her, the night the raven came.  “The Golden Company is the best and largest of the free companies, but ten thousand mercenaries cannot hope to win the Seven Kingdoms.  Elia’s son… I would weep for joy if some part of my sister had survived, but what proof do we have that this is Aegon?”  His voice broke when he said that.  “Where are the dragons?” he asked.  “Where is Daenerys?” and Arianne knew that he was really saying, “Where is my son?”</p>\n<p>In the Boneway and the Prince’s Pass, two Dornish hosts had massed, and there they sat, sharpening their spears, polishing their armor, dicing, drinking, quarreling, their numbers dwindling by the day, waiting, waiting, waiting for the Prince of Dorne to loose them on the enemies of House Martell.  Waiting for the dragons.  For fire and blood.  For me.  One word from Arianne and those armies would march… so long as that word wasdragon.  If instead the word she sent was war, Lord Yronwood and Lord Fowler and their armies would remain in place.  The Prince of Dorne was nothing if not subtle; here warmeant wait.  </p>\n<p>At mid-morning on the third day Ghost Hill loomed up before them, its chalk-white walls shining against the deep blue of the Sea of Dorne.  From the square towers at the castle’s corners flew the banners of House Toland; a green dragon biting its own tail, upon a golden field.  The sun-and-spear of House Martell streamed atop the great central keep, gold and red and orange, defiant.</p>\n<p>Ravens had flown ahead to warn Lady Toland of their coming, so the castle gates were open, and Nymella’s eldest daughter rode forth with her steward to meet them near the bottom of the hill.  Tall and fierce, with a blaze of bright red hair tumbling about her shoulders, Valena Toland greeted Arianne with a shout of, “Come at last, have you?  How slow are those horses?”</p>\n<p>“Swift enough to outrun yours to the castle gates.”    </p>\n<p>“We will see about that.”  Valena wheeled her big red around and put her heels into him, and the race was on, through the dusty lanes of the village at the bottom of the hill, as chickens and villagers alike scrambled out of their path.  Arianne was three horse lengths behind by the time she got her mare up to a gallop, but had closed to one halfway up the slope.  The two of them were side-by-side as they thundered towards the gatehouse, but five yards from the gates Elia Sand came flying from the cloud of dust behind them to rush past both of them on her black filly.</p>\n<p>“Are you half horse, child?” Valena asked, laughing, in the yard.  “Princess, did you bring a stable girl?”</p>\n<p>“I’m Elia,” the girl announced.  “Lady Lance.”</p>\n<p>Whoever hung that name on her has much to answer for.  Like as not it had been Prince Oberyn, though, and the Red Viper had never answered to anyone but himself.</p>\n<p>“The girl jouster,” Valena said.  “Yes, I’ve heard of you.  Since you were the first to the yard, you’ve won the honor of watering and bridling the horses.”</p>\n<p>“And after that find the bath house,” said Princess Arianne.  Elia was chalk and dust from heels to hair.  </p>\n<p>That night Arianne and her knights supped with Lady Nymella and her daughters in the great hall of the castle.  Teora, the younger girl, had the same red hair as her sister, but elsewise could not have been more different.  Short, plump, and so shy she might have passed for a mute, she displayed more interest in the spiced beef and honeyed duck than in the comely young knights at the table, and seemed content to let her lady mother and her sister speak for House Toland.  </p>\n<p>“We have heard the same tales here that you have heard at Sunspear,” Lady Nymella told them as her serving man poured the wine.  “Sellswords landing on Cape Wrath, castles under siege or being taken, crops seized or burned.  Where these men come from and who they are, no one is certain.”</p>\n<p>“Pirates and adventurers, we heard at first,” said Valena.  “Then it was supposed to be the Golden Company.  Now it’s said to be Jon Connington, the Mad King’s Hand, come back from the grave to reclaim his birthright.  Whoever it is, Griffin’s Roost has fallen to them.  Rain House, Crow’s Nest, Mistwood, even Greenstone on its island.  All taken.”</p>\n<p>Arianne’s thoughts went at once to her sweet Spotted Slyva.  “Who would want Greenstone?  Was there a battle?”</p>\n<p>“Not as we have heard, but all the tales are garbled.”</p>\n<p>“Tarth has fallen too, some fisherfolk will tell you,” said Valena.  “These sellswords now hold most of Cape Wrath and half the Stepstones.  We hear talk of elephants in the rainwood.”</p>\n<p>“Elephants?”  Arianne did not know what to think of that.  “Are you certain?  Not dragons?”</p>\n<p>“Elephants,” Lady Nymella said firmly.</p>\n<p>“And krakens off the Broken Arm, pulling under crippled galleys,” said Valena.  “The blood draws them to the surface, our maester claims.  There are bodies in the water.  A few have washed up on our shores.  And that’s not half of it.  A new pirate king has set up on Torturer’s Deep.  The Lord of the Waters, he styles himself.  This one has real warships, three-deckers, monstrous large.  You were wise not to come by sea.  Since the Redwyne fleet passed through the Stepstones, those waters are crawling with strange sails, all the way north to the Straights of Tarth and Shipbreaker’s Bay.  Myrmen, Volantenes, Lyseni, even reavers from the Iron Islands.  Some have entered the Sea of Dorne to land men on the south shore of Cape Wrath.  We found a good fast ship for you, as your father commanded, but even so… be careful.”</p>\n<p>It is true, then.  Arianne wanted to ask after her brother, but her father had urged her to watch every word.  If these ships had not brought Quentyn home again with his dragon queen, best not to mention him.  Only her father and a few of his most trusted men knew about her brother’s mission to Slaver’s Bay.  Lady Toland and her daughters were not amongst them.  If it were Quentyn, he would have brought Daenerys back to Dorne, surely.  Why would he risk a landing on Cape Wrath, amongst the stormlords?  </p>\n<p>“Is Dorne at risk?” Lady Nymella asked.  “I confess, each time I see a strange sail my heart leaps to my throat.  What if these ships turn south?  The best part of the Toland strength is with Lord Yronwood in the Boneway.  Who will defend Ghost Hill if these strangers land upon our shores?  Should I call my men home?”</p>\n<p>“Your men are needed where they are, my lady,” Daemon Sand assured her.  Arianne was quick to nod.  Any other counsel could well lead to Lord Yronwood’s host unravelling like an old tapestry as each man rushed home to defend his own lands against supposed enemies who might or might not ever come.  “Once we know beyond a doubt whether these be friends or foes, my father will know what to do,” the princess said.</p>\n<p>It was then that pasty, pudgy Teora raised her eyes from the creamcakes on her plate.  “It is dragons.”      </p>\n<p>“Dragons?”  said her mother.  “Teora, don’t be mad.”</p>\n<p>“I’m not.  They’re coming.”</p>\n<p>“How could you possibly know that?” her sister asked, with a note of scorn in her voice.</p>\n<p>“One of your little dreams?”</p>\n<p>Teora gave a tiny nod, chin trembling.  “They were dancing.  In my dream.  And everywhere the dragons danced the people died.”</p>\n<p>“Seven save us.”  Lady Nymella gave an exasperated sigh.</p>\n<p>“If you did not eat so many creamcakes you would not have such dreams.  Rich foods are not for girls your age, when your humors are so unbalanced.  Maester Toman says — “</p>\n<p>“I hate Maester Toman,” Teora said.  Then she bolted from the table, leaving her lady mother to make apologies for her.</p>\n<p>“Be gentle with her, my lady,” Arianne said.  “I remember when I was her age.  My father despaired of me, I’m sure.”  </p>\n<p>“I can attest to that.”  Ser Daemon took a sip of wine and said, “House Toland has a dragon on its banners.”  </p>\n<p>“A dragon eating its own tail, aye,” Valena said.  “From the days of Aegon’s Conquest.  He did not conquer here.  Elsewhere he burned his foes, him and his sisters, but here we melted away before them, leaving only stone and sand for them to burn.  And round and round the dragons went, snapping at their tails for want of any other food, till they were tied in knots.”</p>\n<p>“Our forebears played their part in that,” Lady Nymella said proudly.  “Bold deeds were done, and brave men died.  All of it was written down by the maesters who served us.  We have books, if my princess would like to know more.”</p>\n<p>“Some other time, perhaps,” said Arianne.</p>\n<p>As Ghost Hill slept that night, the princess donned a hooded cloak against the chill and and walked the castle battlements to clear her thoughts.  Daemon Sand found her leaning on a parapet and gazing out to sea, where the moon was dancing on the water.  “Princess,” he said.  “You ought to be abed.”</p>\n<p>“I could say the same of you.”  Arianne turned to gaze upon his face.  A good face, she decided.  The boy I knew has become a handsome man.  His eyes were as blue as a desert sky, his hair the light brown of the sands they had just crossed.  A close-cropped beard followed the thin of a strong jaw, but could not quite hide the dimples when he smiled.  I always loved his smile.</p>\n<p>The Bastard of Godsgrace was one of Dorne’s finest swords as well, as might be expected from one who had been Prince Oberyn’s squire and had received his knighthood from the Red Viper himself.  Some said that he had been her uncle’s lover too, though seldom to his face.  Arianne did not know the truth of that.  He had been her lover, though.  At fourteen she had given him her maidenhead.  Daemon had not been much older, so their couplings had been as clumsy as they were ardent.  Still, it had been sweet.  </p>\n<p>Arianne gave him her most seductive smile.  “We might share a bed together.”</p>\n<p>Ser Daemon’s face was stone.  “Have you forgotten, princess?  I am bastard born.”  He took her hand in his.  “If I am unworthy of this hand, how can I be worthy of your cunt?”</p>\n<p>She snatched her hand away.  “You deserve a slap for that.”  </p>\n<p>“My face is yours.  Do what you will.”</p>\n<p>“What I will you will not, it seems.  So be it.  Talk with me instead.  Could this truly be Prince Aegon?”</p>\n<p>“Gregor Clegane ripped Aegon out of Elia’s arms and smashed his head against a wall,” Ser Daemon said.  “If Lord Connington’s prince has a crushed skull, I will believe that Aegon Targaryen has returned from the grave.  Elsewise, no.  This is some feigned boy, no more.  A sellsword’s ploy to win support.”</p>\n<p>My father fears the same.  “If not, though… if this truly is Jon Connington, if the boy is Rhaegar’s son… “</p>\n<p>“Are you hoping that he is, or that he’s not?”</p>\n<p>“I… it would give great joy to my father if Elia’s son were still alive.  He loved his sister well.”</p>\n<p>“It was you I asked about, not your father.”</p>\n<p>So it was.  “I was seven when Elia died.  They say I held her daughter Rhaenys once, when I was too young to remember.  Aegon will be a stranger to me, whether true or false.”  The princess paused.  “We looked for Rhaegar’s sister, not his son.”  Her father had confided in Ser Daemon when he chose him as his daughter’s shield; with him at least she could speak freely.  “I would sooner it were Quentyn who’d returned.”</p>\n<p>“Or so you say,” said Daemon Sand.  “Good night, princess.”  He bowed to her, and left her standing there.</p>\n<p>What did he mean by that?  Arianne watched him walk away.  What sort of sister would I be, if I did not want my brother back?  It was true, she had resented Quentyn for all those years that she had thought their father meant to name him as his heir in place of her, but that had turned out to be just a misunderstanding.  She was the heir to Dorne, she had her father’s word on that.  Quentyn would have his dragon queen, Daenerys.</p>\n<p>In Sunspear hung a portrait of the Princess Daenerys who had come to Dorne to marry one of Arianne’s forebears.  In her younger days Arianne had spent hours gazing at it, back when she was just a pudgy flat-chested girl on the cusp of maidenhood who prayed every night for the gods to make her pretty.  A hundred years ago, Daenerys Targaryen came to Dorne to make a peace.  Now another comes to make a war, and my brother will be her king and consort.King Quentyn.  Why did that sound so silly?  </p>\n<p>Almost as silly as Quentyn riding on a dragon.  Her brother was an earnest boy,well-behaved and dutiful, but dull.  And plain, so plain.  The gods had given Arianne the beauty she had prayed for, but Quentyn must have prayed for something else.  His head was overlarge and sort of square, his hair the color of dried mud.  His shoulders slumped as well, and he was too thick about the middle.  He looks too much like Father.</p>\n<p>“I love my brother,” said Arianne, though only the moon could hear her.  Though if truth be told, she scarcely knew him.  Quentyn had been fostered by Lord Anders of House Yronwood, the Bloodroyal, the son of Lord Ormond Yronwood and grandson of Lord Edgar.  In his youth her uncle Oberyn had fought a duel with Edgar, had given him a wound that mortified and killed him.  Afterward men called him ‘the Red Viper,’ and spoke of poison on his blade.  The Yronwoods were an ancient house, proud and powerful.  Before the coming of the Rhoynar they had been kings over half of Dorne, with domains that dwarfed those of House Martell.  Blood feud and rebellion would surely have followed Lord Edgar’s death, had not her father acted at once.  The Red Viper went to Oldtown, thence across to the narrow sea to Lys, though none dared call it exile.  And in due time, Quentyn was given to Lord Anders to foster as a sign of trust.  That helped to heal the breach between Sunspear and the Yronwoods, but it had opened new ones between Quentyn and the Sand Snakes… and Arianne had always been closer to her cousins than to her distant brother.</p>\n<p>“We are still the same blood, though,” she whispered.  “Of course I want my brother home.  I do.”  The wind off the sea was raising gooseprickles all up and down her arms.  Arianne pulled her cloak about herself, and went off to seek her bed.</p>\n<p>Their ship was called the Peregrine.  They sailed upon the morning tide.  The gods were good to them, the sea calm.  Even with good winds, the crossing took a day and a night.  Jayne Ladybright grew greensick and spent most of the voyage spewing, which Elia Sand seemed to find hilarious.  “Someone needs to spank that child,” Joss Hood was heard to say… but Elia was amongst those who heard him say it.</p>\n<p>“I am almost a woman grown, ser,” she responded haughtily.  “I’ll let you spank me, though…  but first you’ll need to tilt with me, and knock me off my horse.”</p>\n<p>“We are on a ship, and without horses,” Joss replied.</p>\n<p>“And ladies do not joust,” insisted Ser Garibald Shells, a far more serious and proper young man than his companion.</p>\n<p>“I do.  I’m Lady Lance.”</p>\n<p>Arianne had heard enough.  “You may be a lance, but you are no lady.  Go below and stay there till we reach land.”</p>\n<p>Elsewise the crossing was uneventful.  At dusk they spied a galley in the distance, her oars rising and falling against the evening stars, but she was moving away from them, and soon dwindled and was gone.  Arianne played a game of cyvasse with Ser Daemon, and another one with Garibald Shells, and somehow managed to lose both.  Ser Garibald was kind enough to say that she played a gallant game, but Daemon mocked her.  “You have other pieces beside the dragon, princess.  Try moving them sometime.”</p>\n<p>“I like the dragon.”  She wanted to slap the smile off his face.  Or kiss it off, perhaps.  The man was as smug as he was comely.  Of all the knights in Dorne, why did my father chose this one to be my shield?  He knows our history.  “It is just a game.  Tell me of Prince Viserys.”</p>\n<p>“The Beggar King?”  Ser Daemon seemed surprised.  </p>\n<p>“Everyone says that Prince Rhaegar was beautiful.  Was Viserys beautiful as well?”</p>\n<p>“I suppose.  He was Targaryen.  I never saw the man.”</p>\n<p>The secret pact that Prince Doran had made all those years called for Arianne to be wed to Prince Viserys, not Quentyn to Daenerys.  It had all come undone on the Dothraki sea, when he was murdered.  Crowned with a pot of molten gold.  “He was killed by a Dothraki khal,” said Arianne.  “The dragon queen’s own husband.”</p>\n<p>“So I’ve heard.  What of it?”      </p>\n<p>“Just… why did Daenerys let it happen?  Viserys was her brother.  All that remained of her own blood.”</p>\n<p>“The Dothraki are a savage folk.  Who can know why they kill?  Perhaps Viserys wiped his arse with the wrong hand.”</p>\n<p>Perhaps, thought Arianne, or perhaps Daenerys realized that once her brother was crowned and wed to me, she would be doomed to spend the rest of her life sleeping in a tent and smelling like a horse.  “She is the Mad King’s daughter,” the princess said.  “How do we do know — “</p>\n<p>“We cannot know,” Ser Daemon said.  “We can only hope.”</p>"},{"title":"MERCY","date":"2016-04-06T12:51:57.000Z","comments":0,"_content":"\n## MERCYE\\--EXCERPT FROM THE WINDS OF WINTER\n\nShe woke with a gasp, not knowing who she was, or where.\n\nThe smell of blood was heavy in her nostrils… or was that her nightmare, lingering? She had dreamed of wolves again, of running through some dark pine forest with a great pack at her hells, hard on the scent of prey.\n\nHalf-light filled the room, grey and gloomy. Shivering, she sat up in bed and ran a hand across her scalp. Stubble bristled against her palm. I need to shave before Izembaro sees. Mercy, I’m Mercy, and tonight I’ll be raped and murdered. Her true name was Mercedene, but Mercy was all anyone ever called her…\n<!--more-->\nExcept in dreams. She took a breath to quiet the howling in her heart, trying to remember more of what she’d dreamt, but most of it had gone already. There had been blood in it, though, and a full moon overhead, and a tree that watched her as she ran.\n\nShe had fastened the shutters back so the morning sun might wake her. But there was no sun outside the window of Mercy’s little room, only a wall of shifting grey fog. The air had grown chilly… and a good thing, else she might have slept all day. It would be just like Mercy to sleep through her own rape.\n\nGooseprickles covered her legs. Her coverlet had twisted around her like a snake. She unwound it, threw the blanket to the bare plank floor and padded naked to the window. Braavos was lost in fog. She could see the green water of the little canal below, the cobbled stone street that ran beneath her building, two arches of the mossy bridge… but the far end of the bridge vanished in greyness, and of the buildings across the canal only a few vague lights remained. She heard a soft splash as a serpent boat emerged beneath the bridge’s central arch. “What hour?” Mercy called down to the man who stood by the snake’s uplifted tail, pushing her onward with his pole.\n\nThe waterman gazed up, searching for the voice. “Four, by the Titan’s roar.” His words echoed hollowly off the swirling green waters and the walls of unseen buildings.\n\nShe was not late, not yet, but she should not dawdle. Mercy was a happy soul and a hard worker, but seldom timely. That would not serve tonight. The envoy from Westeros was expected at the Gate this evening, and Izembaro would be in no mood to hear excuses, even if she served them up with a sweet smile.\n\nShe had filled her basin from the canal last night before she went to sleep, preferring the brackish water to the slimy green rainwater stewing in the cistern out back. Dipping a rough cloth, she washed herself head to heel, standing on one leg at a time to scrub her calloused feet. After that she found her razor. A bare scalp helped the wigs fit better, Izembaro claimed.\n\nShe shaved, donned her smallclothes, and slipped a shapeless brown wool dress down over her head. One of her stockings needed mending, she saw as she pulled it up. She would ask the Snapper for help; her own sewing was so wretched that the wardrobe mistress usually took pity on her. Else I could filtch a nicer pair from wardrobe. That was risky, though. Izembaro hated it when the mummers wore his costumes in the streets.Except for Wendeyne. Give Izembaro’s cock a little suck and a girl can wear any costume that she wants. Mercy was not so foolish as all that. Daena had warned her. “Girls who start down that road wind up on the Ship, where every man in the pit knows he can have any pretty thing he might see up on the stage, if his purse is plump enough.”\n\nHer boots were lumps of old brown leather mottled with saltstains and cracked from long wear, her belt a length of hempen rope dyed blue. She knotted it about her waist, and hung a knife on her right hip and a coin pouch on her left. Last of all she threw her cloak across her shoulders. It was a real mummer’s cloak, purple wool lined in red silk, with a hood to keep the rain off, and three secret pockets too. She’d hid some coins in one of those, an iron key in another, a blade in the last. A real blade, not a fruit knife like the one on her hip, but it did not belong to Mercy, no more than her other treasures did. The fruit knife belonged to Mercy. She was made for eating fruit, for smiling and joking, for working hard and doing as she was told.\n\n“Mercy, Mercy, Mercy,” she sang as she descended the wooden stair to the street. The handrail was splintery, the steps steep, and there were five flights, but that was why she’d gotten the room so cheap. That, and Mercy’s smile. She might be bald and skinny, but Mercy had a pretty smile, and a certain grace. Even Izembaro agreed that she was graceful. She was not far from the Gate as the crows flies, but for girls with feet instead of wings the way was longer. Braavos was a crooked city. The streets were crooked, the alleys were crookeder, and the canals were crookedest of all. Most days she preferred to go the long way, down the Ragman’s Road along the Outer Harbor, where she had the sea before her and the sky above, and a clear view across the Great Lagoon to the Arsenal and the piney slopes of Sellagoro’s Shield. Sailors would hail her as she passed the docks, calling down from the decks of tarry Ibbenese whalers and big-bellied Westerosi cogs. Mercy could not always understand their words, but she knew what they were saying. Sometimes she would smile back and tell them they could find her at the Gate if they had the coin.\n\nThe long way also took her across the Bridge of Eyes with its carved stone faces. From the top of its span, she could look through the arches and see all the city: the green copper domes of the Hall of Truth, the masts rising like a forest from the Purple Harbor, the tall towers of the mighty, the golden thunderbolt turning on its spire atop the Sealord’s Palace… even the Titan’s bronze shoulders, off across the dark green waters. But that was only when the sun was shining down on Braavos. If the fog was thick there was nothing to see but grey, so today Mercy chose the shorter route to save some wear on her poor cracked boots.\n\nThe mists seemed to part before her and close up again as she passed. The cobblestones were wet and slick under her feet. She heard a cat yowl plaintively. Braavos was a good city for cats, and they roamed everywhere, especially at night. In the fog all cats are grey, Mercy thought. In the fog all men are killers.\n\nShe had never seen a thicker fog than this one. On the larger canals, the watermen would be running their serpent boats into one another, unable to make out any more than dim lights from the buildings to either side of them.\n\nMercy passed an old man with a lantern walking the other way, and envied him his light. The street was so gloomy she could scarcely see where she was stepping. In the humbler parts of the city, the houses, shops, and warehouses crowded together, leaning on each other like drunken lovers, their upper stories so close that you could step from one balcony to the next. The streets below became dark tunnels where every footfall echoed. The small canals were even more hazardous, since many of the houses that lined them had privies jutting out over the water. Izembaro loved to give the Sealord’s speech fromThe Merchant’s Melancholy Daughter, about how “here the last Titan yet stands, astride the stony shoulders of his brothers,” but Mercy preferred the scene where the fat merchant shat on the Sealord’s head as he passed underneath in his gold-and-purple barge. Only in Braavos could something like that happen, it was said, and only in Braavos would Sealord and sailor alike howl with laughter to see it.\n\nThe Gate stood close by the edge of Drowned Town, between the Outer Harbor and the Purple Harbor. An old warehouse had burnt there and the ground was sinking a little more each year, so the land came cheap. Atop the flooded stone foundation of the warehouse, Izembaro raised his cavernous playhall. The Dome and the Blue Lantern might enjoy more fashionable environs, he told his mummers, but here between the harbors they would never lack for sailors and whores to fill their pit. The Ship was close by, still pulling handsome crowds to the quay where she had been moored for twenty years, he said, and the Gate would flourish too.\n\nTime had proved him right. The Gate’s stage had developed a tilt as the building settled, their costumes were prone to mildew, and water snakes nested in the flooded cellar, but none of that troubled the mummers so long as the house was full.\n\nThe last bridge was made of rope and raw planks, and seemed to dissolve into nothingness, but that was only the fog. Mercy scampered across, her heels ringing on the wood. The fog opened before her like a tattered grey curtain to reveal the playhouse. Buttery yellow light spilled from the doors, and Mercy could hear voices from within. Beside the entrance, Big Brusco had painted over the title of the last show, and writtenThe Bloody Hand in its place in huge red letters. He was painting a bloody hand beneath the words, for those who could not read. Mercy stopped to have a look. “That’s a nice hand,” she told him.\n\n“Thumb’s crooked.” Brusco dabbed at it with his brush. “King o’ the Mummers been asking after you.”\n\n“It was so dark I slept and slept.” When Izembaro had first dubbed himself the King of the Mummers, the company had taken a wicked pleasure in it, savoring the outrage of their rivals from the Dome and the Blue Lantern. Of late, though, Izembaro had begun to take his title too seriously. “He will only play kings now,” Marro said, rolling his eyes, “and if the play has no king in it, he would sooner not stage it at all.”\n\nThe Bloody Hand offered two kings, the fat one and the boy. Izembaro would play the fat one. It was not a large part, but he had a fine speech as he lay dying, and a splendid fight with a demonic boar before that. Phario Forel had written it, and he had the bloodiest quill of all of Braavos.\n\nMercy found the company assembled behind the stage, and slipped in between Daena and the Snapper at the back, hoping her late arrival would go unnoticed. Izembaro was telling everyone that he expected the Gate to be packed to the rafters this evening, despite the fog. “The King of Westeros is sending his envoy to do homage to the King of the Mummers tonight,” he told his troupe. “We will not disappoint our fellow monarch.”\n\n“We?” said the Snapper, who did all the costumes for the mummers. “Is there more than one of him, now?”\n\n“He’s fat enough to count for two,” whispered Bobono. Every mummer’s troupe had to have a dwarf. He was theirs. When he saw Mercy, he gave her a leer. “Oho,” he said, “there she is. Is the little girl all ready for her rape?” He smacked his lips.\n\nThe Snapper smacked him in the head. “Be quiet.”\n\nThe King of the Mummers ignored the brief commotion. He was still talking, telling the mummers how magnificent they must be. Besides the Westerosi envoy, there would be keyholders in the crowd this evening, and famous courtesans as well. He did not intend for them to leave with a poor opinion of the Gate. “It shall go ill for any man who fails me,” he promised, a threat he borrowed from the speech Prince Garin gives on the eve of battle in Wroth of the Dragonlords, Phario Forel’s first play.\n\nBy the time Izembaro finally finished speaking, less than an hour remained before the show, and the mummers were all frantic and fretful by turns. The Gate rang to the sound of Mercy’s name.\n\n“Mercy,” her friend Daena implored, “Lady Stork has stepped on the hem of her gown again. Come help me sew it up.”\n\n“Mercy,” the Stranger called, “bring the bloody paste, my horn is coming loose.”\n\n“Mercy,” boomed Izembaro the Great himself, “what have you done with my crown, girl? I cannot make my entrance without my crown. How shall they know that I’m a king?”\n\n“Mercy,” squeaked the dwarf Bobono, “Mercy, something’s amiss with my laces, my cock keeps flopping out.”\n\nShe fetched the sticky paste and fastened the Stranger’s left horn back onto his forehead. She found Izembaro’s crown in the privy where he always left it and helped him pin it to his wig, and then ran for needle and thread so the Snapper could sew the lace hem back onto the cloth-of-gold gown that the queen would wear in the wedding scene.\n\nAnd Bobono’s cock was indeed flopping out. It was made to flop out, for the rape. What a hideous thing, Mercy thought as she knelt before the dwarf to fix him. The cock was a foot long and as thick as her arm, big enough to be seen from the highest balcony. The dyer had done a poor job with the leather, though; the thing was a mottled pink and white, with a bulbous head the color of a plum. Mercy pushed it back into Bobono’s breeches and laced him back up. “Mercy,” he sang as she tied him tight, “Mercy, Mercy, come to my room tonight and make a man of me.”\n\n“I’ll make a eunuch of you if you keep unlacing yourself just so I’ll fiddle with your crotch.”\n\n“We were meant to be together, Mercy,” Bobono insisted. “Look, we’re just the same height.”\n\n“Only when I’m on my knees. Do you remember your first line?” It had only been a fortnight since the dwarf had lurched onto stage in his cups and opened The Anguish of the Archon with the grumpkin’s speech from The Merchant’s Lusty Lady. Izembaro would skin him alive if he made such a blunder again, and never mind how hard it was to find a good dwarf.\n\n“What are we playing, Mercy?” Bobono asked innocently.\n\nHe is teasing me, Mercy thought. He’s not drunk tonight, he knows the show perfectly well. “We are doing Phario’s new Bloody Hand, in honor of the envoy from the Seven Kingdoms.”\n\n“Now I recall.” Bobono lowered his voice to a sinister croak. “The seven-faced god has cheated me,” he said. “My noble sire he made of purest gold, and gold he made my siblings, boy and girl. But I am formed of darker stuff, of bones and blood and clay, twisted into this rude shape you see before you.” With that, he grabbed at her chest, fumbling for a nipple. “You have no titties. How can I rape a girl with no titties?”\n\nShe caught his nose between her thumb and forefinger and twisted. “You’ll have no nose until you get your hands off me.”\n\n“Owwwww,” the dwarf squealed, releasing her.\n\n“I’ll grow titties in a year or two.” Mercy rose, to tower over the little man. “But you’ll never grow another nose. You think of that, before you touch me there.”\n\nBobono rubbed his tender nose. “There’s no need to get so shy. I’ll be raping you soon enough.”\n\n“Not until the second act.”\n\n“I always give Wendeyne’s titties a nice squeeze when I rape her in The Anguish of the Archon,” the dwarf complained. “She likes it, and the pit does too. You have to please the pit.”\n\nThat was one of Izembaro’s “wisdoms,” as he liked to call them. You have to please the pit. “I bet it would please the pit if I ripped off the dwarf’s cock and beat him about the head with it,” Mercy replied. “That’s something they won’t have seen before.” Always give them something they haven’t seen before was another of Izembaro’s “wisdoms,” and one that Bobono had no easy answer for. “There, you’re done,” Mercy announced. “Now see if you can keep in your breeches till it’s needed.”\n\nIzembaro was calling for her again. Now he could not find his boar spear. Mercy found it for him, helped Big Brusco don his boar suit, checked the trick daggers just to make certain no one had replaced one with a real blade (someone had done that at the Dome once, and a mummer had died), and poured Lady Stork the little nip of wine she liked to have before each play. When all the cries of “Mercy, Mercy, Mercy” finally died away, she stole a moment for a quick peek out into the house.\n\nThe pit was as full as ever she’d seen it, and they were enjoying themselves already, joking and jostling, eating and drinking. She saw a peddler selling chunks of cheese, ripping them off the wheel with his fingers whenever he found a buyer. A woman had a bag of wrinkled apples. Skins of wine were being passed from hand to hand, some girls were selling kisses, and one sailor was playing the sea pipes. The sad-eyed little man called Quill stood in the back, come to see what he could steal for one of his own plays. Cossomo the Conjurer had come as well, and on his arm was Yna, the one-eyed whore from the Happy Port, but Mercy could not know those two, and they would not know Mercy. Daena recognized some Gate regulars in the crowd, and pointed them out for her; the dyer Dellono with his pinched white face and mottled purple hands, Galeo the sausage-maker in his greasy leather apron, tall Tomarro with his pet rat on his shoulder. “Tomarro best not let Galeo see that rat,” Daena warned. “That’s the only meat he puts in them sausages, I hear.” Mercy covered her mouth and laughed.\n\nThe balconies were filling too. The first and third levels were for merchants and captains and other respectable folk. The bravos preferred the fourth and highest, where the seats were cheapest. It was a riot of bright color up there, while down below more somber shades held sway. The second balcony was cut up into private boxes where the mighty could comport themselves in comfort and privacy, safely apart from the vulgarity above and below. They had the best view of the stage, and servants to bring them food, wine, cushions, whatever they might desire. It was rare to find the second balcony more than half full at the Gate; such of the mighty who relished a night of mummery were more inclined to visit the Dome or the Blue Lantern, where the offerings were considered subtler and more poetic.\n\nThis night was different, though, no doubt on account of the Westerosi envoy. In one box sat three scions of Otharys, each accompanied by a famous courtesan; Prestayn sat alone, a man so ancient that you wondered how he ever reached his seat; Torone and Pranelis shared a box, as they shared an uncomfortable alliance; the Third Sword was hosting a half-dozen friends.\n\n“I count five keyholders,” said Daena.\n\n“Bessaro is so fat you ought to count him twice,” Mercy replied, giggling. Izembaro had a belly on him, but compared to Bessaro he was as lithe as a willow. The keyholder was so big he needed a special seat, thrice the size of a common chair.\n\n“They’re all fat, them Reyaans,” Daena said. “Bellies as big as their ships. You should have seen the father. He made this one look small. One time he was summoned to the Hall of Truth to vote, but when he stepped onto his barge it sank.” She clutched Mercy by the elbow. “Look, the Sealord’s box.” The Sealord had never visited the Gate, but Izembaro named a box for him anyway, the largest and most opulent in the house. “That must be the Westerosi envoy. Have you ever seen such clothes on an old man? And look, he’s brought the Black Pearl!”\n\nThe envoy was slight and balding, with a funny grey wisp of a beard growing from his chin. His cloak was yellow velvet, and his breeches. His doublet was a blue so bright it almost made Mercy’s eyes water. Upon his breast a shield had been embroidered in yellow thread, and on the shield was a proud blue rooster picked out in lapis lazuli. One of his guards helped him to his seat, while two others stood behind him in the back of the box.\n\nThe woman with him could not have been more than a third his age. She was so lovely that the lamps seemed to burn brighter when she passed. She had dressed in a low-cut gown of pale yellow silk, startling against the light brown of her skin. Her black hair was bound up in a net of spun gold, and a jet-and-gold necklace brushed against the top of her full breasts. As they watched, she leaned close to the envoy and whispered something in his ear that made him laugh. “They should call her the Brown Pearl,” Mercy said to Daena. “She’s more brown than black.”\n\n“The first Black Pearl was black as a pot of ink,” said Daena. “She was a pirate queen, fathered by a Sealord’s son on a princess from the Summer Isles. A dragon king from Westeros took her for his lover.”\n\n“I would like to see a dragon,” Mercy said wistfully. “Why does the envoy have a chicken on his chest?”\n\nDaena howled. “Mercy, don’t you know anything? It’s his siggle. In the Sunset Kingdoms all the lords have siggles. Some have flowers, some have fish, some have bears and elks and other things. See, the envoy’s guards are wearing lions.”\n\nIt was true. There were four guards; big, hard-looking men in ringmail, with heavy Westerosi longswords sheathed at their hips. Their crimson cloaks were bordered in whorls of gold, and golden lions with red garnet eyes clasped each cloak at the shoulder. When Mercy glanced at the faces beneath the gilded, lion-crested helm, her belly gave a quiver.The gods have given me a gift. Her fingers clutched hard at Daena’s arm. “That guard. The one on the end, behind the Black Pearl.”\n\n“What of him? Do you know him?”\n\n“No.” Mercy had been born and bred in Braavos, how could she know some Westerosi? She had to think a moment. “It’s only… well, he’s fair to look on, don’t you think?” He was, in a rough-hewn way, though his eyes were hard.\n\nDaena shrugged. “He’s very old. Not so old as the other ones, but… he could be thirty. And Westerosi. They’re terrible savages, Mercy. Best stay well away from his sort.”\n\n“Stay away?” Mercy giggled. She was a giggly sort of girl, was Mercy. “No. I’ve got to get closer.” She gave Daena a squeeze and said, “If the Snapper comes looking for me, tell her that I went off to read my lines again.” She only had a few, and most were just, “Oh, no, no, no,” and “Don’t, oh don’t, don’t touch me,” and “Please, m’lord, I am still a maiden,” but this was the first time Izembaro had given her any lines at all, so it was only to be expected that poor Mercy would want to get them right.\n\nThe envoy from the Seven Kingdoms had taken two of his guards into his box to stand behind him and the Black Pearl, but the other two had been posted just outside the door to make certain he was not disturbed. They were talking quietly in the Common Tongue of Westeros as she slipped up silently behind them in the darkened passage. That was not a language Mercy knew.\n\n“Seven hells, this place is damp,” she heard her guard complain. “I’m chilled to the bones. Where are the bloody orange trees? I always heard there were orange trees in the Free Cities. Lemons and limes. Pomegranates. Hot peppers, warm nights, girls with bare bellies. Where are the bare-bellied girls, I ask you?”\n\n“Down in Lys, and Myr, and Old Volantis,” the other guard replied. He was an older man, big-bellied and grizzled. “I went to Lys with Lord Tywin once, when he was Hand to Aerys. Braavos is north of King’s Landing, fool. Can’t you read a bloody map?”\n\n“How long do you think we’ll be here?”\n\n“Longer than you’d like,” the old man replied. “If he goes back without the gold the queen will have his head. Besides, I seen that wife of his. There’s steps in Casterly Rock she can’t go down for fear she’d get stuck, that’s how fat she is. Who’d go back to that, when he has his sooty queen?”\n\nThe handsome guardsman grinned. “Don’t suppose he’ll share her with us, afterward?”\n\n“What, are you mad? You think he notices the likes of us? Bloody bugger don’t even get our names right half the time. Maybe it was different with Clegane.”\n\n“Ser wasn’t one for mummer shows and fancy whores. When Ser wanted a woman he took one, but sometimes he’d let us have her, after. I wouldn’t mind having a taste of that Black Pearl. You think she’s pink between her legs?”\n\nMercy wanted to hear more, but there was no time. The Bloody Hand was about to start, and the Snapper would be looking for her to help with costumes. Izembaro might be the King of the Mummers, but the Snapper was the one that they all feared. Time enough for her pretty guardsman later.\n\nThe Bloody Hand opened in a lichyard.\n\nWhen the dwarf appeared suddenly from behind a wooden tombstone, the crowd began to hiss and curse. Bobono waddled to the front of the stage and leered at them. “The seven-faced god has cheated me,” he began, snarling the words. “My noble sire he made of purest gold, and gold he made my siblings, boy and girl. But I am formed of darker stuff, of bones and blood and clay… “\n\nBy then Marro had appeared behind him, gaunt and terrible in the Stranger’s long black robes. His face was black as well, his teeth red and shiny with blood, while ivory horns jutted upwards from his brow. Bobono could not see him, but the balconies could, and now the pit as well. The Gate grew deathly quiet. Marro moved forward silently.\n\nSo did Mercy. The costumes were all hung, and the Snapper was busy sewing Daena into her gown for the court scene, so Mercy’s absence should not be noted. Quiet as a shadow, she slipped around the back again, up to where the guardsmen stood outside the envoy’s box. Standing in a darkened alcove, still as stone, she had a good look at his face. She studied it carefully, to be sure. Am I too young for him? she wondered. Too plain? Too skinny? She hoped he wasn’t the sort of man who liked big breasts on a girl. Bobono had been right about her chest. It would be best if I could take him back to my place, have him all to myself. But will he come with me?\n\n“You think it might be him?” the pretty one was saying.\n\n“What, did the Others take your wits?”\n\n“Why not? He’s a dwarf, ain’t he?”\n\n“The Imp weren’t the only dwarf in the world.”\n\n“Maybe not, but look here, everyone says how clever he was, true? So maybe he figures the last place his sister would ever look for him would be in some mummer show, making fun of himself. So he does just that, to tweak her nose.”\n\n“Ah, you’re mad.”\n\n“Well, maybe I’ll follow him after the mummery. Find out for myself.” The guardsman put a hand on the hilt of his sword. “If I’m right, I’ll be a ma lord, and if I’m wrong, well, bleed it, it’s just some dwarf.” He gave a bark of laughter.\n\nOn stage, Bobono was bargaining with Marro’s sinister Stranger. He had a big voice for such a little man, and he made it ring off the highest rafters now. “Give me the cup,” he told the Stranger, “for I shall drink deep. And if it tastes of gold and lion’s blood, so much the better. As I cannot be the hero, let me be the monster, and lesson them in fear in place of love.”\n\nMercy mouthed the last lines along with him. They were better lines than hers, and apt besides. He’ll want me or he won’t, she thought, so let the play begin. She said a silent prayer to the god of many faces, slipped out of her alcove, and flounced up to the guardsmen. Mercy, Mercy, Mercy. “My lords,” she said, “do you speak Braavosi? Oh, please, tell me you do.”\n\nThe two guardsmen exchanged a look. “What’s this thing going on about?” the older one asked. “Who is she?”\n\n“One of the mummers,” said the pretty one. He pushed his fair hair back off his brow and smiled at her. “Sorry, sweetling, we don’t speak your gibble-gabble.”\n\nFuss and feathers, Mercy thought, they only know the Common Tongue. That was no good. Give it up or go ahead. She could not give it up. She wanted him so bad. “I know your tongue, a little,” she lied, with Mercy’s sweetest smile. “You are lords of Westeros, my friend said.”\n\nThe old one laughed. “Lords? Aye, that’s us.”\n\nMercy looked down at her feet, so shy. “Izembaro said to please the lords,” she whispered. “If there is anything you want, anything at all… “\n\nThe two guardsmen exchanged a look. Then the handsome one reached out and touched her breast. “Anything?“\n\n“You’re disgusting,” said the older man.\n\n“Why? If this Izembaro wants to be hospitable, it would be rude to refuse.” He gave her nipple a tweak through the fabric of her dress, just the way the dwarf had done when she was fixing his cock for him. “Mummers are the next best thing to whores.”\n\n“Might be, but this one is a child.”\n\n“I am not,” lied Mercy. “I’m a maiden now.”\n\n“Not for long,” said the comely one. “I’m Lord Rafford, sweetling, and I know just what I want. Hike up those skirts now, and lean back against that wall.”\n\n“Not here,” Mercy said, brushing his hands away. “Not where the play is on. I might cry out, and Izembaro would be mad.”\n\n“Where, then?”\n\n“I know a place.”\n\nThe older guard was scowling. “What, you think can just scamper off? What if his knightliness comes looking for you?”\n\n“Why would he? He’s got a show to watch. And he’s got his own whore, why shouldn’t I have mine? This won’t take long.”\n\nNo, she thought, it won’t. Mercy took him by the hand, led him through the back and down the steps and out into the foggy night. “You could be a mummer, if you wanted,” she told him, as he pressed her up against the wall of the playhouse.\n\n“Me?” The guardsman snorted. “Not me, girl. All that bloody talking, I wouldn’t remember half of it.”\n\n“It’s hard at first,” she admitted. “But after a time it comes easier. I could teach you to say a line. I could.”\n\nHe grabbed her wrist. “I’ll do the teaching. Time for your first lesson.” He pulled her hard against him and kissed her on the lips, forcing his tongue into her mouth. It was all wet and slimy, like an eel. Mercy licked it with her own tongue, then broke away from him, breathless. “Not here. Someone might see. My room’s not far, but hurry. I have to be back before the second act, or I’ll miss my rape.”\n\nHe grinned. “No fear o’ that, girl.” But he let her pull him after her. Hand in hand, they went racing through the fog, over bridges and through alleys and up five flights of splintery wooden stairs. The guardsman was panting by the time they burst through the door of her little room. Mercy lit a tallow candle, then danced around at him, giggling. “Oh, now you’re all tired out. I forgot how old you were, m’lord. Do you want to take a little nap? Just lie down and close your eyes, and I’ll come back after the Imp’s done raping me.”\n\n“You’re not going anywhere.” He pulled her roughly to him. “Get those rags off, and I’ll show you how old I am, girl.”\n\n“Mercy,” she said. “My name is Mercy. Can you say it?”\n\n“Mercy,” he said. “My name is Raff.”\n\n“I know.” She slipped her hand between his legs, and felt how hard he was through the wool of his breeches.\n\n“The laces,” he urged her. “Be a sweet girl and undo them.” Instead she slid her finger down along the inside of his thigh. He gave a grunt. “Damn, be careful there, you — “\n\nMercy gave a gasp and stepped away, her face confused and frightened. “You’rebleeding.”\n\n“Wha — ” He looked down at himself. “Gods be good. What did you do to me, you little cunt?” The red stain spread across his thigh, soaking the heavy fabric.\n\n“Nothing,” Mercy squeaked. “I never… oh, oh, there’s so much blood. Stop it, stop it, you’re scaring me.”\n\nHe shook his head, a dazed look on his face. When he pressed his hand to his thigh, blood squirted through his fingers. It was running down his leg, into his boot. He doesn’t look so comely now, she thought. He just looks white and frightened.\n\n“A towel,” the guardsman gasped. “Bring me a towel, a rag, press down on it. Gods. I feel dizzy.” His leg was drenched with blood from the thigh down. When he tried to put his weight on it, his knee buckled and he fell. “Help me,” he pleaded, as the crotch of his breeches reddened. “Mother have mercy, girl. A healer… run and find a healer, quick now.”\n\n“There’s one on the next canal, but he won’t come. You have to go to him. Can’t you walk?”\n\n“Walk?” His fingers were slick with blood. “Are you blind, girl? I’m bleeding like a stuck pig. I can’t walk on this.”\n\n“Well,” she said, “I don’t know how you’ll get there, then.”\n\n“You’ll need to carry me.”\n\nSee? thought Mercy. You know your line, and so do I.\n\n“Think so?” asked Arya, sweetly.\n\nRaff the Sweetling looked up sharply as the long thin blade came sliding from her sleeve. She slipped it through his throat beneath the chin, twisted, and ripped it back out sideways with a single smooth slash. A fine red rain followed, and in his eyes the light went out.\n\n“Valar morghulis,” Arya whispered, but Raff was dead and did not hear. She sniffed. I should have helped him down the steps before I killed him. Now I’ll need to drag him all the way to the canal and roll him in. The eels would do the rest.\n\n“Mercy, Mercy, Mercy,” she sang sadly. A foolish, giddy girl she’d been, but good hearted. She would miss her, and she would miss Daena and the Snapper and the rest, even Izembaro and Bobono. This would make trouble for the Sealord and the envoy with the chicken on his chest, she did not doubt.\n\nShe would think about that later, though. Just now, there was no time. I had best run. Mercy still had some lines to say, her first lines and her last, and Izembaro would have her pretty little empty head if she were late for her own rape.\n","source":"_posts/MERCY.md","raw":"---\ntitle: MERCY\ndate: 2016-04-06 20:51:57\ntags: 冰与火之歌\ncomments: false\n---\n\n## MERCYE\\--EXCERPT FROM THE WINDS OF WINTER\n\nShe woke with a gasp, not knowing who she was, or where.\n\nThe smell of blood was heavy in her nostrils… or was that her nightmare, lingering? She had dreamed of wolves again, of running through some dark pine forest with a great pack at her hells, hard on the scent of prey.\n\nHalf-light filled the room, grey and gloomy. Shivering, she sat up in bed and ran a hand across her scalp. Stubble bristled against her palm. I need to shave before Izembaro sees. Mercy, I’m Mercy, and tonight I’ll be raped and murdered. Her true name was Mercedene, but Mercy was all anyone ever called her…\n<!--more-->\nExcept in dreams. She took a breath to quiet the howling in her heart, trying to remember more of what she’d dreamt, but most of it had gone already. There had been blood in it, though, and a full moon overhead, and a tree that watched her as she ran.\n\nShe had fastened the shutters back so the morning sun might wake her. But there was no sun outside the window of Mercy’s little room, only a wall of shifting grey fog. The air had grown chilly… and a good thing, else she might have slept all day. It would be just like Mercy to sleep through her own rape.\n\nGooseprickles covered her legs. Her coverlet had twisted around her like a snake. She unwound it, threw the blanket to the bare plank floor and padded naked to the window. Braavos was lost in fog. She could see the green water of the little canal below, the cobbled stone street that ran beneath her building, two arches of the mossy bridge… but the far end of the bridge vanished in greyness, and of the buildings across the canal only a few vague lights remained. She heard a soft splash as a serpent boat emerged beneath the bridge’s central arch. “What hour?” Mercy called down to the man who stood by the snake’s uplifted tail, pushing her onward with his pole.\n\nThe waterman gazed up, searching for the voice. “Four, by the Titan’s roar.” His words echoed hollowly off the swirling green waters and the walls of unseen buildings.\n\nShe was not late, not yet, but she should not dawdle. Mercy was a happy soul and a hard worker, but seldom timely. That would not serve tonight. The envoy from Westeros was expected at the Gate this evening, and Izembaro would be in no mood to hear excuses, even if she served them up with a sweet smile.\n\nShe had filled her basin from the canal last night before she went to sleep, preferring the brackish water to the slimy green rainwater stewing in the cistern out back. Dipping a rough cloth, she washed herself head to heel, standing on one leg at a time to scrub her calloused feet. After that she found her razor. A bare scalp helped the wigs fit better, Izembaro claimed.\n\nShe shaved, donned her smallclothes, and slipped a shapeless brown wool dress down over her head. One of her stockings needed mending, she saw as she pulled it up. She would ask the Snapper for help; her own sewing was so wretched that the wardrobe mistress usually took pity on her. Else I could filtch a nicer pair from wardrobe. That was risky, though. Izembaro hated it when the mummers wore his costumes in the streets.Except for Wendeyne. Give Izembaro’s cock a little suck and a girl can wear any costume that she wants. Mercy was not so foolish as all that. Daena had warned her. “Girls who start down that road wind up on the Ship, where every man in the pit knows he can have any pretty thing he might see up on the stage, if his purse is plump enough.”\n\nHer boots were lumps of old brown leather mottled with saltstains and cracked from long wear, her belt a length of hempen rope dyed blue. She knotted it about her waist, and hung a knife on her right hip and a coin pouch on her left. Last of all she threw her cloak across her shoulders. It was a real mummer’s cloak, purple wool lined in red silk, with a hood to keep the rain off, and three secret pockets too. She’d hid some coins in one of those, an iron key in another, a blade in the last. A real blade, not a fruit knife like the one on her hip, but it did not belong to Mercy, no more than her other treasures did. The fruit knife belonged to Mercy. She was made for eating fruit, for smiling and joking, for working hard and doing as she was told.\n\n“Mercy, Mercy, Mercy,” she sang as she descended the wooden stair to the street. The handrail was splintery, the steps steep, and there were five flights, but that was why she’d gotten the room so cheap. That, and Mercy’s smile. She might be bald and skinny, but Mercy had a pretty smile, and a certain grace. Even Izembaro agreed that she was graceful. She was not far from the Gate as the crows flies, but for girls with feet instead of wings the way was longer. Braavos was a crooked city. The streets were crooked, the alleys were crookeder, and the canals were crookedest of all. Most days she preferred to go the long way, down the Ragman’s Road along the Outer Harbor, where she had the sea before her and the sky above, and a clear view across the Great Lagoon to the Arsenal and the piney slopes of Sellagoro’s Shield. Sailors would hail her as she passed the docks, calling down from the decks of tarry Ibbenese whalers and big-bellied Westerosi cogs. Mercy could not always understand their words, but she knew what they were saying. Sometimes she would smile back and tell them they could find her at the Gate if they had the coin.\n\nThe long way also took her across the Bridge of Eyes with its carved stone faces. From the top of its span, she could look through the arches and see all the city: the green copper domes of the Hall of Truth, the masts rising like a forest from the Purple Harbor, the tall towers of the mighty, the golden thunderbolt turning on its spire atop the Sealord’s Palace… even the Titan’s bronze shoulders, off across the dark green waters. But that was only when the sun was shining down on Braavos. If the fog was thick there was nothing to see but grey, so today Mercy chose the shorter route to save some wear on her poor cracked boots.\n\nThe mists seemed to part before her and close up again as she passed. The cobblestones were wet and slick under her feet. She heard a cat yowl plaintively. Braavos was a good city for cats, and they roamed everywhere, especially at night. In the fog all cats are grey, Mercy thought. In the fog all men are killers.\n\nShe had never seen a thicker fog than this one. On the larger canals, the watermen would be running their serpent boats into one another, unable to make out any more than dim lights from the buildings to either side of them.\n\nMercy passed an old man with a lantern walking the other way, and envied him his light. The street was so gloomy she could scarcely see where she was stepping. In the humbler parts of the city, the houses, shops, and warehouses crowded together, leaning on each other like drunken lovers, their upper stories so close that you could step from one balcony to the next. The streets below became dark tunnels where every footfall echoed. The small canals were even more hazardous, since many of the houses that lined them had privies jutting out over the water. Izembaro loved to give the Sealord’s speech fromThe Merchant’s Melancholy Daughter, about how “here the last Titan yet stands, astride the stony shoulders of his brothers,” but Mercy preferred the scene where the fat merchant shat on the Sealord’s head as he passed underneath in his gold-and-purple barge. Only in Braavos could something like that happen, it was said, and only in Braavos would Sealord and sailor alike howl with laughter to see it.\n\nThe Gate stood close by the edge of Drowned Town, between the Outer Harbor and the Purple Harbor. An old warehouse had burnt there and the ground was sinking a little more each year, so the land came cheap. Atop the flooded stone foundation of the warehouse, Izembaro raised his cavernous playhall. The Dome and the Blue Lantern might enjoy more fashionable environs, he told his mummers, but here between the harbors they would never lack for sailors and whores to fill their pit. The Ship was close by, still pulling handsome crowds to the quay where she had been moored for twenty years, he said, and the Gate would flourish too.\n\nTime had proved him right. The Gate’s stage had developed a tilt as the building settled, their costumes were prone to mildew, and water snakes nested in the flooded cellar, but none of that troubled the mummers so long as the house was full.\n\nThe last bridge was made of rope and raw planks, and seemed to dissolve into nothingness, but that was only the fog. Mercy scampered across, her heels ringing on the wood. The fog opened before her like a tattered grey curtain to reveal the playhouse. Buttery yellow light spilled from the doors, and Mercy could hear voices from within. Beside the entrance, Big Brusco had painted over the title of the last show, and writtenThe Bloody Hand in its place in huge red letters. He was painting a bloody hand beneath the words, for those who could not read. Mercy stopped to have a look. “That’s a nice hand,” she told him.\n\n“Thumb’s crooked.” Brusco dabbed at it with his brush. “King o’ the Mummers been asking after you.”\n\n“It was so dark I slept and slept.” When Izembaro had first dubbed himself the King of the Mummers, the company had taken a wicked pleasure in it, savoring the outrage of their rivals from the Dome and the Blue Lantern. Of late, though, Izembaro had begun to take his title too seriously. “He will only play kings now,” Marro said, rolling his eyes, “and if the play has no king in it, he would sooner not stage it at all.”\n\nThe Bloody Hand offered two kings, the fat one and the boy. Izembaro would play the fat one. It was not a large part, but he had a fine speech as he lay dying, and a splendid fight with a demonic boar before that. Phario Forel had written it, and he had the bloodiest quill of all of Braavos.\n\nMercy found the company assembled behind the stage, and slipped in between Daena and the Snapper at the back, hoping her late arrival would go unnoticed. Izembaro was telling everyone that he expected the Gate to be packed to the rafters this evening, despite the fog. “The King of Westeros is sending his envoy to do homage to the King of the Mummers tonight,” he told his troupe. “We will not disappoint our fellow monarch.”\n\n“We?” said the Snapper, who did all the costumes for the mummers. “Is there more than one of him, now?”\n\n“He’s fat enough to count for two,” whispered Bobono. Every mummer’s troupe had to have a dwarf. He was theirs. When he saw Mercy, he gave her a leer. “Oho,” he said, “there she is. Is the little girl all ready for her rape?” He smacked his lips.\n\nThe Snapper smacked him in the head. “Be quiet.”\n\nThe King of the Mummers ignored the brief commotion. He was still talking, telling the mummers how magnificent they must be. Besides the Westerosi envoy, there would be keyholders in the crowd this evening, and famous courtesans as well. He did not intend for them to leave with a poor opinion of the Gate. “It shall go ill for any man who fails me,” he promised, a threat he borrowed from the speech Prince Garin gives on the eve of battle in Wroth of the Dragonlords, Phario Forel’s first play.\n\nBy the time Izembaro finally finished speaking, less than an hour remained before the show, and the mummers were all frantic and fretful by turns. The Gate rang to the sound of Mercy’s name.\n\n“Mercy,” her friend Daena implored, “Lady Stork has stepped on the hem of her gown again. Come help me sew it up.”\n\n“Mercy,” the Stranger called, “bring the bloody paste, my horn is coming loose.”\n\n“Mercy,” boomed Izembaro the Great himself, “what have you done with my crown, girl? I cannot make my entrance without my crown. How shall they know that I’m a king?”\n\n“Mercy,” squeaked the dwarf Bobono, “Mercy, something’s amiss with my laces, my cock keeps flopping out.”\n\nShe fetched the sticky paste and fastened the Stranger’s left horn back onto his forehead. She found Izembaro’s crown in the privy where he always left it and helped him pin it to his wig, and then ran for needle and thread so the Snapper could sew the lace hem back onto the cloth-of-gold gown that the queen would wear in the wedding scene.\n\nAnd Bobono’s cock was indeed flopping out. It was made to flop out, for the rape. What a hideous thing, Mercy thought as she knelt before the dwarf to fix him. The cock was a foot long and as thick as her arm, big enough to be seen from the highest balcony. The dyer had done a poor job with the leather, though; the thing was a mottled pink and white, with a bulbous head the color of a plum. Mercy pushed it back into Bobono’s breeches and laced him back up. “Mercy,” he sang as she tied him tight, “Mercy, Mercy, come to my room tonight and make a man of me.”\n\n“I’ll make a eunuch of you if you keep unlacing yourself just so I’ll fiddle with your crotch.”\n\n“We were meant to be together, Mercy,” Bobono insisted. “Look, we’re just the same height.”\n\n“Only when I’m on my knees. Do you remember your first line?” It had only been a fortnight since the dwarf had lurched onto stage in his cups and opened The Anguish of the Archon with the grumpkin’s speech from The Merchant’s Lusty Lady. Izembaro would skin him alive if he made such a blunder again, and never mind how hard it was to find a good dwarf.\n\n“What are we playing, Mercy?” Bobono asked innocently.\n\nHe is teasing me, Mercy thought. He’s not drunk tonight, he knows the show perfectly well. “We are doing Phario’s new Bloody Hand, in honor of the envoy from the Seven Kingdoms.”\n\n“Now I recall.” Bobono lowered his voice to a sinister croak. “The seven-faced god has cheated me,” he said. “My noble sire he made of purest gold, and gold he made my siblings, boy and girl. But I am formed of darker stuff, of bones and blood and clay, twisted into this rude shape you see before you.” With that, he grabbed at her chest, fumbling for a nipple. “You have no titties. How can I rape a girl with no titties?”\n\nShe caught his nose between her thumb and forefinger and twisted. “You’ll have no nose until you get your hands off me.”\n\n“Owwwww,” the dwarf squealed, releasing her.\n\n“I’ll grow titties in a year or two.” Mercy rose, to tower over the little man. “But you’ll never grow another nose. You think of that, before you touch me there.”\n\nBobono rubbed his tender nose. “There’s no need to get so shy. I’ll be raping you soon enough.”\n\n“Not until the second act.”\n\n“I always give Wendeyne’s titties a nice squeeze when I rape her in The Anguish of the Archon,” the dwarf complained. “She likes it, and the pit does too. You have to please the pit.”\n\nThat was one of Izembaro’s “wisdoms,” as he liked to call them. You have to please the pit. “I bet it would please the pit if I ripped off the dwarf’s cock and beat him about the head with it,” Mercy replied. “That’s something they won’t have seen before.” Always give them something they haven’t seen before was another of Izembaro’s “wisdoms,” and one that Bobono had no easy answer for. “There, you’re done,” Mercy announced. “Now see if you can keep in your breeches till it’s needed.”\n\nIzembaro was calling for her again. Now he could not find his boar spear. Mercy found it for him, helped Big Brusco don his boar suit, checked the trick daggers just to make certain no one had replaced one with a real blade (someone had done that at the Dome once, and a mummer had died), and poured Lady Stork the little nip of wine she liked to have before each play. When all the cries of “Mercy, Mercy, Mercy” finally died away, she stole a moment for a quick peek out into the house.\n\nThe pit was as full as ever she’d seen it, and they were enjoying themselves already, joking and jostling, eating and drinking. She saw a peddler selling chunks of cheese, ripping them off the wheel with his fingers whenever he found a buyer. A woman had a bag of wrinkled apples. Skins of wine were being passed from hand to hand, some girls were selling kisses, and one sailor was playing the sea pipes. The sad-eyed little man called Quill stood in the back, come to see what he could steal for one of his own plays. Cossomo the Conjurer had come as well, and on his arm was Yna, the one-eyed whore from the Happy Port, but Mercy could not know those two, and they would not know Mercy. Daena recognized some Gate regulars in the crowd, and pointed them out for her; the dyer Dellono with his pinched white face and mottled purple hands, Galeo the sausage-maker in his greasy leather apron, tall Tomarro with his pet rat on his shoulder. “Tomarro best not let Galeo see that rat,” Daena warned. “That’s the only meat he puts in them sausages, I hear.” Mercy covered her mouth and laughed.\n\nThe balconies were filling too. The first and third levels were for merchants and captains and other respectable folk. The bravos preferred the fourth and highest, where the seats were cheapest. It was a riot of bright color up there, while down below more somber shades held sway. The second balcony was cut up into private boxes where the mighty could comport themselves in comfort and privacy, safely apart from the vulgarity above and below. They had the best view of the stage, and servants to bring them food, wine, cushions, whatever they might desire. It was rare to find the second balcony more than half full at the Gate; such of the mighty who relished a night of mummery were more inclined to visit the Dome or the Blue Lantern, where the offerings were considered subtler and more poetic.\n\nThis night was different, though, no doubt on account of the Westerosi envoy. In one box sat three scions of Otharys, each accompanied by a famous courtesan; Prestayn sat alone, a man so ancient that you wondered how he ever reached his seat; Torone and Pranelis shared a box, as they shared an uncomfortable alliance; the Third Sword was hosting a half-dozen friends.\n\n“I count five keyholders,” said Daena.\n\n“Bessaro is so fat you ought to count him twice,” Mercy replied, giggling. Izembaro had a belly on him, but compared to Bessaro he was as lithe as a willow. The keyholder was so big he needed a special seat, thrice the size of a common chair.\n\n“They’re all fat, them Reyaans,” Daena said. “Bellies as big as their ships. You should have seen the father. He made this one look small. One time he was summoned to the Hall of Truth to vote, but when he stepped onto his barge it sank.” She clutched Mercy by the elbow. “Look, the Sealord’s box.” The Sealord had never visited the Gate, but Izembaro named a box for him anyway, the largest and most opulent in the house. “That must be the Westerosi envoy. Have you ever seen such clothes on an old man? And look, he’s brought the Black Pearl!”\n\nThe envoy was slight and balding, with a funny grey wisp of a beard growing from his chin. His cloak was yellow velvet, and his breeches. His doublet was a blue so bright it almost made Mercy’s eyes water. Upon his breast a shield had been embroidered in yellow thread, and on the shield was a proud blue rooster picked out in lapis lazuli. One of his guards helped him to his seat, while two others stood behind him in the back of the box.\n\nThe woman with him could not have been more than a third his age. She was so lovely that the lamps seemed to burn brighter when she passed. She had dressed in a low-cut gown of pale yellow silk, startling against the light brown of her skin. Her black hair was bound up in a net of spun gold, and a jet-and-gold necklace brushed against the top of her full breasts. As they watched, she leaned close to the envoy and whispered something in his ear that made him laugh. “They should call her the Brown Pearl,” Mercy said to Daena. “She’s more brown than black.”\n\n“The first Black Pearl was black as a pot of ink,” said Daena. “She was a pirate queen, fathered by a Sealord’s son on a princess from the Summer Isles. A dragon king from Westeros took her for his lover.”\n\n“I would like to see a dragon,” Mercy said wistfully. “Why does the envoy have a chicken on his chest?”\n\nDaena howled. “Mercy, don’t you know anything? It’s his siggle. In the Sunset Kingdoms all the lords have siggles. Some have flowers, some have fish, some have bears and elks and other things. See, the envoy’s guards are wearing lions.”\n\nIt was true. There were four guards; big, hard-looking men in ringmail, with heavy Westerosi longswords sheathed at their hips. Their crimson cloaks were bordered in whorls of gold, and golden lions with red garnet eyes clasped each cloak at the shoulder. When Mercy glanced at the faces beneath the gilded, lion-crested helm, her belly gave a quiver.The gods have given me a gift. Her fingers clutched hard at Daena’s arm. “That guard. The one on the end, behind the Black Pearl.”\n\n“What of him? Do you know him?”\n\n“No.” Mercy had been born and bred in Braavos, how could she know some Westerosi? She had to think a moment. “It’s only… well, he’s fair to look on, don’t you think?” He was, in a rough-hewn way, though his eyes were hard.\n\nDaena shrugged. “He’s very old. Not so old as the other ones, but… he could be thirty. And Westerosi. They’re terrible savages, Mercy. Best stay well away from his sort.”\n\n“Stay away?” Mercy giggled. She was a giggly sort of girl, was Mercy. “No. I’ve got to get closer.” She gave Daena a squeeze and said, “If the Snapper comes looking for me, tell her that I went off to read my lines again.” She only had a few, and most were just, “Oh, no, no, no,” and “Don’t, oh don’t, don’t touch me,” and “Please, m’lord, I am still a maiden,” but this was the first time Izembaro had given her any lines at all, so it was only to be expected that poor Mercy would want to get them right.\n\nThe envoy from the Seven Kingdoms had taken two of his guards into his box to stand behind him and the Black Pearl, but the other two had been posted just outside the door to make certain he was not disturbed. They were talking quietly in the Common Tongue of Westeros as she slipped up silently behind them in the darkened passage. That was not a language Mercy knew.\n\n“Seven hells, this place is damp,” she heard her guard complain. “I’m chilled to the bones. Where are the bloody orange trees? I always heard there were orange trees in the Free Cities. Lemons and limes. Pomegranates. Hot peppers, warm nights, girls with bare bellies. Where are the bare-bellied girls, I ask you?”\n\n“Down in Lys, and Myr, and Old Volantis,” the other guard replied. He was an older man, big-bellied and grizzled. “I went to Lys with Lord Tywin once, when he was Hand to Aerys. Braavos is north of King’s Landing, fool. Can’t you read a bloody map?”\n\n“How long do you think we’ll be here?”\n\n“Longer than you’d like,” the old man replied. “If he goes back without the gold the queen will have his head. Besides, I seen that wife of his. There’s steps in Casterly Rock she can’t go down for fear she’d get stuck, that’s how fat she is. Who’d go back to that, when he has his sooty queen?”\n\nThe handsome guardsman grinned. “Don’t suppose he’ll share her with us, afterward?”\n\n“What, are you mad? You think he notices the likes of us? Bloody bugger don’t even get our names right half the time. Maybe it was different with Clegane.”\n\n“Ser wasn’t one for mummer shows and fancy whores. When Ser wanted a woman he took one, but sometimes he’d let us have her, after. I wouldn’t mind having a taste of that Black Pearl. You think she’s pink between her legs?”\n\nMercy wanted to hear more, but there was no time. The Bloody Hand was about to start, and the Snapper would be looking for her to help with costumes. Izembaro might be the King of the Mummers, but the Snapper was the one that they all feared. Time enough for her pretty guardsman later.\n\nThe Bloody Hand opened in a lichyard.\n\nWhen the dwarf appeared suddenly from behind a wooden tombstone, the crowd began to hiss and curse. Bobono waddled to the front of the stage and leered at them. “The seven-faced god has cheated me,” he began, snarling the words. “My noble sire he made of purest gold, and gold he made my siblings, boy and girl. But I am formed of darker stuff, of bones and blood and clay… “\n\nBy then Marro had appeared behind him, gaunt and terrible in the Stranger’s long black robes. His face was black as well, his teeth red and shiny with blood, while ivory horns jutted upwards from his brow. Bobono could not see him, but the balconies could, and now the pit as well. The Gate grew deathly quiet. Marro moved forward silently.\n\nSo did Mercy. The costumes were all hung, and the Snapper was busy sewing Daena into her gown for the court scene, so Mercy’s absence should not be noted. Quiet as a shadow, she slipped around the back again, up to where the guardsmen stood outside the envoy’s box. Standing in a darkened alcove, still as stone, she had a good look at his face. She studied it carefully, to be sure. Am I too young for him? she wondered. Too plain? Too skinny? She hoped he wasn’t the sort of man who liked big breasts on a girl. Bobono had been right about her chest. It would be best if I could take him back to my place, have him all to myself. But will he come with me?\n\n“You think it might be him?” the pretty one was saying.\n\n“What, did the Others take your wits?”\n\n“Why not? He’s a dwarf, ain’t he?”\n\n“The Imp weren’t the only dwarf in the world.”\n\n“Maybe not, but look here, everyone says how clever he was, true? So maybe he figures the last place his sister would ever look for him would be in some mummer show, making fun of himself. So he does just that, to tweak her nose.”\n\n“Ah, you’re mad.”\n\n“Well, maybe I’ll follow him after the mummery. Find out for myself.” The guardsman put a hand on the hilt of his sword. “If I’m right, I’ll be a ma lord, and if I’m wrong, well, bleed it, it’s just some dwarf.” He gave a bark of laughter.\n\nOn stage, Bobono was bargaining with Marro’s sinister Stranger. He had a big voice for such a little man, and he made it ring off the highest rafters now. “Give me the cup,” he told the Stranger, “for I shall drink deep. And if it tastes of gold and lion’s blood, so much the better. As I cannot be the hero, let me be the monster, and lesson them in fear in place of love.”\n\nMercy mouthed the last lines along with him. They were better lines than hers, and apt besides. He’ll want me or he won’t, she thought, so let the play begin. She said a silent prayer to the god of many faces, slipped out of her alcove, and flounced up to the guardsmen. Mercy, Mercy, Mercy. “My lords,” she said, “do you speak Braavosi? Oh, please, tell me you do.”\n\nThe two guardsmen exchanged a look. “What’s this thing going on about?” the older one asked. “Who is she?”\n\n“One of the mummers,” said the pretty one. He pushed his fair hair back off his brow and smiled at her. “Sorry, sweetling, we don’t speak your gibble-gabble.”\n\nFuss and feathers, Mercy thought, they only know the Common Tongue. That was no good. Give it up or go ahead. She could not give it up. She wanted him so bad. “I know your tongue, a little,” she lied, with Mercy’s sweetest smile. “You are lords of Westeros, my friend said.”\n\nThe old one laughed. “Lords? Aye, that’s us.”\n\nMercy looked down at her feet, so shy. “Izembaro said to please the lords,” she whispered. “If there is anything you want, anything at all… “\n\nThe two guardsmen exchanged a look. Then the handsome one reached out and touched her breast. “Anything?“\n\n“You’re disgusting,” said the older man.\n\n“Why? If this Izembaro wants to be hospitable, it would be rude to refuse.” He gave her nipple a tweak through the fabric of her dress, just the way the dwarf had done when she was fixing his cock for him. “Mummers are the next best thing to whores.”\n\n“Might be, but this one is a child.”\n\n“I am not,” lied Mercy. “I’m a maiden now.”\n\n“Not for long,” said the comely one. “I’m Lord Rafford, sweetling, and I know just what I want. Hike up those skirts now, and lean back against that wall.”\n\n“Not here,” Mercy said, brushing his hands away. “Not where the play is on. I might cry out, and Izembaro would be mad.”\n\n“Where, then?”\n\n“I know a place.”\n\nThe older guard was scowling. “What, you think can just scamper off? What if his knightliness comes looking for you?”\n\n“Why would he? He’s got a show to watch. And he’s got his own whore, why shouldn’t I have mine? This won’t take long.”\n\nNo, she thought, it won’t. Mercy took him by the hand, led him through the back and down the steps and out into the foggy night. “You could be a mummer, if you wanted,” she told him, as he pressed her up against the wall of the playhouse.\n\n“Me?” The guardsman snorted. “Not me, girl. All that bloody talking, I wouldn’t remember half of it.”\n\n“It’s hard at first,” she admitted. “But after a time it comes easier. I could teach you to say a line. I could.”\n\nHe grabbed her wrist. “I’ll do the teaching. Time for your first lesson.” He pulled her hard against him and kissed her on the lips, forcing his tongue into her mouth. It was all wet and slimy, like an eel. Mercy licked it with her own tongue, then broke away from him, breathless. “Not here. Someone might see. My room’s not far, but hurry. I have to be back before the second act, or I’ll miss my rape.”\n\nHe grinned. “No fear o’ that, girl.” But he let her pull him after her. Hand in hand, they went racing through the fog, over bridges and through alleys and up five flights of splintery wooden stairs. The guardsman was panting by the time they burst through the door of her little room. Mercy lit a tallow candle, then danced around at him, giggling. “Oh, now you’re all tired out. I forgot how old you were, m’lord. Do you want to take a little nap? Just lie down and close your eyes, and I’ll come back after the Imp’s done raping me.”\n\n“You’re not going anywhere.” He pulled her roughly to him. “Get those rags off, and I’ll show you how old I am, girl.”\n\n“Mercy,” she said. “My name is Mercy. Can you say it?”\n\n“Mercy,” he said. “My name is Raff.”\n\n“I know.” She slipped her hand between his legs, and felt how hard he was through the wool of his breeches.\n\n“The laces,” he urged her. “Be a sweet girl and undo them.” Instead she slid her finger down along the inside of his thigh. He gave a grunt. “Damn, be careful there, you — “\n\nMercy gave a gasp and stepped away, her face confused and frightened. “You’rebleeding.”\n\n“Wha — ” He looked down at himself. “Gods be good. What did you do to me, you little cunt?” The red stain spread across his thigh, soaking the heavy fabric.\n\n“Nothing,” Mercy squeaked. “I never… oh, oh, there’s so much blood. Stop it, stop it, you’re scaring me.”\n\nHe shook his head, a dazed look on his face. When he pressed his hand to his thigh, blood squirted through his fingers. It was running down his leg, into his boot. He doesn’t look so comely now, she thought. He just looks white and frightened.\n\n“A towel,” the guardsman gasped. “Bring me a towel, a rag, press down on it. Gods. I feel dizzy.” His leg was drenched with blood from the thigh down. When he tried to put his weight on it, his knee buckled and he fell. “Help me,” he pleaded, as the crotch of his breeches reddened. “Mother have mercy, girl. A healer… run and find a healer, quick now.”\n\n“There’s one on the next canal, but he won’t come. You have to go to him. Can’t you walk?”\n\n“Walk?” His fingers were slick with blood. “Are you blind, girl? I’m bleeding like a stuck pig. I can’t walk on this.”\n\n“Well,” she said, “I don’t know how you’ll get there, then.”\n\n“You’ll need to carry me.”\n\nSee? thought Mercy. You know your line, and so do I.\n\n“Think so?” asked Arya, sweetly.\n\nRaff the Sweetling looked up sharply as the long thin blade came sliding from her sleeve. She slipped it through his throat beneath the chin, twisted, and ripped it back out sideways with a single smooth slash. A fine red rain followed, and in his eyes the light went out.\n\n“Valar morghulis,” Arya whispered, but Raff was dead and did not hear. She sniffed. I should have helped him down the steps before I killed him. Now I’ll need to drag him all the way to the canal and roll him in. The eels would do the rest.\n\n“Mercy, Mercy, Mercy,” she sang sadly. A foolish, giddy girl she’d been, but good hearted. She would miss her, and she would miss Daena and the Snapper and the rest, even Izembaro and Bobono. This would make trouble for the Sealord and the envoy with the chicken on his chest, she did not doubt.\n\nShe would think about that later, though. Just now, there was no time. I had best run. Mercy still had some lines to say, her first lines and her last, and Izembaro would have her pretty little empty head if she were late for her own rape.\n","slug":"MERCY","published":1,"updated":"2017-04-15T14:05:50.000Z","layout":"post","photos":[],"link":"","_id":"cjr66wicv000cmetph18pxox5","content":"<h2 id=\"MERCYE-EXCERPT-FROM-THE-WINDS-OF-WINTER\"><a href=\"#MERCYE-EXCERPT-FROM-THE-WINDS-OF-WINTER\" class=\"headerlink\" title=\"MERCYE--EXCERPT FROM THE WINDS OF WINTER\"></a>MERCYE--EXCERPT FROM THE WINDS OF WINTER</h2><p>She woke with a gasp, not knowing who she was, or where.</p>\n<p>The smell of blood was heavy in her nostrils… or was that her nightmare, lingering? She had dreamed of wolves again, of running through some dark pine forest with a great pack at her hells, hard on the scent of prey.</p>\n<p>Half-light filled the room, grey and gloomy. Shivering, she sat up in bed and ran a hand across her scalp. Stubble bristled against her palm. I need to shave before Izembaro sees. Mercy, I’m Mercy, and tonight I’ll be raped and murdered. Her true name was Mercedene, but Mercy was all anyone ever called her…<br><a id=\"more\"></a><br>Except in dreams. She took a breath to quiet the howling in her heart, trying to remember more of what she’d dreamt, but most of it had gone already. There had been blood in it, though, and a full moon overhead, and a tree that watched her as she ran.</p>\n<p>She had fastened the shutters back so the morning sun might wake her. But there was no sun outside the window of Mercy’s little room, only a wall of shifting grey fog. The air had grown chilly… and a good thing, else she might have slept all day. It would be just like Mercy to sleep through her own rape.</p>\n<p>Gooseprickles covered her legs. Her coverlet had twisted around her like a snake. She unwound it, threw the blanket to the bare plank floor and padded naked to the window. Braavos was lost in fog. She could see the green water of the little canal below, the cobbled stone street that ran beneath her building, two arches of the mossy bridge… but the far end of the bridge vanished in greyness, and of the buildings across the canal only a few vague lights remained. She heard a soft splash as a serpent boat emerged beneath the bridge’s central arch. “What hour?” Mercy called down to the man who stood by the snake’s uplifted tail, pushing her onward with his pole.</p>\n<p>The waterman gazed up, searching for the voice. “Four, by the Titan’s roar.” His words echoed hollowly off the swirling green waters and the walls of unseen buildings.</p>\n<p>She was not late, not yet, but she should not dawdle. Mercy was a happy soul and a hard worker, but seldom timely. That would not serve tonight. The envoy from Westeros was expected at the Gate this evening, and Izembaro would be in no mood to hear excuses, even if she served them up with a sweet smile.</p>\n<p>She had filled her basin from the canal last night before she went to sleep, preferring the brackish water to the slimy green rainwater stewing in the cistern out back. Dipping a rough cloth, she washed herself head to heel, standing on one leg at a time to scrub her calloused feet. After that she found her razor. A bare scalp helped the wigs fit better, Izembaro claimed.</p>\n<p>She shaved, donned her smallclothes, and slipped a shapeless brown wool dress down over her head. One of her stockings needed mending, she saw as she pulled it up. She would ask the Snapper for help; her own sewing was so wretched that the wardrobe mistress usually took pity on her. Else I could filtch a nicer pair from wardrobe. That was risky, though. Izembaro hated it when the mummers wore his costumes in the streets.Except for Wendeyne. Give Izembaro’s cock a little suck and a girl can wear any costume that she wants. Mercy was not so foolish as all that. Daena had warned her. “Girls who start down that road wind up on the Ship, where every man in the pit knows he can have any pretty thing he might see up on the stage, if his purse is plump enough.”</p>\n<p>Her boots were lumps of old brown leather mottled with saltstains and cracked from long wear, her belt a length of hempen rope dyed blue. She knotted it about her waist, and hung a knife on her right hip and a coin pouch on her left. Last of all she threw her cloak across her shoulders. It was a real mummer’s cloak, purple wool lined in red silk, with a hood to keep the rain off, and three secret pockets too. She’d hid some coins in one of those, an iron key in another, a blade in the last. A real blade, not a fruit knife like the one on her hip, but it did not belong to Mercy, no more than her other treasures did. The fruit knife belonged to Mercy. She was made for eating fruit, for smiling and joking, for working hard and doing as she was told.</p>\n<p>“Mercy, Mercy, Mercy,” she sang as she descended the wooden stair to the street. The handrail was splintery, the steps steep, and there were five flights, but that was why she’d gotten the room so cheap. That, and Mercy’s smile. She might be bald and skinny, but Mercy had a pretty smile, and a certain grace. Even Izembaro agreed that she was graceful. She was not far from the Gate as the crows flies, but for girls with feet instead of wings the way was longer. Braavos was a crooked city. The streets were crooked, the alleys were crookeder, and the canals were crookedest of all. Most days she preferred to go the long way, down the Ragman’s Road along the Outer Harbor, where she had the sea before her and the sky above, and a clear view across the Great Lagoon to the Arsenal and the piney slopes of Sellagoro’s Shield. Sailors would hail her as she passed the docks, calling down from the decks of tarry Ibbenese whalers and big-bellied Westerosi cogs. Mercy could not always understand their words, but she knew what they were saying. Sometimes she would smile back and tell them they could find her at the Gate if they had the coin.</p>\n<p>The long way also took her across the Bridge of Eyes with its carved stone faces. From the top of its span, she could look through the arches and see all the city: the green copper domes of the Hall of Truth, the masts rising like a forest from the Purple Harbor, the tall towers of the mighty, the golden thunderbolt turning on its spire atop the Sealord’s Palace… even the Titan’s bronze shoulders, off across the dark green waters. But that was only when the sun was shining down on Braavos. If the fog was thick there was nothing to see but grey, so today Mercy chose the shorter route to save some wear on her poor cracked boots.</p>\n<p>The mists seemed to part before her and close up again as she passed. The cobblestones were wet and slick under her feet. She heard a cat yowl plaintively. Braavos was a good city for cats, and they roamed everywhere, especially at night. In the fog all cats are grey, Mercy thought. In the fog all men are killers.</p>\n<p>She had never seen a thicker fog than this one. On the larger canals, the watermen would be running their serpent boats into one another, unable to make out any more than dim lights from the buildings to either side of them.</p>\n<p>Mercy passed an old man with a lantern walking the other way, and envied him his light. The street was so gloomy she could scarcely see where she was stepping. In the humbler parts of the city, the houses, shops, and warehouses crowded together, leaning on each other like drunken lovers, their upper stories so close that you could step from one balcony to the next. The streets below became dark tunnels where every footfall echoed. The small canals were even more hazardous, since many of the houses that lined them had privies jutting out over the water. Izembaro loved to give the Sealord’s speech fromThe Merchant’s Melancholy Daughter, about how “here the last Titan yet stands, astride the stony shoulders of his brothers,” but Mercy preferred the scene where the fat merchant shat on the Sealord’s head as he passed underneath in his gold-and-purple barge. Only in Braavos could something like that happen, it was said, and only in Braavos would Sealord and sailor alike howl with laughter to see it.</p>\n<p>The Gate stood close by the edge of Drowned Town, between the Outer Harbor and the Purple Harbor. An old warehouse had burnt there and the ground was sinking a little more each year, so the land came cheap. Atop the flooded stone foundation of the warehouse, Izembaro raised his cavernous playhall. The Dome and the Blue Lantern might enjoy more fashionable environs, he told his mummers, but here between the harbors they would never lack for sailors and whores to fill their pit. The Ship was close by, still pulling handsome crowds to the quay where she had been moored for twenty years, he said, and the Gate would flourish too.</p>\n<p>Time had proved him right. The Gate’s stage had developed a tilt as the building settled, their costumes were prone to mildew, and water snakes nested in the flooded cellar, but none of that troubled the mummers so long as the house was full.</p>\n<p>The last bridge was made of rope and raw planks, and seemed to dissolve into nothingness, but that was only the fog. Mercy scampered across, her heels ringing on the wood. The fog opened before her like a tattered grey curtain to reveal the playhouse. Buttery yellow light spilled from the doors, and Mercy could hear voices from within. Beside the entrance, Big Brusco had painted over the title of the last show, and writtenThe Bloody Hand in its place in huge red letters. He was painting a bloody hand beneath the words, for those who could not read. Mercy stopped to have a look. “That’s a nice hand,” she told him.</p>\n<p>“Thumb’s crooked.” Brusco dabbed at it with his brush. “King o’ the Mummers been asking after you.”</p>\n<p>“It was so dark I slept and slept.” When Izembaro had first dubbed himself the King of the Mummers, the company had taken a wicked pleasure in it, savoring the outrage of their rivals from the Dome and the Blue Lantern. Of late, though, Izembaro had begun to take his title too seriously. “He will only play kings now,” Marro said, rolling his eyes, “and if the play has no king in it, he would sooner not stage it at all.”</p>\n<p>The Bloody Hand offered two kings, the fat one and the boy. Izembaro would play the fat one. It was not a large part, but he had a fine speech as he lay dying, and a splendid fight with a demonic boar before that. Phario Forel had written it, and he had the bloodiest quill of all of Braavos.</p>\n<p>Mercy found the company assembled behind the stage, and slipped in between Daena and the Snapper at the back, hoping her late arrival would go unnoticed. Izembaro was telling everyone that he expected the Gate to be packed to the rafters this evening, despite the fog. “The King of Westeros is sending his envoy to do homage to the King of the Mummers tonight,” he told his troupe. “We will not disappoint our fellow monarch.”</p>\n<p>“We?” said the Snapper, who did all the costumes for the mummers. “Is there more than one of him, now?”</p>\n<p>“He’s fat enough to count for two,” whispered Bobono. Every mummer’s troupe had to have a dwarf. He was theirs. When he saw Mercy, he gave her a leer. “Oho,” he said, “there she is. Is the little girl all ready for her rape?” He smacked his lips.</p>\n<p>The Snapper smacked him in the head. “Be quiet.”</p>\n<p>The King of the Mummers ignored the brief commotion. He was still talking, telling the mummers how magnificent they must be. Besides the Westerosi envoy, there would be keyholders in the crowd this evening, and famous courtesans as well. He did not intend for them to leave with a poor opinion of the Gate. “It shall go ill for any man who fails me,” he promised, a threat he borrowed from the speech Prince Garin gives on the eve of battle in Wroth of the Dragonlords, Phario Forel’s first play.</p>\n<p>By the time Izembaro finally finished speaking, less than an hour remained before the show, and the mummers were all frantic and fretful by turns. The Gate rang to the sound of Mercy’s name.</p>\n<p>“Mercy,” her friend Daena implored, “Lady Stork has stepped on the hem of her gown again. Come help me sew it up.”</p>\n<p>“Mercy,” the Stranger called, “bring the bloody paste, my horn is coming loose.”</p>\n<p>“Mercy,” boomed Izembaro the Great himself, “what have you done with my crown, girl? I cannot make my entrance without my crown. How shall they know that I’m a king?”</p>\n<p>“Mercy,” squeaked the dwarf Bobono, “Mercy, something’s amiss with my laces, my cock keeps flopping out.”</p>\n<p>She fetched the sticky paste and fastened the Stranger’s left horn back onto his forehead. She found Izembaro’s crown in the privy where he always left it and helped him pin it to his wig, and then ran for needle and thread so the Snapper could sew the lace hem back onto the cloth-of-gold gown that the queen would wear in the wedding scene.</p>\n<p>And Bobono’s cock was indeed flopping out. It was made to flop out, for the rape. What a hideous thing, Mercy thought as she knelt before the dwarf to fix him. The cock was a foot long and as thick as her arm, big enough to be seen from the highest balcony. The dyer had done a poor job with the leather, though; the thing was a mottled pink and white, with a bulbous head the color of a plum. Mercy pushed it back into Bobono’s breeches and laced him back up. “Mercy,” he sang as she tied him tight, “Mercy, Mercy, come to my room tonight and make a man of me.”</p>\n<p>“I’ll make a eunuch of you if you keep unlacing yourself just so I’ll fiddle with your crotch.”</p>\n<p>“We were meant to be together, Mercy,” Bobono insisted. “Look, we’re just the same height.”</p>\n<p>“Only when I’m on my knees. Do you remember your first line?” It had only been a fortnight since the dwarf had lurched onto stage in his cups and opened The Anguish of the Archon with the grumpkin’s speech from The Merchant’s Lusty Lady. Izembaro would skin him alive if he made such a blunder again, and never mind how hard it was to find a good dwarf.</p>\n<p>“What are we playing, Mercy?” Bobono asked innocently.</p>\n<p>He is teasing me, Mercy thought. He’s not drunk tonight, he knows the show perfectly well. “We are doing Phario’s new Bloody Hand, in honor of the envoy from the Seven Kingdoms.”</p>\n<p>“Now I recall.” Bobono lowered his voice to a sinister croak. “The seven-faced god has cheated me,” he said. “My noble sire he made of purest gold, and gold he made my siblings, boy and girl. But I am formed of darker stuff, of bones and blood and clay, twisted into this rude shape you see before you.” With that, he grabbed at her chest, fumbling for a nipple. “You have no titties. How can I rape a girl with no titties?”</p>\n<p>She caught his nose between her thumb and forefinger and twisted. “You’ll have no nose until you get your hands off me.”</p>\n<p>“Owwwww,” the dwarf squealed, releasing her.</p>\n<p>“I’ll grow titties in a year or two.” Mercy rose, to tower over the little man. “But you’ll never grow another nose. You think of that, before you touch me there.”</p>\n<p>Bobono rubbed his tender nose. “There’s no need to get so shy. I’ll be raping you soon enough.”</p>\n<p>“Not until the second act.”</p>\n<p>“I always give Wendeyne’s titties a nice squeeze when I rape her in The Anguish of the Archon,” the dwarf complained. “She likes it, and the pit does too. You have to please the pit.”</p>\n<p>That was one of Izembaro’s “wisdoms,” as he liked to call them. You have to please the pit. “I bet it would please the pit if I ripped off the dwarf’s cock and beat him about the head with it,” Mercy replied. “That’s something they won’t have seen before.” Always give them something they haven’t seen before was another of Izembaro’s “wisdoms,” and one that Bobono had no easy answer for. “There, you’re done,” Mercy announced. “Now see if you can keep in your breeches till it’s needed.”</p>\n<p>Izembaro was calling for her again. Now he could not find his boar spear. Mercy found it for him, helped Big Brusco don his boar suit, checked the trick daggers just to make certain no one had replaced one with a real blade (someone had done that at the Dome once, and a mummer had died), and poured Lady Stork the little nip of wine she liked to have before each play. When all the cries of “Mercy, Mercy, Mercy” finally died away, she stole a moment for a quick peek out into the house.</p>\n<p>The pit was as full as ever she’d seen it, and they were enjoying themselves already, joking and jostling, eating and drinking. She saw a peddler selling chunks of cheese, ripping them off the wheel with his fingers whenever he found a buyer. A woman had a bag of wrinkled apples. Skins of wine were being passed from hand to hand, some girls were selling kisses, and one sailor was playing the sea pipes. The sad-eyed little man called Quill stood in the back, come to see what he could steal for one of his own plays. Cossomo the Conjurer had come as well, and on his arm was Yna, the one-eyed whore from the Happy Port, but Mercy could not know those two, and they would not know Mercy. Daena recognized some Gate regulars in the crowd, and pointed them out for her; the dyer Dellono with his pinched white face and mottled purple hands, Galeo the sausage-maker in his greasy leather apron, tall Tomarro with his pet rat on his shoulder. “Tomarro best not let Galeo see that rat,” Daena warned. “That’s the only meat he puts in them sausages, I hear.” Mercy covered her mouth and laughed.</p>\n<p>The balconies were filling too. The first and third levels were for merchants and captains and other respectable folk. The bravos preferred the fourth and highest, where the seats were cheapest. It was a riot of bright color up there, while down below more somber shades held sway. The second balcony was cut up into private boxes where the mighty could comport themselves in comfort and privacy, safely apart from the vulgarity above and below. They had the best view of the stage, and servants to bring them food, wine, cushions, whatever they might desire. It was rare to find the second balcony more than half full at the Gate; such of the mighty who relished a night of mummery were more inclined to visit the Dome or the Blue Lantern, where the offerings were considered subtler and more poetic.</p>\n<p>This night was different, though, no doubt on account of the Westerosi envoy. In one box sat three scions of Otharys, each accompanied by a famous courtesan; Prestayn sat alone, a man so ancient that you wondered how he ever reached his seat; Torone and Pranelis shared a box, as they shared an uncomfortable alliance; the Third Sword was hosting a half-dozen friends.</p>\n<p>“I count five keyholders,” said Daena.</p>\n<p>“Bessaro is so fat you ought to count him twice,” Mercy replied, giggling. Izembaro had a belly on him, but compared to Bessaro he was as lithe as a willow. The keyholder was so big he needed a special seat, thrice the size of a common chair.</p>\n<p>“They’re all fat, them Reyaans,” Daena said. “Bellies as big as their ships. You should have seen the father. He made this one look small. One time he was summoned to the Hall of Truth to vote, but when he stepped onto his barge it sank.” She clutched Mercy by the elbow. “Look, the Sealord’s box.” The Sealord had never visited the Gate, but Izembaro named a box for him anyway, the largest and most opulent in the house. “That must be the Westerosi envoy. Have you ever seen such clothes on an old man? And look, he’s brought the Black Pearl!”</p>\n<p>The envoy was slight and balding, with a funny grey wisp of a beard growing from his chin. His cloak was yellow velvet, and his breeches. His doublet was a blue so bright it almost made Mercy’s eyes water. Upon his breast a shield had been embroidered in yellow thread, and on the shield was a proud blue rooster picked out in lapis lazuli. One of his guards helped him to his seat, while two others stood behind him in the back of the box.</p>\n<p>The woman with him could not have been more than a third his age. She was so lovely that the lamps seemed to burn brighter when she passed. She had dressed in a low-cut gown of pale yellow silk, startling against the light brown of her skin. Her black hair was bound up in a net of spun gold, and a jet-and-gold necklace brushed against the top of her full breasts. As they watched, she leaned close to the envoy and whispered something in his ear that made him laugh. “They should call her the Brown Pearl,” Mercy said to Daena. “She’s more brown than black.”</p>\n<p>“The first Black Pearl was black as a pot of ink,” said Daena. “She was a pirate queen, fathered by a Sealord’s son on a princess from the Summer Isles. A dragon king from Westeros took her for his lover.”</p>\n<p>“I would like to see a dragon,” Mercy said wistfully. “Why does the envoy have a chicken on his chest?”</p>\n<p>Daena howled. “Mercy, don’t you know anything? It’s his siggle. In the Sunset Kingdoms all the lords have siggles. Some have flowers, some have fish, some have bears and elks and other things. See, the envoy’s guards are wearing lions.”</p>\n<p>It was true. There were four guards; big, hard-looking men in ringmail, with heavy Westerosi longswords sheathed at their hips. Their crimson cloaks were bordered in whorls of gold, and golden lions with red garnet eyes clasped each cloak at the shoulder. When Mercy glanced at the faces beneath the gilded, lion-crested helm, her belly gave a quiver.The gods have given me a gift. Her fingers clutched hard at Daena’s arm. “That guard. The one on the end, behind the Black Pearl.”</p>\n<p>“What of him? Do you know him?”</p>\n<p>“No.” Mercy had been born and bred in Braavos, how could she know some Westerosi? She had to think a moment. “It’s only… well, he’s fair to look on, don’t you think?” He was, in a rough-hewn way, though his eyes were hard.</p>\n<p>Daena shrugged. “He’s very old. Not so old as the other ones, but… he could be thirty. And Westerosi. They’re terrible savages, Mercy. Best stay well away from his sort.”</p>\n<p>“Stay away?” Mercy giggled. She was a giggly sort of girl, was Mercy. “No. I’ve got to get closer.” She gave Daena a squeeze and said, “If the Snapper comes looking for me, tell her that I went off to read my lines again.” She only had a few, and most were just, “Oh, no, no, no,” and “Don’t, oh don’t, don’t touch me,” and “Please, m’lord, I am still a maiden,” but this was the first time Izembaro had given her any lines at all, so it was only to be expected that poor Mercy would want to get them right.</p>\n<p>The envoy from the Seven Kingdoms had taken two of his guards into his box to stand behind him and the Black Pearl, but the other two had been posted just outside the door to make certain he was not disturbed. They were talking quietly in the Common Tongue of Westeros as she slipped up silently behind them in the darkened passage. That was not a language Mercy knew.</p>\n<p>“Seven hells, this place is damp,” she heard her guard complain. “I’m chilled to the bones. Where are the bloody orange trees? I always heard there were orange trees in the Free Cities. Lemons and limes. Pomegranates. Hot peppers, warm nights, girls with bare bellies. Where are the bare-bellied girls, I ask you?”</p>\n<p>“Down in Lys, and Myr, and Old Volantis,” the other guard replied. He was an older man, big-bellied and grizzled. “I went to Lys with Lord Tywin once, when he was Hand to Aerys. Braavos is north of King’s Landing, fool. Can’t you read a bloody map?”</p>\n<p>“How long do you think we’ll be here?”</p>\n<p>“Longer than you’d like,” the old man replied. “If he goes back without the gold the queen will have his head. Besides, I seen that wife of his. There’s steps in Casterly Rock she can’t go down for fear she’d get stuck, that’s how fat she is. Who’d go back to that, when he has his sooty queen?”</p>\n<p>The handsome guardsman grinned. “Don’t suppose he’ll share her with us, afterward?”</p>\n<p>“What, are you mad? You think he notices the likes of us? Bloody bugger don’t even get our names right half the time. Maybe it was different with Clegane.”</p>\n<p>“Ser wasn’t one for mummer shows and fancy whores. When Ser wanted a woman he took one, but sometimes he’d let us have her, after. I wouldn’t mind having a taste of that Black Pearl. You think she’s pink between her legs?”</p>\n<p>Mercy wanted to hear more, but there was no time. The Bloody Hand was about to start, and the Snapper would be looking for her to help with costumes. Izembaro might be the King of the Mummers, but the Snapper was the one that they all feared. Time enough for her pretty guardsman later.</p>\n<p>The Bloody Hand opened in a lichyard.</p>\n<p>When the dwarf appeared suddenly from behind a wooden tombstone, the crowd began to hiss and curse. Bobono waddled to the front of the stage and leered at them. “The seven-faced god has cheated me,” he began, snarling the words. “My noble sire he made of purest gold, and gold he made my siblings, boy and girl. But I am formed of darker stuff, of bones and blood and clay… “</p>\n<p>By then Marro had appeared behind him, gaunt and terrible in the Stranger’s long black robes. His face was black as well, his teeth red and shiny with blood, while ivory horns jutted upwards from his brow. Bobono could not see him, but the balconies could, and now the pit as well. The Gate grew deathly quiet. Marro moved forward silently.</p>\n<p>So did Mercy. The costumes were all hung, and the Snapper was busy sewing Daena into her gown for the court scene, so Mercy’s absence should not be noted. Quiet as a shadow, she slipped around the back again, up to where the guardsmen stood outside the envoy’s box. Standing in a darkened alcove, still as stone, she had a good look at his face. She studied it carefully, to be sure. Am I too young for him? she wondered. Too plain? Too skinny? She hoped he wasn’t the sort of man who liked big breasts on a girl. Bobono had been right about her chest. It would be best if I could take him back to my place, have him all to myself. But will he come with me?</p>\n<p>“You think it might be him?” the pretty one was saying.</p>\n<p>“What, did the Others take your wits?”</p>\n<p>“Why not? He’s a dwarf, ain’t he?”</p>\n<p>“The Imp weren’t the only dwarf in the world.”</p>\n<p>“Maybe not, but look here, everyone says how clever he was, true? So maybe he figures the last place his sister would ever look for him would be in some mummer show, making fun of himself. So he does just that, to tweak her nose.”</p>\n<p>“Ah, you’re mad.”</p>\n<p>“Well, maybe I’ll follow him after the mummery. Find out for myself.” The guardsman put a hand on the hilt of his sword. “If I’m right, I’ll be a ma lord, and if I’m wrong, well, bleed it, it’s just some dwarf.” He gave a bark of laughter.</p>\n<p>On stage, Bobono was bargaining with Marro’s sinister Stranger. He had a big voice for such a little man, and he made it ring off the highest rafters now. “Give me the cup,” he told the Stranger, “for I shall drink deep. And if it tastes of gold and lion’s blood, so much the better. As I cannot be the hero, let me be the monster, and lesson them in fear in place of love.”</p>\n<p>Mercy mouthed the last lines along with him. They were better lines than hers, and apt besides. He’ll want me or he won’t, she thought, so let the play begin. She said a silent prayer to the god of many faces, slipped out of her alcove, and flounced up to the guardsmen. Mercy, Mercy, Mercy. “My lords,” she said, “do you speak Braavosi? Oh, please, tell me you do.”</p>\n<p>The two guardsmen exchanged a look. “What’s this thing going on about?” the older one asked. “Who is she?”</p>\n<p>“One of the mummers,” said the pretty one. He pushed his fair hair back off his brow and smiled at her. “Sorry, sweetling, we don’t speak your gibble-gabble.”</p>\n<p>Fuss and feathers, Mercy thought, they only know the Common Tongue. That was no good. Give it up or go ahead. She could not give it up. She wanted him so bad. “I know your tongue, a little,” she lied, with Mercy’s sweetest smile. “You are lords of Westeros, my friend said.”</p>\n<p>The old one laughed. “Lords? Aye, that’s us.”</p>\n<p>Mercy looked down at her feet, so shy. “Izembaro said to please the lords,” she whispered. “If there is anything you want, anything at all… “</p>\n<p>The two guardsmen exchanged a look. Then the handsome one reached out and touched her breast. “Anything?“</p>\n<p>“You’re disgusting,” said the older man.</p>\n<p>“Why? If this Izembaro wants to be hospitable, it would be rude to refuse.” He gave her nipple a tweak through the fabric of her dress, just the way the dwarf had done when she was fixing his cock for him. “Mummers are the next best thing to whores.”</p>\n<p>“Might be, but this one is a child.”</p>\n<p>“I am not,” lied Mercy. “I’m a maiden now.”</p>\n<p>“Not for long,” said the comely one. “I’m Lord Rafford, sweetling, and I know just what I want. Hike up those skirts now, and lean back against that wall.”</p>\n<p>“Not here,” Mercy said, brushing his hands away. “Not where the play is on. I might cry out, and Izembaro would be mad.”</p>\n<p>“Where, then?”</p>\n<p>“I know a place.”</p>\n<p>The older guard was scowling. “What, you think can just scamper off? What if his knightliness comes looking for you?”</p>\n<p>“Why would he? He’s got a show to watch. And he’s got his own whore, why shouldn’t I have mine? This won’t take long.”</p>\n<p>No, she thought, it won’t. Mercy took him by the hand, led him through the back and down the steps and out into the foggy night. “You could be a mummer, if you wanted,” she told him, as he pressed her up against the wall of the playhouse.</p>\n<p>“Me?” The guardsman snorted. “Not me, girl. All that bloody talking, I wouldn’t remember half of it.”</p>\n<p>“It’s hard at first,” she admitted. “But after a time it comes easier. I could teach you to say a line. I could.”</p>\n<p>He grabbed her wrist. “I’ll do the teaching. Time for your first lesson.” He pulled her hard against him and kissed her on the lips, forcing his tongue into her mouth. It was all wet and slimy, like an eel. Mercy licked it with her own tongue, then broke away from him, breathless. “Not here. Someone might see. My room’s not far, but hurry. I have to be back before the second act, or I’ll miss my rape.”</p>\n<p>He grinned. “No fear o’ that, girl.” But he let her pull him after her. Hand in hand, they went racing through the fog, over bridges and through alleys and up five flights of splintery wooden stairs. The guardsman was panting by the time they burst through the door of her little room. Mercy lit a tallow candle, then danced around at him, giggling. “Oh, now you’re all tired out. I forgot how old you were, m’lord. Do you want to take a little nap? Just lie down and close your eyes, and I’ll come back after the Imp’s done raping me.”</p>\n<p>“You’re not going anywhere.” He pulled her roughly to him. “Get those rags off, and I’ll show you how old I am, girl.”</p>\n<p>“Mercy,” she said. “My name is Mercy. Can you say it?”</p>\n<p>“Mercy,” he said. “My name is Raff.”</p>\n<p>“I know.” She slipped her hand between his legs, and felt how hard he was through the wool of his breeches.</p>\n<p>“The laces,” he urged her. “Be a sweet girl and undo them.” Instead she slid her finger down along the inside of his thigh. He gave a grunt. “Damn, be careful there, you — “</p>\n<p>Mercy gave a gasp and stepped away, her face confused and frightened. “You’rebleeding.”</p>\n<p>“Wha — ” He looked down at himself. “Gods be good. What did you do to me, you little cunt?” The red stain spread across his thigh, soaking the heavy fabric.</p>\n<p>“Nothing,” Mercy squeaked. “I never… oh, oh, there’s so much blood. Stop it, stop it, you’re scaring me.”</p>\n<p>He shook his head, a dazed look on his face. When he pressed his hand to his thigh, blood squirted through his fingers. It was running down his leg, into his boot. He doesn’t look so comely now, she thought. He just looks white and frightened.</p>\n<p>“A towel,” the guardsman gasped. “Bring me a towel, a rag, press down on it. Gods. I feel dizzy.” His leg was drenched with blood from the thigh down. When he tried to put his weight on it, his knee buckled and he fell. “Help me,” he pleaded, as the crotch of his breeches reddened. “Mother have mercy, girl. A healer… run and find a healer, quick now.”</p>\n<p>“There’s one on the next canal, but he won’t come. You have to go to him. Can’t you walk?”</p>\n<p>“Walk?” His fingers were slick with blood. “Are you blind, girl? I’m bleeding like a stuck pig. I can’t walk on this.”</p>\n<p>“Well,” she said, “I don’t know how you’ll get there, then.”</p>\n<p>“You’ll need to carry me.”</p>\n<p>See? thought Mercy. You know your line, and so do I.</p>\n<p>“Think so?” asked Arya, sweetly.</p>\n<p>Raff the Sweetling looked up sharply as the long thin blade came sliding from her sleeve. She slipped it through his throat beneath the chin, twisted, and ripped it back out sideways with a single smooth slash. A fine red rain followed, and in his eyes the light went out.</p>\n<p>“Valar morghulis,” Arya whispered, but Raff was dead and did not hear. She sniffed. I should have helped him down the steps before I killed him. Now I’ll need to drag him all the way to the canal and roll him in. The eels would do the rest.</p>\n<p>“Mercy, Mercy, Mercy,” she sang sadly. A foolish, giddy girl she’d been, but good hearted. She would miss her, and she would miss Daena and the Snapper and the rest, even Izembaro and Bobono. This would make trouble for the Sealord and the envoy with the chicken on his chest, she did not doubt.</p>\n<p>She would think about that later, though. Just now, there was no time. I had best run. Mercy still had some lines to say, her first lines and her last, and Izembaro would have her pretty little empty head if she were late for her own rape.</p>\n","excerpt":"<h2 id=\"MERCYE-EXCERPT-FROM-THE-WINDS-OF-WINTER\"><a href=\"#MERCYE-EXCERPT-FROM-THE-WINDS-OF-WINTER\" class=\"headerlink\" title=\"MERCYE--EXCERPT FROM THE WINDS OF WINTER\"></a>MERCYE--EXCERPT FROM THE WINDS OF WINTER</h2><p>She woke with a gasp, not knowing who she was, or where.</p>\n<p>The smell of blood was heavy in her nostrils… or was that her nightmare, lingering? She had dreamed of wolves again, of running through some dark pine forest with a great pack at her hells, hard on the scent of prey.</p>\n<p>Half-light filled the room, grey and gloomy. Shivering, she sat up in bed and ran a hand across her scalp. Stubble bristled against her palm. I need to shave before Izembaro sees. Mercy, I’m Mercy, and tonight I’ll be raped and murdered. Her true name was Mercedene, but Mercy was all anyone ever called her…<br>","more":"<br>Except in dreams. She took a breath to quiet the howling in her heart, trying to remember more of what she’d dreamt, but most of it had gone already. There had been blood in it, though, and a full moon overhead, and a tree that watched her as she ran.</p>\n<p>She had fastened the shutters back so the morning sun might wake her. But there was no sun outside the window of Mercy’s little room, only a wall of shifting grey fog. The air had grown chilly… and a good thing, else she might have slept all day. It would be just like Mercy to sleep through her own rape.</p>\n<p>Gooseprickles covered her legs. Her coverlet had twisted around her like a snake. She unwound it, threw the blanket to the bare plank floor and padded naked to the window. Braavos was lost in fog. She could see the green water of the little canal below, the cobbled stone street that ran beneath her building, two arches of the mossy bridge… but the far end of the bridge vanished in greyness, and of the buildings across the canal only a few vague lights remained. She heard a soft splash as a serpent boat emerged beneath the bridge’s central arch. “What hour?” Mercy called down to the man who stood by the snake’s uplifted tail, pushing her onward with his pole.</p>\n<p>The waterman gazed up, searching for the voice. “Four, by the Titan’s roar.” His words echoed hollowly off the swirling green waters and the walls of unseen buildings.</p>\n<p>She was not late, not yet, but she should not dawdle. Mercy was a happy soul and a hard worker, but seldom timely. That would not serve tonight. The envoy from Westeros was expected at the Gate this evening, and Izembaro would be in no mood to hear excuses, even if she served them up with a sweet smile.</p>\n<p>She had filled her basin from the canal last night before she went to sleep, preferring the brackish water to the slimy green rainwater stewing in the cistern out back. Dipping a rough cloth, she washed herself head to heel, standing on one leg at a time to scrub her calloused feet. After that she found her razor. A bare scalp helped the wigs fit better, Izembaro claimed.</p>\n<p>She shaved, donned her smallclothes, and slipped a shapeless brown wool dress down over her head. One of her stockings needed mending, she saw as she pulled it up. She would ask the Snapper for help; her own sewing was so wretched that the wardrobe mistress usually took pity on her. Else I could filtch a nicer pair from wardrobe. That was risky, though. Izembaro hated it when the mummers wore his costumes in the streets.Except for Wendeyne. Give Izembaro’s cock a little suck and a girl can wear any costume that she wants. Mercy was not so foolish as all that. Daena had warned her. “Girls who start down that road wind up on the Ship, where every man in the pit knows he can have any pretty thing he might see up on the stage, if his purse is plump enough.”</p>\n<p>Her boots were lumps of old brown leather mottled with saltstains and cracked from long wear, her belt a length of hempen rope dyed blue. She knotted it about her waist, and hung a knife on her right hip and a coin pouch on her left. Last of all she threw her cloak across her shoulders. It was a real mummer’s cloak, purple wool lined in red silk, with a hood to keep the rain off, and three secret pockets too. She’d hid some coins in one of those, an iron key in another, a blade in the last. A real blade, not a fruit knife like the one on her hip, but it did not belong to Mercy, no more than her other treasures did. The fruit knife belonged to Mercy. She was made for eating fruit, for smiling and joking, for working hard and doing as she was told.</p>\n<p>“Mercy, Mercy, Mercy,” she sang as she descended the wooden stair to the street. The handrail was splintery, the steps steep, and there were five flights, but that was why she’d gotten the room so cheap. That, and Mercy’s smile. She might be bald and skinny, but Mercy had a pretty smile, and a certain grace. Even Izembaro agreed that she was graceful. She was not far from the Gate as the crows flies, but for girls with feet instead of wings the way was longer. Braavos was a crooked city. The streets were crooked, the alleys were crookeder, and the canals were crookedest of all. Most days she preferred to go the long way, down the Ragman’s Road along the Outer Harbor, where she had the sea before her and the sky above, and a clear view across the Great Lagoon to the Arsenal and the piney slopes of Sellagoro’s Shield. Sailors would hail her as she passed the docks, calling down from the decks of tarry Ibbenese whalers and big-bellied Westerosi cogs. Mercy could not always understand their words, but she knew what they were saying. Sometimes she would smile back and tell them they could find her at the Gate if they had the coin.</p>\n<p>The long way also took her across the Bridge of Eyes with its carved stone faces. From the top of its span, she could look through the arches and see all the city: the green copper domes of the Hall of Truth, the masts rising like a forest from the Purple Harbor, the tall towers of the mighty, the golden thunderbolt turning on its spire atop the Sealord’s Palace… even the Titan’s bronze shoulders, off across the dark green waters. But that was only when the sun was shining down on Braavos. If the fog was thick there was nothing to see but grey, so today Mercy chose the shorter route to save some wear on her poor cracked boots.</p>\n<p>The mists seemed to part before her and close up again as she passed. The cobblestones were wet and slick under her feet. She heard a cat yowl plaintively. Braavos was a good city for cats, and they roamed everywhere, especially at night. In the fog all cats are grey, Mercy thought. In the fog all men are killers.</p>\n<p>She had never seen a thicker fog than this one. On the larger canals, the watermen would be running their serpent boats into one another, unable to make out any more than dim lights from the buildings to either side of them.</p>\n<p>Mercy passed an old man with a lantern walking the other way, and envied him his light. The street was so gloomy she could scarcely see where she was stepping. In the humbler parts of the city, the houses, shops, and warehouses crowded together, leaning on each other like drunken lovers, their upper stories so close that you could step from one balcony to the next. The streets below became dark tunnels where every footfall echoed. The small canals were even more hazardous, since many of the houses that lined them had privies jutting out over the water. Izembaro loved to give the Sealord’s speech fromThe Merchant’s Melancholy Daughter, about how “here the last Titan yet stands, astride the stony shoulders of his brothers,” but Mercy preferred the scene where the fat merchant shat on the Sealord’s head as he passed underneath in his gold-and-purple barge. Only in Braavos could something like that happen, it was said, and only in Braavos would Sealord and sailor alike howl with laughter to see it.</p>\n<p>The Gate stood close by the edge of Drowned Town, between the Outer Harbor and the Purple Harbor. An old warehouse had burnt there and the ground was sinking a little more each year, so the land came cheap. Atop the flooded stone foundation of the warehouse, Izembaro raised his cavernous playhall. The Dome and the Blue Lantern might enjoy more fashionable environs, he told his mummers, but here between the harbors they would never lack for sailors and whores to fill their pit. The Ship was close by, still pulling handsome crowds to the quay where she had been moored for twenty years, he said, and the Gate would flourish too.</p>\n<p>Time had proved him right. The Gate’s stage had developed a tilt as the building settled, their costumes were prone to mildew, and water snakes nested in the flooded cellar, but none of that troubled the mummers so long as the house was full.</p>\n<p>The last bridge was made of rope and raw planks, and seemed to dissolve into nothingness, but that was only the fog. Mercy scampered across, her heels ringing on the wood. The fog opened before her like a tattered grey curtain to reveal the playhouse. Buttery yellow light spilled from the doors, and Mercy could hear voices from within. Beside the entrance, Big Brusco had painted over the title of the last show, and writtenThe Bloody Hand in its place in huge red letters. He was painting a bloody hand beneath the words, for those who could not read. Mercy stopped to have a look. “That’s a nice hand,” she told him.</p>\n<p>“Thumb’s crooked.” Brusco dabbed at it with his brush. “King o’ the Mummers been asking after you.”</p>\n<p>“It was so dark I slept and slept.” When Izembaro had first dubbed himself the King of the Mummers, the company had taken a wicked pleasure in it, savoring the outrage of their rivals from the Dome and the Blue Lantern. Of late, though, Izembaro had begun to take his title too seriously. “He will only play kings now,” Marro said, rolling his eyes, “and if the play has no king in it, he would sooner not stage it at all.”</p>\n<p>The Bloody Hand offered two kings, the fat one and the boy. Izembaro would play the fat one. It was not a large part, but he had a fine speech as he lay dying, and a splendid fight with a demonic boar before that. Phario Forel had written it, and he had the bloodiest quill of all of Braavos.</p>\n<p>Mercy found the company assembled behind the stage, and slipped in between Daena and the Snapper at the back, hoping her late arrival would go unnoticed. Izembaro was telling everyone that he expected the Gate to be packed to the rafters this evening, despite the fog. “The King of Westeros is sending his envoy to do homage to the King of the Mummers tonight,” he told his troupe. “We will not disappoint our fellow monarch.”</p>\n<p>“We?” said the Snapper, who did all the costumes for the mummers. “Is there more than one of him, now?”</p>\n<p>“He’s fat enough to count for two,” whispered Bobono. Every mummer’s troupe had to have a dwarf. He was theirs. When he saw Mercy, he gave her a leer. “Oho,” he said, “there she is. Is the little girl all ready for her rape?” He smacked his lips.</p>\n<p>The Snapper smacked him in the head. “Be quiet.”</p>\n<p>The King of the Mummers ignored the brief commotion. He was still talking, telling the mummers how magnificent they must be. Besides the Westerosi envoy, there would be keyholders in the crowd this evening, and famous courtesans as well. He did not intend for them to leave with a poor opinion of the Gate. “It shall go ill for any man who fails me,” he promised, a threat he borrowed from the speech Prince Garin gives on the eve of battle in Wroth of the Dragonlords, Phario Forel’s first play.</p>\n<p>By the time Izembaro finally finished speaking, less than an hour remained before the show, and the mummers were all frantic and fretful by turns. The Gate rang to the sound of Mercy’s name.</p>\n<p>“Mercy,” her friend Daena implored, “Lady Stork has stepped on the hem of her gown again. Come help me sew it up.”</p>\n<p>“Mercy,” the Stranger called, “bring the bloody paste, my horn is coming loose.”</p>\n<p>“Mercy,” boomed Izembaro the Great himself, “what have you done with my crown, girl? I cannot make my entrance without my crown. How shall they know that I’m a king?”</p>\n<p>“Mercy,” squeaked the dwarf Bobono, “Mercy, something’s amiss with my laces, my cock keeps flopping out.”</p>\n<p>She fetched the sticky paste and fastened the Stranger’s left horn back onto his forehead. She found Izembaro’s crown in the privy where he always left it and helped him pin it to his wig, and then ran for needle and thread so the Snapper could sew the lace hem back onto the cloth-of-gold gown that the queen would wear in the wedding scene.</p>\n<p>And Bobono’s cock was indeed flopping out. It was made to flop out, for the rape. What a hideous thing, Mercy thought as she knelt before the dwarf to fix him. The cock was a foot long and as thick as her arm, big enough to be seen from the highest balcony. The dyer had done a poor job with the leather, though; the thing was a mottled pink and white, with a bulbous head the color of a plum. Mercy pushed it back into Bobono’s breeches and laced him back up. “Mercy,” he sang as she tied him tight, “Mercy, Mercy, come to my room tonight and make a man of me.”</p>\n<p>“I’ll make a eunuch of you if you keep unlacing yourself just so I’ll fiddle with your crotch.”</p>\n<p>“We were meant to be together, Mercy,” Bobono insisted. “Look, we’re just the same height.”</p>\n<p>“Only when I’m on my knees. Do you remember your first line?” It had only been a fortnight since the dwarf had lurched onto stage in his cups and opened The Anguish of the Archon with the grumpkin’s speech from The Merchant’s Lusty Lady. Izembaro would skin him alive if he made such a blunder again, and never mind how hard it was to find a good dwarf.</p>\n<p>“What are we playing, Mercy?” Bobono asked innocently.</p>\n<p>He is teasing me, Mercy thought. He’s not drunk tonight, he knows the show perfectly well. “We are doing Phario’s new Bloody Hand, in honor of the envoy from the Seven Kingdoms.”</p>\n<p>“Now I recall.” Bobono lowered his voice to a sinister croak. “The seven-faced god has cheated me,” he said. “My noble sire he made of purest gold, and gold he made my siblings, boy and girl. But I am formed of darker stuff, of bones and blood and clay, twisted into this rude shape you see before you.” With that, he grabbed at her chest, fumbling for a nipple. “You have no titties. How can I rape a girl with no titties?”</p>\n<p>She caught his nose between her thumb and forefinger and twisted. “You’ll have no nose until you get your hands off me.”</p>\n<p>“Owwwww,” the dwarf squealed, releasing her.</p>\n<p>“I’ll grow titties in a year or two.” Mercy rose, to tower over the little man. “But you’ll never grow another nose. You think of that, before you touch me there.”</p>\n<p>Bobono rubbed his tender nose. “There’s no need to get so shy. I’ll be raping you soon enough.”</p>\n<p>“Not until the second act.”</p>\n<p>“I always give Wendeyne’s titties a nice squeeze when I rape her in The Anguish of the Archon,” the dwarf complained. “She likes it, and the pit does too. You have to please the pit.”</p>\n<p>That was one of Izembaro’s “wisdoms,” as he liked to call them. You have to please the pit. “I bet it would please the pit if I ripped off the dwarf’s cock and beat him about the head with it,” Mercy replied. “That’s something they won’t have seen before.” Always give them something they haven’t seen before was another of Izembaro’s “wisdoms,” and one that Bobono had no easy answer for. “There, you’re done,” Mercy announced. “Now see if you can keep in your breeches till it’s needed.”</p>\n<p>Izembaro was calling for her again. Now he could not find his boar spear. Mercy found it for him, helped Big Brusco don his boar suit, checked the trick daggers just to make certain no one had replaced one with a real blade (someone had done that at the Dome once, and a mummer had died), and poured Lady Stork the little nip of wine she liked to have before each play. When all the cries of “Mercy, Mercy, Mercy” finally died away, she stole a moment for a quick peek out into the house.</p>\n<p>The pit was as full as ever she’d seen it, and they were enjoying themselves already, joking and jostling, eating and drinking. She saw a peddler selling chunks of cheese, ripping them off the wheel with his fingers whenever he found a buyer. A woman had a bag of wrinkled apples. Skins of wine were being passed from hand to hand, some girls were selling kisses, and one sailor was playing the sea pipes. The sad-eyed little man called Quill stood in the back, come to see what he could steal for one of his own plays. Cossomo the Conjurer had come as well, and on his arm was Yna, the one-eyed whore from the Happy Port, but Mercy could not know those two, and they would not know Mercy. Daena recognized some Gate regulars in the crowd, and pointed them out for her; the dyer Dellono with his pinched white face and mottled purple hands, Galeo the sausage-maker in his greasy leather apron, tall Tomarro with his pet rat on his shoulder. “Tomarro best not let Galeo see that rat,” Daena warned. “That’s the only meat he puts in them sausages, I hear.” Mercy covered her mouth and laughed.</p>\n<p>The balconies were filling too. The first and third levels were for merchants and captains and other respectable folk. The bravos preferred the fourth and highest, where the seats were cheapest. It was a riot of bright color up there, while down below more somber shades held sway. The second balcony was cut up into private boxes where the mighty could comport themselves in comfort and privacy, safely apart from the vulgarity above and below. They had the best view of the stage, and servants to bring them food, wine, cushions, whatever they might desire. It was rare to find the second balcony more than half full at the Gate; such of the mighty who relished a night of mummery were more inclined to visit the Dome or the Blue Lantern, where the offerings were considered subtler and more poetic.</p>\n<p>This night was different, though, no doubt on account of the Westerosi envoy. In one box sat three scions of Otharys, each accompanied by a famous courtesan; Prestayn sat alone, a man so ancient that you wondered how he ever reached his seat; Torone and Pranelis shared a box, as they shared an uncomfortable alliance; the Third Sword was hosting a half-dozen friends.</p>\n<p>“I count five keyholders,” said Daena.</p>\n<p>“Bessaro is so fat you ought to count him twice,” Mercy replied, giggling. Izembaro had a belly on him, but compared to Bessaro he was as lithe as a willow. The keyholder was so big he needed a special seat, thrice the size of a common chair.</p>\n<p>“They’re all fat, them Reyaans,” Daena said. “Bellies as big as their ships. You should have seen the father. He made this one look small. One time he was summoned to the Hall of Truth to vote, but when he stepped onto his barge it sank.” She clutched Mercy by the elbow. “Look, the Sealord’s box.” The Sealord had never visited the Gate, but Izembaro named a box for him anyway, the largest and most opulent in the house. “That must be the Westerosi envoy. Have you ever seen such clothes on an old man? And look, he’s brought the Black Pearl!”</p>\n<p>The envoy was slight and balding, with a funny grey wisp of a beard growing from his chin. His cloak was yellow velvet, and his breeches. His doublet was a blue so bright it almost made Mercy’s eyes water. Upon his breast a shield had been embroidered in yellow thread, and on the shield was a proud blue rooster picked out in lapis lazuli. One of his guards helped him to his seat, while two others stood behind him in the back of the box.</p>\n<p>The woman with him could not have been more than a third his age. She was so lovely that the lamps seemed to burn brighter when she passed. She had dressed in a low-cut gown of pale yellow silk, startling against the light brown of her skin. Her black hair was bound up in a net of spun gold, and a jet-and-gold necklace brushed against the top of her full breasts. As they watched, she leaned close to the envoy and whispered something in his ear that made him laugh. “They should call her the Brown Pearl,” Mercy said to Daena. “She’s more brown than black.”</p>\n<p>“The first Black Pearl was black as a pot of ink,” said Daena. “She was a pirate queen, fathered by a Sealord’s son on a princess from the Summer Isles. A dragon king from Westeros took her for his lover.”</p>\n<p>“I would like to see a dragon,” Mercy said wistfully. “Why does the envoy have a chicken on his chest?”</p>\n<p>Daena howled. “Mercy, don’t you know anything? It’s his siggle. In the Sunset Kingdoms all the lords have siggles. Some have flowers, some have fish, some have bears and elks and other things. See, the envoy’s guards are wearing lions.”</p>\n<p>It was true. There were four guards; big, hard-looking men in ringmail, with heavy Westerosi longswords sheathed at their hips. Their crimson cloaks were bordered in whorls of gold, and golden lions with red garnet eyes clasped each cloak at the shoulder. When Mercy glanced at the faces beneath the gilded, lion-crested helm, her belly gave a quiver.The gods have given me a gift. Her fingers clutched hard at Daena’s arm. “That guard. The one on the end, behind the Black Pearl.”</p>\n<p>“What of him? Do you know him?”</p>\n<p>“No.” Mercy had been born and bred in Braavos, how could she know some Westerosi? She had to think a moment. “It’s only… well, he’s fair to look on, don’t you think?” He was, in a rough-hewn way, though his eyes were hard.</p>\n<p>Daena shrugged. “He’s very old. Not so old as the other ones, but… he could be thirty. And Westerosi. They’re terrible savages, Mercy. Best stay well away from his sort.”</p>\n<p>“Stay away?” Mercy giggled. She was a giggly sort of girl, was Mercy. “No. I’ve got to get closer.” She gave Daena a squeeze and said, “If the Snapper comes looking for me, tell her that I went off to read my lines again.” She only had a few, and most were just, “Oh, no, no, no,” and “Don’t, oh don’t, don’t touch me,” and “Please, m’lord, I am still a maiden,” but this was the first time Izembaro had given her any lines at all, so it was only to be expected that poor Mercy would want to get them right.</p>\n<p>The envoy from the Seven Kingdoms had taken two of his guards into his box to stand behind him and the Black Pearl, but the other two had been posted just outside the door to make certain he was not disturbed. They were talking quietly in the Common Tongue of Westeros as she slipped up silently behind them in the darkened passage. That was not a language Mercy knew.</p>\n<p>“Seven hells, this place is damp,” she heard her guard complain. “I’m chilled to the bones. Where are the bloody orange trees? I always heard there were orange trees in the Free Cities. Lemons and limes. Pomegranates. Hot peppers, warm nights, girls with bare bellies. Where are the bare-bellied girls, I ask you?”</p>\n<p>“Down in Lys, and Myr, and Old Volantis,” the other guard replied. He was an older man, big-bellied and grizzled. “I went to Lys with Lord Tywin once, when he was Hand to Aerys. Braavos is north of King’s Landing, fool. Can’t you read a bloody map?”</p>\n<p>“How long do you think we’ll be here?”</p>\n<p>“Longer than you’d like,” the old man replied. “If he goes back without the gold the queen will have his head. Besides, I seen that wife of his. There’s steps in Casterly Rock she can’t go down for fear she’d get stuck, that’s how fat she is. Who’d go back to that, when he has his sooty queen?”</p>\n<p>The handsome guardsman grinned. “Don’t suppose he’ll share her with us, afterward?”</p>\n<p>“What, are you mad? You think he notices the likes of us? Bloody bugger don’t even get our names right half the time. Maybe it was different with Clegane.”</p>\n<p>“Ser wasn’t one for mummer shows and fancy whores. When Ser wanted a woman he took one, but sometimes he’d let us have her, after. I wouldn’t mind having a taste of that Black Pearl. You think she’s pink between her legs?”</p>\n<p>Mercy wanted to hear more, but there was no time. The Bloody Hand was about to start, and the Snapper would be looking for her to help with costumes. Izembaro might be the King of the Mummers, but the Snapper was the one that they all feared. Time enough for her pretty guardsman later.</p>\n<p>The Bloody Hand opened in a lichyard.</p>\n<p>When the dwarf appeared suddenly from behind a wooden tombstone, the crowd began to hiss and curse. Bobono waddled to the front of the stage and leered at them. “The seven-faced god has cheated me,” he began, snarling the words. “My noble sire he made of purest gold, and gold he made my siblings, boy and girl. But I am formed of darker stuff, of bones and blood and clay… “</p>\n<p>By then Marro had appeared behind him, gaunt and terrible in the Stranger’s long black robes. His face was black as well, his teeth red and shiny with blood, while ivory horns jutted upwards from his brow. Bobono could not see him, but the balconies could, and now the pit as well. The Gate grew deathly quiet. Marro moved forward silently.</p>\n<p>So did Mercy. The costumes were all hung, and the Snapper was busy sewing Daena into her gown for the court scene, so Mercy’s absence should not be noted. Quiet as a shadow, she slipped around the back again, up to where the guardsmen stood outside the envoy’s box. Standing in a darkened alcove, still as stone, she had a good look at his face. She studied it carefully, to be sure. Am I too young for him? she wondered. Too plain? Too skinny? She hoped he wasn’t the sort of man who liked big breasts on a girl. Bobono had been right about her chest. It would be best if I could take him back to my place, have him all to myself. But will he come with me?</p>\n<p>“You think it might be him?” the pretty one was saying.</p>\n<p>“What, did the Others take your wits?”</p>\n<p>“Why not? He’s a dwarf, ain’t he?”</p>\n<p>“The Imp weren’t the only dwarf in the world.”</p>\n<p>“Maybe not, but look here, everyone says how clever he was, true? So maybe he figures the last place his sister would ever look for him would be in some mummer show, making fun of himself. So he does just that, to tweak her nose.”</p>\n<p>“Ah, you’re mad.”</p>\n<p>“Well, maybe I’ll follow him after the mummery. Find out for myself.” The guardsman put a hand on the hilt of his sword. “If I’m right, I’ll be a ma lord, and if I’m wrong, well, bleed it, it’s just some dwarf.” He gave a bark of laughter.</p>\n<p>On stage, Bobono was bargaining with Marro’s sinister Stranger. He had a big voice for such a little man, and he made it ring off the highest rafters now. “Give me the cup,” he told the Stranger, “for I shall drink deep. And if it tastes of gold and lion’s blood, so much the better. As I cannot be the hero, let me be the monster, and lesson them in fear in place of love.”</p>\n<p>Mercy mouthed the last lines along with him. They were better lines than hers, and apt besides. He’ll want me or he won’t, she thought, so let the play begin. She said a silent prayer to the god of many faces, slipped out of her alcove, and flounced up to the guardsmen. Mercy, Mercy, Mercy. “My lords,” she said, “do you speak Braavosi? Oh, please, tell me you do.”</p>\n<p>The two guardsmen exchanged a look. “What’s this thing going on about?” the older one asked. “Who is she?”</p>\n<p>“One of the mummers,” said the pretty one. He pushed his fair hair back off his brow and smiled at her. “Sorry, sweetling, we don’t speak your gibble-gabble.”</p>\n<p>Fuss and feathers, Mercy thought, they only know the Common Tongue. That was no good. Give it up or go ahead. She could not give it up. She wanted him so bad. “I know your tongue, a little,” she lied, with Mercy’s sweetest smile. “You are lords of Westeros, my friend said.”</p>\n<p>The old one laughed. “Lords? Aye, that’s us.”</p>\n<p>Mercy looked down at her feet, so shy. “Izembaro said to please the lords,” she whispered. “If there is anything you want, anything at all… “</p>\n<p>The two guardsmen exchanged a look. Then the handsome one reached out and touched her breast. “Anything?“</p>\n<p>“You’re disgusting,” said the older man.</p>\n<p>“Why? If this Izembaro wants to be hospitable, it would be rude to refuse.” He gave her nipple a tweak through the fabric of her dress, just the way the dwarf had done when she was fixing his cock for him. “Mummers are the next best thing to whores.”</p>\n<p>“Might be, but this one is a child.”</p>\n<p>“I am not,” lied Mercy. “I’m a maiden now.”</p>\n<p>“Not for long,” said the comely one. “I’m Lord Rafford, sweetling, and I know just what I want. Hike up those skirts now, and lean back against that wall.”</p>\n<p>“Not here,” Mercy said, brushing his hands away. “Not where the play is on. I might cry out, and Izembaro would be mad.”</p>\n<p>“Where, then?”</p>\n<p>“I know a place.”</p>\n<p>The older guard was scowling. “What, you think can just scamper off? What if his knightliness comes looking for you?”</p>\n<p>“Why would he? He’s got a show to watch. And he’s got his own whore, why shouldn’t I have mine? This won’t take long.”</p>\n<p>No, she thought, it won’t. Mercy took him by the hand, led him through the back and down the steps and out into the foggy night. “You could be a mummer, if you wanted,” she told him, as he pressed her up against the wall of the playhouse.</p>\n<p>“Me?” The guardsman snorted. “Not me, girl. All that bloody talking, I wouldn’t remember half of it.”</p>\n<p>“It’s hard at first,” she admitted. “But after a time it comes easier. I could teach you to say a line. I could.”</p>\n<p>He grabbed her wrist. “I’ll do the teaching. Time for your first lesson.” He pulled her hard against him and kissed her on the lips, forcing his tongue into her mouth. It was all wet and slimy, like an eel. Mercy licked it with her own tongue, then broke away from him, breathless. “Not here. Someone might see. My room’s not far, but hurry. I have to be back before the second act, or I’ll miss my rape.”</p>\n<p>He grinned. “No fear o’ that, girl.” But he let her pull him after her. Hand in hand, they went racing through the fog, over bridges and through alleys and up five flights of splintery wooden stairs. The guardsman was panting by the time they burst through the door of her little room. Mercy lit a tallow candle, then danced around at him, giggling. “Oh, now you’re all tired out. I forgot how old you were, m’lord. Do you want to take a little nap? Just lie down and close your eyes, and I’ll come back after the Imp’s done raping me.”</p>\n<p>“You’re not going anywhere.” He pulled her roughly to him. “Get those rags off, and I’ll show you how old I am, girl.”</p>\n<p>“Mercy,” she said. “My name is Mercy. Can you say it?”</p>\n<p>“Mercy,” he said. “My name is Raff.”</p>\n<p>“I know.” She slipped her hand between his legs, and felt how hard he was through the wool of his breeches.</p>\n<p>“The laces,” he urged her. “Be a sweet girl and undo them.” Instead she slid her finger down along the inside of his thigh. He gave a grunt. “Damn, be careful there, you — “</p>\n<p>Mercy gave a gasp and stepped away, her face confused and frightened. “You’rebleeding.”</p>\n<p>“Wha — ” He looked down at himself. “Gods be good. What did you do to me, you little cunt?” The red stain spread across his thigh, soaking the heavy fabric.</p>\n<p>“Nothing,” Mercy squeaked. “I never… oh, oh, there’s so much blood. Stop it, stop it, you’re scaring me.”</p>\n<p>He shook his head, a dazed look on his face. When he pressed his hand to his thigh, blood squirted through his fingers. It was running down his leg, into his boot. He doesn’t look so comely now, she thought. He just looks white and frightened.</p>\n<p>“A towel,” the guardsman gasped. “Bring me a towel, a rag, press down on it. Gods. I feel dizzy.” His leg was drenched with blood from the thigh down. When he tried to put his weight on it, his knee buckled and he fell. “Help me,” he pleaded, as the crotch of his breeches reddened. “Mother have mercy, girl. A healer… run and find a healer, quick now.”</p>\n<p>“There’s one on the next canal, but he won’t come. You have to go to him. Can’t you walk?”</p>\n<p>“Walk?” His fingers were slick with blood. “Are you blind, girl? I’m bleeding like a stuck pig. I can’t walk on this.”</p>\n<p>“Well,” she said, “I don’t know how you’ll get there, then.”</p>\n<p>“You’ll need to carry me.”</p>\n<p>See? thought Mercy. You know your line, and so do I.</p>\n<p>“Think so?” asked Arya, sweetly.</p>\n<p>Raff the Sweetling looked up sharply as the long thin blade came sliding from her sleeve. She slipped it through his throat beneath the chin, twisted, and ripped it back out sideways with a single smooth slash. A fine red rain followed, and in his eyes the light went out.</p>\n<p>“Valar morghulis,” Arya whispered, but Raff was dead and did not hear. She sniffed. I should have helped him down the steps before I killed him. Now I’ll need to drag him all the way to the canal and roll him in. The eels would do the rest.</p>\n<p>“Mercy, Mercy, Mercy,” she sang sadly. A foolish, giddy girl she’d been, but good hearted. She would miss her, and she would miss Daena and the Snapper and the rest, even Izembaro and Bobono. This would make trouble for the Sealord and the envoy with the chicken on his chest, she did not doubt.</p>\n<p>She would think about that later, though. Just now, there was no time. I had best run. Mercy still had some lines to say, her first lines and her last, and Izembaro would have her pretty little empty head if she were late for her own rape.</p>"},{"title":"思考篇：2","date":"2016-12-26T16:00:00.000Z","comments":0,"_content":"\n从哪儿开始写好呢？算起来这是一篇拖了很久的文章，一直打算要写的，可是直到现在才开始，毕竟一篇文章不是一篇谈话节目，要有清晰的结构，不然的话变成流水账就显得没有意义了，而我从来没有想好这篇文章究竟该从哪儿开始。2016年就要结束了，那就当这是一篇年终总结吧！\n\n<!--more-->\n迄今，大学毕业已达年半有余，然吾等默默无闻之辈依然悲悲戚戚。在这一年半的时间里发生了很多事情，有很多始料未及，也有很多有意为之的事情。由刚开始更多面临的如何活下去，到今日开始思考如何生存的更好的问题上面，渐渐地作出了选择。我无法回答这种选择是否正确，我大概只能问，为了自己的选择究竟努力了多少。\n\n想想走过的这一年半，从大学宿舍，到公司宿舍，到舍友租的房子里面的临时借宿，再到用光积蓄颤抖着双手去找人生第一次要租的房子，再到现在费劲心机终于安稳住了一段时间。回头发现，我终于还是自己走出了第一步，哪怕这第一步走的那么艰难，我还是迈步走出来了。2014年底用了两个月的实习工资买了Pad Air2，到今天信用卡分期买了新出的MacBook pro。我不晓得我是否应该自豪，因为现在的我已无任何积蓄，即使我终于拥有了传说中的生产力工具了。在决定要买新的电脑的时候，我就问过自己，我究竟想要什么？我已经不愿意去折腾无聊的电脑笔记本了，我需要的也不是一款强劲的游戏本，买下MacBook的那一刻我就告诉我自己，这是一个新的起点，我要的是一件足够好用的简易工具，之前折腾ubuntu，折腾windows，到最后发现，一个趁手的工具对效率的提升是显而易见的。\n\n一个月前，我买了新的域名``www.serbad.net``和``www.serbad.info``,上周才找时间修复了挂在`GitHub page`上的网站的Bug。``Ser Bad``我想我可以解释下是什么意思，``Ser``是一个不存在的词，是J·R·R·马丁大爷创造的，意思是``爵士``的意思，大概是因为我很迷恋那种爵士的绅士风度吧，虽然马丁大爷的作品里面和风度一毛钱关系都没有。既然买了新的域名，我就要想办法把这个域名维护下去，不然的话乱花钱就真的是``Bad``了。\n\n国庆前夕，早上高高兴兴地去上班，晚上回来就失业在家了。所谓的``资本寒冬``大抵就是这个样子的，没想到，该来的还是回来，同一个公司的iOS同事到现在都还没有找到工作。我自己找工作也有点儿急，只要面试过后两天之内没有通知我就基本忽略了，没想到在答应了现在这家公司的第二天之前面试的公司就通知我去上班了，只能遗憾地放弃。想想，自己为什么会答应现在这家公司呢，大概的原因是老板很热情，真心没想到，最近发现是我对工作太没有热情了（手动加一个😓的表情），这就让我开始思考自己以后的人生究竟该怎么走的问题了。\n\n说到底，程序员算什么呢？现在的技术经理是一个``不懂得开发的人``，在他眼里，技术是解决问题的，不管你用什么东西，只有解决了问题才是好的技术，这并没有错，我们现在用到的技术也并不是什么改变世界的技术，并不足以让我们用技术来换钱，这就是很现实的问题，任何公司都是以盈利为导向的，不然话，公司也就无法生存下去。讲道理，在我第一次提到需要时间去完善代码的时候，他说的一句话深深地打击了我```“代码够用就好了，你管人家写的好还是不好，哪怕你写的再好又能怎样，又有谁会看到？”```。是啊，这就是技术人员的悲哀，除了少部分创造出”有价值的”的人，大部分人终其一生都是默默无闻的小员工，没有话语权，没有成就，属于可替代品。我呢？除了完善自己的技术能力以外，我还有什么呢？我的工作是属于可替代的，兴许别人比我做的还要好，我对自己如何定位呢？思考了好久，发现自己无法得到合理的答案，我只能送自己一句话：“完成现阶段作为程序员的主要职责，然后保持适度的技术好奇心，再去拓展其他方面的技能。”，再加一句：“Read the fucking source code.”。\n\n既然写到这里了，顺便提下自己的感情状况吧。今年七月中旬的时候，和前尘去湖南旅游了一周，很久以前答应过她去湖南旅游的，而且我的确有些事放不下，所以毫不犹豫地就答应去了。因为是跟着旅行团走的，一路上就是各种赶路，在全程没有准备的情况下，我始终处于懵的状态。回来之后，我发现我终于放下了，时间啊就是这么残忍，当你迷茫裹足不前的时候，走到那个终点去看看就知道自己究竟想要的是什么了。哪怕我总是不遗余力地向前尘解释我那漏洞百出的人生观，在她眼里我依旧只是一个情商不高的傻子，三观不合何必强求，我不是情商不高，只是太自负了，这几年的打击才开始真正让我开始学会谦让。直到这一天，我觉得我终于遇到了那个对的人，可是遗憾地发现，我不知道该如何去跨过这一步。\n\n又走过了一年，未来的计划应该是这样子：积累自己的素材库多把新的内容分享出来。好了，就这样了，期待有一个美好的2017年。\n","source":"_posts/Thinking2.md","raw":"---\ntitle: 思考篇：2\ndate: 2016-12-27 00:00:00\ntags: 随笔\ncategories: 随笔\ncomments: false\n---\n\n从哪儿开始写好呢？算起来这是一篇拖了很久的文章，一直打算要写的，可是直到现在才开始，毕竟一篇文章不是一篇谈话节目，要有清晰的结构，不然的话变成流水账就显得没有意义了，而我从来没有想好这篇文章究竟该从哪儿开始。2016年就要结束了，那就当这是一篇年终总结吧！\n\n<!--more-->\n迄今，大学毕业已达年半有余，然吾等默默无闻之辈依然悲悲戚戚。在这一年半的时间里发生了很多事情，有很多始料未及，也有很多有意为之的事情。由刚开始更多面临的如何活下去，到今日开始思考如何生存的更好的问题上面，渐渐地作出了选择。我无法回答这种选择是否正确，我大概只能问，为了自己的选择究竟努力了多少。\n\n想想走过的这一年半，从大学宿舍，到公司宿舍，到舍友租的房子里面的临时借宿，再到用光积蓄颤抖着双手去找人生第一次要租的房子，再到现在费劲心机终于安稳住了一段时间。回头发现，我终于还是自己走出了第一步，哪怕这第一步走的那么艰难，我还是迈步走出来了。2014年底用了两个月的实习工资买了Pad Air2，到今天信用卡分期买了新出的MacBook pro。我不晓得我是否应该自豪，因为现在的我已无任何积蓄，即使我终于拥有了传说中的生产力工具了。在决定要买新的电脑的时候，我就问过自己，我究竟想要什么？我已经不愿意去折腾无聊的电脑笔记本了，我需要的也不是一款强劲的游戏本，买下MacBook的那一刻我就告诉我自己，这是一个新的起点，我要的是一件足够好用的简易工具，之前折腾ubuntu，折腾windows，到最后发现，一个趁手的工具对效率的提升是显而易见的。\n\n一个月前，我买了新的域名``www.serbad.net``和``www.serbad.info``,上周才找时间修复了挂在`GitHub page`上的网站的Bug。``Ser Bad``我想我可以解释下是什么意思，``Ser``是一个不存在的词，是J·R·R·马丁大爷创造的，意思是``爵士``的意思，大概是因为我很迷恋那种爵士的绅士风度吧，虽然马丁大爷的作品里面和风度一毛钱关系都没有。既然买了新的域名，我就要想办法把这个域名维护下去，不然的话乱花钱就真的是``Bad``了。\n\n国庆前夕，早上高高兴兴地去上班，晚上回来就失业在家了。所谓的``资本寒冬``大抵就是这个样子的，没想到，该来的还是回来，同一个公司的iOS同事到现在都还没有找到工作。我自己找工作也有点儿急，只要面试过后两天之内没有通知我就基本忽略了，没想到在答应了现在这家公司的第二天之前面试的公司就通知我去上班了，只能遗憾地放弃。想想，自己为什么会答应现在这家公司呢，大概的原因是老板很热情，真心没想到，最近发现是我对工作太没有热情了（手动加一个😓的表情），这就让我开始思考自己以后的人生究竟该怎么走的问题了。\n\n说到底，程序员算什么呢？现在的技术经理是一个``不懂得开发的人``，在他眼里，技术是解决问题的，不管你用什么东西，只有解决了问题才是好的技术，这并没有错，我们现在用到的技术也并不是什么改变世界的技术，并不足以让我们用技术来换钱，这就是很现实的问题，任何公司都是以盈利为导向的，不然话，公司也就无法生存下去。讲道理，在我第一次提到需要时间去完善代码的时候，他说的一句话深深地打击了我```“代码够用就好了，你管人家写的好还是不好，哪怕你写的再好又能怎样，又有谁会看到？”```。是啊，这就是技术人员的悲哀，除了少部分创造出”有价值的”的人，大部分人终其一生都是默默无闻的小员工，没有话语权，没有成就，属于可替代品。我呢？除了完善自己的技术能力以外，我还有什么呢？我的工作是属于可替代的，兴许别人比我做的还要好，我对自己如何定位呢？思考了好久，发现自己无法得到合理的答案，我只能送自己一句话：“完成现阶段作为程序员的主要职责，然后保持适度的技术好奇心，再去拓展其他方面的技能。”，再加一句：“Read the fucking source code.”。\n\n既然写到这里了，顺便提下自己的感情状况吧。今年七月中旬的时候，和前尘去湖南旅游了一周，很久以前答应过她去湖南旅游的，而且我的确有些事放不下，所以毫不犹豫地就答应去了。因为是跟着旅行团走的，一路上就是各种赶路，在全程没有准备的情况下，我始终处于懵的状态。回来之后，我发现我终于放下了，时间啊就是这么残忍，当你迷茫裹足不前的时候，走到那个终点去看看就知道自己究竟想要的是什么了。哪怕我总是不遗余力地向前尘解释我那漏洞百出的人生观，在她眼里我依旧只是一个情商不高的傻子，三观不合何必强求，我不是情商不高，只是太自负了，这几年的打击才开始真正让我开始学会谦让。直到这一天，我觉得我终于遇到了那个对的人，可是遗憾地发现，我不知道该如何去跨过这一步。\n\n又走过了一年，未来的计划应该是这样子：积累自己的素材库多把新的内容分享出来。好了，就这样了，期待有一个美好的2017年。\n","slug":"Thinking2","published":1,"updated":"2018-06-12T16:30:50.883Z","layout":"post","photos":[],"link":"","_id":"cjr66wicx000emetpfet62jp0","content":"<p>从哪儿开始写好呢？算起来这是一篇拖了很久的文章，一直打算要写的，可是直到现在才开始，毕竟一篇文章不是一篇谈话节目，要有清晰的结构，不然的话变成流水账就显得没有意义了，而我从来没有想好这篇文章究竟该从哪儿开始。2016年就要结束了，那就当这是一篇年终总结吧！</p>\n<a id=\"more\"></a>\n<p>迄今，大学毕业已达年半有余，然吾等默默无闻之辈依然悲悲戚戚。在这一年半的时间里发生了很多事情，有很多始料未及，也有很多有意为之的事情。由刚开始更多面临的如何活下去，到今日开始思考如何生存的更好的问题上面，渐渐地作出了选择。我无法回答这种选择是否正确，我大概只能问，为了自己的选择究竟努力了多少。</p>\n<p>想想走过的这一年半，从大学宿舍，到公司宿舍，到舍友租的房子里面的临时借宿，再到用光积蓄颤抖着双手去找人生第一次要租的房子，再到现在费劲心机终于安稳住了一段时间。回头发现，我终于还是自己走出了第一步，哪怕这第一步走的那么艰难，我还是迈步走出来了。2014年底用了两个月的实习工资买了Pad Air2，到今天信用卡分期买了新出的MacBook pro。我不晓得我是否应该自豪，因为现在的我已无任何积蓄，即使我终于拥有了传说中的生产力工具了。在决定要买新的电脑的时候，我就问过自己，我究竟想要什么？我已经不愿意去折腾无聊的电脑笔记本了，我需要的也不是一款强劲的游戏本，买下MacBook的那一刻我就告诉我自己，这是一个新的起点，我要的是一件足够好用的简易工具，之前折腾ubuntu，折腾windows，到最后发现，一个趁手的工具对效率的提升是显而易见的。</p>\n<p>一个月前，我买了新的域名<code>www.serbad.net</code>和<code>www.serbad.info</code>,上周才找时间修复了挂在<code>GitHub page</code>上的网站的Bug。<code>Ser Bad</code>我想我可以解释下是什么意思，<code>Ser</code>是一个不存在的词，是J·R·R·马丁大爷创造的，意思是<code>爵士</code>的意思，大概是因为我很迷恋那种爵士的绅士风度吧，虽然马丁大爷的作品里面和风度一毛钱关系都没有。既然买了新的域名，我就要想办法把这个域名维护下去，不然的话乱花钱就真的是<code>Bad</code>了。</p>\n<p>国庆前夕，早上高高兴兴地去上班，晚上回来就失业在家了。所谓的<code>资本寒冬</code>大抵就是这个样子的，没想到，该来的还是回来，同一个公司的iOS同事到现在都还没有找到工作。我自己找工作也有点儿急，只要面试过后两天之内没有通知我就基本忽略了，没想到在答应了现在这家公司的第二天之前面试的公司就通知我去上班了，只能遗憾地放弃。想想，自己为什么会答应现在这家公司呢，大概的原因是老板很热情，真心没想到，最近发现是我对工作太没有热情了（手动加一个😓的表情），这就让我开始思考自己以后的人生究竟该怎么走的问题了。</p>\n<p>说到底，程序员算什么呢？现在的技术经理是一个<code>不懂得开发的人</code>，在他眼里，技术是解决问题的，不管你用什么东西，只有解决了问题才是好的技术，这并没有错，我们现在用到的技术也并不是什么改变世界的技术，并不足以让我们用技术来换钱，这就是很现实的问题，任何公司都是以盈利为导向的，不然话，公司也就无法生存下去。讲道理，在我第一次提到需要时间去完善代码的时候，他说的一句话深深地打击了我<code>“代码够用就好了，你管人家写的好还是不好，哪怕你写的再好又能怎样，又有谁会看到？”</code>。是啊，这就是技术人员的悲哀，除了少部分创造出”有价值的”的人，大部分人终其一生都是默默无闻的小员工，没有话语权，没有成就，属于可替代品。我呢？除了完善自己的技术能力以外，我还有什么呢？我的工作是属于可替代的，兴许别人比我做的还要好，我对自己如何定位呢？思考了好久，发现自己无法得到合理的答案，我只能送自己一句话：“完成现阶段作为程序员的主要职责，然后保持适度的技术好奇心，再去拓展其他方面的技能。”，再加一句：“Read the fucking source code.”。</p>\n<p>既然写到这里了，顺便提下自己的感情状况吧。今年七月中旬的时候，和前尘去湖南旅游了一周，很久以前答应过她去湖南旅游的，而且我的确有些事放不下，所以毫不犹豫地就答应去了。因为是跟着旅行团走的，一路上就是各种赶路，在全程没有准备的情况下，我始终处于懵的状态。回来之后，我发现我终于放下了，时间啊就是这么残忍，当你迷茫裹足不前的时候，走到那个终点去看看就知道自己究竟想要的是什么了。哪怕我总是不遗余力地向前尘解释我那漏洞百出的人生观，在她眼里我依旧只是一个情商不高的傻子，三观不合何必强求，我不是情商不高，只是太自负了，这几年的打击才开始真正让我开始学会谦让。直到这一天，我觉得我终于遇到了那个对的人，可是遗憾地发现，我不知道该如何去跨过这一步。</p>\n<p>又走过了一年，未来的计划应该是这样子：积累自己的素材库多把新的内容分享出来。好了，就这样了，期待有一个美好的2017年。</p>\n","excerpt":"<p>从哪儿开始写好呢？算起来这是一篇拖了很久的文章，一直打算要写的，可是直到现在才开始，毕竟一篇文章不是一篇谈话节目，要有清晰的结构，不然的话变成流水账就显得没有意义了，而我从来没有想好这篇文章究竟该从哪儿开始。2016年就要结束了，那就当这是一篇年终总结吧！</p>","more":"<p>迄今，大学毕业已达年半有余，然吾等默默无闻之辈依然悲悲戚戚。在这一年半的时间里发生了很多事情，有很多始料未及，也有很多有意为之的事情。由刚开始更多面临的如何活下去，到今日开始思考如何生存的更好的问题上面，渐渐地作出了选择。我无法回答这种选择是否正确，我大概只能问，为了自己的选择究竟努力了多少。</p>\n<p>想想走过的这一年半，从大学宿舍，到公司宿舍，到舍友租的房子里面的临时借宿，再到用光积蓄颤抖着双手去找人生第一次要租的房子，再到现在费劲心机终于安稳住了一段时间。回头发现，我终于还是自己走出了第一步，哪怕这第一步走的那么艰难，我还是迈步走出来了。2014年底用了两个月的实习工资买了Pad Air2，到今天信用卡分期买了新出的MacBook pro。我不晓得我是否应该自豪，因为现在的我已无任何积蓄，即使我终于拥有了传说中的生产力工具了。在决定要买新的电脑的时候，我就问过自己，我究竟想要什么？我已经不愿意去折腾无聊的电脑笔记本了，我需要的也不是一款强劲的游戏本，买下MacBook的那一刻我就告诉我自己，这是一个新的起点，我要的是一件足够好用的简易工具，之前折腾ubuntu，折腾windows，到最后发现，一个趁手的工具对效率的提升是显而易见的。</p>\n<p>一个月前，我买了新的域名<code>www.serbad.net</code>和<code>www.serbad.info</code>,上周才找时间修复了挂在<code>GitHub page</code>上的网站的Bug。<code>Ser Bad</code>我想我可以解释下是什么意思，<code>Ser</code>是一个不存在的词，是J·R·R·马丁大爷创造的，意思是<code>爵士</code>的意思，大概是因为我很迷恋那种爵士的绅士风度吧，虽然马丁大爷的作品里面和风度一毛钱关系都没有。既然买了新的域名，我就要想办法把这个域名维护下去，不然的话乱花钱就真的是<code>Bad</code>了。</p>\n<p>国庆前夕，早上高高兴兴地去上班，晚上回来就失业在家了。所谓的<code>资本寒冬</code>大抵就是这个样子的，没想到，该来的还是回来，同一个公司的iOS同事到现在都还没有找到工作。我自己找工作也有点儿急，只要面试过后两天之内没有通知我就基本忽略了，没想到在答应了现在这家公司的第二天之前面试的公司就通知我去上班了，只能遗憾地放弃。想想，自己为什么会答应现在这家公司呢，大概的原因是老板很热情，真心没想到，最近发现是我对工作太没有热情了（手动加一个😓的表情），这就让我开始思考自己以后的人生究竟该怎么走的问题了。</p>\n<p>说到底，程序员算什么呢？现在的技术经理是一个<code>不懂得开发的人</code>，在他眼里，技术是解决问题的，不管你用什么东西，只有解决了问题才是好的技术，这并没有错，我们现在用到的技术也并不是什么改变世界的技术，并不足以让我们用技术来换钱，这就是很现实的问题，任何公司都是以盈利为导向的，不然话，公司也就无法生存下去。讲道理，在我第一次提到需要时间去完善代码的时候，他说的一句话深深地打击了我<code>“代码够用就好了，你管人家写的好还是不好，哪怕你写的再好又能怎样，又有谁会看到？”</code>。是啊，这就是技术人员的悲哀，除了少部分创造出”有价值的”的人，大部分人终其一生都是默默无闻的小员工，没有话语权，没有成就，属于可替代品。我呢？除了完善自己的技术能力以外，我还有什么呢？我的工作是属于可替代的，兴许别人比我做的还要好，我对自己如何定位呢？思考了好久，发现自己无法得到合理的答案，我只能送自己一句话：“完成现阶段作为程序员的主要职责，然后保持适度的技术好奇心，再去拓展其他方面的技能。”，再加一句：“Read the fucking source code.”。</p>\n<p>既然写到这里了，顺便提下自己的感情状况吧。今年七月中旬的时候，和前尘去湖南旅游了一周，很久以前答应过她去湖南旅游的，而且我的确有些事放不下，所以毫不犹豫地就答应去了。因为是跟着旅行团走的，一路上就是各种赶路，在全程没有准备的情况下，我始终处于懵的状态。回来之后，我发现我终于放下了，时间啊就是这么残忍，当你迷茫裹足不前的时候，走到那个终点去看看就知道自己究竟想要的是什么了。哪怕我总是不遗余力地向前尘解释我那漏洞百出的人生观，在她眼里我依旧只是一个情商不高的傻子，三观不合何必强求，我不是情商不高，只是太自负了，这几年的打击才开始真正让我开始学会谦让。直到这一天，我觉得我终于遇到了那个对的人，可是遗憾地发现，我不知道该如何去跨过这一步。</p>\n<p>又走过了一年，未来的计划应该是这样子：积累自己的素材库多把新的内容分享出来。好了，就这样了，期待有一个美好的2017年。</p>"},{"title":"思考篇：3","date":"2017-04-16T07:22:31.000Z","comments":0,"_content":"距离上次的随笔文章有段时间了，最近，CSDN上一篇文章因为一个标题“Android微信支付踩坑全记录”死活发不出去，也不知道踩中哪个敏感词，这就是在别人的平台上发布东西所必然面临的问题，包括我一直不看好的微信小程序。所以，我要继续维护我的Github page了。\n<!--more-->\n\n在最近的项目里，尝试使用了很火的MVP模式，日后找时间会把MVP模式的实践过程写出来，可是却发现有几个问题需要去注意一下。\n1. 我选择让View层负责页面逻辑，Presenter层负责业务逻辑，Model层负责网络请求。\n2. MVP适合业务逻辑比较重的地方使用。因为项目一开始的时候，页面逻辑、业务逻辑、后台接口都在变，所以每次修改的时候要跑去修改很多的文件，平白增加了无数的工作，显然没有必要，所以在尝试之后就暂停了继续使用MVP，等到业务稳定了之后，再尝试吧。也就是说，大概估算除非Activity里面的代码最少会有上千行，否则其实没有必要使用MVP模式。\n3. MVP模式比较考验逻辑的拆分能力，就是讲如何在各层之间分配接口，是一件比较耗时的事情，也许是因为自己还没有完全适应MVP的开发，所以刚开始的时候会有点儿不适应把。\n4. 没有最好的设计模式，只有最适合的设计模式。\n\n一个月前，公司团队新招了一位成员，可是在与这位新成员合作的时候，却发生了很多不愉快的事情。这就让我不得不思考，如何和一个不愿意合作的人进行团队协作呢？无论怎么说，大家都是因为工作聚在一起的，不管大家能不能成为朋友，都需要能够处理好工作上的问题。虽然在一开始的时候，就对后台接口提了很多接口的规范，可是这位新的同事一来，很多规范都被打破了，比如返回的字段里面居然有大写字母，比如本来应该返回数组的内容却有可能返回对象，比如完全忽视restful原则，甚至需要同时请求两个接口才能拿到最终所需要的数据，比如突然增加的莫名其妙的字段名，等等等。有些实在无法让人忍受的，我都非常坚持的去让他改掉了，甚至当着经理的面让他去改，我也很无奈，当我向他提出这个问题的时候他说“这是你自己的问题，是你自己解析不了”，实在被噎的无话可说，毕竟我无权领导后台的工作。可是工作还是要继续做，生活也要继续过，不能因为一个人就毁掉了本来愉快的心情，也不能因为一个人就不做任何的工作了。有一句话说的很对，能成事的人都需要具有说服别人与自己协作的能力。我想，既然大家还是一起共事，就需要大家一起继续合作。\n\n最近看了一本书《巨人的陨落》，给我感触最深的大概是，阶层的转移吧，大家都是小人物，“自由”如美国也是有权贵阶层的。又及，最近买的书有点儿多，要花点儿时间才能全部看完了。\n","source":"_posts/Thinking3.md","raw":"---\ntitle: 思考篇：3\ndate: 2017-04-16 15:22:31\ntags: 随笔\ncategories: 随笔\ncomments: false\n---\n距离上次的随笔文章有段时间了，最近，CSDN上一篇文章因为一个标题“Android微信支付踩坑全记录”死活发不出去，也不知道踩中哪个敏感词，这就是在别人的平台上发布东西所必然面临的问题，包括我一直不看好的微信小程序。所以，我要继续维护我的Github page了。\n<!--more-->\n\n在最近的项目里，尝试使用了很火的MVP模式，日后找时间会把MVP模式的实践过程写出来，可是却发现有几个问题需要去注意一下。\n1. 我选择让View层负责页面逻辑，Presenter层负责业务逻辑，Model层负责网络请求。\n2. MVP适合业务逻辑比较重的地方使用。因为项目一开始的时候，页面逻辑、业务逻辑、后台接口都在变，所以每次修改的时候要跑去修改很多的文件，平白增加了无数的工作，显然没有必要，所以在尝试之后就暂停了继续使用MVP，等到业务稳定了之后，再尝试吧。也就是说，大概估算除非Activity里面的代码最少会有上千行，否则其实没有必要使用MVP模式。\n3. MVP模式比较考验逻辑的拆分能力，就是讲如何在各层之间分配接口，是一件比较耗时的事情，也许是因为自己还没有完全适应MVP的开发，所以刚开始的时候会有点儿不适应把。\n4. 没有最好的设计模式，只有最适合的设计模式。\n\n一个月前，公司团队新招了一位成员，可是在与这位新成员合作的时候，却发生了很多不愉快的事情。这就让我不得不思考，如何和一个不愿意合作的人进行团队协作呢？无论怎么说，大家都是因为工作聚在一起的，不管大家能不能成为朋友，都需要能够处理好工作上的问题。虽然在一开始的时候，就对后台接口提了很多接口的规范，可是这位新的同事一来，很多规范都被打破了，比如返回的字段里面居然有大写字母，比如本来应该返回数组的内容却有可能返回对象，比如完全忽视restful原则，甚至需要同时请求两个接口才能拿到最终所需要的数据，比如突然增加的莫名其妙的字段名，等等等。有些实在无法让人忍受的，我都非常坚持的去让他改掉了，甚至当着经理的面让他去改，我也很无奈，当我向他提出这个问题的时候他说“这是你自己的问题，是你自己解析不了”，实在被噎的无话可说，毕竟我无权领导后台的工作。可是工作还是要继续做，生活也要继续过，不能因为一个人就毁掉了本来愉快的心情，也不能因为一个人就不做任何的工作了。有一句话说的很对，能成事的人都需要具有说服别人与自己协作的能力。我想，既然大家还是一起共事，就需要大家一起继续合作。\n\n最近看了一本书《巨人的陨落》，给我感触最深的大概是，阶层的转移吧，大家都是小人物，“自由”如美国也是有权贵阶层的。又及，最近买的书有点儿多，要花点儿时间才能全部看完了。\n","slug":"Thinking3","published":1,"updated":"2018-06-12T16:30:53.946Z","layout":"post","photos":[],"link":"","_id":"cjr66wid1000imetpozmha1w7","content":"<p>距离上次的随笔文章有段时间了，最近，CSDN上一篇文章因为一个标题“Android微信支付踩坑全记录”死活发不出去，也不知道踩中哪个敏感词，这就是在别人的平台上发布东西所必然面临的问题，包括我一直不看好的微信小程序。所以，我要继续维护我的Github page了。<br><a id=\"more\"></a></p>\n<p>在最近的项目里，尝试使用了很火的MVP模式，日后找时间会把MVP模式的实践过程写出来，可是却发现有几个问题需要去注意一下。</p>\n<ol>\n<li>我选择让View层负责页面逻辑，Presenter层负责业务逻辑，Model层负责网络请求。</li>\n<li>MVP适合业务逻辑比较重的地方使用。因为项目一开始的时候，页面逻辑、业务逻辑、后台接口都在变，所以每次修改的时候要跑去修改很多的文件，平白增加了无数的工作，显然没有必要，所以在尝试之后就暂停了继续使用MVP，等到业务稳定了之后，再尝试吧。也就是说，大概估算除非Activity里面的代码最少会有上千行，否则其实没有必要使用MVP模式。</li>\n<li>MVP模式比较考验逻辑的拆分能力，就是讲如何在各层之间分配接口，是一件比较耗时的事情，也许是因为自己还没有完全适应MVP的开发，所以刚开始的时候会有点儿不适应把。</li>\n<li>没有最好的设计模式，只有最适合的设计模式。</li>\n</ol>\n<p>一个月前，公司团队新招了一位成员，可是在与这位新成员合作的时候，却发生了很多不愉快的事情。这就让我不得不思考，如何和一个不愿意合作的人进行团队协作呢？无论怎么说，大家都是因为工作聚在一起的，不管大家能不能成为朋友，都需要能够处理好工作上的问题。虽然在一开始的时候，就对后台接口提了很多接口的规范，可是这位新的同事一来，很多规范都被打破了，比如返回的字段里面居然有大写字母，比如本来应该返回数组的内容却有可能返回对象，比如完全忽视restful原则，甚至需要同时请求两个接口才能拿到最终所需要的数据，比如突然增加的莫名其妙的字段名，等等等。有些实在无法让人忍受的，我都非常坚持的去让他改掉了，甚至当着经理的面让他去改，我也很无奈，当我向他提出这个问题的时候他说“这是你自己的问题，是你自己解析不了”，实在被噎的无话可说，毕竟我无权领导后台的工作。可是工作还是要继续做，生活也要继续过，不能因为一个人就毁掉了本来愉快的心情，也不能因为一个人就不做任何的工作了。有一句话说的很对，能成事的人都需要具有说服别人与自己协作的能力。我想，既然大家还是一起共事，就需要大家一起继续合作。</p>\n<p>最近看了一本书《巨人的陨落》，给我感触最深的大概是，阶层的转移吧，大家都是小人物，“自由”如美国也是有权贵阶层的。又及，最近买的书有点儿多，要花点儿时间才能全部看完了。</p>\n","excerpt":"<p>距离上次的随笔文章有段时间了，最近，CSDN上一篇文章因为一个标题“Android微信支付踩坑全记录”死活发不出去，也不知道踩中哪个敏感词，这就是在别人的平台上发布东西所必然面临的问题，包括我一直不看好的微信小程序。所以，我要继续维护我的Github page了。<br>","more":"</p>\n<p>在最近的项目里，尝试使用了很火的MVP模式，日后找时间会把MVP模式的实践过程写出来，可是却发现有几个问题需要去注意一下。</p>\n<ol>\n<li>我选择让View层负责页面逻辑，Presenter层负责业务逻辑，Model层负责网络请求。</li>\n<li>MVP适合业务逻辑比较重的地方使用。因为项目一开始的时候，页面逻辑、业务逻辑、后台接口都在变，所以每次修改的时候要跑去修改很多的文件，平白增加了无数的工作，显然没有必要，所以在尝试之后就暂停了继续使用MVP，等到业务稳定了之后，再尝试吧。也就是说，大概估算除非Activity里面的代码最少会有上千行，否则其实没有必要使用MVP模式。</li>\n<li>MVP模式比较考验逻辑的拆分能力，就是讲如何在各层之间分配接口，是一件比较耗时的事情，也许是因为自己还没有完全适应MVP的开发，所以刚开始的时候会有点儿不适应把。</li>\n<li>没有最好的设计模式，只有最适合的设计模式。</li>\n</ol>\n<p>一个月前，公司团队新招了一位成员，可是在与这位新成员合作的时候，却发生了很多不愉快的事情。这就让我不得不思考，如何和一个不愿意合作的人进行团队协作呢？无论怎么说，大家都是因为工作聚在一起的，不管大家能不能成为朋友，都需要能够处理好工作上的问题。虽然在一开始的时候，就对后台接口提了很多接口的规范，可是这位新的同事一来，很多规范都被打破了，比如返回的字段里面居然有大写字母，比如本来应该返回数组的内容却有可能返回对象，比如完全忽视restful原则，甚至需要同时请求两个接口才能拿到最终所需要的数据，比如突然增加的莫名其妙的字段名，等等等。有些实在无法让人忍受的，我都非常坚持的去让他改掉了，甚至当着经理的面让他去改，我也很无奈，当我向他提出这个问题的时候他说“这是你自己的问题，是你自己解析不了”，实在被噎的无话可说，毕竟我无权领导后台的工作。可是工作还是要继续做，生活也要继续过，不能因为一个人就毁掉了本来愉快的心情，也不能因为一个人就不做任何的工作了。有一句话说的很对，能成事的人都需要具有说服别人与自己协作的能力。我想，既然大家还是一起共事，就需要大家一起继续合作。</p>\n<p>最近看了一本书《巨人的陨落》，给我感触最深的大概是，阶层的转移吧，大家都是小人物，“自由”如美国也是有权贵阶层的。又及，最近买的书有点儿多，要花点儿时间才能全部看完了。</p>"},{"title":"关于SharedPreferences的一次问题","date":"2016-06-02T12:50:22.000Z","comments":0,"_content":"SharedPreferences可以用来保存一些很简单的数据，对应的就是一个key-value。但是最近遇到一个问题就是在多进程的时候，没有办法同步保存数据。看到一个解决办法是``Context.MODE_MULTI_PROCESS`` 来进行多线程访问。在官网在介绍这个方法的时候是这样子的：\n<!--more-->\n```\nThis constant was deprecated in API level 23.\nMODE_MULTI_PROCESS does not work reliably in some versions of Android, and furthermore does not provide any mechanism for reconciling concurrent modifications across processes.\nApplications should not attempt to use it.\nInstead, they should use an explicit cross-process data management approach such as ContentProvider.\n\nSharedPreference loading flag: when set, the file on disk will be checked for modification even if the shared preferences instance is already loaded in this process.\nThis behavior is sometimes desired in cases where the application has multiple processes, all writing to the same SharedPreferences file.\nGenerally there are better forms of communication between processes, though.\n\nThis was the legacy (but undocumented) behavior in and before Gingerbread (Android 2.3) and this flag is implied when targetting such releases.\nFor applications targetting SDK versions greater than Android 2.3, this flag must be explicitly set if desired.\n```\n\n在6.0以上这个方法已经被弃用了，最低支持2.3。而且最好使用``ContentProvider``。\n一定要用的话，要尽力避免同时去操作SharedPreferencesde。其实也找到一些开源的库，可是觉得没有必要，所以还是算了。\n\n放一些链接：\n -  <https://github.com/android-cn/android-discuss/issues/135>\n -  <http://zmywly8866.github.io/2015/09/09/sharedpreferences-in-multiprocess.html>\n","source":"_posts/a-problem-about-sharedPreferencesde.md","raw":"---\ntitle: 关于SharedPreferences的一次问题\ndate: 2016-06-02 20:50:22\ntags: android\ncomments: false\n---\nSharedPreferences可以用来保存一些很简单的数据，对应的就是一个key-value。但是最近遇到一个问题就是在多进程的时候，没有办法同步保存数据。看到一个解决办法是``Context.MODE_MULTI_PROCESS`` 来进行多线程访问。在官网在介绍这个方法的时候是这样子的：\n<!--more-->\n```\nThis constant was deprecated in API level 23.\nMODE_MULTI_PROCESS does not work reliably in some versions of Android, and furthermore does not provide any mechanism for reconciling concurrent modifications across processes.\nApplications should not attempt to use it.\nInstead, they should use an explicit cross-process data management approach such as ContentProvider.\n\nSharedPreference loading flag: when set, the file on disk will be checked for modification even if the shared preferences instance is already loaded in this process.\nThis behavior is sometimes desired in cases where the application has multiple processes, all writing to the same SharedPreferences file.\nGenerally there are better forms of communication between processes, though.\n\nThis was the legacy (but undocumented) behavior in and before Gingerbread (Android 2.3) and this flag is implied when targetting such releases.\nFor applications targetting SDK versions greater than Android 2.3, this flag must be explicitly set if desired.\n```\n\n在6.0以上这个方法已经被弃用了，最低支持2.3。而且最好使用``ContentProvider``。\n一定要用的话，要尽力避免同时去操作SharedPreferencesde。其实也找到一些开源的库，可是觉得没有必要，所以还是算了。\n\n放一些链接：\n -  <https://github.com/android-cn/android-discuss/issues/135>\n -  <http://zmywly8866.github.io/2015/09/09/sharedpreferences-in-multiprocess.html>\n","slug":"a-problem-about-sharedPreferencesde","published":1,"updated":"2017-07-10T07:25:08.000Z","layout":"post","photos":[],"link":"","_id":"cjr66wid3000lmetpmrbjdyil","content":"<p>SharedPreferences可以用来保存一些很简单的数据，对应的就是一个key-value。但是最近遇到一个问题就是在多进程的时候，没有办法同步保存数据。看到一个解决办法是<code>Context.MODE_MULTI_PROCESS</code> 来进行多线程访问。在官网在介绍这个方法的时候是这样子的：<br><a id=\"more\"></a><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">This constant was deprecated in API level 23.</div><div class=\"line\">MODE_MULTI_PROCESS does not work reliably in some versions of Android, and furthermore does not provide any mechanism for reconciling concurrent modifications across processes.</div><div class=\"line\">Applications should not attempt to use it.</div><div class=\"line\">Instead, they should use an explicit cross-process data management approach such as ContentProvider.</div><div class=\"line\"></div><div class=\"line\">SharedPreference loading flag: when set, the file on disk will be checked for modification even if the shared preferences instance is already loaded in this process.</div><div class=\"line\">This behavior is sometimes desired in cases where the application has multiple processes, all writing to the same SharedPreferences file.</div><div class=\"line\">Generally there are better forms of communication between processes, though.</div><div class=\"line\"></div><div class=\"line\">This was the legacy (but undocumented) behavior in and before Gingerbread (Android 2.3) and this flag is implied when targetting such releases.</div><div class=\"line\">For applications targetting SDK versions greater than Android 2.3, this flag must be explicitly set if desired.</div></pre></td></tr></table></figure></p>\n<p>在6.0以上这个方法已经被弃用了，最低支持2.3。而且最好使用<code>ContentProvider</code>。<br>一定要用的话，要尽力避免同时去操作SharedPreferencesde。其实也找到一些开源的库，可是觉得没有必要，所以还是算了。</p>\n<p>放一些链接：</p>\n<ul>\n<li><a href=\"https://github.com/android-cn/android-discuss/issues/135\" target=\"_blank\" rel=\"external\">https://github.com/android-cn/android-discuss/issues/135</a></li>\n<li><a href=\"http://zmywly8866.github.io/2015/09/09/sharedpreferences-in-multiprocess.html\" target=\"_blank\" rel=\"external\">http://zmywly8866.github.io/2015/09/09/sharedpreferences-in-multiprocess.html</a></li>\n</ul>\n","excerpt":"<p>SharedPreferences可以用来保存一些很简单的数据，对应的就是一个key-value。但是最近遇到一个问题就是在多进程的时候，没有办法同步保存数据。看到一个解决办法是<code>Context.MODE_MULTI_PROCESS</code> 来进行多线程访问。在官网在介绍这个方法的时候是这样子的：<br>","more":"<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">This constant was deprecated in API level 23.</div><div class=\"line\">MODE_MULTI_PROCESS does not work reliably in some versions of Android, and furthermore does not provide any mechanism for reconciling concurrent modifications across processes.</div><div class=\"line\">Applications should not attempt to use it.</div><div class=\"line\">Instead, they should use an explicit cross-process data management approach such as ContentProvider.</div><div class=\"line\"></div><div class=\"line\">SharedPreference loading flag: when set, the file on disk will be checked for modification even if the shared preferences instance is already loaded in this process.</div><div class=\"line\">This behavior is sometimes desired in cases where the application has multiple processes, all writing to the same SharedPreferences file.</div><div class=\"line\">Generally there are better forms of communication between processes, though.</div><div class=\"line\"></div><div class=\"line\">This was the legacy (but undocumented) behavior in and before Gingerbread (Android 2.3) and this flag is implied when targetting such releases.</div><div class=\"line\">For applications targetting SDK versions greater than Android 2.3, this flag must be explicitly set if desired.</div></pre></td></tr></table></figure></p>\n<p>在6.0以上这个方法已经被弃用了，最低支持2.3。而且最好使用<code>ContentProvider</code>。<br>一定要用的话，要尽力避免同时去操作SharedPreferencesde。其实也找到一些开源的库，可是觉得没有必要，所以还是算了。</p>\n<p>放一些链接：</p>\n<ul>\n<li><a href=\"https://github.com/android-cn/android-discuss/issues/135\">https://github.com/android-cn/android-discuss/issues/135</a></li>\n<li><a href=\"http://zmywly8866.github.io/2015/09/09/sharedpreferences-in-multiprocess.html\">http://zmywly8866.github.io/2015/09/09/sharedpreferences-in-multiprocess.html</a></li>\n</ul>"},{"title":"思考篇：4","date":"2017-05-17T13:51:15.000Z","updated":"2017-05-17T13:51:15.000Z","comments":0,"_content":"最近这一个月，在帮公司面试Android工程师，真的是发现简历上呈现的东西，实在是信息量有限，所以这才会有面试的程序。说下这几天发生的感悟吧。\n<!--more-->\n- 一定要保证你简历上的东西是真实，是你会的。\n\n  讲道理，有的人连自己简历上的知识点都回答的不完整，遇到几个简历上写的精通Java，可是却连最基本的Java基础的集合都讲不清楚，实在是不知道那里来的勇气写精通的。对于筛选你来面试的人，一定是觉得你简历合适的，可是如果你乱写，浪费大家时间，你也辛苦白跑一趟，何必呢？\n- 请仔细检查自己简历里面的大小写拼写以及错误。\n\n  一份简历，一定是你看过很多遍的东西，如果连指望你对关乎自己工作的``门面``都检查不好，怎么指望你能够有一个好的代码规范，有一个好的工作习惯呢？甚至有可能，简历上面的东西，是你随意拼凑出来的东西，那更加不能指望你了。\n\n- 如果自己基础不够，请在面试之前，多看看书。\n\n  面试期间，有一个印象很深刻，因为我一开始问了几个基础的问题，然后说自己不会。然后我问他，请把你来之前准备过的东西描述一遍可以吗？他说，来之前没有准备。我的内心。瞬间就有点儿对这个人不看好了，因为我为了面试你，我都要做一些准备的，包括一些我可能记忆不是很深刻的知识点，我都要再去确认一遍细节，可是你居然说你没有准备，没有准备也就罢了，连基础都回答不出来，那不是浪费大家的时间吗？然后，我又挑了他简历上写的几个知识点问了下，然后他又说自己不知道，那我只有``礼貌地``请他离开了。\n- 关于职业规划。\n\n  其中有一个，年龄以及30岁+，可是我当我问他，想做开发组的组长，还是做普通的程序员时，他说都可以。然后问了一些基础的东西，但是没能完美回答上来，然后问了一些团队管理的问题，也回答的有问题。\n\n  之后，我真的是在感慨，程序员这条路走起来并不容易。虽然都知道，大部分人无法做到top10%，但是有的人，年纪一大把却连top60%都做不到，这个时候就开始面临学习能力的下降，竞争力的下降，不得不被市场淘汰掉。然后想想自己，我该如何让自己顺利更快成长呢？\n\n- 基础的算法能力。\n\n  大学教育千奇百怪，居然会遇到有几个人，连冒泡算法都没有听过，你说你一时回答不出来，我可以假装自己原谅你，可是都没有听过，那就真的是说不过去了。\n- 关于几点遗憾。\n\n  其实在面试过程中，也遇到了一些虽然基础薄弱，但是学习意识很强，只是因为自己之前接触的环境，没能给自己指明一条良好的道路。有一个，在我提出问题，表示自己不会的时候，还虚心请教，我都尽我所能给出了回答，要不是因为我被要求找一个经验丰富的工程师，不然的话，我其实蛮想把这个人找来的，虽然我很礼貌表明了我的意思，真心希望他能尽快找到一家愿意收留他的人，也希望我所讲过的话，没有把他带偏。\n\n- 关于在简历中留博客的人。\n\n  关于在简历中留博客的人，是一件很冒险的事情，因为，有些人的博客实在是太过简单了。甚至有的人在2017年还把自己用eclipse写的代码贴上去，这就有点儿说不过去了，我就不说他博客里面贴的代码过于简单了，关键是一眼就能看出来贴的是eclipse上写的代码。这实在无法让人忍受。\n\n  其实，很多公司招聘启事会说希望能留一个博客，是为了让对方有一个技术积累，不会这么多年只写一些简单的业务代码，能对Android的技术提出一些自己的想法，这个很关键，这能看出来一个人是否有技术追求，是否有学习能力，这才是让别人贴博客的原因，绝对不是流于形式，放一篇博客就完事了。\n- 关于自己的反思。\n\n  在面试别人的时候，也不一而足，问的问题也会不一样。比如有的人，我会问``如果有一天Android不行了，你怎么办呢？``，后来我和一个朋友争论过这个问题，他的做法是，在一开始就选一个日后绝对会用的到技术，比如后端的技术。虽然后端的技术也在变革，但是长期来看，后端的Java还是具有相当的生命力的。\n\n  可是，我已经选了Android了，我就不得不面对这种问题，最后我说了一句连我自己都不信的话，Android绝对不会轻易垮掉的。其实问这个问题，我只是想知道对方究竟有没有想过这个问题，回答什么都行，只要逻辑自洽就行，但是绝对不能回答不知道，这代表你对生活得过且过，不会去想尽办法成长。\n\n  当然因为自己经验有限，也会遇到一些没有接触过的东西，那我就只能判断一个大概，因为真的做过的人，是能够做到对于这个东西理解的逻辑不会出现漏洞的。\n\n  也希望自己能够继续努力，多做准备，继续成长。毕竟对于公司而言，只适合能够帮到公司的人。\n\n  本博客，没有做推广，不过也许会有人偶然看到这里，那么本公司依然欢迎你投递简历，这是基本的信任。\n","source":"_posts/Thinking4.md","raw":"---\ntitle: 思考篇：4\ndate: 2017-05-17 21:51:15\nupdated: 2017-05-17 21:51:15\ntags: 随笔\ncategories: 随笔\ncomments: false\n---\n最近这一个月，在帮公司面试Android工程师，真的是发现简历上呈现的东西，实在是信息量有限，所以这才会有面试的程序。说下这几天发生的感悟吧。\n<!--more-->\n- 一定要保证你简历上的东西是真实，是你会的。\n\n  讲道理，有的人连自己简历上的知识点都回答的不完整，遇到几个简历上写的精通Java，可是却连最基本的Java基础的集合都讲不清楚，实在是不知道那里来的勇气写精通的。对于筛选你来面试的人，一定是觉得你简历合适的，可是如果你乱写，浪费大家时间，你也辛苦白跑一趟，何必呢？\n- 请仔细检查自己简历里面的大小写拼写以及错误。\n\n  一份简历，一定是你看过很多遍的东西，如果连指望你对关乎自己工作的``门面``都检查不好，怎么指望你能够有一个好的代码规范，有一个好的工作习惯呢？甚至有可能，简历上面的东西，是你随意拼凑出来的东西，那更加不能指望你了。\n\n- 如果自己基础不够，请在面试之前，多看看书。\n\n  面试期间，有一个印象很深刻，因为我一开始问了几个基础的问题，然后说自己不会。然后我问他，请把你来之前准备过的东西描述一遍可以吗？他说，来之前没有准备。我的内心。瞬间就有点儿对这个人不看好了，因为我为了面试你，我都要做一些准备的，包括一些我可能记忆不是很深刻的知识点，我都要再去确认一遍细节，可是你居然说你没有准备，没有准备也就罢了，连基础都回答不出来，那不是浪费大家的时间吗？然后，我又挑了他简历上写的几个知识点问了下，然后他又说自己不知道，那我只有``礼貌地``请他离开了。\n- 关于职业规划。\n\n  其中有一个，年龄以及30岁+，可是我当我问他，想做开发组的组长，还是做普通的程序员时，他说都可以。然后问了一些基础的东西，但是没能完美回答上来，然后问了一些团队管理的问题，也回答的有问题。\n\n  之后，我真的是在感慨，程序员这条路走起来并不容易。虽然都知道，大部分人无法做到top10%，但是有的人，年纪一大把却连top60%都做不到，这个时候就开始面临学习能力的下降，竞争力的下降，不得不被市场淘汰掉。然后想想自己，我该如何让自己顺利更快成长呢？\n\n- 基础的算法能力。\n\n  大学教育千奇百怪，居然会遇到有几个人，连冒泡算法都没有听过，你说你一时回答不出来，我可以假装自己原谅你，可是都没有听过，那就真的是说不过去了。\n- 关于几点遗憾。\n\n  其实在面试过程中，也遇到了一些虽然基础薄弱，但是学习意识很强，只是因为自己之前接触的环境，没能给自己指明一条良好的道路。有一个，在我提出问题，表示自己不会的时候，还虚心请教，我都尽我所能给出了回答，要不是因为我被要求找一个经验丰富的工程师，不然的话，我其实蛮想把这个人找来的，虽然我很礼貌表明了我的意思，真心希望他能尽快找到一家愿意收留他的人，也希望我所讲过的话，没有把他带偏。\n\n- 关于在简历中留博客的人。\n\n  关于在简历中留博客的人，是一件很冒险的事情，因为，有些人的博客实在是太过简单了。甚至有的人在2017年还把自己用eclipse写的代码贴上去，这就有点儿说不过去了，我就不说他博客里面贴的代码过于简单了，关键是一眼就能看出来贴的是eclipse上写的代码。这实在无法让人忍受。\n\n  其实，很多公司招聘启事会说希望能留一个博客，是为了让对方有一个技术积累，不会这么多年只写一些简单的业务代码，能对Android的技术提出一些自己的想法，这个很关键，这能看出来一个人是否有技术追求，是否有学习能力，这才是让别人贴博客的原因，绝对不是流于形式，放一篇博客就完事了。\n- 关于自己的反思。\n\n  在面试别人的时候，也不一而足，问的问题也会不一样。比如有的人，我会问``如果有一天Android不行了，你怎么办呢？``，后来我和一个朋友争论过这个问题，他的做法是，在一开始就选一个日后绝对会用的到技术，比如后端的技术。虽然后端的技术也在变革，但是长期来看，后端的Java还是具有相当的生命力的。\n\n  可是，我已经选了Android了，我就不得不面对这种问题，最后我说了一句连我自己都不信的话，Android绝对不会轻易垮掉的。其实问这个问题，我只是想知道对方究竟有没有想过这个问题，回答什么都行，只要逻辑自洽就行，但是绝对不能回答不知道，这代表你对生活得过且过，不会去想尽办法成长。\n\n  当然因为自己经验有限，也会遇到一些没有接触过的东西，那我就只能判断一个大概，因为真的做过的人，是能够做到对于这个东西理解的逻辑不会出现漏洞的。\n\n  也希望自己能够继续努力，多做准备，继续成长。毕竟对于公司而言，只适合能够帮到公司的人。\n\n  本博客，没有做推广，不过也许会有人偶然看到这里，那么本公司依然欢迎你投递简历，这是基本的信任。\n","slug":"Thinking4","published":1,"layout":"post","photos":[],"link":"","_id":"cjr66wid5000pmetph4ffjhbw","content":"<p>最近这一个月，在帮公司面试Android工程师，真的是发现简历上呈现的东西，实在是信息量有限，所以这才会有面试的程序。说下这几天发生的感悟吧。<br><a id=\"more\"></a></p>\n<ul>\n<li><p>一定要保证你简历上的东西是真实，是你会的。</p>\n<p>讲道理，有的人连自己简历上的知识点都回答的不完整，遇到几个简历上写的精通Java，可是却连最基本的Java基础的集合都讲不清楚，实在是不知道那里来的勇气写精通的。对于筛选你来面试的人，一定是觉得你简历合适的，可是如果你乱写，浪费大家时间，你也辛苦白跑一趟，何必呢？</p>\n</li>\n<li><p>请仔细检查自己简历里面的大小写拼写以及错误。</p>\n<p>一份简历，一定是你看过很多遍的东西，如果连指望你对关乎自己工作的<code>门面</code>都检查不好，怎么指望你能够有一个好的代码规范，有一个好的工作习惯呢？甚至有可能，简历上面的东西，是你随意拼凑出来的东西，那更加不能指望你了。</p>\n</li>\n<li><p>如果自己基础不够，请在面试之前，多看看书。</p>\n<p>面试期间，有一个印象很深刻，因为我一开始问了几个基础的问题，然后说自己不会。然后我问他，请把你来之前准备过的东西描述一遍可以吗？他说，来之前没有准备。我的内心。瞬间就有点儿对这个人不看好了，因为我为了面试你，我都要做一些准备的，包括一些我可能记忆不是很深刻的知识点，我都要再去确认一遍细节，可是你居然说你没有准备，没有准备也就罢了，连基础都回答不出来，那不是浪费大家的时间吗？然后，我又挑了他简历上写的几个知识点问了下，然后他又说自己不知道，那我只有<code>礼貌地</code>请他离开了。</p>\n</li>\n<li><p>关于职业规划。</p>\n<p>其中有一个，年龄以及30岁+，可是我当我问他，想做开发组的组长，还是做普通的程序员时，他说都可以。然后问了一些基础的东西，但是没能完美回答上来，然后问了一些团队管理的问题，也回答的有问题。</p>\n<p>之后，我真的是在感慨，程序员这条路走起来并不容易。虽然都知道，大部分人无法做到top10%，但是有的人，年纪一大把却连top60%都做不到，这个时候就开始面临学习能力的下降，竞争力的下降，不得不被市场淘汰掉。然后想想自己，我该如何让自己顺利更快成长呢？</p>\n</li>\n<li><p>基础的算法能力。</p>\n<p>大学教育千奇百怪，居然会遇到有几个人，连冒泡算法都没有听过，你说你一时回答不出来，我可以假装自己原谅你，可是都没有听过，那就真的是说不过去了。</p>\n</li>\n<li><p>关于几点遗憾。</p>\n<p>其实在面试过程中，也遇到了一些虽然基础薄弱，但是学习意识很强，只是因为自己之前接触的环境，没能给自己指明一条良好的道路。有一个，在我提出问题，表示自己不会的时候，还虚心请教，我都尽我所能给出了回答，要不是因为我被要求找一个经验丰富的工程师，不然的话，我其实蛮想把这个人找来的，虽然我很礼貌表明了我的意思，真心希望他能尽快找到一家愿意收留他的人，也希望我所讲过的话，没有把他带偏。</p>\n</li>\n<li><p>关于在简历中留博客的人。</p>\n<p>关于在简历中留博客的人，是一件很冒险的事情，因为，有些人的博客实在是太过简单了。甚至有的人在2017年还把自己用eclipse写的代码贴上去，这就有点儿说不过去了，我就不说他博客里面贴的代码过于简单了，关键是一眼就能看出来贴的是eclipse上写的代码。这实在无法让人忍受。</p>\n<p>其实，很多公司招聘启事会说希望能留一个博客，是为了让对方有一个技术积累，不会这么多年只写一些简单的业务代码，能对Android的技术提出一些自己的想法，这个很关键，这能看出来一个人是否有技术追求，是否有学习能力，这才是让别人贴博客的原因，绝对不是流于形式，放一篇博客就完事了。</p>\n</li>\n<li><p>关于自己的反思。</p>\n<p>在面试别人的时候，也不一而足，问的问题也会不一样。比如有的人，我会问<code>如果有一天Android不行了，你怎么办呢？</code>，后来我和一个朋友争论过这个问题，他的做法是，在一开始就选一个日后绝对会用的到技术，比如后端的技术。虽然后端的技术也在变革，但是长期来看，后端的Java还是具有相当的生命力的。</p>\n<p>可是，我已经选了Android了，我就不得不面对这种问题，最后我说了一句连我自己都不信的话，Android绝对不会轻易垮掉的。其实问这个问题，我只是想知道对方究竟有没有想过这个问题，回答什么都行，只要逻辑自洽就行，但是绝对不能回答不知道，这代表你对生活得过且过，不会去想尽办法成长。</p>\n<p>当然因为自己经验有限，也会遇到一些没有接触过的东西，那我就只能判断一个大概，因为真的做过的人，是能够做到对于这个东西理解的逻辑不会出现漏洞的。</p>\n<p>也希望自己能够继续努力，多做准备，继续成长。毕竟对于公司而言，只适合能够帮到公司的人。</p>\n<p>本博客，没有做推广，不过也许会有人偶然看到这里，那么本公司依然欢迎你投递简历，这是基本的信任。</p>\n</li>\n</ul>\n","excerpt":"<p>最近这一个月，在帮公司面试Android工程师，真的是发现简历上呈现的东西，实在是信息量有限，所以这才会有面试的程序。说下这几天发生的感悟吧。<br>","more":"</p>\n<ul>\n<li><p>一定要保证你简历上的东西是真实，是你会的。</p>\n<p>讲道理，有的人连自己简历上的知识点都回答的不完整，遇到几个简历上写的精通Java，可是却连最基本的Java基础的集合都讲不清楚，实在是不知道那里来的勇气写精通的。对于筛选你来面试的人，一定是觉得你简历合适的，可是如果你乱写，浪费大家时间，你也辛苦白跑一趟，何必呢？</p>\n</li>\n<li><p>请仔细检查自己简历里面的大小写拼写以及错误。</p>\n<p>一份简历，一定是你看过很多遍的东西，如果连指望你对关乎自己工作的<code>门面</code>都检查不好，怎么指望你能够有一个好的代码规范，有一个好的工作习惯呢？甚至有可能，简历上面的东西，是你随意拼凑出来的东西，那更加不能指望你了。</p>\n</li>\n<li><p>如果自己基础不够，请在面试之前，多看看书。</p>\n<p>面试期间，有一个印象很深刻，因为我一开始问了几个基础的问题，然后说自己不会。然后我问他，请把你来之前准备过的东西描述一遍可以吗？他说，来之前没有准备。我的内心。瞬间就有点儿对这个人不看好了，因为我为了面试你，我都要做一些准备的，包括一些我可能记忆不是很深刻的知识点，我都要再去确认一遍细节，可是你居然说你没有准备，没有准备也就罢了，连基础都回答不出来，那不是浪费大家的时间吗？然后，我又挑了他简历上写的几个知识点问了下，然后他又说自己不知道，那我只有<code>礼貌地</code>请他离开了。</p>\n</li>\n<li><p>关于职业规划。</p>\n<p>其中有一个，年龄以及30岁+，可是我当我问他，想做开发组的组长，还是做普通的程序员时，他说都可以。然后问了一些基础的东西，但是没能完美回答上来，然后问了一些团队管理的问题，也回答的有问题。</p>\n<p>之后，我真的是在感慨，程序员这条路走起来并不容易。虽然都知道，大部分人无法做到top10%，但是有的人，年纪一大把却连top60%都做不到，这个时候就开始面临学习能力的下降，竞争力的下降，不得不被市场淘汰掉。然后想想自己，我该如何让自己顺利更快成长呢？</p>\n</li>\n<li><p>基础的算法能力。</p>\n<p>大学教育千奇百怪，居然会遇到有几个人，连冒泡算法都没有听过，你说你一时回答不出来，我可以假装自己原谅你，可是都没有听过，那就真的是说不过去了。</p>\n</li>\n<li><p>关于几点遗憾。</p>\n<p>其实在面试过程中，也遇到了一些虽然基础薄弱，但是学习意识很强，只是因为自己之前接触的环境，没能给自己指明一条良好的道路。有一个，在我提出问题，表示自己不会的时候，还虚心请教，我都尽我所能给出了回答，要不是因为我被要求找一个经验丰富的工程师，不然的话，我其实蛮想把这个人找来的，虽然我很礼貌表明了我的意思，真心希望他能尽快找到一家愿意收留他的人，也希望我所讲过的话，没有把他带偏。</p>\n</li>\n<li><p>关于在简历中留博客的人。</p>\n<p>关于在简历中留博客的人，是一件很冒险的事情，因为，有些人的博客实在是太过简单了。甚至有的人在2017年还把自己用eclipse写的代码贴上去，这就有点儿说不过去了，我就不说他博客里面贴的代码过于简单了，关键是一眼就能看出来贴的是eclipse上写的代码。这实在无法让人忍受。</p>\n<p>其实，很多公司招聘启事会说希望能留一个博客，是为了让对方有一个技术积累，不会这么多年只写一些简单的业务代码，能对Android的技术提出一些自己的想法，这个很关键，这能看出来一个人是否有技术追求，是否有学习能力，这才是让别人贴博客的原因，绝对不是流于形式，放一篇博客就完事了。</p>\n</li>\n<li><p>关于自己的反思。</p>\n<p>在面试别人的时候，也不一而足，问的问题也会不一样。比如有的人，我会问<code>如果有一天Android不行了，你怎么办呢？</code>，后来我和一个朋友争论过这个问题，他的做法是，在一开始就选一个日后绝对会用的到技术，比如后端的技术。虽然后端的技术也在变革，但是长期来看，后端的Java还是具有相当的生命力的。</p>\n<p>可是，我已经选了Android了，我就不得不面对这种问题，最后我说了一句连我自己都不信的话，Android绝对不会轻易垮掉的。其实问这个问题，我只是想知道对方究竟有没有想过这个问题，回答什么都行，只要逻辑自洽就行，但是绝对不能回答不知道，这代表你对生活得过且过，不会去想尽办法成长。</p>\n<p>当然因为自己经验有限，也会遇到一些没有接触过的东西，那我就只能判断一个大概，因为真的做过的人，是能够做到对于这个东西理解的逻辑不会出现漏洞的。</p>\n<p>也希望自己能够继续努力，多做准备，继续成长。毕竟对于公司而言，只适合能够帮到公司的人。</p>\n<p>本博客，没有做推广，不过也许会有人偶然看到这里，那么本公司依然欢迎你投递简历，这是基本的信任。</p>\n</li>\n</ul>"},{"title":"关于技术选型","date":"2016-04-13T12:59:36.000Z","update":"2016-04-13T12:59:36.000Z","comments":0,"_content":"## 关于技术选型\n\n对于一个初成长的互联网团队而言，如何选定自己团队需要用的技术是很关键\n1. 要兼顾团队的实力，我相信有一定量的初创团队在一开始的时候的技术实力一定是很弱的，而且也没有多余的钱去请大牛来帮你开发，如果使用外包的话，如果使用外包的最后一定会遇到一堆的坑，说不定哪天恰好在你高速发展的时候你不得不因为技术原因推到重来。那个时候就真的是欲哭无泪了。\n2. 另一方面也要考虑后面的可维护性，不然随着业务的扩展，可维护性的降低，代码迭代的越来越艰难，新功能的开发也越来越慢。现在前端、后端、移动端的选择越来越多，之所以出现这么多的选择就是为了快速提高开发效率，分工合作，高度耦合，提高网站或者app的访问速度。\n3. 不能只使用新的技术，新的技术有可能不稳定，说不定过段时间就被淘汰了。而且太过新颖的技术，网上的教程也很少，甚至有可能连Google都找不到，也不利于新的技术的学习。\n4. 还有最关键的一条，团队才是最重要的。\n<!--more-->\n\n## 关于我的选择\n\n首先我们的主要目标并不是需要一个强大的后台，主要目标是有一个前台的展示效果，足够的好看，访问速度足够的快就行了，而且，团队里面的技术人员都不是做后台的，我自己平时主要是Android程序员，虽然会Java，可是使用Java来开发后台却是一件麻烦的事情，也不利于团队协作。如果说把前端完全外包出去，一来无法保证开发进度，也无法保证开发质量，也不利于后期的维护。\n\n经过几天的思考选择，最后我选择了node.js 用到的技术有：\n- [**node.js**](http://www.imooc.com/learn/75 \"一个视频教学的例子\")  主要用于连接前端和后端，也可以单独作为后端来使用，好处就是响应速度更快，网上的教程也足够的多。\n- **express** 基于node.js的一个MVC的框架，好处就是足够的流行，教程也很多。\n- [**bootstrap**](http://www.bootcss.com/ \"bootstrap的中文教程网站\") 这是一个前端的展示页面，看了一些实例之后觉得，可以应付我们的前端需求，也很简单，上手也很容易，文杰也应该能够上手,而且最新的[bootstrap3](http://v3.bootcss.com/css/ \"关于bootstrap3的介绍\")对于移动端的支持也足够的好。\n- **mysql** 本来看到有的文章说node.js因为是使用js写的，所以对于MongoDB天然地支持，可是我看了一些文档之后觉得，现在没必要使用MongoDB，对于团队来说学习成本太高了，但是现在我对mysql更熟悉的情况下，贸然使用另一个完全不熟悉的数据库会有很大的风险。\n\n> **貌似需要用到语言有 sql，js，html，css，less**\n\n## 后记\n\n这几天就是在面临一些艰难的选择，虽然我知道在Android程序员的这条路上，我还有很多的路要走，可是现在面临新的需求却不得不去解决它。哪怕有可能我在Android这条路上目前无法做到足够的深度，不，花更多的时间就是了。\n\n作为程序员而言，最重要的是什么，那就是学习能力了，恐怕很多人都会对这句话保持赞同的。是时候继续开始新的学习了。\n","source":"_posts/about-technology-selection.md","raw":"---\ntitle: 关于技术选型\ndate: 2016-04-13 20:59:36\ntags: 随笔\nupdate: 2016-04-13 20:59:36\ncomments: false\n---\n## 关于技术选型\n\n对于一个初成长的互联网团队而言，如何选定自己团队需要用的技术是很关键\n1. 要兼顾团队的实力，我相信有一定量的初创团队在一开始的时候的技术实力一定是很弱的，而且也没有多余的钱去请大牛来帮你开发，如果使用外包的话，如果使用外包的最后一定会遇到一堆的坑，说不定哪天恰好在你高速发展的时候你不得不因为技术原因推到重来。那个时候就真的是欲哭无泪了。\n2. 另一方面也要考虑后面的可维护性，不然随着业务的扩展，可维护性的降低，代码迭代的越来越艰难，新功能的开发也越来越慢。现在前端、后端、移动端的选择越来越多，之所以出现这么多的选择就是为了快速提高开发效率，分工合作，高度耦合，提高网站或者app的访问速度。\n3. 不能只使用新的技术，新的技术有可能不稳定，说不定过段时间就被淘汰了。而且太过新颖的技术，网上的教程也很少，甚至有可能连Google都找不到，也不利于新的技术的学习。\n4. 还有最关键的一条，团队才是最重要的。\n<!--more-->\n\n## 关于我的选择\n\n首先我们的主要目标并不是需要一个强大的后台，主要目标是有一个前台的展示效果，足够的好看，访问速度足够的快就行了，而且，团队里面的技术人员都不是做后台的，我自己平时主要是Android程序员，虽然会Java，可是使用Java来开发后台却是一件麻烦的事情，也不利于团队协作。如果说把前端完全外包出去，一来无法保证开发进度，也无法保证开发质量，也不利于后期的维护。\n\n经过几天的思考选择，最后我选择了node.js 用到的技术有：\n- [**node.js**](http://www.imooc.com/learn/75 \"一个视频教学的例子\")  主要用于连接前端和后端，也可以单独作为后端来使用，好处就是响应速度更快，网上的教程也足够的多。\n- **express** 基于node.js的一个MVC的框架，好处就是足够的流行，教程也很多。\n- [**bootstrap**](http://www.bootcss.com/ \"bootstrap的中文教程网站\") 这是一个前端的展示页面，看了一些实例之后觉得，可以应付我们的前端需求，也很简单，上手也很容易，文杰也应该能够上手,而且最新的[bootstrap3](http://v3.bootcss.com/css/ \"关于bootstrap3的介绍\")对于移动端的支持也足够的好。\n- **mysql** 本来看到有的文章说node.js因为是使用js写的，所以对于MongoDB天然地支持，可是我看了一些文档之后觉得，现在没必要使用MongoDB，对于团队来说学习成本太高了，但是现在我对mysql更熟悉的情况下，贸然使用另一个完全不熟悉的数据库会有很大的风险。\n\n> **貌似需要用到语言有 sql，js，html，css，less**\n\n## 后记\n\n这几天就是在面临一些艰难的选择，虽然我知道在Android程序员的这条路上，我还有很多的路要走，可是现在面临新的需求却不得不去解决它。哪怕有可能我在Android这条路上目前无法做到足够的深度，不，花更多的时间就是了。\n\n作为程序员而言，最重要的是什么，那就是学习能力了，恐怕很多人都会对这句话保持赞同的。是时候继续开始新的学习了。\n","slug":"about-technology-selection","published":1,"updated":"2017-04-15T14:05:01.000Z","layout":"post","photos":[],"link":"","_id":"cjr66wid6000smetpemjdngzd","content":"<h2 id=\"关于技术选型\"><a href=\"#关于技术选型\" class=\"headerlink\" title=\"关于技术选型\"></a>关于技术选型</h2><p>对于一个初成长的互联网团队而言，如何选定自己团队需要用的技术是很关键</p>\n<ol>\n<li>要兼顾团队的实力，我相信有一定量的初创团队在一开始的时候的技术实力一定是很弱的，而且也没有多余的钱去请大牛来帮你开发，如果使用外包的话，如果使用外包的最后一定会遇到一堆的坑，说不定哪天恰好在你高速发展的时候你不得不因为技术原因推到重来。那个时候就真的是欲哭无泪了。</li>\n<li>另一方面也要考虑后面的可维护性，不然随着业务的扩展，可维护性的降低，代码迭代的越来越艰难，新功能的开发也越来越慢。现在前端、后端、移动端的选择越来越多，之所以出现这么多的选择就是为了快速提高开发效率，分工合作，高度耦合，提高网站或者app的访问速度。</li>\n<li>不能只使用新的技术，新的技术有可能不稳定，说不定过段时间就被淘汰了。而且太过新颖的技术，网上的教程也很少，甚至有可能连Google都找不到，也不利于新的技术的学习。</li>\n<li>还有最关键的一条，团队才是最重要的。<a id=\"more\"></a>\n</li>\n</ol>\n<h2 id=\"关于我的选择\"><a href=\"#关于我的选择\" class=\"headerlink\" title=\"关于我的选择\"></a>关于我的选择</h2><p>首先我们的主要目标并不是需要一个强大的后台，主要目标是有一个前台的展示效果，足够的好看，访问速度足够的快就行了，而且，团队里面的技术人员都不是做后台的，我自己平时主要是Android程序员，虽然会Java，可是使用Java来开发后台却是一件麻烦的事情，也不利于团队协作。如果说把前端完全外包出去，一来无法保证开发进度，也无法保证开发质量，也不利于后期的维护。</p>\n<p>经过几天的思考选择，最后我选择了node.js 用到的技术有：</p>\n<ul>\n<li><a href=\"http://www.imooc.com/learn/75\" title=\"一个视频教学的例子\" target=\"_blank\" rel=\"external\"><strong>node.js</strong></a>  主要用于连接前端和后端，也可以单独作为后端来使用，好处就是响应速度更快，网上的教程也足够的多。</li>\n<li><strong>express</strong> 基于node.js的一个MVC的框架，好处就是足够的流行，教程也很多。</li>\n<li><a href=\"http://www.bootcss.com/\" title=\"bootstrap的中文教程网站\" target=\"_blank\" rel=\"external\"><strong>bootstrap</strong></a> 这是一个前端的展示页面，看了一些实例之后觉得，可以应付我们的前端需求，也很简单，上手也很容易，文杰也应该能够上手,而且最新的<a href=\"http://v3.bootcss.com/css/\" title=\"关于bootstrap3的介绍\" target=\"_blank\" rel=\"external\">bootstrap3</a>对于移动端的支持也足够的好。</li>\n<li><strong>mysql</strong> 本来看到有的文章说node.js因为是使用js写的，所以对于MongoDB天然地支持，可是我看了一些文档之后觉得，现在没必要使用MongoDB，对于团队来说学习成本太高了，但是现在我对mysql更熟悉的情况下，贸然使用另一个完全不熟悉的数据库会有很大的风险。</li>\n</ul>\n<blockquote>\n<p><strong>貌似需要用到语言有 sql，js，html，css，less</strong></p>\n</blockquote>\n<h2 id=\"后记\"><a href=\"#后记\" class=\"headerlink\" title=\"后记\"></a>后记</h2><p>这几天就是在面临一些艰难的选择，虽然我知道在Android程序员的这条路上，我还有很多的路要走，可是现在面临新的需求却不得不去解决它。哪怕有可能我在Android这条路上目前无法做到足够的深度，不，花更多的时间就是了。</p>\n<p>作为程序员而言，最重要的是什么，那就是学习能力了，恐怕很多人都会对这句话保持赞同的。是时候继续开始新的学习了。</p>\n","excerpt":"<h2 id=\"关于技术选型\"><a href=\"#关于技术选型\" class=\"headerlink\" title=\"关于技术选型\"></a>关于技术选型</h2><p>对于一个初成长的互联网团队而言，如何选定自己团队需要用的技术是很关键</p>\n<ol>\n<li>要兼顾团队的实力，我相信有一定量的初创团队在一开始的时候的技术实力一定是很弱的，而且也没有多余的钱去请大牛来帮你开发，如果使用外包的话，如果使用外包的最后一定会遇到一堆的坑，说不定哪天恰好在你高速发展的时候你不得不因为技术原因推到重来。那个时候就真的是欲哭无泪了。</li>\n<li>另一方面也要考虑后面的可维护性，不然随着业务的扩展，可维护性的降低，代码迭代的越来越艰难，新功能的开发也越来越慢。现在前端、后端、移动端的选择越来越多，之所以出现这么多的选择就是为了快速提高开发效率，分工合作，高度耦合，提高网站或者app的访问速度。</li>\n<li>不能只使用新的技术，新的技术有可能不稳定，说不定过段时间就被淘汰了。而且太过新颖的技术，网上的教程也很少，甚至有可能连Google都找不到，也不利于新的技术的学习。</li>\n<li>还有最关键的一条，团队才是最重要的。","more":"</li>\n</ol>\n<h2 id=\"关于我的选择\"><a href=\"#关于我的选择\" class=\"headerlink\" title=\"关于我的选择\"></a>关于我的选择</h2><p>首先我们的主要目标并不是需要一个强大的后台，主要目标是有一个前台的展示效果，足够的好看，访问速度足够的快就行了，而且，团队里面的技术人员都不是做后台的，我自己平时主要是Android程序员，虽然会Java，可是使用Java来开发后台却是一件麻烦的事情，也不利于团队协作。如果说把前端完全外包出去，一来无法保证开发进度，也无法保证开发质量，也不利于后期的维护。</p>\n<p>经过几天的思考选择，最后我选择了node.js 用到的技术有：</p>\n<ul>\n<li><a href=\"http://www.imooc.com/learn/75\" title=\"一个视频教学的例子\"><strong>node.js</strong></a>  主要用于连接前端和后端，也可以单独作为后端来使用，好处就是响应速度更快，网上的教程也足够的多。</li>\n<li><strong>express</strong> 基于node.js的一个MVC的框架，好处就是足够的流行，教程也很多。</li>\n<li><a href=\"http://www.bootcss.com/\" title=\"bootstrap的中文教程网站\"><strong>bootstrap</strong></a> 这是一个前端的展示页面，看了一些实例之后觉得，可以应付我们的前端需求，也很简单，上手也很容易，文杰也应该能够上手,而且最新的<a href=\"http://v3.bootcss.com/css/\" title=\"关于bootstrap3的介绍\">bootstrap3</a>对于移动端的支持也足够的好。</li>\n<li><strong>mysql</strong> 本来看到有的文章说node.js因为是使用js写的，所以对于MongoDB天然地支持，可是我看了一些文档之后觉得，现在没必要使用MongoDB，对于团队来说学习成本太高了，但是现在我对mysql更熟悉的情况下，贸然使用另一个完全不熟悉的数据库会有很大的风险。</li>\n</ul>\n<blockquote>\n<p><strong>貌似需要用到语言有 sql，js，html，css，less</strong></p>\n</blockquote>\n<h2 id=\"后记\"><a href=\"#后记\" class=\"headerlink\" title=\"后记\"></a>后记</h2><p>这几天就是在面临一些艰难的选择，虽然我知道在Android程序员的这条路上，我还有很多的路要走，可是现在面临新的需求却不得不去解决它。哪怕有可能我在Android这条路上目前无法做到足够的深度，不，花更多的时间就是了。</p>\n<p>作为程序员而言，最重要的是什么，那就是学习能力了，恐怕很多人都会对这句话保持赞同的。是时候继续开始新的学习了。</p>"},{"title":"当前activity截图以及包含打开的dialog","date":"2016-08-28T06:08:51.000Z","comments":0,"_content":"当前activity截图以及包含打开的dialog，没有找到官方提供的截图方法，当前方法是读取要截图的view的缓存然后绘制称为图片，要保存打开的dialog，如果需要背景，那就把背景绘制到一起，就可以了。\n<!-- more -->\n```java\n\t\tView mainView = getWindow().getDecorView();\n\t\t//也可以用下面的，效果等同于上面的效果\n    //mainView= findViewById(android.R.id.content);\n    mainView.setDrawingCacheEnabled(true);\n    mainView.buildDrawingCache();\n    //没找到可以截取状态栏的办法，如果有人知道，可以告知一下本人。上面获取到的bitmap是包含顶部状态栏的，所以需要去掉。\n    int statusBarHeight = AppUtil.getStatusBarHeight(context);\n    //virtualHight是底部虚拟按键的高度，如何获取，参见我的上一篇博客，这里不进行赘述了。\n    Bitmap bitmap = Bitmap.createBitmap(mainView.getDrawingCache(),0,statusBarHeight, mainView.getWidth(),mainView.getHeight()－statusBarHeight-virtualHight);\n    //如果需要同时保存打开的dialog的截图，可以这么做，如果不需要，上面的bitmap就是当前activity的截图了。\n    View dialogView = dialog.getWindow().getDecorView();\n    int location[] = new int[2];\n    mainView.getLocationOnScreen(location);\n    int location2[] = new int[2];\n    dialogView.getLocationOnScreen(location2);\n\t\tdialogView.setDrawingCacheEnabled(true);\n    dialogView.buildDrawingCache();\n    Bitmap bitmap2 = Bitmap.createBitmap(dialogView.getDrawingCache(), 0, 0, dialogView.getWidth(), dialogView.getHeight());\n    Canvas canvas = new Canvas(bitmap);\n    canvas.drawBitmap(bitmap2, location2[0] - location[0], location2[1] - location[1], new Paint());\n    mainView.destroyDrawingCache();\n    dialogView.destroyDrawingCache();\n```\n下面是保存bitmap的方法\n```java\n\t\tpublic void saveBitmap(Bitmap bitmap,String fileName){\n\t\tFile path = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES);\n\t    File imageFile = new File(path, fileName+\".png\");\n\t    FileOutputStream fileOutPutStream = null;\n\t    try {\n\t\t\tfileOutPutStream = new FileOutputStream(imageFile);\n\t\t} catch (FileNotFoundException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\t//第一个参数是图片的类型，有三种，第二个参数是保存的图片的质量。0～100\n\t\tbitmap.compress(Bitmap.CompressFormat.PNG, 100, fileOutPutStream);\n\t\ttry {\n\t\t\tfileOutPutStream.flush();\n\t\t\tfileOutPutStream.close();\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\t//这是保存好的图片的绝对地址\n        //Uri uri = Uri.parse(\"file://\" + imageFile.getAbsolutePath());\n\t}\n```\n","source":"_posts/activity-screenshot-with-dialog.md","raw":"---\ntitle: 当前activity截图以及包含打开的dialog\ndate: 2016-08-28 14:08:51\ntags: Android\ncomments: false\n---\n当前activity截图以及包含打开的dialog，没有找到官方提供的截图方法，当前方法是读取要截图的view的缓存然后绘制称为图片，要保存打开的dialog，如果需要背景，那就把背景绘制到一起，就可以了。\n<!-- more -->\n```java\n\t\tView mainView = getWindow().getDecorView();\n\t\t//也可以用下面的，效果等同于上面的效果\n    //mainView= findViewById(android.R.id.content);\n    mainView.setDrawingCacheEnabled(true);\n    mainView.buildDrawingCache();\n    //没找到可以截取状态栏的办法，如果有人知道，可以告知一下本人。上面获取到的bitmap是包含顶部状态栏的，所以需要去掉。\n    int statusBarHeight = AppUtil.getStatusBarHeight(context);\n    //virtualHight是底部虚拟按键的高度，如何获取，参见我的上一篇博客，这里不进行赘述了。\n    Bitmap bitmap = Bitmap.createBitmap(mainView.getDrawingCache(),0,statusBarHeight, mainView.getWidth(),mainView.getHeight()－statusBarHeight-virtualHight);\n    //如果需要同时保存打开的dialog的截图，可以这么做，如果不需要，上面的bitmap就是当前activity的截图了。\n    View dialogView = dialog.getWindow().getDecorView();\n    int location[] = new int[2];\n    mainView.getLocationOnScreen(location);\n    int location2[] = new int[2];\n    dialogView.getLocationOnScreen(location2);\n\t\tdialogView.setDrawingCacheEnabled(true);\n    dialogView.buildDrawingCache();\n    Bitmap bitmap2 = Bitmap.createBitmap(dialogView.getDrawingCache(), 0, 0, dialogView.getWidth(), dialogView.getHeight());\n    Canvas canvas = new Canvas(bitmap);\n    canvas.drawBitmap(bitmap2, location2[0] - location[0], location2[1] - location[1], new Paint());\n    mainView.destroyDrawingCache();\n    dialogView.destroyDrawingCache();\n```\n下面是保存bitmap的方法\n```java\n\t\tpublic void saveBitmap(Bitmap bitmap,String fileName){\n\t\tFile path = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES);\n\t    File imageFile = new File(path, fileName+\".png\");\n\t    FileOutputStream fileOutPutStream = null;\n\t    try {\n\t\t\tfileOutPutStream = new FileOutputStream(imageFile);\n\t\t} catch (FileNotFoundException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\t//第一个参数是图片的类型，有三种，第二个参数是保存的图片的质量。0～100\n\t\tbitmap.compress(Bitmap.CompressFormat.PNG, 100, fileOutPutStream);\n\t\ttry {\n\t\t\tfileOutPutStream.flush();\n\t\t\tfileOutPutStream.close();\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\t//这是保存好的图片的绝对地址\n        //Uri uri = Uri.parse(\"file://\" + imageFile.getAbsolutePath());\n\t}\n```\n","slug":"activity-screenshot-with-dialog","published":1,"updated":"2017-04-15T14:05:24.000Z","layout":"post","photos":[],"link":"","_id":"cjr66wid7000wmetpexxcbupk","content":"<p>当前activity截图以及包含打开的dialog，没有找到官方提供的截图方法，当前方法是读取要截图的view的缓存然后绘制称为图片，要保存打开的dialog，如果需要背景，那就把背景绘制到一起，就可以了。<br><a id=\"more\"></a><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">View mainView = getWindow().getDecorView();</div><div class=\"line\"><span class=\"comment\">//也可以用下面的，效果等同于上面的效果</span></div><div class=\"line\">  <span class=\"comment\">//mainView= findViewById(android.R.id.content);</span></div><div class=\"line\">  mainView.setDrawingCacheEnabled(<span class=\"keyword\">true</span>);</div><div class=\"line\">  mainView.buildDrawingCache();</div><div class=\"line\">  <span class=\"comment\">//没找到可以截取状态栏的办法，如果有人知道，可以告知一下本人。上面获取到的bitmap是包含顶部状态栏的，所以需要去掉。</span></div><div class=\"line\">  <span class=\"keyword\">int</span> statusBarHeight = AppUtil.getStatusBarHeight(context);</div><div class=\"line\">  <span class=\"comment\">//virtualHight是底部虚拟按键的高度，如何获取，参见我的上一篇博客，这里不进行赘述了。</span></div><div class=\"line\">  Bitmap bitmap = Bitmap.createBitmap(mainView.getDrawingCache(),<span class=\"number\">0</span>,statusBarHeight, mainView.getWidth(),mainView.getHeight()－statusBarHeight-virtualHight);</div><div class=\"line\">  <span class=\"comment\">//如果需要同时保存打开的dialog的截图，可以这么做，如果不需要，上面的bitmap就是当前activity的截图了。</span></div><div class=\"line\">  View dialogView = dialog.getWindow().getDecorView();</div><div class=\"line\">  <span class=\"keyword\">int</span> location[] = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">2</span>];</div><div class=\"line\">  mainView.getLocationOnScreen(location);</div><div class=\"line\">  <span class=\"keyword\">int</span> location2[] = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">2</span>];</div><div class=\"line\">  dialogView.getLocationOnScreen(location2);</div><div class=\"line\">dialogView.setDrawingCacheEnabled(<span class=\"keyword\">true</span>);</div><div class=\"line\">  dialogView.buildDrawingCache();</div><div class=\"line\">  Bitmap bitmap2 = Bitmap.createBitmap(dialogView.getDrawingCache(), <span class=\"number\">0</span>, <span class=\"number\">0</span>, dialogView.getWidth(), dialogView.getHeight());</div><div class=\"line\">  Canvas canvas = <span class=\"keyword\">new</span> Canvas(bitmap);</div><div class=\"line\">  canvas.drawBitmap(bitmap2, location2[<span class=\"number\">0</span>] - location[<span class=\"number\">0</span>], location2[<span class=\"number\">1</span>] - location[<span class=\"number\">1</span>], <span class=\"keyword\">new</span> Paint());</div><div class=\"line\">  mainView.destroyDrawingCache();</div><div class=\"line\">  dialogView.destroyDrawingCache();</div></pre></td></tr></table></figure></p>\n<p>下面是保存bitmap的方法<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">saveBitmap</span><span class=\"params\">(Bitmap bitmap,String fileName)</span></span>&#123;</div><div class=\"line\">\tFile path = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES);</div><div class=\"line\">    File imageFile = <span class=\"keyword\">new</span> File(path, fileName+<span class=\"string\">\".png\"</span>);</div><div class=\"line\">    FileOutputStream fileOutPutStream = <span class=\"keyword\">null</span>;</div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\tfileOutPutStream = <span class=\"keyword\">new</span> FileOutputStream(imageFile);</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (FileNotFoundException e) &#123;</div><div class=\"line\">\t\te.printStackTrace();</div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"comment\">//第一个参数是图片的类型，有三种，第二个参数是保存的图片的质量。0～100</span></div><div class=\"line\">\tbitmap.compress(Bitmap.CompressFormat.PNG, <span class=\"number\">100</span>, fileOutPutStream);</div><div class=\"line\">\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\tfileOutPutStream.flush();</div><div class=\"line\">\t\tfileOutPutStream.close();</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</div><div class=\"line\">\t\te.printStackTrace();</div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"comment\">//这是保存好的图片的绝对地址</span></div><div class=\"line\">       <span class=\"comment\">//Uri uri = Uri.parse(\"file://\" + imageFile.getAbsolutePath());</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n","excerpt":"<p>当前activity截图以及包含打开的dialog，没有找到官方提供的截图方法，当前方法是读取要截图的view的缓存然后绘制称为图片，要保存打开的dialog，如果需要背景，那就把背景绘制到一起，就可以了。<br>","more":"<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">View mainView = getWindow().getDecorView();</div><div class=\"line\"><span class=\"comment\">//也可以用下面的，效果等同于上面的效果</span></div><div class=\"line\">  <span class=\"comment\">//mainView= findViewById(android.R.id.content);</span></div><div class=\"line\">  mainView.setDrawingCacheEnabled(<span class=\"keyword\">true</span>);</div><div class=\"line\">  mainView.buildDrawingCache();</div><div class=\"line\">  <span class=\"comment\">//没找到可以截取状态栏的办法，如果有人知道，可以告知一下本人。上面获取到的bitmap是包含顶部状态栏的，所以需要去掉。</span></div><div class=\"line\">  <span class=\"keyword\">int</span> statusBarHeight = AppUtil.getStatusBarHeight(context);</div><div class=\"line\">  <span class=\"comment\">//virtualHight是底部虚拟按键的高度，如何获取，参见我的上一篇博客，这里不进行赘述了。</span></div><div class=\"line\">  Bitmap bitmap = Bitmap.createBitmap(mainView.getDrawingCache(),<span class=\"number\">0</span>,statusBarHeight, mainView.getWidth(),mainView.getHeight()－statusBarHeight-virtualHight);</div><div class=\"line\">  <span class=\"comment\">//如果需要同时保存打开的dialog的截图，可以这么做，如果不需要，上面的bitmap就是当前activity的截图了。</span></div><div class=\"line\">  View dialogView = dialog.getWindow().getDecorView();</div><div class=\"line\">  <span class=\"keyword\">int</span> location[] = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">2</span>];</div><div class=\"line\">  mainView.getLocationOnScreen(location);</div><div class=\"line\">  <span class=\"keyword\">int</span> location2[] = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">2</span>];</div><div class=\"line\">  dialogView.getLocationOnScreen(location2);</div><div class=\"line\">dialogView.setDrawingCacheEnabled(<span class=\"keyword\">true</span>);</div><div class=\"line\">  dialogView.buildDrawingCache();</div><div class=\"line\">  Bitmap bitmap2 = Bitmap.createBitmap(dialogView.getDrawingCache(), <span class=\"number\">0</span>, <span class=\"number\">0</span>, dialogView.getWidth(), dialogView.getHeight());</div><div class=\"line\">  Canvas canvas = <span class=\"keyword\">new</span> Canvas(bitmap);</div><div class=\"line\">  canvas.drawBitmap(bitmap2, location2[<span class=\"number\">0</span>] - location[<span class=\"number\">0</span>], location2[<span class=\"number\">1</span>] - location[<span class=\"number\">1</span>], <span class=\"keyword\">new</span> Paint());</div><div class=\"line\">  mainView.destroyDrawingCache();</div><div class=\"line\">  dialogView.destroyDrawingCache();</div></pre></td></tr></table></figure></p>\n<p>下面是保存bitmap的方法<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">saveBitmap</span><span class=\"params\">(Bitmap bitmap,String fileName)</span></span>&#123;</div><div class=\"line\">\tFile path = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES);</div><div class=\"line\">    File imageFile = <span class=\"keyword\">new</span> File(path, fileName+<span class=\"string\">\".png\"</span>);</div><div class=\"line\">    FileOutputStream fileOutPutStream = <span class=\"keyword\">null</span>;</div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\tfileOutPutStream = <span class=\"keyword\">new</span> FileOutputStream(imageFile);</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (FileNotFoundException e) &#123;</div><div class=\"line\">\t\te.printStackTrace();</div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"comment\">//第一个参数是图片的类型，有三种，第二个参数是保存的图片的质量。0～100</span></div><div class=\"line\">\tbitmap.compress(Bitmap.CompressFormat.PNG, <span class=\"number\">100</span>, fileOutPutStream);</div><div class=\"line\">\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\tfileOutPutStream.flush();</div><div class=\"line\">\t\tfileOutPutStream.close();</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</div><div class=\"line\">\t\te.printStackTrace();</div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"comment\">//这是保存好的图片的绝对地址</span></div><div class=\"line\">       <span class=\"comment\">//Uri uri = Uri.parse(\"file://\" + imageFile.getAbsolutePath());</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>"},{"title":"android动画","date":"2016-04-14T13:45:03.000Z","update":"2016-06-02T12:44:09.000Z","comments":0,"_content":"\n关于android的动画效果一共有三种\n> + View Animtion 即 tweened animation 补间动画\n> + Drawable Animation 即 frame-by-frame animation 帧动画\n> + Property Animation 属性动画\n\n  <!--more-->\n\n 关于这几种动画一直没有搞清楚，最近折腾好久才发现自己搞错了\n\n 前两种动画效果，网上的教程很多，只放一篇吧\n <http://www.cnblogs.com/feisky/archive/2010/01/11/1644482.html>\n\n 推荐一个Android官网最新的文档的网站，面翻墙，国内人做的镜像\n <http://www.loverobots.cn/android-api/reference/android/view/animation/package-summary.html>\n\nProperty Animation的动画找到了一篇很详细的介绍的\n> * [Android属性动画完全解析(上)，初识属性动画的基本用法](http://blog.csdn.net/guolin_blog/article/details/43536355)\n* [Android属性动画完全解析(中)，ValueAnimator和ObjectAnimator的高级用法](http://blog.csdn.net/guolin_blog/article/details/43816093)\n* [Android属性动画完全解析(下)，Interpolator和ViewPropertyAnimator的用法](http://blog.csdn.net/guolin_blog/article/details/44171115)\n\n特此记录下来，免得再犯错\n\n附上`ObjectAnimator.ofFloat(Object target, String propertyName, float... values);`中第二个参数[**propertyName**](http://developer.android.com/guide/topics/graphics/prop-animation.html)的值\n\n> * ***translationX*** and ***translationY***  :\nThese properties control where the View is located as a delta from its left and top coordinates which are set by its layout container.\n* ***rotation***, ***rotationX***, and ***rotationY***  :\nThese properties control the rotation in 2D (rotation property) and 3D around the pivot point.\n* ***scaleX*** and ***scaleY***  :\nThese properties control the 2D scaling of a View around its pivot point.\n* ***pivotX*** and ***pivotY***  :\nThese properties control the location of the pivot point, around which the rotation and scaling transforms occur. By default, the pivot point is located at the center of the object.\n* ***x*** and ***y***  :\nThese are simple utility properties to describe the final location of the View in its container, as a sum of the left and top values and translationX and translationY values.\n* ***alpha***  :\nRepresents the alpha transparency on the View. This value is 1 (opaque) by default, with a value of 0 representing full transparency (not visible).\n\n##update:\n 关于上面那个值，最近发现自己错了，一直懒得改这个地方。其实那个只要你在``target`` 里面你定义一个``setXxYy(float f)`` 这个 ``xxYy`` 就可以用在 ``propertyName`` 。很简单的，还支持：\n -  **public static ObjectAnimator ofArgb (Object target, String propertyName, int... values)**\n -  **public static ObjectAnimator ofInt (Object target, String propertyName, int... values)**\n -  **public static ObjectAnimator ofMultiFloat (Object target, String propertyName, float[][] values)**\n\n还有一个是``android.animation.ValueAnimator``  ，其实``ObjectAnimator`` 也是继承自``ValueAnimator`` 的。\n- **public static ValueAnimator ofArgb (int... values)**\n-  **public static ValueAnimator ofFloat (float... values)**\n-  **public static ValueAnimator ofInt (int... values)**\n\n以上还有很多方法都是提供，值的变化的，感兴趣的可以去查看文档。\n","source":"_posts/android-animtion.md","raw":"---\ntitle: android动画\ndate: 2016-04-14 21:45:03\nupdate: 2016-06-02 20:44:09\ntags: android\ncomments: false\n---\n\n关于android的动画效果一共有三种\n> + View Animtion 即 tweened animation 补间动画\n> + Drawable Animation 即 frame-by-frame animation 帧动画\n> + Property Animation 属性动画\n\n  <!--more-->\n\n 关于这几种动画一直没有搞清楚，最近折腾好久才发现自己搞错了\n\n 前两种动画效果，网上的教程很多，只放一篇吧\n <http://www.cnblogs.com/feisky/archive/2010/01/11/1644482.html>\n\n 推荐一个Android官网最新的文档的网站，面翻墙，国内人做的镜像\n <http://www.loverobots.cn/android-api/reference/android/view/animation/package-summary.html>\n\nProperty Animation的动画找到了一篇很详细的介绍的\n> * [Android属性动画完全解析(上)，初识属性动画的基本用法](http://blog.csdn.net/guolin_blog/article/details/43536355)\n* [Android属性动画完全解析(中)，ValueAnimator和ObjectAnimator的高级用法](http://blog.csdn.net/guolin_blog/article/details/43816093)\n* [Android属性动画完全解析(下)，Interpolator和ViewPropertyAnimator的用法](http://blog.csdn.net/guolin_blog/article/details/44171115)\n\n特此记录下来，免得再犯错\n\n附上`ObjectAnimator.ofFloat(Object target, String propertyName, float... values);`中第二个参数[**propertyName**](http://developer.android.com/guide/topics/graphics/prop-animation.html)的值\n\n> * ***translationX*** and ***translationY***  :\nThese properties control where the View is located as a delta from its left and top coordinates which are set by its layout container.\n* ***rotation***, ***rotationX***, and ***rotationY***  :\nThese properties control the rotation in 2D (rotation property) and 3D around the pivot point.\n* ***scaleX*** and ***scaleY***  :\nThese properties control the 2D scaling of a View around its pivot point.\n* ***pivotX*** and ***pivotY***  :\nThese properties control the location of the pivot point, around which the rotation and scaling transforms occur. By default, the pivot point is located at the center of the object.\n* ***x*** and ***y***  :\nThese are simple utility properties to describe the final location of the View in its container, as a sum of the left and top values and translationX and translationY values.\n* ***alpha***  :\nRepresents the alpha transparency on the View. This value is 1 (opaque) by default, with a value of 0 representing full transparency (not visible).\n\n##update:\n 关于上面那个值，最近发现自己错了，一直懒得改这个地方。其实那个只要你在``target`` 里面你定义一个``setXxYy(float f)`` 这个 ``xxYy`` 就可以用在 ``propertyName`` 。很简单的，还支持：\n -  **public static ObjectAnimator ofArgb (Object target, String propertyName, int... values)**\n -  **public static ObjectAnimator ofInt (Object target, String propertyName, int... values)**\n -  **public static ObjectAnimator ofMultiFloat (Object target, String propertyName, float[][] values)**\n\n还有一个是``android.animation.ValueAnimator``  ，其实``ObjectAnimator`` 也是继承自``ValueAnimator`` 的。\n- **public static ValueAnimator ofArgb (int... values)**\n-  **public static ValueAnimator ofFloat (float... values)**\n-  **public static ValueAnimator ofInt (int... values)**\n\n以上还有很多方法都是提供，值的变化的，感兴趣的可以去查看文档。\n","slug":"android-animtion","published":1,"updated":"2017-04-15T14:05:40.000Z","layout":"post","photos":[],"link":"","_id":"cjr66wid8000zmetp2a4s5cl6","content":"<p>关于android的动画效果一共有三种</p>\n<blockquote>\n<ul>\n<li>View Animtion 即 tweened animation 补间动画</li>\n<li>Drawable Animation 即 frame-by-frame animation 帧动画</li>\n<li>Property Animation 属性动画</li>\n</ul>\n</blockquote>\n  <a id=\"more\"></a>\n<p> 关于这几种动画一直没有搞清楚，最近折腾好久才发现自己搞错了</p>\n<p> 前两种动画效果，网上的教程很多，只放一篇吧<br> <a href=\"http://www.cnblogs.com/feisky/archive/2010/01/11/1644482.html\" target=\"_blank\" rel=\"external\">http://www.cnblogs.com/feisky/archive/2010/01/11/1644482.html</a></p>\n<p> 推荐一个Android官网最新的文档的网站，面翻墙，国内人做的镜像<br> <a href=\"http://www.loverobots.cn/android-api/reference/android/view/animation/package-summary.html\" target=\"_blank\" rel=\"external\">http://www.loverobots.cn/android-api/reference/android/view/animation/package-summary.html</a></p>\n<p>Property Animation的动画找到了一篇很详细的介绍的</p>\n<blockquote>\n<ul>\n<li><a href=\"http://blog.csdn.net/guolin_blog/article/details/43536355\" target=\"_blank\" rel=\"external\">Android属性动画完全解析(上)，初识属性动画的基本用法</a></li>\n<li><a href=\"http://blog.csdn.net/guolin_blog/article/details/43816093\" target=\"_blank\" rel=\"external\">Android属性动画完全解析(中)，ValueAnimator和ObjectAnimator的高级用法</a></li>\n<li><a href=\"http://blog.csdn.net/guolin_blog/article/details/44171115\" target=\"_blank\" rel=\"external\">Android属性动画完全解析(下)，Interpolator和ViewPropertyAnimator的用法</a></li>\n</ul>\n</blockquote>\n<p>特此记录下来，免得再犯错</p>\n<p>附上<code>ObjectAnimator.ofFloat(Object target, String propertyName, float... values);</code>中第二个参数<a href=\"http://developer.android.com/guide/topics/graphics/prop-animation.html\" target=\"_blank\" rel=\"external\"><strong>propertyName</strong></a>的值</p>\n<blockquote>\n<ul>\n<li><strong><em>translationX</em></strong> and <strong><em>translationY</em></strong>  :<br>These properties control where the View is located as a delta from its left and top coordinates which are set by its layout container.</li>\n<li><strong><em>rotation</em></strong>, <strong><em>rotationX</em></strong>, and <strong><em>rotationY</em></strong>  :<br>These properties control the rotation in 2D (rotation property) and 3D around the pivot point.</li>\n<li><strong><em>scaleX</em></strong> and <strong><em>scaleY</em></strong>  :<br>These properties control the 2D scaling of a View around its pivot point.</li>\n<li><strong><em>pivotX</em></strong> and <strong><em>pivotY</em></strong>  :<br>These properties control the location of the pivot point, around which the rotation and scaling transforms occur. By default, the pivot point is located at the center of the object.</li>\n<li><strong><em>x</em></strong> and <strong><em>y</em></strong>  :<br>These are simple utility properties to describe the final location of the View in its container, as a sum of the left and top values and translationX and translationY values.</li>\n<li><strong><em>alpha</em></strong>  :<br>Represents the alpha transparency on the View. This value is 1 (opaque) by default, with a value of 0 representing full transparency (not visible).</li>\n</ul>\n</blockquote>\n<p>##update:<br> 关于上面那个值，最近发现自己错了，一直懒得改这个地方。其实那个只要你在<code>target</code> 里面你定义一个<code>setXxYy(float f)</code> 这个 <code>xxYy</code> 就可以用在 <code>propertyName</code> 。很简单的，还支持：</p>\n<ul>\n<li><strong>public static ObjectAnimator ofArgb (Object target, String propertyName, int… values)</strong></li>\n<li><strong>public static ObjectAnimator ofInt (Object target, String propertyName, int… values)</strong></li>\n<li><strong>public static ObjectAnimator ofMultiFloat (Object target, String propertyName, float[][] values)</strong></li>\n</ul>\n<p>还有一个是<code>android.animation.ValueAnimator</code>  ，其实<code>ObjectAnimator</code> 也是继承自<code>ValueAnimator</code> 的。</p>\n<ul>\n<li><strong>public static ValueAnimator ofArgb (int… values)</strong></li>\n<li><strong>public static ValueAnimator ofFloat (float… values)</strong></li>\n<li><strong>public static ValueAnimator ofInt (int… values)</strong></li>\n</ul>\n<p>以上还有很多方法都是提供，值的变化的，感兴趣的可以去查看文档。</p>\n","excerpt":"<p>关于android的动画效果一共有三种</p>\n<blockquote>\n<ul>\n<li>View Animtion 即 tweened animation 补间动画</li>\n<li>Drawable Animation 即 frame-by-frame animation 帧动画</li>\n<li>Property Animation 属性动画</li>\n</ul>\n</blockquote>","more":"<p> 关于这几种动画一直没有搞清楚，最近折腾好久才发现自己搞错了</p>\n<p> 前两种动画效果，网上的教程很多，只放一篇吧<br> <a href=\"http://www.cnblogs.com/feisky/archive/2010/01/11/1644482.html\">http://www.cnblogs.com/feisky/archive/2010/01/11/1644482.html</a></p>\n<p> 推荐一个Android官网最新的文档的网站，面翻墙，国内人做的镜像<br> <a href=\"http://www.loverobots.cn/android-api/reference/android/view/animation/package-summary.html\">http://www.loverobots.cn/android-api/reference/android/view/animation/package-summary.html</a></p>\n<p>Property Animation的动画找到了一篇很详细的介绍的</p>\n<blockquote>\n<ul>\n<li><a href=\"http://blog.csdn.net/guolin_blog/article/details/43536355\">Android属性动画完全解析(上)，初识属性动画的基本用法</a></li>\n<li><a href=\"http://blog.csdn.net/guolin_blog/article/details/43816093\">Android属性动画完全解析(中)，ValueAnimator和ObjectAnimator的高级用法</a></li>\n<li><a href=\"http://blog.csdn.net/guolin_blog/article/details/44171115\">Android属性动画完全解析(下)，Interpolator和ViewPropertyAnimator的用法</a></li>\n</ul>\n</blockquote>\n<p>特此记录下来，免得再犯错</p>\n<p>附上<code>ObjectAnimator.ofFloat(Object target, String propertyName, float... values);</code>中第二个参数<a href=\"http://developer.android.com/guide/topics/graphics/prop-animation.html\"><strong>propertyName</strong></a>的值</p>\n<blockquote>\n<ul>\n<li><strong><em>translationX</em></strong> and <strong><em>translationY</em></strong>  :<br>These properties control where the View is located as a delta from its left and top coordinates which are set by its layout container.</li>\n<li><strong><em>rotation</em></strong>, <strong><em>rotationX</em></strong>, and <strong><em>rotationY</em></strong>  :<br>These properties control the rotation in 2D (rotation property) and 3D around the pivot point.</li>\n<li><strong><em>scaleX</em></strong> and <strong><em>scaleY</em></strong>  :<br>These properties control the 2D scaling of a View around its pivot point.</li>\n<li><strong><em>pivotX</em></strong> and <strong><em>pivotY</em></strong>  :<br>These properties control the location of the pivot point, around which the rotation and scaling transforms occur. By default, the pivot point is located at the center of the object.</li>\n<li><strong><em>x</em></strong> and <strong><em>y</em></strong>  :<br>These are simple utility properties to describe the final location of the View in its container, as a sum of the left and top values and translationX and translationY values.</li>\n<li><strong><em>alpha</em></strong>  :<br>Represents the alpha transparency on the View. This value is 1 (opaque) by default, with a value of 0 representing full transparency (not visible).</li>\n</ul>\n</blockquote>\n<p>##update:<br> 关于上面那个值，最近发现自己错了，一直懒得改这个地方。其实那个只要你在<code>target</code> 里面你定义一个<code>setXxYy(float f)</code> 这个 <code>xxYy</code> 就可以用在 <code>propertyName</code> 。很简单的，还支持：</p>\n<ul>\n<li><strong>public static ObjectAnimator ofArgb (Object target, String propertyName, int… values)</strong></li>\n<li><strong>public static ObjectAnimator ofInt (Object target, String propertyName, int… values)</strong></li>\n<li><strong>public static ObjectAnimator ofMultiFloat (Object target, String propertyName, float[][] values)</strong></li>\n</ul>\n<p>还有一个是<code>android.animation.ValueAnimator</code>  ，其实<code>ObjectAnimator</code> 也是继承自<code>ValueAnimator</code> 的。</p>\n<ul>\n<li><strong>public static ValueAnimator ofArgb (int… values)</strong></li>\n<li><strong>public static ValueAnimator ofFloat (float… values)</strong></li>\n<li><strong>public static ValueAnimator ofInt (int… values)</strong></li>\n</ul>\n<p>以上还有很多方法都是提供，值的变化的，感兴趣的可以去查看文档。</p>"},{"title":"一份有用的Android混淆指南","date":"2017-03-16T05:05:43.000Z","comments":0,"_content":"做 Android开发的经常遇到需要混淆的地方，但是每次都要去找一遍也蛮麻烦的，所以在这里记录以下常用的Android混淆方式。\n<!--more-->\n```text\n#指定压缩级别\n-optimizationpasses 5\n\n#不跳过非公共的库的类成员\n-dontskipnonpubliclibraryclassmembers\n#不跳过非公共的库的类\n-dontskipnonpubliclibraryclasses\n\n#混淆时采用的算法\n-optimizations !code/simplification/arithmetic,!field/*,!class/merging/*\n\n#把混淆类中的方法名也混淆了\n-useuniqueclassmembernames\n\n#优化时允许访问并修改有修饰符的类和类的成员\n-allowaccessmodification\n\n#将文件来源重命名为“SourceFile”字符串\n-renamesourcefileattribute SourceFile\n#保留行号\n-keepattributes SourceFile,LineNumberTable\n\n#保持所有实现 Serializable 接口的类成员\n-keepclassmembers class * implements java.io.Serializable {\n    static final long serialVersionUID;\n    private static final java.io.ObjectStreamField[] serialPersistentFields;\n    private void writeObject(java.io.ObjectOutputStream);\n    private void readObject(java.io.ObjectInputStream);\n    java.lang.Object writeReplace();\n    java.lang.Object readResolve();\n    private *;\n    public *;\n    void set*(***);\n    *** get*();\n}\n\n#保持Parcelable不被混淆\n-keep class * implements android.os.Parcelable {\n   public static final android.os.Parcelable$Creator *;\n}\n#-dontwarn com.google.gson.**\n\n#Fragment不需要在AndroidManifest.xml中注册，需要额外保护下\n-keep public class * extends android.support.v4.app.Fragment\n-keep public class * extends android.app.Fragment\n#包名不混合大小写\n-dontusemixedcaseclassnames\n\n#混淆时记录日志\n-verbose\n\n#关闭预校验\n-dontpreverify\n\n#不优化输入的类文件\n-dontoptimize\n\n#保护注解\n-keepattributes *Annotation*\n\n#保持所有拥有本地方法的类名及本地方法名\n-keepclasseswithmembernames class * {\n    native <methods>;\n}\n\n#保持自定义View的get和set相关方法\n-keepclassmembers public class * extends android.view.View {\n   void set*(***);\n   *** get*();\n}\n\n#保持Activity中View及其子类入参的方法\n-keepclassmembers class * extends android.app.Activity {\n   public void *(android.view.View);\n}\n\n#枚举\n-keepclassmembers enum * {\n    **[] $VALUES;\n    public *;\n}\n\n#Parcelable\n-keepclassmembers class * implements android.os.Parcelable {\n  public static final android.os.Parcelable$Creator CREATOR;\n}\n\n#R文件的静态成员\n-keepclassmembers class **.R$* {\n    public static <fields>;\n}\n\n-dontwarn android.support.**\n\n#keep相关注解\n-keep class android.support.annotation.Keep\n\n-keep @android.support.annotation.Keep class * {*;}\n\n-keepclasseswithmembers class * {\n    @android.support.annotation.Keep <methods>;\n}\n\n-keepclasseswithmembers class * {\n    @android.support.annotation.Keep <fields>;\n}\n\n-keepclasseswithmembers class * {\n    @android.support.annotation.Keep <init>(...);\n}\n\n#retrofit 混淆\n-dontnote retrofit2.Platform\n-dontnote retrofit2.Platform$IOS$MainThreadExecutor\n-dontwarn retrofit2.Platform$Java8\n-keepattributes Signature\n-keepattributes Exceptions\n-dontwarn okio.**\n#Picasso 混淆\n-dontwarn com.squareup.okhttp.**\n\n#alipay\n-keep class com.alipay.android.app.IAlixPay{*;}\n-keep class com.alipay.android.app.IAlixPay$Stub{*;}\n-keep class com.alipay.android.app.IRemoteServiceCallback{*;}\n-keep class com.alipay.android.app.IRemoteServiceCallback$Stub{*;}\n-keep class com.alipay.sdk.app.PayTask{ public *;}\n-keep class com.alipay.sdk.app.AuthTask{ public *;}\n-dontwarn android.net.**\n-keep class android.net.SSLCertificateSocketFactory{*;}\n```\n","source":"_posts/android-proguard-rules.md","raw":"---\ntitle: 一份有用的Android混淆指南\ndate: 2017-03-16 13:05:43\ntags: android\ncomments: false\n---\n做 Android开发的经常遇到需要混淆的地方，但是每次都要去找一遍也蛮麻烦的，所以在这里记录以下常用的Android混淆方式。\n<!--more-->\n```text\n#指定压缩级别\n-optimizationpasses 5\n\n#不跳过非公共的库的类成员\n-dontskipnonpubliclibraryclassmembers\n#不跳过非公共的库的类\n-dontskipnonpubliclibraryclasses\n\n#混淆时采用的算法\n-optimizations !code/simplification/arithmetic,!field/*,!class/merging/*\n\n#把混淆类中的方法名也混淆了\n-useuniqueclassmembernames\n\n#优化时允许访问并修改有修饰符的类和类的成员\n-allowaccessmodification\n\n#将文件来源重命名为“SourceFile”字符串\n-renamesourcefileattribute SourceFile\n#保留行号\n-keepattributes SourceFile,LineNumberTable\n\n#保持所有实现 Serializable 接口的类成员\n-keepclassmembers class * implements java.io.Serializable {\n    static final long serialVersionUID;\n    private static final java.io.ObjectStreamField[] serialPersistentFields;\n    private void writeObject(java.io.ObjectOutputStream);\n    private void readObject(java.io.ObjectInputStream);\n    java.lang.Object writeReplace();\n    java.lang.Object readResolve();\n    private *;\n    public *;\n    void set*(***);\n    *** get*();\n}\n\n#保持Parcelable不被混淆\n-keep class * implements android.os.Parcelable {\n   public static final android.os.Parcelable$Creator *;\n}\n#-dontwarn com.google.gson.**\n\n#Fragment不需要在AndroidManifest.xml中注册，需要额外保护下\n-keep public class * extends android.support.v4.app.Fragment\n-keep public class * extends android.app.Fragment\n#包名不混合大小写\n-dontusemixedcaseclassnames\n\n#混淆时记录日志\n-verbose\n\n#关闭预校验\n-dontpreverify\n\n#不优化输入的类文件\n-dontoptimize\n\n#保护注解\n-keepattributes *Annotation*\n\n#保持所有拥有本地方法的类名及本地方法名\n-keepclasseswithmembernames class * {\n    native <methods>;\n}\n\n#保持自定义View的get和set相关方法\n-keepclassmembers public class * extends android.view.View {\n   void set*(***);\n   *** get*();\n}\n\n#保持Activity中View及其子类入参的方法\n-keepclassmembers class * extends android.app.Activity {\n   public void *(android.view.View);\n}\n\n#枚举\n-keepclassmembers enum * {\n    **[] $VALUES;\n    public *;\n}\n\n#Parcelable\n-keepclassmembers class * implements android.os.Parcelable {\n  public static final android.os.Parcelable$Creator CREATOR;\n}\n\n#R文件的静态成员\n-keepclassmembers class **.R$* {\n    public static <fields>;\n}\n\n-dontwarn android.support.**\n\n#keep相关注解\n-keep class android.support.annotation.Keep\n\n-keep @android.support.annotation.Keep class * {*;}\n\n-keepclasseswithmembers class * {\n    @android.support.annotation.Keep <methods>;\n}\n\n-keepclasseswithmembers class * {\n    @android.support.annotation.Keep <fields>;\n}\n\n-keepclasseswithmembers class * {\n    @android.support.annotation.Keep <init>(...);\n}\n\n#retrofit 混淆\n-dontnote retrofit2.Platform\n-dontnote retrofit2.Platform$IOS$MainThreadExecutor\n-dontwarn retrofit2.Platform$Java8\n-keepattributes Signature\n-keepattributes Exceptions\n-dontwarn okio.**\n#Picasso 混淆\n-dontwarn com.squareup.okhttp.**\n\n#alipay\n-keep class com.alipay.android.app.IAlixPay{*;}\n-keep class com.alipay.android.app.IAlixPay$Stub{*;}\n-keep class com.alipay.android.app.IRemoteServiceCallback{*;}\n-keep class com.alipay.android.app.IRemoteServiceCallback$Stub{*;}\n-keep class com.alipay.sdk.app.PayTask{ public *;}\n-keep class com.alipay.sdk.app.AuthTask{ public *;}\n-dontwarn android.net.**\n-keep class android.net.SSLCertificateSocketFactory{*;}\n```\n","slug":"android-proguard-rules","published":1,"updated":"2017-07-10T07:01:20.000Z","layout":"post","photos":[],"link":"","_id":"cjr66wid90012metp3usnylyj","content":"<p>做 Android开发的经常遇到需要混淆的地方，但是每次都要去找一遍也蛮麻烦的，所以在这里记录以下常用的Android混淆方式。<br><a id=\"more\"></a><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div></pre></td><td class=\"code\"><pre><div class=\"line\">#指定压缩级别</div><div class=\"line\">-optimizationpasses 5</div><div class=\"line\"></div><div class=\"line\">#不跳过非公共的库的类成员</div><div class=\"line\">-dontskipnonpubliclibraryclassmembers</div><div class=\"line\">#不跳过非公共的库的类</div><div class=\"line\">-dontskipnonpubliclibraryclasses</div><div class=\"line\"></div><div class=\"line\">#混淆时采用的算法</div><div class=\"line\">-optimizations !code/simplification/arithmetic,!field/*,!class/merging/*</div><div class=\"line\"></div><div class=\"line\">#把混淆类中的方法名也混淆了</div><div class=\"line\">-useuniqueclassmembernames</div><div class=\"line\"></div><div class=\"line\">#优化时允许访问并修改有修饰符的类和类的成员</div><div class=\"line\">-allowaccessmodification</div><div class=\"line\"></div><div class=\"line\">#将文件来源重命名为“SourceFile”字符串</div><div class=\"line\">-renamesourcefileattribute SourceFile</div><div class=\"line\">#保留行号</div><div class=\"line\">-keepattributes SourceFile,LineNumberTable</div><div class=\"line\"></div><div class=\"line\">#保持所有实现 Serializable 接口的类成员</div><div class=\"line\">-keepclassmembers class * implements java.io.Serializable &#123;</div><div class=\"line\">    static final long serialVersionUID;</div><div class=\"line\">    private static final java.io.ObjectStreamField[] serialPersistentFields;</div><div class=\"line\">    private void writeObject(java.io.ObjectOutputStream);</div><div class=\"line\">    private void readObject(java.io.ObjectInputStream);</div><div class=\"line\">    java.lang.Object writeReplace();</div><div class=\"line\">    java.lang.Object readResolve();</div><div class=\"line\">    private *;</div><div class=\"line\">    public *;</div><div class=\"line\">    void set*(***);</div><div class=\"line\">    *** get*();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#保持Parcelable不被混淆</div><div class=\"line\">-keep class * implements android.os.Parcelable &#123;</div><div class=\"line\">   public static final android.os.Parcelable$Creator *;</div><div class=\"line\">&#125;</div><div class=\"line\">#-dontwarn com.google.gson.**</div><div class=\"line\"></div><div class=\"line\">#Fragment不需要在AndroidManifest.xml中注册，需要额外保护下</div><div class=\"line\">-keep public class * extends android.support.v4.app.Fragment</div><div class=\"line\">-keep public class * extends android.app.Fragment</div><div class=\"line\">#包名不混合大小写</div><div class=\"line\">-dontusemixedcaseclassnames</div><div class=\"line\"></div><div class=\"line\">#混淆时记录日志</div><div class=\"line\">-verbose</div><div class=\"line\"></div><div class=\"line\">#关闭预校验</div><div class=\"line\">-dontpreverify</div><div class=\"line\"></div><div class=\"line\">#不优化输入的类文件</div><div class=\"line\">-dontoptimize</div><div class=\"line\"></div><div class=\"line\">#保护注解</div><div class=\"line\">-keepattributes *Annotation*</div><div class=\"line\"></div><div class=\"line\">#保持所有拥有本地方法的类名及本地方法名</div><div class=\"line\">-keepclasseswithmembernames class * &#123;</div><div class=\"line\">    native &lt;methods&gt;;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#保持自定义View的get和set相关方法</div><div class=\"line\">-keepclassmembers public class * extends android.view.View &#123;</div><div class=\"line\">   void set*(***);</div><div class=\"line\">   *** get*();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#保持Activity中View及其子类入参的方法</div><div class=\"line\">-keepclassmembers class * extends android.app.Activity &#123;</div><div class=\"line\">   public void *(android.view.View);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#枚举</div><div class=\"line\">-keepclassmembers enum * &#123;</div><div class=\"line\">    **[] $VALUES;</div><div class=\"line\">    public *;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#Parcelable</div><div class=\"line\">-keepclassmembers class * implements android.os.Parcelable &#123;</div><div class=\"line\">  public static final android.os.Parcelable$Creator CREATOR;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#R文件的静态成员</div><div class=\"line\">-keepclassmembers class **.R$* &#123;</div><div class=\"line\">    public static &lt;fields&gt;;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">-dontwarn android.support.**</div><div class=\"line\"></div><div class=\"line\">#keep相关注解</div><div class=\"line\">-keep class android.support.annotation.Keep</div><div class=\"line\"></div><div class=\"line\">-keep @android.support.annotation.Keep class * &#123;*;&#125;</div><div class=\"line\"></div><div class=\"line\">-keepclasseswithmembers class * &#123;</div><div class=\"line\">    @android.support.annotation.Keep &lt;methods&gt;;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">-keepclasseswithmembers class * &#123;</div><div class=\"line\">    @android.support.annotation.Keep &lt;fields&gt;;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">-keepclasseswithmembers class * &#123;</div><div class=\"line\">    @android.support.annotation.Keep &lt;init&gt;(...);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#retrofit 混淆</div><div class=\"line\">-dontnote retrofit2.Platform</div><div class=\"line\">-dontnote retrofit2.Platform$IOS$MainThreadExecutor</div><div class=\"line\">-dontwarn retrofit2.Platform$Java8</div><div class=\"line\">-keepattributes Signature</div><div class=\"line\">-keepattributes Exceptions</div><div class=\"line\">-dontwarn okio.**</div><div class=\"line\">#Picasso 混淆</div><div class=\"line\">-dontwarn com.squareup.okhttp.**</div><div class=\"line\"></div><div class=\"line\">#alipay</div><div class=\"line\">-keep class com.alipay.android.app.IAlixPay&#123;*;&#125;</div><div class=\"line\">-keep class com.alipay.android.app.IAlixPay$Stub&#123;*;&#125;</div><div class=\"line\">-keep class com.alipay.android.app.IRemoteServiceCallback&#123;*;&#125;</div><div class=\"line\">-keep class com.alipay.android.app.IRemoteServiceCallback$Stub&#123;*;&#125;</div><div class=\"line\">-keep class com.alipay.sdk.app.PayTask&#123; public *;&#125;</div><div class=\"line\">-keep class com.alipay.sdk.app.AuthTask&#123; public *;&#125;</div><div class=\"line\">-dontwarn android.net.**</div><div class=\"line\">-keep class android.net.SSLCertificateSocketFactory&#123;*;&#125;</div></pre></td></tr></table></figure></p>\n","excerpt":"<p>做 Android开发的经常遇到需要混淆的地方，但是每次都要去找一遍也蛮麻烦的，所以在这里记录以下常用的Android混淆方式。<br>","more":"<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div></pre></td><td class=\"code\"><pre><div class=\"line\">#指定压缩级别</div><div class=\"line\">-optimizationpasses 5</div><div class=\"line\"></div><div class=\"line\">#不跳过非公共的库的类成员</div><div class=\"line\">-dontskipnonpubliclibraryclassmembers</div><div class=\"line\">#不跳过非公共的库的类</div><div class=\"line\">-dontskipnonpubliclibraryclasses</div><div class=\"line\"></div><div class=\"line\">#混淆时采用的算法</div><div class=\"line\">-optimizations !code/simplification/arithmetic,!field/*,!class/merging/*</div><div class=\"line\"></div><div class=\"line\">#把混淆类中的方法名也混淆了</div><div class=\"line\">-useuniqueclassmembernames</div><div class=\"line\"></div><div class=\"line\">#优化时允许访问并修改有修饰符的类和类的成员</div><div class=\"line\">-allowaccessmodification</div><div class=\"line\"></div><div class=\"line\">#将文件来源重命名为“SourceFile”字符串</div><div class=\"line\">-renamesourcefileattribute SourceFile</div><div class=\"line\">#保留行号</div><div class=\"line\">-keepattributes SourceFile,LineNumberTable</div><div class=\"line\"></div><div class=\"line\">#保持所有实现 Serializable 接口的类成员</div><div class=\"line\">-keepclassmembers class * implements java.io.Serializable &#123;</div><div class=\"line\">    static final long serialVersionUID;</div><div class=\"line\">    private static final java.io.ObjectStreamField[] serialPersistentFields;</div><div class=\"line\">    private void writeObject(java.io.ObjectOutputStream);</div><div class=\"line\">    private void readObject(java.io.ObjectInputStream);</div><div class=\"line\">    java.lang.Object writeReplace();</div><div class=\"line\">    java.lang.Object readResolve();</div><div class=\"line\">    private *;</div><div class=\"line\">    public *;</div><div class=\"line\">    void set*(***);</div><div class=\"line\">    *** get*();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#保持Parcelable不被混淆</div><div class=\"line\">-keep class * implements android.os.Parcelable &#123;</div><div class=\"line\">   public static final android.os.Parcelable$Creator *;</div><div class=\"line\">&#125;</div><div class=\"line\">#-dontwarn com.google.gson.**</div><div class=\"line\"></div><div class=\"line\">#Fragment不需要在AndroidManifest.xml中注册，需要额外保护下</div><div class=\"line\">-keep public class * extends android.support.v4.app.Fragment</div><div class=\"line\">-keep public class * extends android.app.Fragment</div><div class=\"line\">#包名不混合大小写</div><div class=\"line\">-dontusemixedcaseclassnames</div><div class=\"line\"></div><div class=\"line\">#混淆时记录日志</div><div class=\"line\">-verbose</div><div class=\"line\"></div><div class=\"line\">#关闭预校验</div><div class=\"line\">-dontpreverify</div><div class=\"line\"></div><div class=\"line\">#不优化输入的类文件</div><div class=\"line\">-dontoptimize</div><div class=\"line\"></div><div class=\"line\">#保护注解</div><div class=\"line\">-keepattributes *Annotation*</div><div class=\"line\"></div><div class=\"line\">#保持所有拥有本地方法的类名及本地方法名</div><div class=\"line\">-keepclasseswithmembernames class * &#123;</div><div class=\"line\">    native &lt;methods&gt;;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#保持自定义View的get和set相关方法</div><div class=\"line\">-keepclassmembers public class * extends android.view.View &#123;</div><div class=\"line\">   void set*(***);</div><div class=\"line\">   *** get*();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#保持Activity中View及其子类入参的方法</div><div class=\"line\">-keepclassmembers class * extends android.app.Activity &#123;</div><div class=\"line\">   public void *(android.view.View);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#枚举</div><div class=\"line\">-keepclassmembers enum * &#123;</div><div class=\"line\">    **[] $VALUES;</div><div class=\"line\">    public *;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#Parcelable</div><div class=\"line\">-keepclassmembers class * implements android.os.Parcelable &#123;</div><div class=\"line\">  public static final android.os.Parcelable$Creator CREATOR;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#R文件的静态成员</div><div class=\"line\">-keepclassmembers class **.R$* &#123;</div><div class=\"line\">    public static &lt;fields&gt;;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">-dontwarn android.support.**</div><div class=\"line\"></div><div class=\"line\">#keep相关注解</div><div class=\"line\">-keep class android.support.annotation.Keep</div><div class=\"line\"></div><div class=\"line\">-keep @android.support.annotation.Keep class * &#123;*;&#125;</div><div class=\"line\"></div><div class=\"line\">-keepclasseswithmembers class * &#123;</div><div class=\"line\">    @android.support.annotation.Keep &lt;methods&gt;;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">-keepclasseswithmembers class * &#123;</div><div class=\"line\">    @android.support.annotation.Keep &lt;fields&gt;;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">-keepclasseswithmembers class * &#123;</div><div class=\"line\">    @android.support.annotation.Keep &lt;init&gt;(...);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">#retrofit 混淆</div><div class=\"line\">-dontnote retrofit2.Platform</div><div class=\"line\">-dontnote retrofit2.Platform$IOS$MainThreadExecutor</div><div class=\"line\">-dontwarn retrofit2.Platform$Java8</div><div class=\"line\">-keepattributes Signature</div><div class=\"line\">-keepattributes Exceptions</div><div class=\"line\">-dontwarn okio.**</div><div class=\"line\">#Picasso 混淆</div><div class=\"line\">-dontwarn com.squareup.okhttp.**</div><div class=\"line\"></div><div class=\"line\">#alipay</div><div class=\"line\">-keep class com.alipay.android.app.IAlixPay&#123;*;&#125;</div><div class=\"line\">-keep class com.alipay.android.app.IAlixPay$Stub&#123;*;&#125;</div><div class=\"line\">-keep class com.alipay.android.app.IRemoteServiceCallback&#123;*;&#125;</div><div class=\"line\">-keep class com.alipay.android.app.IRemoteServiceCallback$Stub&#123;*;&#125;</div><div class=\"line\">-keep class com.alipay.sdk.app.PayTask&#123; public *;&#125;</div><div class=\"line\">-keep class com.alipay.sdk.app.AuthTask&#123; public *;&#125;</div><div class=\"line\">-dontwarn android.net.**</div><div class=\"line\">-keep class android.net.SSLCertificateSocketFactory&#123;*;&#125;</div></pre></td></tr></table></figure></p>"},{"title":"docker安装的问题","comments":0,"date":"2017-07-18T02:48:42.000Z","_content":"# Windows7\n<!--more-->\n![这里写图片描述](http://img.blog.csdn.net/20170627104103415?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\nWindows7安装docker的时候，困扰了好久没有安装成功，今天终于试成功了。\n之前一直报boot2docker找不到，仔细检查了报错的日志信息，其中一条就是下载boot2docker失败，但是我明确自己是下载成功的，最后直接把``boot2docker.iso`` 放到 ```C:\\Users\\user\\.boot2docker``` 就好了，然后就可以直接运行了。\n\n# Windows10\nwin10，直接在官网上下载Docker安装就好了，但是遇到一个问题，就是IDEA始终无法通过API URL：``tcp://localhost:2375`` 连上本地的docker，后来查遍论坛github才知道是下面的原因，打上勾就好了，真的是一大坑。\n![这里写图片描述](http://img.blog.csdn.net/20170718104004533?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n# macOS10.10.3\nmacOS10.10.3以上也是一样的，直接安装[docker](https://store.docker.com/editions/community/docker-ce-desktop-mac)就好了。\n\n# Intellij Idea\nIntellij Idea使用docker的话，需要安装docker integration插件。\n\n以上，没什么特别的内容只是自己在安装过程踩过的一个坑。\n","source":"_posts/docker-install.md","raw":"---\ntitle: docker安装的问题\ntags: docker\ncomments: false\ndate: 2017-07-18 10:48:42\n---\n# Windows7\n<!--more-->\n![这里写图片描述](http://img.blog.csdn.net/20170627104103415?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\nWindows7安装docker的时候，困扰了好久没有安装成功，今天终于试成功了。\n之前一直报boot2docker找不到，仔细检查了报错的日志信息，其中一条就是下载boot2docker失败，但是我明确自己是下载成功的，最后直接把``boot2docker.iso`` 放到 ```C:\\Users\\user\\.boot2docker``` 就好了，然后就可以直接运行了。\n\n# Windows10\nwin10，直接在官网上下载Docker安装就好了，但是遇到一个问题，就是IDEA始终无法通过API URL：``tcp://localhost:2375`` 连上本地的docker，后来查遍论坛github才知道是下面的原因，打上勾就好了，真的是一大坑。\n![这里写图片描述](http://img.blog.csdn.net/20170718104004533?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n# macOS10.10.3\nmacOS10.10.3以上也是一样的，直接安装[docker](https://store.docker.com/editions/community/docker-ce-desktop-mac)就好了。\n\n# Intellij Idea\nIntellij Idea使用docker的话，需要安装docker integration插件。\n\n以上，没什么特别的内容只是自己在安装过程踩过的一个坑。\n","slug":"docker-install","published":1,"updated":"2017-07-18T02:50:12.000Z","layout":"post","photos":[],"link":"","_id":"cjr66wida0014metp4zy595oo","content":"<h1 id=\"Windows7\"><a href=\"#Windows7\" class=\"headerlink\" title=\"Windows7\"></a>Windows7</h1><a id=\"more\"></a>\n<p><img src=\"http://img.blog.csdn.net/20170627104103415?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"><br>Windows7安装docker的时候，困扰了好久没有安装成功，今天终于试成功了。<br>之前一直报boot2docker找不到，仔细检查了报错的日志信息，其中一条就是下载boot2docker失败，但是我明确自己是下载成功的，最后直接把<code>boot2docker.iso</code> 放到 <code>C:\\Users\\user\\.boot2docker</code> 就好了，然后就可以直接运行了。</p>\n<h1 id=\"Windows10\"><a href=\"#Windows10\" class=\"headerlink\" title=\"Windows10\"></a>Windows10</h1><p>win10，直接在官网上下载Docker安装就好了，但是遇到一个问题，就是IDEA始终无法通过API URL：<code>tcp://localhost:2375</code> 连上本地的docker，后来查遍论坛github才知道是下面的原因，打上勾就好了，真的是一大坑。<br><img src=\"http://img.blog.csdn.net/20170718104004533?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"></p>\n<h1 id=\"macOS10-10-3\"><a href=\"#macOS10-10-3\" class=\"headerlink\" title=\"macOS10.10.3\"></a>macOS10.10.3</h1><p>macOS10.10.3以上也是一样的，直接安装<a href=\"https://store.docker.com/editions/community/docker-ce-desktop-mac\" target=\"_blank\" rel=\"external\">docker</a>就好了。</p>\n<h1 id=\"Intellij-Idea\"><a href=\"#Intellij-Idea\" class=\"headerlink\" title=\"Intellij Idea\"></a>Intellij Idea</h1><p>Intellij Idea使用docker的话，需要安装docker integration插件。</p>\n<p>以上，没什么特别的内容只是自己在安装过程踩过的一个坑。</p>\n","excerpt":"<h1 id=\"Windows7\"><a href=\"#Windows7\" class=\"headerlink\" title=\"Windows7\"></a>Windows7</h1>","more":"<p><img src=\"http://img.blog.csdn.net/20170627104103415?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"><br>Windows7安装docker的时候，困扰了好久没有安装成功，今天终于试成功了。<br>之前一直报boot2docker找不到，仔细检查了报错的日志信息，其中一条就是下载boot2docker失败，但是我明确自己是下载成功的，最后直接把<code>boot2docker.iso</code> 放到 <code>C:\\Users\\user\\.boot2docker</code> 就好了，然后就可以直接运行了。</p>\n<h1 id=\"Windows10\"><a href=\"#Windows10\" class=\"headerlink\" title=\"Windows10\"></a>Windows10</h1><p>win10，直接在官网上下载Docker安装就好了，但是遇到一个问题，就是IDEA始终无法通过API URL：<code>tcp://localhost:2375</code> 连上本地的docker，后来查遍论坛github才知道是下面的原因，打上勾就好了，真的是一大坑。<br><img src=\"http://img.blog.csdn.net/20170718104004533?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"></p>\n<h1 id=\"macOS10-10-3\"><a href=\"#macOS10-10-3\" class=\"headerlink\" title=\"macOS10.10.3\"></a>macOS10.10.3</h1><p>macOS10.10.3以上也是一样的，直接安装<a href=\"https://store.docker.com/editions/community/docker-ce-desktop-mac\">docker</a>就好了。</p>\n<h1 id=\"Intellij-Idea\"><a href=\"#Intellij-Idea\" class=\"headerlink\" title=\"Intellij Idea\"></a>Intellij Idea</h1><p>Intellij Idea使用docker的话，需要安装docker integration插件。</p>\n<p>以上，没什么特别的内容只是自己在安装过程踩过的一个坑。</p>"},{"title":"ALAYNE","date":"2016-04-06T12:59:24.000Z","comments":0,"_content":"## ALAYNE\\--EXCERPT FROM THE WINDS OF WINTER\n\nShe was reading her little lord a tale of the Winged Knight when Mya Stone came knocking on the door of his bedchamber, clad in boots and riding leathers and smelling strongly of the stable. Mya had straw in her hair and a scowl on her face. That scowl comes of having Mychel Redfort near, Alayne knew.\n\n“Your lordship,” Mya informed Lord Robert, “Lady Waynwood’s banners have been seen an hour down the road. She will be here soon, with your cousin Harry. Will you want to greet them?”\n\nWhy did she have to mention Harry? Alayne thought. We will never get Sweetrobin out of bed now. The boy slapped a pillow. “Send them away. I never asked them here.”\n<!-- more -->\nMya looked nonplussed. No one in the Vale was better at handling a mule, but lordlings were another matter. “They were invited,” she said uncertainly, “for the tourney. I don’t… “\n\nAlayne closed her book.  “Thank you, Mya. Let me talk with Lord Robert, if you would.”\n\nRelief plain on her face, Mya fled without another word.\n\n“I hate that Harry,” Sweetrobin said when she was gone. “He calls me cousin, but he’s just waiting for me to die so he can take the Eyrie. He thinks I don’t know, but I do.”\n\n“Your lordship should not believe such nonsense,” Alayne said. “I’m sure Ser Harrold loves you well.” And if the gods are good, he will love me too. Her tummy gave a little flutter.\n\n“He doesn’t,” Lord Robert insisted. “He wants my father’s castle, that’s all, so he pretends.” The boy clutched the blanket to his pimply chest. “I don’t want you to marry him, Alayne. I am the Lord of the Eyrie, and I forbid it.” He sounded as if he were about to cry. “You should marry me instead. We could sleep in the same bed every night, and you could read me stories.”\n\nNo man can wed me so long as my dwarf husband still lives somewhere in this world. Queen Cersei had collected the head of a dozen dwarfs, Petyr claimed, but none were Tyrion’s. “Sweetrobin, you must not say such things. You are the Lord of the Eyrie and Defender of the Vale, and you must wed a highborn lady and father a son to sit in the High Hall of House Arryn after you are gone.”\n\nRobert wiped his nose. “But I want — “\n\nShe put a finger to his lips. “I know what you want, but it cannot be. I am no fit wife for you. I am bastard born.”\n\n“I don’t care. I love you best of anyone. “\n\nYou are such a little fool.  “Your lords bannermen will care. Some call my father upjumped and ambitious. If you were to take me to wife, they would say that he made you do it, that it was no will of yours. The Lords Declarant might take arms against him once again, and he and I should both be put to death.”\n\n“I wouldn’t let them hurt you!” Lord Robert said. “If they try I will make them all fly.” His hand began to tremble.\n\nAlayne stroked his fingers. “There, my Sweetrobin, be still now.” When the shaking passed, she said, “You must have a proper wife, a trueborn maid of noble birth.”\n\n“No. I want to marry you, Alayne.”\n\nOnce your lady mother intended that very thing, but I was trueborn then, and noble. “My lord is kind to say so.” Alayne smoothed his hair. Lady Lysa had never let the servants touch it, and after she had died Robert had suffered terrible shaking fits whenever anyone came near him with a blade, so it had been allowed to grow until it tumbled over his round shoulders and halfway down his flabby white chest. He does have pretty hair.  If the gods are good and he lives long enough to wed, his wife will admire his hair, surely.  That much she will love about him. “Any child of ours would be baseborn. Only a trueborn child of House Arryn can displace Ser Harrold as your heir. My father will find a proper wife for you, some highborn girl much prettier than me. You’ll hunt and hawk together, and she’ll give you her favor to wear in tournaments. Before long, you will have forgotten me entirely.”\n\n“I won’t!”\n\n“You will. You must.” Her voice was firm, but gentle.\n\n“The Lord of the Eyrie can do as he likes. Can’t I still love you, even if I have to marry her? Ser Harrold has a common woman. Benjicot says she’s carrying his bastard.”\n\nBenjicot should learn to keep his fool’s mouth shut. “Is that what you would have from me? A bastard?” She pulled her fingers from his grasp. “Would you dishonor me that way?”\n\nThe boy looked stricken. “No. I never meant — “\n\nAlayne stood. “If it please my lord, I must go and find my father. Someone needs to greet Lady Waynwood.” Before her little lord could find the words to protest, she gave him a quick curtsy and fled the bedchamber, sweeping down the hall and across a covered bridge to the Lord Protector’s apartments.\n\nWhen she had left Petyr Baelish that morning he had been breaking his fast with old Oswell who had arrived last night from Gulltown on a lathered horse. She hoped they might still be talking, but Petyr’s solar proved empty. Someone had left a window open and a stack of papers had blown onto the floor. The sun was slanting through the thick yellow windows, and dust motes danced in the light like tiny golden insects. Though snow had blanketed the heights of the Giant’s Lance above, below the mountain the autumn lingered and winter wheat was ripening in the fields.  Outside the window she could hear the laughter of the washerwomen at the well, the din of steel on steel from the ward where the knights were at their drills. Good sounds.\n\nAlayne loved it here. She felt alive again, for the first since her father… since Lord Eddard Stark had died.\n\nShe closed the window, gathered up the fallen papers, and stacked them on the table. One was a list of the competitors. Four-and-sixty knights had been invited to vie for places amongst Lord Robert Arryn’s  new Brotherhood of Winged Knights, and four­ and-sixty knights had come to tilt for the right to wear falcon’s wings upon their warhelms and guard their lord.\n\nThe competitors came from all over the Vale, from the mountain valleys and the coast, from Gulltown and the Bloody Gate, even the Three Sisters. Though a few were promised, only three were wed; the eight victors would be expected to spend the next three years at Lord Robert’s side, as his own personal guard (Alayne had suggested seven, like the Kingsguard, but Sweetrobin had insisted that he must have more knights than King Tommen), so older men with wives and children had not been invited.\n\nAnd they came, Alayne thought proudly. They all came.\n\nIt had fallen out just as Petyr said it would, the day the ravens flew. “They’re young, eager, hungry for adventure and renown. Lysa would not let them go to war. This is the next best thing. A chance to serve their lord and prove their prowess. They will come. Even Harry the Heir.” He had smoothed her hair and kissed her forehead. “What a clever daughter you are.”\n\nIt was clever. The tourney, the prizes, the winged knights, it had all been her own notion. Lord Robert’s mother had filled him full of fears, but he always took courage from the tales she read him of Ser Artys Arryn, the Winged Knight of legend, founder of his line. Why not surround him with Winged Knights?  She had thought one night, after Sweetrobin had finally drifted off to sleep. His own Kingsguard, to keep him safe and make him brave. And no sooner did she tell Petyr her idea than he went out and made it happen. He will want to be there to greet Ser Harrold. Where could he have gone?\n\nAlayne swept down the tower stairs to enter the pillared gallery at the back of the Great Hall. Below her, serving men were setting up trestle tables for the evening feast, while their wives and daughters swept up the old rushes and scattered fresh ones. Lord Nestor was showing Lady Waxley his prize tapestries, with their scenes of hunt and chase. The same panels had once hung in the Red Keep of King’s Landing, when Robert sat the Iron Throne. Joffrey had them taken down and they had languished in some cellar until Petyr Baelish arranged for them to be brought to the Vale as a gift for Nestor Royce. Not only were the hangings beautiful, but the High Steward delighted in telling anyone who’d listen that they had once belonged to a king.\n\nPetyr was not in the Great Hall. Alayne crossed the gallery and descended the stair built into the thick west wall, to come out in the inner ward, where the jousting would be held. Viewing stands had raised for all those who had come to watch, with four long tilting barriers in between. Lord Nestor’s men were painting the barriers with whitewash, draping the stands with bright banners, and hanging shields on the gate the competitors would pass through when they made their entrance.\n\nAt the north end of the yard, three quintains had been set up, and some of the competitors were riding at them. Alayne knew them by their shields; the bells of Belmore, green vipers for the Lynderlys, the red sledge of Breakstone, House Tollett’s black and grey pily. Ser Mychel Redfort set one quintain spinning with a perfectly placed blow. He was one of those favored to win wings.\n\nPetyr was not at the quintains, nor anywhere in the yard, but as she turned to go a woman’s voice called out. “Alayne!” cried Myranda Royce, from a carved stone bench beneath a beech tree, where she was seated between two men. She looked in need of rescue. Smiling, Alayne walked toward her friend.\n\nMyranda was wearing a grey woolen dress, a green hooded cloak, and a rather desperate look. On either side of her sat a knight. The one on her right had a grizzled beard, a bald head, and a belly that spilled over his swordbelt where his lap should have been. The one on her left was no more than eighteen, and skinny as a spear. His ginger-colored whiskers only partially served to disguise the angry red pimples that dotted his face.\n\nThe bald knight wore a dark blue surcoat emblazoned with a huge pair of pink lips. The pimply-gingerlad countered with nine white seagulls on a field of brown, which marked him for a Shett of Gulltown. He was staring so intently at Myranda’s breasts that he hardly noticed Alayne until Myranda rose to hug her. “Thank you, thank you, thank you ” Randa whispered in her ear, before she turned to say, “Sers, may I present you the Lady Alayne Stone?”\n\n“The Lord Protector’s daughter,” the bald knight announced, all hearty gallantry. He rose ponderously. “And full as lovely as the tales told of her, I see.”\n\nNot to be outdone, the pimply knight hopped up and said,  “Ser Ossifer speaks truly, you are the most beautiful maid in all the Seven Kingdoms.” It might have been a sweeter courtesy had he not addressed it to her chest.\n\n“And have you seen all those maids yourself, ser?” Alayne asked him. “You are young to be so widely travelled.”\n\nHe blushed, which only made his pimples look angrier.  “No, my lady.   I am from Gulltown.”\n\nAnd I am not, though Alayne was born there. She would need to be careful around this one. “I remember Gulltown fondly,” she told him, with a smile as vague as it was pleasant. To Myranda she said, “Do you know where my father’s gotten to, perchance?”\n\n“Let me take you to him, my lady.”\n\n“I do hope you will forgive me for depriving you of Lady Myranda’s company,” Alayne told the knights. She did not wait for a reply, but took the older girl arm-in-arm and drew her away from the bench. Only when they were out of earshot did she whisper,  “Do you really know where my father is?”\n\n“Of course not. Walk faster, my new suitors may be following.” Myranda made a face. “Ossifer Lipps is the dullest knight in the Vale, but Uther Shett aspires to his laurels. I am praying they fight a duel for my hand, and kill each other.”\n\nAlayne giggled. “Surely Lord Nestor would not seriously entertain a suit from such men.”\n\n“Oh, he might. My lord father is annoyed with me for killing my last husband and putting him to all this trouble.”\n\n“It was not your fault he died.”\n\n“There was no one else in the bed that I recall.”\n\nAlayne could not help but shutter. Myranda’s husband had died when he was making love with her. “Those Sistermen who came in yesterday were gallant,” she said, to change the subject. “If you don’t like Ser Ossifer or Ser Uther, marry one of them instead. I thought the youngest one was very handsome.”\n\n“The one in the sealskin cloak?” Randa said, incredulous.\n\n“One of his brothers, then.”\n\nMyranda rolled her eyes. “They’re from the Sisters. Did you ever know a Sisterman who could joust? They clean their swords with codfish oil and wash in tubs of cold seawater.”\n\n“Well,” Alayne said, “at least they’re clean.”\n\n“Some of them have webs between their toes. I’d sooner marry Lord Petyr. Then I’d be your mother. How little is his finger, I ask you?”\n\nAlayne did not dignify that question with an answer. “Lady Waynwood will be here soon, with her sons.”\n\n“Is that a promise or a threat?” Myranda said. “The first Lady Waynwood must have been a mare, I think. How else to explain why all the Waynwood men are horse-faced? If I were ever to wed a Waynwood, he would have to swear a vow to don his helm whenever he wished to fuck me, and keep the visor closed.” She gave Alayne a pinch on the arm. “My Harry will be with them, though. I notice that you left him out. I shall never forgive you for stealing him away from me. He’s the boy I want to marry.”\n\n“The betrothal was my father’s doing,”  Alayne protested, as she had a hundred times before.  She is only teasing, she told herself… but behind the japes, she could hear the hurt.\n\nMyranda stopped to gaze across the yard at the knights at their practice. “Now there’s the very sort of husband I need.”\n\nA few feet away, two knights were fighting with blunted practice swords. Their blades crashed together twice, then slipped past each other only to be blocked by upraised shields, but the bigger man gave ground at the impact. Alayne could not see the front of his shield from where she stood, but his attacker bore three ravens in flight, each clutching a red heart in its claws. Three hearts and three ravens.\n\nShe knew right then how the fight would end.\n\nA few moments later and the big man sprawled dazed in the dust with his helm askew. When his squire undid the fastenings to bare his head, there was blood trickling down his scalp. If the swords had not been blunted, there would be brains as well. That last head blow had been so hard Alayne had winced in sympathy when it fell. Myranda Royce considered the victor thoughtfully.  “Do you think if I asked nicely Ser Lyn would kill my suitors for me?”\n\n“He might, for a plump bag of gold.” Ser Lyn Corbray was forever desperately short of coin, all the Vale knew that.\n\n“Alas, all I have is a plump pair of teats. Though with Ser Lyn, a plump sausage under my skirts would serve me better.”\n\nAlayne’s giggle drew Corbray’s attention. He handed his shield to his loutish squire, removed his helm and quilted coif.  “Ladies.” His long brown hair was plastered to his brow by sweat.\n\n“Well struck, Ser Lyn,” Alayne called out. “Though I fear you’ve knocked poor Ser Owen insensible.”\n\nCorbray glanced back to where his foe was being helped from the yard by his squire. “He had no sense to start with, or he should not have tried me.”\n\nThere is truth in that, Alayne thought, but some demon of mischief was in her that morning, so she gave Ser Lyn a thrust of her own. Smiling sweetly, she said, “My lord father tells me your brother’s new wife is with child.”\n\nCorbray gave her a dark look. “Lyonel sends his regrets. He remains at Heart’s Home with his peddler’s daughter, watching her belly swell as if he were the first man who ever got a wench pregnant.”\n\nOh, that’s an open wound, thought Alayne. Lyonel Corbray’s first wife had given him nothing but a frail, sickly babe who died in infancy, and during all those years Ser Lyn had remained his brother’s heir. When the poor woman finally died, however, Petyr Baelish had stepped in and brokered a new marriage for Lord Corbray. The second Lady Corbray was sixteen, the daughter of a wealthy Gulltown merchant, but she had come with an immense dowry, and men said she was a tall, strapping, healthy girl, with big breasts and good, wide hips. And fertile too, it seems.\n\n“We are all praying that the Mother grants Lady Corbray an easy labor and a healthy child,” said Myranda.\n\nAlayne could not help herself. She smiled and said, “My father is always pleased to be of service to one of Lord Robert’s leal bannermen. I’m sure he would be most delighted to help broker a marriage for you as well, Ser Lyn.”\n\n“How kind of him.” Corbray’s lips drew back in something that might have been meant as a smile, though it gave Alayne a chill. “But what need have I for heirs when I am landless and like to remain so, thanks to our Lord Protector?  No.  Tell your lord father I need none of his brood mares.”\n\nThe venom in his voice was so thick that for a moment she almost forgot that Lyn Corbray was actually her father’s catspaw, bought and paid for. Or was he?  Perhaps, instead of being Petyr’s man pretending to be Petyr’s foe, he was actually his foe pretending to be his man pretending to be his foe.\n\nJust thinking about it was enough to make her head spin. Alayne turned abruptly from the yard… and bumped into a short, sharp-faced man with a brush of orange hair who had come up behind her.  His hand shot out and caught her arm before she could fall.   “My lady.  My pardons if I took you unawares.”\n\n“The fault was mine. I did not see you standing there.”\n\n“We mice are quiet creatures.” Ser Shadrich was so short that he might have been taken for a squire, but his face belonged to a much older man. She saw long leagues in the wrinkles at the corner of his mouth, old battles in the scar beneath his ear, and a hardness behind the eyes that no boy would ever have. This was a man grown. Even Randa overtopped him, though.\n\n“Will you be seeking wings?” the Royce girl said.\n\n“A mouse with wings would be a silly sight.”\n\n“Perhaps you will try the melee instead?” Alayne suggested.  The melee was an afterthought, a sop for all the brothers, uncles, fathers, and friends who had accompanied the competitors to the Gates of the Moon to see them win their silver wings, but there would be prizes for the champions, and a chance to win ransoms.\n\n“A good melee is all a hedge knight can hope for, unless he stumbles on a bag of dragons. And that’s not likely, is it?”\n\n“I suppose not. But now you must excuse us, ser, we need to find my lord father. “\n\nHorns sounded from atop the wall.  “Too late,” Myranda said. “They’re here.  We shall need to do the honors by ourselves.”  She grinned.   “Last one to the gate must marry Uther Shett.”\n\nThey made a race of it, dashing headlong across the yard and past the stables, skirts flapping, whilst knights and serving men alike looked on, and pigs and chickens scattered before them. It was most unladylike, but Alayne sound found herself laughing. For just a little while, as she ran, she forget who she was, and where, and found herself remembering bright cold days at Winterfell, when she would race through Winterfell with her friend Jeyne Poole, with Arya running after them trying to keep up.\n\nBy the time they arrived at the gatehouse, both of them were red-faced and panting. Myranda had lost her cloak somewhere along the way. They were just in time. The portcullis had been raised, and a column of riders twenty strong were passing underneath. At their head rode Anya Waynwood, Lady of Ironoaks, stern and slim, her grey-brown hair bound up in a scarf. Her riding cloak was heavy green wool trimmed with brown fur, and clasped at the throat by a niello brooch in the shape of the broken wheel of her House.\n\nMyranda Royce stepped forward and sketched a curtsy. “Lady Anya. Welcome to the Gates of the Moon.”\n\n“Lady Myranda. Lady Alayne.” Anya Waynwood inclined her head to each of them in turn. “It is good of you to greet us. Allow me to present my grandson, Ser Roland Waynwood.”  She nodded at the knight who had spoken.  “And this is my youngest son, Ser Wallace Waynwood.  And of course my ward, Ser Harrold Hardyng.”\n\nHarry the Heir, Alayne thought. My husband-to-be, if he will have me.  A sudden terror filled her.  She wondered if her face was red. Don’t stare at him, she reminded herself, don’t stare, don’t gape, don’t gawk.  Look away. Her hair must be a frightful mess after all that running.  It took all her will to stop herself from trying to tuck the loose strands back into place. Never mind your stupid hair.  Your hair doesn’t matter.  It’s him that matters.  Him, and the Waynwoods.\n\nSer Roland was the oldest of the three, though no more than five-and-twenty. He was taller and more muscular than Ser Wallace, but both were long-faced and lantern-jawed, with stringy brown hair and pinched noses.  Horsefaced and homely, Alayne thought.\n\nHarry, though…\n\nMy Harry.  My lord, my lover, my betrothed.\n\nSer Harrold Hardyng looked every inch a lord-in-waiting; clean-limbed and handsome, straight as a lance, hard with muscle. Men old enough to have known Jon Arryn in his youth said Ser Harrold had his look, she knew. He had a mop of sandy blond hair, pale blue eyes, an aquiline nose. Joffrey was comely too, though, she reminded herself.   A comely monster, that’s what he was.  Little Lord Tyrion was kinder, twisted though he was.\n\nHarry was staring at her. He knows who I am, she realized, and he does not seem pleased to see me. It was only then that she took note of his heraldry. Though his surcoat and horse trappings were patterned in the red-and-white diamonds of House Hardyng, his shield was quartered. The arms of Hardyng and Waynwood were displayed in the first and third quarters, respectively, but in the second and fourth quarters he bore the moon-and-falcon of House Arryn, sky blue and cream. Sweetrobin will not like that.\n\nSer Wallace said, “Are we the l-l-last?”\n\n“You are, sers,” replied Myranda Royce, taking absolutely no notice of his stammer.\n\n“Wh-wh-when will the t-t-tilts commence?”\n\n“Oh, soon, I pray,” said Randa. “Some of the competitors have been here for almost a moon’s turn, partaking of my father’s meat and mead. All good fellows, and very brave… but they do eat rather a lot.”\n\nThe Waynwoods laughed, and even Harry the Heir cracked a thin smile. “It was snowing in the passes, else we would have been here sooner,” said Lady Anya.\n\n“Had we known such beauty awaited us at the Gates, we would have flown,” Ser Roland said.  Though his words were addressed to Myranda Royce, he smiled at Alayne as he said them.\n\n“To fly you would need wings,” Randa replied, “and there are some knights here who might have a thing to say concerning that.”\n\n“I look forward to a spirited discussion.” Ser Roland swung down from his horse, turned to Alayne, and smiled.  “I had heard that Lord Littlefinger’s daughter was fair of face and full of grace, but no one ever told me that she was a thief.”\n\n“You wrong me, ser. I am no thief!”\n\nSer Roland placed his hand over his heart. “Then how do you explain this hole in my chest, from where you stole my heart?”\n\n“He is only t-teasing you, my lady,” stammered Ser Wallace. “My n-n-nephew never had a h-h-heart.”\n\n“The Waynwood wheel has a broken spoke, and we have my nuncle here.” Ser Roland gave Wallace a whap behind the ear.  “Squires should be quiet when knights are speaking.”\n\nSer Wallace reddened.  “I am no more a s-squire, my lady.  My n-nephew knows full well that I was k-k-kni-k-k-kni –“\n\n“Dubbed?” Alayne suggested gently.\n\n“Dubbed,” said Wallace Waynwood, gratefully.\n\nRobb would be his age, if he were still alive, she could not help but think, but Robb died a king, and this is just a boy.\n\n“My lord father has assigned you rooms in the East Tower,” Lady Myranda was telling Lady Waynwood, “but I fear your knights will need to share a bed. The Gates of the Moon were never meant to house so many noble visitors.”\n\n“You are in the Falcon Tower, Ser Harrold,” Alayne put in. Far away from Sweetrobin. That was intentional, she knew. Petyr Baelish did not leave such things to chance. “If it please you, I will show you to your chambers myself.” This time her eyes met Harry’s.  She smiled just for him, and said a silent prayer to the Maiden. Please, he doesn’t need to love me, just make him like me, just a little, that would be enough for now.\n\nSer Harrold looked down at her coldly. “Why should it please me to be escorted anywhere by Littlefinger’s bastard?”\n\nAll three Waynwoods looked at him askance. “You are a guest here, Harry,” Lady Anya reminded him, in a frosty voice. “See that you remember that.”\n\nA lady’s armor is her courtesy. Alayne could feel the blood rushing to her face. No tears, she prayed. Please, please, I must not cry. “As you wish, ser. And now if you will excuse me, Littlefinger’s bastard must find her lord father and let him know that you have come, so we can begin the tourney on the morrow.”  And may your horse stumble, Harry the Heir, so you fall on your stupid head in your first tilt. She showed the Waynwoods a stone face as they blurted out awkward apologies for their companion. When they were done she turned and fled.\n\nNear the keep, she ran headlong into Ser Lothor Brune and almost knocked him off his feet. “Harry the Heir?  Harry the Arse, I say. He’s just some upjumped squire.”\n\nAlayne was so grateful that she hugged him. “Thank you. Have you seen my father, ser?”\n\n“Down in the vaults, ” Ser Lothar said, “inspecting Lord Nestor’s granaries with Lord Grafton and Lord Belmore.”\n\nThe vaults were large and dark and filthy. Alayne lit a taper and clutched her skirt as she made the descent. Near the bottom, she heard Lord Grafton’s booming voice, and followed.”The merchants are clamoring to buy, and the lords are clamoring to sell,” the Gulltowner was saying when she found them.  Though not a tall man, Grafton was wide, with thick arms and shoulders.  His hair was a dirty blond mop.  “How am I to stop that, my lord?”\n\n“Post guardsmen on the docks. If need be, seize the ships. How does not matter, so long as no food leaves the Vale. “\n\n“These prices, though,”  protested fat Lord Belmore,”  these prices are more than fair.”\n\n“You say more than fair, my lord.  I say less than we would wish.  Wait.  If need be, buy the food yourself and keep it stored.  Winter is coming.  Prices must go higher.”\n\n“Perhaps,”  said Belmore, doubtfully.\n\n“Bronze Yohn will not wait, ”  Grafton complained.  “He need not ship through Gulltown, he has his own ports.  Whilst we are hoarding our harvest, Royce and the other Lords Declarant will turn theirs into silver, you may be sure of that.”\n\n“Let us hope so,”  said Petyr.  “When their granaries are empty, they will need every scrap of that silver to buy sustenance from us.  And now if you will excuse me, my lord, it would seem my daughter has need of me.”\n\n“Lady Alayne,” Lord Grafton said. “You look bright-eyed this morning.”\n\n“You are kind to say so, my lord. Father, I am sorry to disturb you, but I thought you would want to know that the Waynwoods have arrived.”\n\n“And is Ser Harrold with them?”\n\nHorrible Ser Harrold.  “ He is.”\n\nLord Belmore laughed. “I never thought Royce would let him come. Is he blind, or merely stupid?”\n\n“He is honorable.  Sometimes it amounts to the same thing.  If he denied the lad the chance to prove himself, it could create a rift between them, so why not let him tilt?  The boy is nowise skilled enough to win a place amongst the Winged Knights.”\n\n“I suppose not,” said Belmore, grudgingly.  Lord Grafton kissed Alayne on the hand, and the two lords went off, leaving her alone with her lord father.\n\n“Come,” Petyr said, “walk with me.”  He took her by the arm and led her deeper into the vaults, past an empty dungeon.  “And how was your first meeting with Harry the Heir?”\n\n“He’s horrible.”\n\n“The world is full of horrors, sweet.  By now you ought to know that.  You’ve seen enough of them.”\n\n“Yes,” she said, “but why must he be so cruel?  He called me your bastard.  Right in the yard, in front of everyone.”\n\n“So far as he knows, that’s who you are.  This betrothal was never his idea, and Bronze Yohn has no doubt warned him against my wiles.  You are my daughter.  He does not trust you, and he believes that you’re beneath him.”\n\n“Well, I’m not.  He may think he’s some great knight, but Ser Lothor says he’s just some upjumped squire.”\n\nPetyr put his arm around her.  “So he is, but he is Robert’s heir as well.  Bringing Harry here was the first step in our plan, but now we need to keep him, and only you can do that.  He has a weakness for a pretty face, and whose face is prettier than yours?  Charm him.  Entrance him.  Bewitch him.”\n\n“I don’t know how,”  she said miserably.\n\n“Oh, I think you do,” said Littlefinger, with one of those smiles that did not reach his eyes.  “You will be the most beautiful woman in the hall tonight, as lovely as your lady mother at your age.  I cannot seat you on the dais, but you’ll have a place of honor above the salt and underneath a wall sconce.  The fire will be shining in your hair, so everyone will see how fair of face you are.  Keep a good long spoon on hand to beat the squires off, sweetling.  You will not want green boys underfoot when the knights come round to beg you for your favor.”\n\n“Who would ask to wear a bastard’s favor?”\n\n“Harry, if he has the wits the gods gave a goose… but do not give it to him.  Choose some other gallant, and favor him instead.  You do not want to seem too eager.”\n\n“No,” Alayne said.\n\n“Lady Waynwood will insist that Harry dance with you, I can promise you that much.  That will be your chance. Smile at the boy.  Touch him when you speak.  Tease him, to pique his pride.  If he seems to be responding, tell him that you are feeling faint, and ask him to take you outside for a breath of fresh air.  No knight could refuse such a request from a fair maiden.”\n\n“Yes,” she said, “but he thinks that I’m a bastard.”\n\n“A beautiful bastard, and the Lord Protector’s daughter.”  Petyr drew her close and kissed her on both cheeks.  “The night belongs to you, sweetling, Remember that, always.”\n\n“I’ll try, father,” she said.\n\nThe feast proved to be everything her father promised.\n\nSixty-four dishes were served, in honor of the sixty-four competitors who had come so far to contest for silver wings before their lord. From the rivers and the lakes came pike and trout and salmon, from the seas crabs and cod and herring. Ducks there were, and capons, peacocks in their plumage and swans in almond milk. Suckling pigs were served up crackling with apples in their mouths, and three huge aurochs were roasted whole above firepits in the castle yard, since they were too big to get through the kitchen doors. Loaves of hot bread filled the trestle tables in Lord Nestor’s hall, and massive wheels of cheese were brought up from the vaults.  The butter was fresh-churned, and there were leeks and carrots, roasted onions, beets, turnips, parsnips.  And best of all, Lord Nestor’s cooks prepared a splendid subtlety, a lemon cake in the shape of the Giant’s Lance, twelve feet tall and adorned with an Eyrie made of sugar.\n\nFor me, Alayne thought, as they wheeled it out.  Sweetrobin loved lemon cakes too, but only after she told him that they were her favorites.  The cake had required every lemon in the Vale, but Petyr had promised that he would send to Dorne for more.\n\nThere were gifts as well, splendid gifts.  Each of the competitors received a cloak of cloth-of-silver and a lapis brooch in the shape of a pair of falcon’s wings.  Fine steel daggers were given to the brothers, fathers, and friends who had come to watch them tilt.  For their mothers, sisters, and ladies fair there were bolts of silk and Myrish lace.\n\n“Lord Nestor has an open hand,” Alayne heard Ser Edmund Breakstone say.  “An open hand and a little finger,” Lady Waynwood replied, with a nod toward Petyr Baelish.   Breakstone was not slow to take her meaning.  The true source of this largesse was not Lord Nestor, but the Lord Protector.\n\nWhen the last course had been served and cleared, the tables were lifted from their trestles to clear the floor for dancing, and musicians were brought in.\n\n“Are there no singers?” asked Ben Coldwater.\n\n“The little lord cannot abide them,” Ser Lymond Lynderly replied.  “Not since Marillion.”\n\n“Ah… that was the man who murdered Lady Lysa, yes?”\n\nAlayne spoke up. “His singing pleased her greatly, and she showed him too much favor, perhaps.  When she wed my father he went mad and pushed her out the Moon Door.  Lord Robert has hated singing ever since.  He is still fond of music, though.”\n\n“As am I,” Coldwater said.  Rising, he offered Alayne his hand.  “Would you honor me with this dance, my lady?”\n\n“You’re very kind,” she said, as he led her to the floor.\n\nHe was her first partner of the evening, but far from the last.  Just as Petyr had promised, the young knights flocked around her, vying for her favor.  After Ben came Andrew Tollett, handsome Ser Byron, red-nosed Ser Morgarth, and Ser Shadrich the Mad Mouse.  Then Ser Albar Royce, Myranda’s stout dull brother and Lord Nestor’s heir.  She danced with all three Sunderlands, none of whom had webs between their fingers, though she could not vouch for their toes.  Uther Shett appeared to pay her slimy compliments as he trod upon her feet, but Ser Targon the Halfwild proved to be the soul of courtesy.  After that Ser Roland Waynwood swept her up and made her laugh with mocking comments about half the other knights in the hall.  His uncle Wallace took a turn as well and tried to do the same, but the words would not come.  Alayne finally took pity on him and began to chatter happily, to spare him the embarrassment.  When the dance was done she excused herself, and went back to her place to have a drink of wine.\n\nAnd there he stood, Harry the Heir himself; tall, handsome, scowling.  “Lady Alayne. May I partner you in this dance?”\n\nShe considered for a moment. “No. I don’t think so.”\n\nColor rose to his cheeks.  “I was unforgiveably rude to you in the yard.  You must forgive me.”\n\n“Must?” She tossed her hair, took a sip of wine, made him wait.  “How can you forgive someone who is unforgiveably rude?  Will you explain that to me, ser?”\n\nSer Harrold looked confused. “Please.  One dance.”\n\nCharm him.  Entrance him.  Bewitch him.  “If you insist.”\n\nHe nodded, offered his arm, led her out onto the floor.  As they waited for the music to resume, Alayne glanced at the dais, where Lord Robert sat staring at them.  Please, she prayed, don’t let him start to twitch and shake.  Not here.  Not now.  Maester Coleman would have made certain that he drank a strong dose of sweetmilk before the feast, but even so.\n\nThen the musicians took up a tune, and she was dancing.\n\nSay something, she urged herself.  You will never make Ser Harry love you if you don’t have the courage to talk him.  Should she tell him what a good dancer he was?  No, he’s probably heard that a dozen times tonight.  Besides, Petyr said that I should not seem eager.  Instead she said, “I have heard that you are about to be a father.”  It was not something most girls would say to their almost-betrothed, but she wanted to see if Ser Harrold would lie.\n\n“For the second time. My daughter Alys is two years old.”\n\nYour bastard daughter Alys, Alayne thought, but what she said was, “That one had a different mother, though.”\n\n“Yes. Cissy was a pretty thing when I tumbled her, but childbirth left her as fat as a cow, so Lady Anya arranged for her to marry one of her men-at-arms.  It is different with Saffron.”\n\n“Saffron?”  Alayne tried not to laugh.  “Truly?”\n\nSer Harrold had the grace to blush.  “Her father says she is more precious to him than gold.  He’s rich, the richest man in Gulltown.  A fortune in spices.”\n\n“What will you name the babe?” she asked.  “Cinnamon if she’s a girl?  Cloves if he’s a boy?”\n\nThat almost made him stumble.  “My lady japes.”\n\n“Oh, no.”  Petyr will howl when I tell him what I said.\n\n“Saffron is very beautiful, I’ll have you know.  Tall and slim, with big brown eyes and hair like honey.”\n\nAlayne raised her head.  “More beautiful than me?”\n\nSer Harrold studied her face. “You are comely enough, I grant you.  When Lady Anya first told me of this match, I was afraid that you might look like your father.”\n\n“Little pointy beard and all?”  Alayne laughed.\n\n“I never meant… “\n\n“I hope you joust better than you talk.”\n\nFor a moment he looked shocked.  But as the song was ending, he burst into a laugh.  “No one told me you were clever.”\n\nHe has good teeth, she thought, straight and white.  And when he smiles, he has the nicest dimples.  She ran one finger down his cheek.  “Should we ever wed, you’ll have to send Saffron back to her father.  I’ll be all the spice you’ll want.”\n\nHe grinned.  “I will hold you to that promise, my lady.  Until that day, may I wear your favor in the tourney?”\n\n“You may not.  It is promised to… another.”  She was not sure who as yet, but she knew she would find someone.\n","source":"_posts/ALAYNE.md","raw":"---\ntitle: ALAYNE\ndate: 2016-04-06 20:59:24\ntags: 冰与火之歌\ncomments: false\n---\n## ALAYNE\\--EXCERPT FROM THE WINDS OF WINTER\n\nShe was reading her little lord a tale of the Winged Knight when Mya Stone came knocking on the door of his bedchamber, clad in boots and riding leathers and smelling strongly of the stable. Mya had straw in her hair and a scowl on her face. That scowl comes of having Mychel Redfort near, Alayne knew.\n\n“Your lordship,” Mya informed Lord Robert, “Lady Waynwood’s banners have been seen an hour down the road. She will be here soon, with your cousin Harry. Will you want to greet them?”\n\nWhy did she have to mention Harry? Alayne thought. We will never get Sweetrobin out of bed now. The boy slapped a pillow. “Send them away. I never asked them here.”\n<!-- more -->\nMya looked nonplussed. No one in the Vale was better at handling a mule, but lordlings were another matter. “They were invited,” she said uncertainly, “for the tourney. I don’t… “\n\nAlayne closed her book.  “Thank you, Mya. Let me talk with Lord Robert, if you would.”\n\nRelief plain on her face, Mya fled without another word.\n\n“I hate that Harry,” Sweetrobin said when she was gone. “He calls me cousin, but he’s just waiting for me to die so he can take the Eyrie. He thinks I don’t know, but I do.”\n\n“Your lordship should not believe such nonsense,” Alayne said. “I’m sure Ser Harrold loves you well.” And if the gods are good, he will love me too. Her tummy gave a little flutter.\n\n“He doesn’t,” Lord Robert insisted. “He wants my father’s castle, that’s all, so he pretends.” The boy clutched the blanket to his pimply chest. “I don’t want you to marry him, Alayne. I am the Lord of the Eyrie, and I forbid it.” He sounded as if he were about to cry. “You should marry me instead. We could sleep in the same bed every night, and you could read me stories.”\n\nNo man can wed me so long as my dwarf husband still lives somewhere in this world. Queen Cersei had collected the head of a dozen dwarfs, Petyr claimed, but none were Tyrion’s. “Sweetrobin, you must not say such things. You are the Lord of the Eyrie and Defender of the Vale, and you must wed a highborn lady and father a son to sit in the High Hall of House Arryn after you are gone.”\n\nRobert wiped his nose. “But I want — “\n\nShe put a finger to his lips. “I know what you want, but it cannot be. I am no fit wife for you. I am bastard born.”\n\n“I don’t care. I love you best of anyone. “\n\nYou are such a little fool.  “Your lords bannermen will care. Some call my father upjumped and ambitious. If you were to take me to wife, they would say that he made you do it, that it was no will of yours. The Lords Declarant might take arms against him once again, and he and I should both be put to death.”\n\n“I wouldn’t let them hurt you!” Lord Robert said. “If they try I will make them all fly.” His hand began to tremble.\n\nAlayne stroked his fingers. “There, my Sweetrobin, be still now.” When the shaking passed, she said, “You must have a proper wife, a trueborn maid of noble birth.”\n\n“No. I want to marry you, Alayne.”\n\nOnce your lady mother intended that very thing, but I was trueborn then, and noble. “My lord is kind to say so.” Alayne smoothed his hair. Lady Lysa had never let the servants touch it, and after she had died Robert had suffered terrible shaking fits whenever anyone came near him with a blade, so it had been allowed to grow until it tumbled over his round shoulders and halfway down his flabby white chest. He does have pretty hair.  If the gods are good and he lives long enough to wed, his wife will admire his hair, surely.  That much she will love about him. “Any child of ours would be baseborn. Only a trueborn child of House Arryn can displace Ser Harrold as your heir. My father will find a proper wife for you, some highborn girl much prettier than me. You’ll hunt and hawk together, and she’ll give you her favor to wear in tournaments. Before long, you will have forgotten me entirely.”\n\n“I won’t!”\n\n“You will. You must.” Her voice was firm, but gentle.\n\n“The Lord of the Eyrie can do as he likes. Can’t I still love you, even if I have to marry her? Ser Harrold has a common woman. Benjicot says she’s carrying his bastard.”\n\nBenjicot should learn to keep his fool’s mouth shut. “Is that what you would have from me? A bastard?” She pulled her fingers from his grasp. “Would you dishonor me that way?”\n\nThe boy looked stricken. “No. I never meant — “\n\nAlayne stood. “If it please my lord, I must go and find my father. Someone needs to greet Lady Waynwood.” Before her little lord could find the words to protest, she gave him a quick curtsy and fled the bedchamber, sweeping down the hall and across a covered bridge to the Lord Protector’s apartments.\n\nWhen she had left Petyr Baelish that morning he had been breaking his fast with old Oswell who had arrived last night from Gulltown on a lathered horse. She hoped they might still be talking, but Petyr’s solar proved empty. Someone had left a window open and a stack of papers had blown onto the floor. The sun was slanting through the thick yellow windows, and dust motes danced in the light like tiny golden insects. Though snow had blanketed the heights of the Giant’s Lance above, below the mountain the autumn lingered and winter wheat was ripening in the fields.  Outside the window she could hear the laughter of the washerwomen at the well, the din of steel on steel from the ward where the knights were at their drills. Good sounds.\n\nAlayne loved it here. She felt alive again, for the first since her father… since Lord Eddard Stark had died.\n\nShe closed the window, gathered up the fallen papers, and stacked them on the table. One was a list of the competitors. Four-and-sixty knights had been invited to vie for places amongst Lord Robert Arryn’s  new Brotherhood of Winged Knights, and four­ and-sixty knights had come to tilt for the right to wear falcon’s wings upon their warhelms and guard their lord.\n\nThe competitors came from all over the Vale, from the mountain valleys and the coast, from Gulltown and the Bloody Gate, even the Three Sisters. Though a few were promised, only three were wed; the eight victors would be expected to spend the next three years at Lord Robert’s side, as his own personal guard (Alayne had suggested seven, like the Kingsguard, but Sweetrobin had insisted that he must have more knights than King Tommen), so older men with wives and children had not been invited.\n\nAnd they came, Alayne thought proudly. They all came.\n\nIt had fallen out just as Petyr said it would, the day the ravens flew. “They’re young, eager, hungry for adventure and renown. Lysa would not let them go to war. This is the next best thing. A chance to serve their lord and prove their prowess. They will come. Even Harry the Heir.” He had smoothed her hair and kissed her forehead. “What a clever daughter you are.”\n\nIt was clever. The tourney, the prizes, the winged knights, it had all been her own notion. Lord Robert’s mother had filled him full of fears, but he always took courage from the tales she read him of Ser Artys Arryn, the Winged Knight of legend, founder of his line. Why not surround him with Winged Knights?  She had thought one night, after Sweetrobin had finally drifted off to sleep. His own Kingsguard, to keep him safe and make him brave. And no sooner did she tell Petyr her idea than he went out and made it happen. He will want to be there to greet Ser Harrold. Where could he have gone?\n\nAlayne swept down the tower stairs to enter the pillared gallery at the back of the Great Hall. Below her, serving men were setting up trestle tables for the evening feast, while their wives and daughters swept up the old rushes and scattered fresh ones. Lord Nestor was showing Lady Waxley his prize tapestries, with their scenes of hunt and chase. The same panels had once hung in the Red Keep of King’s Landing, when Robert sat the Iron Throne. Joffrey had them taken down and they had languished in some cellar until Petyr Baelish arranged for them to be brought to the Vale as a gift for Nestor Royce. Not only were the hangings beautiful, but the High Steward delighted in telling anyone who’d listen that they had once belonged to a king.\n\nPetyr was not in the Great Hall. Alayne crossed the gallery and descended the stair built into the thick west wall, to come out in the inner ward, where the jousting would be held. Viewing stands had raised for all those who had come to watch, with four long tilting barriers in between. Lord Nestor’s men were painting the barriers with whitewash, draping the stands with bright banners, and hanging shields on the gate the competitors would pass through when they made their entrance.\n\nAt the north end of the yard, three quintains had been set up, and some of the competitors were riding at them. Alayne knew them by their shields; the bells of Belmore, green vipers for the Lynderlys, the red sledge of Breakstone, House Tollett’s black and grey pily. Ser Mychel Redfort set one quintain spinning with a perfectly placed blow. He was one of those favored to win wings.\n\nPetyr was not at the quintains, nor anywhere in the yard, but as she turned to go a woman’s voice called out. “Alayne!” cried Myranda Royce, from a carved stone bench beneath a beech tree, where she was seated between two men. She looked in need of rescue. Smiling, Alayne walked toward her friend.\n\nMyranda was wearing a grey woolen dress, a green hooded cloak, and a rather desperate look. On either side of her sat a knight. The one on her right had a grizzled beard, a bald head, and a belly that spilled over his swordbelt where his lap should have been. The one on her left was no more than eighteen, and skinny as a spear. His ginger-colored whiskers only partially served to disguise the angry red pimples that dotted his face.\n\nThe bald knight wore a dark blue surcoat emblazoned with a huge pair of pink lips. The pimply-gingerlad countered with nine white seagulls on a field of brown, which marked him for a Shett of Gulltown. He was staring so intently at Myranda’s breasts that he hardly noticed Alayne until Myranda rose to hug her. “Thank you, thank you, thank you ” Randa whispered in her ear, before she turned to say, “Sers, may I present you the Lady Alayne Stone?”\n\n“The Lord Protector’s daughter,” the bald knight announced, all hearty gallantry. He rose ponderously. “And full as lovely as the tales told of her, I see.”\n\nNot to be outdone, the pimply knight hopped up and said,  “Ser Ossifer speaks truly, you are the most beautiful maid in all the Seven Kingdoms.” It might have been a sweeter courtesy had he not addressed it to her chest.\n\n“And have you seen all those maids yourself, ser?” Alayne asked him. “You are young to be so widely travelled.”\n\nHe blushed, which only made his pimples look angrier.  “No, my lady.   I am from Gulltown.”\n\nAnd I am not, though Alayne was born there. She would need to be careful around this one. “I remember Gulltown fondly,” she told him, with a smile as vague as it was pleasant. To Myranda she said, “Do you know where my father’s gotten to, perchance?”\n\n“Let me take you to him, my lady.”\n\n“I do hope you will forgive me for depriving you of Lady Myranda’s company,” Alayne told the knights. She did not wait for a reply, but took the older girl arm-in-arm and drew her away from the bench. Only when they were out of earshot did she whisper,  “Do you really know where my father is?”\n\n“Of course not. Walk faster, my new suitors may be following.” Myranda made a face. “Ossifer Lipps is the dullest knight in the Vale, but Uther Shett aspires to his laurels. I am praying they fight a duel for my hand, and kill each other.”\n\nAlayne giggled. “Surely Lord Nestor would not seriously entertain a suit from such men.”\n\n“Oh, he might. My lord father is annoyed with me for killing my last husband and putting him to all this trouble.”\n\n“It was not your fault he died.”\n\n“There was no one else in the bed that I recall.”\n\nAlayne could not help but shutter. Myranda’s husband had died when he was making love with her. “Those Sistermen who came in yesterday were gallant,” she said, to change the subject. “If you don’t like Ser Ossifer or Ser Uther, marry one of them instead. I thought the youngest one was very handsome.”\n\n“The one in the sealskin cloak?” Randa said, incredulous.\n\n“One of his brothers, then.”\n\nMyranda rolled her eyes. “They’re from the Sisters. Did you ever know a Sisterman who could joust? They clean their swords with codfish oil and wash in tubs of cold seawater.”\n\n“Well,” Alayne said, “at least they’re clean.”\n\n“Some of them have webs between their toes. I’d sooner marry Lord Petyr. Then I’d be your mother. How little is his finger, I ask you?”\n\nAlayne did not dignify that question with an answer. “Lady Waynwood will be here soon, with her sons.”\n\n“Is that a promise or a threat?” Myranda said. “The first Lady Waynwood must have been a mare, I think. How else to explain why all the Waynwood men are horse-faced? If I were ever to wed a Waynwood, he would have to swear a vow to don his helm whenever he wished to fuck me, and keep the visor closed.” She gave Alayne a pinch on the arm. “My Harry will be with them, though. I notice that you left him out. I shall never forgive you for stealing him away from me. He’s the boy I want to marry.”\n\n“The betrothal was my father’s doing,”  Alayne protested, as she had a hundred times before.  She is only teasing, she told herself… but behind the japes, she could hear the hurt.\n\nMyranda stopped to gaze across the yard at the knights at their practice. “Now there’s the very sort of husband I need.”\n\nA few feet away, two knights were fighting with blunted practice swords. Their blades crashed together twice, then slipped past each other only to be blocked by upraised shields, but the bigger man gave ground at the impact. Alayne could not see the front of his shield from where she stood, but his attacker bore three ravens in flight, each clutching a red heart in its claws. Three hearts and three ravens.\n\nShe knew right then how the fight would end.\n\nA few moments later and the big man sprawled dazed in the dust with his helm askew. When his squire undid the fastenings to bare his head, there was blood trickling down his scalp. If the swords had not been blunted, there would be brains as well. That last head blow had been so hard Alayne had winced in sympathy when it fell. Myranda Royce considered the victor thoughtfully.  “Do you think if I asked nicely Ser Lyn would kill my suitors for me?”\n\n“He might, for a plump bag of gold.” Ser Lyn Corbray was forever desperately short of coin, all the Vale knew that.\n\n“Alas, all I have is a plump pair of teats. Though with Ser Lyn, a plump sausage under my skirts would serve me better.”\n\nAlayne’s giggle drew Corbray’s attention. He handed his shield to his loutish squire, removed his helm and quilted coif.  “Ladies.” His long brown hair was plastered to his brow by sweat.\n\n“Well struck, Ser Lyn,” Alayne called out. “Though I fear you’ve knocked poor Ser Owen insensible.”\n\nCorbray glanced back to where his foe was being helped from the yard by his squire. “He had no sense to start with, or he should not have tried me.”\n\nThere is truth in that, Alayne thought, but some demon of mischief was in her that morning, so she gave Ser Lyn a thrust of her own. Smiling sweetly, she said, “My lord father tells me your brother’s new wife is with child.”\n\nCorbray gave her a dark look. “Lyonel sends his regrets. He remains at Heart’s Home with his peddler’s daughter, watching her belly swell as if he were the first man who ever got a wench pregnant.”\n\nOh, that’s an open wound, thought Alayne. Lyonel Corbray’s first wife had given him nothing but a frail, sickly babe who died in infancy, and during all those years Ser Lyn had remained his brother’s heir. When the poor woman finally died, however, Petyr Baelish had stepped in and brokered a new marriage for Lord Corbray. The second Lady Corbray was sixteen, the daughter of a wealthy Gulltown merchant, but she had come with an immense dowry, and men said she was a tall, strapping, healthy girl, with big breasts and good, wide hips. And fertile too, it seems.\n\n“We are all praying that the Mother grants Lady Corbray an easy labor and a healthy child,” said Myranda.\n\nAlayne could not help herself. She smiled and said, “My father is always pleased to be of service to one of Lord Robert’s leal bannermen. I’m sure he would be most delighted to help broker a marriage for you as well, Ser Lyn.”\n\n“How kind of him.” Corbray’s lips drew back in something that might have been meant as a smile, though it gave Alayne a chill. “But what need have I for heirs when I am landless and like to remain so, thanks to our Lord Protector?  No.  Tell your lord father I need none of his brood mares.”\n\nThe venom in his voice was so thick that for a moment she almost forgot that Lyn Corbray was actually her father’s catspaw, bought and paid for. Or was he?  Perhaps, instead of being Petyr’s man pretending to be Petyr’s foe, he was actually his foe pretending to be his man pretending to be his foe.\n\nJust thinking about it was enough to make her head spin. Alayne turned abruptly from the yard… and bumped into a short, sharp-faced man with a brush of orange hair who had come up behind her.  His hand shot out and caught her arm before she could fall.   “My lady.  My pardons if I took you unawares.”\n\n“The fault was mine. I did not see you standing there.”\n\n“We mice are quiet creatures.” Ser Shadrich was so short that he might have been taken for a squire, but his face belonged to a much older man. She saw long leagues in the wrinkles at the corner of his mouth, old battles in the scar beneath his ear, and a hardness behind the eyes that no boy would ever have. This was a man grown. Even Randa overtopped him, though.\n\n“Will you be seeking wings?” the Royce girl said.\n\n“A mouse with wings would be a silly sight.”\n\n“Perhaps you will try the melee instead?” Alayne suggested.  The melee was an afterthought, a sop for all the brothers, uncles, fathers, and friends who had accompanied the competitors to the Gates of the Moon to see them win their silver wings, but there would be prizes for the champions, and a chance to win ransoms.\n\n“A good melee is all a hedge knight can hope for, unless he stumbles on a bag of dragons. And that’s not likely, is it?”\n\n“I suppose not. But now you must excuse us, ser, we need to find my lord father. “\n\nHorns sounded from atop the wall.  “Too late,” Myranda said. “They’re here.  We shall need to do the honors by ourselves.”  She grinned.   “Last one to the gate must marry Uther Shett.”\n\nThey made a race of it, dashing headlong across the yard and past the stables, skirts flapping, whilst knights and serving men alike looked on, and pigs and chickens scattered before them. It was most unladylike, but Alayne sound found herself laughing. For just a little while, as she ran, she forget who she was, and where, and found herself remembering bright cold days at Winterfell, when she would race through Winterfell with her friend Jeyne Poole, with Arya running after them trying to keep up.\n\nBy the time they arrived at the gatehouse, both of them were red-faced and panting. Myranda had lost her cloak somewhere along the way. They were just in time. The portcullis had been raised, and a column of riders twenty strong were passing underneath. At their head rode Anya Waynwood, Lady of Ironoaks, stern and slim, her grey-brown hair bound up in a scarf. Her riding cloak was heavy green wool trimmed with brown fur, and clasped at the throat by a niello brooch in the shape of the broken wheel of her House.\n\nMyranda Royce stepped forward and sketched a curtsy. “Lady Anya. Welcome to the Gates of the Moon.”\n\n“Lady Myranda. Lady Alayne.” Anya Waynwood inclined her head to each of them in turn. “It is good of you to greet us. Allow me to present my grandson, Ser Roland Waynwood.”  She nodded at the knight who had spoken.  “And this is my youngest son, Ser Wallace Waynwood.  And of course my ward, Ser Harrold Hardyng.”\n\nHarry the Heir, Alayne thought. My husband-to-be, if he will have me.  A sudden terror filled her.  She wondered if her face was red. Don’t stare at him, she reminded herself, don’t stare, don’t gape, don’t gawk.  Look away. Her hair must be a frightful mess after all that running.  It took all her will to stop herself from trying to tuck the loose strands back into place. Never mind your stupid hair.  Your hair doesn’t matter.  It’s him that matters.  Him, and the Waynwoods.\n\nSer Roland was the oldest of the three, though no more than five-and-twenty. He was taller and more muscular than Ser Wallace, but both were long-faced and lantern-jawed, with stringy brown hair and pinched noses.  Horsefaced and homely, Alayne thought.\n\nHarry, though…\n\nMy Harry.  My lord, my lover, my betrothed.\n\nSer Harrold Hardyng looked every inch a lord-in-waiting; clean-limbed and handsome, straight as a lance, hard with muscle. Men old enough to have known Jon Arryn in his youth said Ser Harrold had his look, she knew. He had a mop of sandy blond hair, pale blue eyes, an aquiline nose. Joffrey was comely too, though, she reminded herself.   A comely monster, that’s what he was.  Little Lord Tyrion was kinder, twisted though he was.\n\nHarry was staring at her. He knows who I am, she realized, and he does not seem pleased to see me. It was only then that she took note of his heraldry. Though his surcoat and horse trappings were patterned in the red-and-white diamonds of House Hardyng, his shield was quartered. The arms of Hardyng and Waynwood were displayed in the first and third quarters, respectively, but in the second and fourth quarters he bore the moon-and-falcon of House Arryn, sky blue and cream. Sweetrobin will not like that.\n\nSer Wallace said, “Are we the l-l-last?”\n\n“You are, sers,” replied Myranda Royce, taking absolutely no notice of his stammer.\n\n“Wh-wh-when will the t-t-tilts commence?”\n\n“Oh, soon, I pray,” said Randa. “Some of the competitors have been here for almost a moon’s turn, partaking of my father’s meat and mead. All good fellows, and very brave… but they do eat rather a lot.”\n\nThe Waynwoods laughed, and even Harry the Heir cracked a thin smile. “It was snowing in the passes, else we would have been here sooner,” said Lady Anya.\n\n“Had we known such beauty awaited us at the Gates, we would have flown,” Ser Roland said.  Though his words were addressed to Myranda Royce, he smiled at Alayne as he said them.\n\n“To fly you would need wings,” Randa replied, “and there are some knights here who might have a thing to say concerning that.”\n\n“I look forward to a spirited discussion.” Ser Roland swung down from his horse, turned to Alayne, and smiled.  “I had heard that Lord Littlefinger’s daughter was fair of face and full of grace, but no one ever told me that she was a thief.”\n\n“You wrong me, ser. I am no thief!”\n\nSer Roland placed his hand over his heart. “Then how do you explain this hole in my chest, from where you stole my heart?”\n\n“He is only t-teasing you, my lady,” stammered Ser Wallace. “My n-n-nephew never had a h-h-heart.”\n\n“The Waynwood wheel has a broken spoke, and we have my nuncle here.” Ser Roland gave Wallace a whap behind the ear.  “Squires should be quiet when knights are speaking.”\n\nSer Wallace reddened.  “I am no more a s-squire, my lady.  My n-nephew knows full well that I was k-k-kni-k-k-kni –“\n\n“Dubbed?” Alayne suggested gently.\n\n“Dubbed,” said Wallace Waynwood, gratefully.\n\nRobb would be his age, if he were still alive, she could not help but think, but Robb died a king, and this is just a boy.\n\n“My lord father has assigned you rooms in the East Tower,” Lady Myranda was telling Lady Waynwood, “but I fear your knights will need to share a bed. The Gates of the Moon were never meant to house so many noble visitors.”\n\n“You are in the Falcon Tower, Ser Harrold,” Alayne put in. Far away from Sweetrobin. That was intentional, she knew. Petyr Baelish did not leave such things to chance. “If it please you, I will show you to your chambers myself.” This time her eyes met Harry’s.  She smiled just for him, and said a silent prayer to the Maiden. Please, he doesn’t need to love me, just make him like me, just a little, that would be enough for now.\n\nSer Harrold looked down at her coldly. “Why should it please me to be escorted anywhere by Littlefinger’s bastard?”\n\nAll three Waynwoods looked at him askance. “You are a guest here, Harry,” Lady Anya reminded him, in a frosty voice. “See that you remember that.”\n\nA lady’s armor is her courtesy. Alayne could feel the blood rushing to her face. No tears, she prayed. Please, please, I must not cry. “As you wish, ser. And now if you will excuse me, Littlefinger’s bastard must find her lord father and let him know that you have come, so we can begin the tourney on the morrow.”  And may your horse stumble, Harry the Heir, so you fall on your stupid head in your first tilt. She showed the Waynwoods a stone face as they blurted out awkward apologies for their companion. When they were done she turned and fled.\n\nNear the keep, she ran headlong into Ser Lothor Brune and almost knocked him off his feet. “Harry the Heir?  Harry the Arse, I say. He’s just some upjumped squire.”\n\nAlayne was so grateful that she hugged him. “Thank you. Have you seen my father, ser?”\n\n“Down in the vaults, ” Ser Lothar said, “inspecting Lord Nestor’s granaries with Lord Grafton and Lord Belmore.”\n\nThe vaults were large and dark and filthy. Alayne lit a taper and clutched her skirt as she made the descent. Near the bottom, she heard Lord Grafton’s booming voice, and followed.”The merchants are clamoring to buy, and the lords are clamoring to sell,” the Gulltowner was saying when she found them.  Though not a tall man, Grafton was wide, with thick arms and shoulders.  His hair was a dirty blond mop.  “How am I to stop that, my lord?”\n\n“Post guardsmen on the docks. If need be, seize the ships. How does not matter, so long as no food leaves the Vale. “\n\n“These prices, though,”  protested fat Lord Belmore,”  these prices are more than fair.”\n\n“You say more than fair, my lord.  I say less than we would wish.  Wait.  If need be, buy the food yourself and keep it stored.  Winter is coming.  Prices must go higher.”\n\n“Perhaps,”  said Belmore, doubtfully.\n\n“Bronze Yohn will not wait, ”  Grafton complained.  “He need not ship through Gulltown, he has his own ports.  Whilst we are hoarding our harvest, Royce and the other Lords Declarant will turn theirs into silver, you may be sure of that.”\n\n“Let us hope so,”  said Petyr.  “When their granaries are empty, they will need every scrap of that silver to buy sustenance from us.  And now if you will excuse me, my lord, it would seem my daughter has need of me.”\n\n“Lady Alayne,” Lord Grafton said. “You look bright-eyed this morning.”\n\n“You are kind to say so, my lord. Father, I am sorry to disturb you, but I thought you would want to know that the Waynwoods have arrived.”\n\n“And is Ser Harrold with them?”\n\nHorrible Ser Harrold.  “ He is.”\n\nLord Belmore laughed. “I never thought Royce would let him come. Is he blind, or merely stupid?”\n\n“He is honorable.  Sometimes it amounts to the same thing.  If he denied the lad the chance to prove himself, it could create a rift between them, so why not let him tilt?  The boy is nowise skilled enough to win a place amongst the Winged Knights.”\n\n“I suppose not,” said Belmore, grudgingly.  Lord Grafton kissed Alayne on the hand, and the two lords went off, leaving her alone with her lord father.\n\n“Come,” Petyr said, “walk with me.”  He took her by the arm and led her deeper into the vaults, past an empty dungeon.  “And how was your first meeting with Harry the Heir?”\n\n“He’s horrible.”\n\n“The world is full of horrors, sweet.  By now you ought to know that.  You’ve seen enough of them.”\n\n“Yes,” she said, “but why must he be so cruel?  He called me your bastard.  Right in the yard, in front of everyone.”\n\n“So far as he knows, that’s who you are.  This betrothal was never his idea, and Bronze Yohn has no doubt warned him against my wiles.  You are my daughter.  He does not trust you, and he believes that you’re beneath him.”\n\n“Well, I’m not.  He may think he’s some great knight, but Ser Lothor says he’s just some upjumped squire.”\n\nPetyr put his arm around her.  “So he is, but he is Robert’s heir as well.  Bringing Harry here was the first step in our plan, but now we need to keep him, and only you can do that.  He has a weakness for a pretty face, and whose face is prettier than yours?  Charm him.  Entrance him.  Bewitch him.”\n\n“I don’t know how,”  she said miserably.\n\n“Oh, I think you do,” said Littlefinger, with one of those smiles that did not reach his eyes.  “You will be the most beautiful woman in the hall tonight, as lovely as your lady mother at your age.  I cannot seat you on the dais, but you’ll have a place of honor above the salt and underneath a wall sconce.  The fire will be shining in your hair, so everyone will see how fair of face you are.  Keep a good long spoon on hand to beat the squires off, sweetling.  You will not want green boys underfoot when the knights come round to beg you for your favor.”\n\n“Who would ask to wear a bastard’s favor?”\n\n“Harry, if he has the wits the gods gave a goose… but do not give it to him.  Choose some other gallant, and favor him instead.  You do not want to seem too eager.”\n\n“No,” Alayne said.\n\n“Lady Waynwood will insist that Harry dance with you, I can promise you that much.  That will be your chance. Smile at the boy.  Touch him when you speak.  Tease him, to pique his pride.  If he seems to be responding, tell him that you are feeling faint, and ask him to take you outside for a breath of fresh air.  No knight could refuse such a request from a fair maiden.”\n\n“Yes,” she said, “but he thinks that I’m a bastard.”\n\n“A beautiful bastard, and the Lord Protector’s daughter.”  Petyr drew her close and kissed her on both cheeks.  “The night belongs to you, sweetling, Remember that, always.”\n\n“I’ll try, father,” she said.\n\nThe feast proved to be everything her father promised.\n\nSixty-four dishes were served, in honor of the sixty-four competitors who had come so far to contest for silver wings before their lord. From the rivers and the lakes came pike and trout and salmon, from the seas crabs and cod and herring. Ducks there were, and capons, peacocks in their plumage and swans in almond milk. Suckling pigs were served up crackling with apples in their mouths, and three huge aurochs were roasted whole above firepits in the castle yard, since they were too big to get through the kitchen doors. Loaves of hot bread filled the trestle tables in Lord Nestor’s hall, and massive wheels of cheese were brought up from the vaults.  The butter was fresh-churned, and there were leeks and carrots, roasted onions, beets, turnips, parsnips.  And best of all, Lord Nestor’s cooks prepared a splendid subtlety, a lemon cake in the shape of the Giant’s Lance, twelve feet tall and adorned with an Eyrie made of sugar.\n\nFor me, Alayne thought, as they wheeled it out.  Sweetrobin loved lemon cakes too, but only after she told him that they were her favorites.  The cake had required every lemon in the Vale, but Petyr had promised that he would send to Dorne for more.\n\nThere were gifts as well, splendid gifts.  Each of the competitors received a cloak of cloth-of-silver and a lapis brooch in the shape of a pair of falcon’s wings.  Fine steel daggers were given to the brothers, fathers, and friends who had come to watch them tilt.  For their mothers, sisters, and ladies fair there were bolts of silk and Myrish lace.\n\n“Lord Nestor has an open hand,” Alayne heard Ser Edmund Breakstone say.  “An open hand and a little finger,” Lady Waynwood replied, with a nod toward Petyr Baelish.   Breakstone was not slow to take her meaning.  The true source of this largesse was not Lord Nestor, but the Lord Protector.\n\nWhen the last course had been served and cleared, the tables were lifted from their trestles to clear the floor for dancing, and musicians were brought in.\n\n“Are there no singers?” asked Ben Coldwater.\n\n“The little lord cannot abide them,” Ser Lymond Lynderly replied.  “Not since Marillion.”\n\n“Ah… that was the man who murdered Lady Lysa, yes?”\n\nAlayne spoke up. “His singing pleased her greatly, and she showed him too much favor, perhaps.  When she wed my father he went mad and pushed her out the Moon Door.  Lord Robert has hated singing ever since.  He is still fond of music, though.”\n\n“As am I,” Coldwater said.  Rising, he offered Alayne his hand.  “Would you honor me with this dance, my lady?”\n\n“You’re very kind,” she said, as he led her to the floor.\n\nHe was her first partner of the evening, but far from the last.  Just as Petyr had promised, the young knights flocked around her, vying for her favor.  After Ben came Andrew Tollett, handsome Ser Byron, red-nosed Ser Morgarth, and Ser Shadrich the Mad Mouse.  Then Ser Albar Royce, Myranda’s stout dull brother and Lord Nestor’s heir.  She danced with all three Sunderlands, none of whom had webs between their fingers, though she could not vouch for their toes.  Uther Shett appeared to pay her slimy compliments as he trod upon her feet, but Ser Targon the Halfwild proved to be the soul of courtesy.  After that Ser Roland Waynwood swept her up and made her laugh with mocking comments about half the other knights in the hall.  His uncle Wallace took a turn as well and tried to do the same, but the words would not come.  Alayne finally took pity on him and began to chatter happily, to spare him the embarrassment.  When the dance was done she excused herself, and went back to her place to have a drink of wine.\n\nAnd there he stood, Harry the Heir himself; tall, handsome, scowling.  “Lady Alayne. May I partner you in this dance?”\n\nShe considered for a moment. “No. I don’t think so.”\n\nColor rose to his cheeks.  “I was unforgiveably rude to you in the yard.  You must forgive me.”\n\n“Must?” She tossed her hair, took a sip of wine, made him wait.  “How can you forgive someone who is unforgiveably rude?  Will you explain that to me, ser?”\n\nSer Harrold looked confused. “Please.  One dance.”\n\nCharm him.  Entrance him.  Bewitch him.  “If you insist.”\n\nHe nodded, offered his arm, led her out onto the floor.  As they waited for the music to resume, Alayne glanced at the dais, where Lord Robert sat staring at them.  Please, she prayed, don’t let him start to twitch and shake.  Not here.  Not now.  Maester Coleman would have made certain that he drank a strong dose of sweetmilk before the feast, but even so.\n\nThen the musicians took up a tune, and she was dancing.\n\nSay something, she urged herself.  You will never make Ser Harry love you if you don’t have the courage to talk him.  Should she tell him what a good dancer he was?  No, he’s probably heard that a dozen times tonight.  Besides, Petyr said that I should not seem eager.  Instead she said, “I have heard that you are about to be a father.”  It was not something most girls would say to their almost-betrothed, but she wanted to see if Ser Harrold would lie.\n\n“For the second time. My daughter Alys is two years old.”\n\nYour bastard daughter Alys, Alayne thought, but what she said was, “That one had a different mother, though.”\n\n“Yes. Cissy was a pretty thing when I tumbled her, but childbirth left her as fat as a cow, so Lady Anya arranged for her to marry one of her men-at-arms.  It is different with Saffron.”\n\n“Saffron?”  Alayne tried not to laugh.  “Truly?”\n\nSer Harrold had the grace to blush.  “Her father says she is more precious to him than gold.  He’s rich, the richest man in Gulltown.  A fortune in spices.”\n\n“What will you name the babe?” she asked.  “Cinnamon if she’s a girl?  Cloves if he’s a boy?”\n\nThat almost made him stumble.  “My lady japes.”\n\n“Oh, no.”  Petyr will howl when I tell him what I said.\n\n“Saffron is very beautiful, I’ll have you know.  Tall and slim, with big brown eyes and hair like honey.”\n\nAlayne raised her head.  “More beautiful than me?”\n\nSer Harrold studied her face. “You are comely enough, I grant you.  When Lady Anya first told me of this match, I was afraid that you might look like your father.”\n\n“Little pointy beard and all?”  Alayne laughed.\n\n“I never meant… “\n\n“I hope you joust better than you talk.”\n\nFor a moment he looked shocked.  But as the song was ending, he burst into a laugh.  “No one told me you were clever.”\n\nHe has good teeth, she thought, straight and white.  And when he smiles, he has the nicest dimples.  She ran one finger down his cheek.  “Should we ever wed, you’ll have to send Saffron back to her father.  I’ll be all the spice you’ll want.”\n\nHe grinned.  “I will hold you to that promise, my lady.  Until that day, may I wear your favor in the tourney?”\n\n“You may not.  It is promised to… another.”  She was not sure who as yet, but she knew she would find someone.\n","slug":"ALAYNE","published":1,"updated":"2017-04-15T14:05:37.000Z","layout":"post","photos":[],"link":"","_id":"cjr66widb0017metps4wxprjz","content":"<h2 id=\"ALAYNE-EXCERPT-FROM-THE-WINDS-OF-WINTER\"><a href=\"#ALAYNE-EXCERPT-FROM-THE-WINDS-OF-WINTER\" class=\"headerlink\" title=\"ALAYNE--EXCERPT FROM THE WINDS OF WINTER\"></a>ALAYNE--EXCERPT FROM THE WINDS OF WINTER</h2><p>She was reading her little lord a tale of the Winged Knight when Mya Stone came knocking on the door of his bedchamber, clad in boots and riding leathers and smelling strongly of the stable. Mya had straw in her hair and a scowl on her face. That scowl comes of having Mychel Redfort near, Alayne knew.</p>\n<p>“Your lordship,” Mya informed Lord Robert, “Lady Waynwood’s banners have been seen an hour down the road. She will be here soon, with your cousin Harry. Will you want to greet them?”</p>\n<p>Why did she have to mention Harry? Alayne thought. We will never get Sweetrobin out of bed now. The boy slapped a pillow. “Send them away. I never asked them here.”<br><a id=\"more\"></a><br>Mya looked nonplussed. No one in the Vale was better at handling a mule, but lordlings were another matter. “They were invited,” she said uncertainly, “for the tourney. I don’t… “</p>\n<p>Alayne closed her book.  “Thank you, Mya. Let me talk with Lord Robert, if you would.”</p>\n<p>Relief plain on her face, Mya fled without another word.</p>\n<p>“I hate that Harry,” Sweetrobin said when she was gone. “He calls me cousin, but he’s just waiting for me to die so he can take the Eyrie. He thinks I don’t know, but I do.”</p>\n<p>“Your lordship should not believe such nonsense,” Alayne said. “I’m sure Ser Harrold loves you well.” And if the gods are good, he will love me too. Her tummy gave a little flutter.</p>\n<p>“He doesn’t,” Lord Robert insisted. “He wants my father’s castle, that’s all, so he pretends.” The boy clutched the blanket to his pimply chest. “I don’t want you to marry him, Alayne. I am the Lord of the Eyrie, and I forbid it.” He sounded as if he were about to cry. “You should marry me instead. We could sleep in the same bed every night, and you could read me stories.”</p>\n<p>No man can wed me so long as my dwarf husband still lives somewhere in this world. Queen Cersei had collected the head of a dozen dwarfs, Petyr claimed, but none were Tyrion’s. “Sweetrobin, you must not say such things. You are the Lord of the Eyrie and Defender of the Vale, and you must wed a highborn lady and father a son to sit in the High Hall of House Arryn after you are gone.”</p>\n<p>Robert wiped his nose. “But I want — “</p>\n<p>She put a finger to his lips. “I know what you want, but it cannot be. I am no fit wife for you. I am bastard born.”</p>\n<p>“I don’t care. I love you best of anyone. “</p>\n<p>You are such a little fool.  “Your lords bannermen will care. Some call my father upjumped and ambitious. If you were to take me to wife, they would say that he made you do it, that it was no will of yours. The Lords Declarant might take arms against him once again, and he and I should both be put to death.”</p>\n<p>“I wouldn’t let them hurt you!” Lord Robert said. “If they try I will make them all fly.” His hand began to tremble.</p>\n<p>Alayne stroked his fingers. “There, my Sweetrobin, be still now.” When the shaking passed, she said, “You must have a proper wife, a trueborn maid of noble birth.”</p>\n<p>“No. I want to marry you, Alayne.”</p>\n<p>Once your lady mother intended that very thing, but I was trueborn then, and noble. “My lord is kind to say so.” Alayne smoothed his hair. Lady Lysa had never let the servants touch it, and after she had died Robert had suffered terrible shaking fits whenever anyone came near him with a blade, so it had been allowed to grow until it tumbled over his round shoulders and halfway down his flabby white chest. He does have pretty hair.  If the gods are good and he lives long enough to wed, his wife will admire his hair, surely.  That much she will love about him. “Any child of ours would be baseborn. Only a trueborn child of House Arryn can displace Ser Harrold as your heir. My father will find a proper wife for you, some highborn girl much prettier than me. You’ll hunt and hawk together, and she’ll give you her favor to wear in tournaments. Before long, you will have forgotten me entirely.”</p>\n<p>“I won’t!”</p>\n<p>“You will. You must.” Her voice was firm, but gentle.</p>\n<p>“The Lord of the Eyrie can do as he likes. Can’t I still love you, even if I have to marry her? Ser Harrold has a common woman. Benjicot says she’s carrying his bastard.”</p>\n<p>Benjicot should learn to keep his fool’s mouth shut. “Is that what you would have from me? A bastard?” She pulled her fingers from his grasp. “Would you dishonor me that way?”</p>\n<p>The boy looked stricken. “No. I never meant — “</p>\n<p>Alayne stood. “If it please my lord, I must go and find my father. Someone needs to greet Lady Waynwood.” Before her little lord could find the words to protest, she gave him a quick curtsy and fled the bedchamber, sweeping down the hall and across a covered bridge to the Lord Protector’s apartments.</p>\n<p>When she had left Petyr Baelish that morning he had been breaking his fast with old Oswell who had arrived last night from Gulltown on a lathered horse. She hoped they might still be talking, but Petyr’s solar proved empty. Someone had left a window open and a stack of papers had blown onto the floor. The sun was slanting through the thick yellow windows, and dust motes danced in the light like tiny golden insects. Though snow had blanketed the heights of the Giant’s Lance above, below the mountain the autumn lingered and winter wheat was ripening in the fields.  Outside the window she could hear the laughter of the washerwomen at the well, the din of steel on steel from the ward where the knights were at their drills. Good sounds.</p>\n<p>Alayne loved it here. She felt alive again, for the first since her father… since Lord Eddard Stark had died.</p>\n<p>She closed the window, gathered up the fallen papers, and stacked them on the table. One was a list of the competitors. Four-and-sixty knights had been invited to vie for places amongst Lord Robert Arryn’s  new Brotherhood of Winged Knights, and four­ and-sixty knights had come to tilt for the right to wear falcon’s wings upon their warhelms and guard their lord.</p>\n<p>The competitors came from all over the Vale, from the mountain valleys and the coast, from Gulltown and the Bloody Gate, even the Three Sisters. Though a few were promised, only three were wed; the eight victors would be expected to spend the next three years at Lord Robert’s side, as his own personal guard (Alayne had suggested seven, like the Kingsguard, but Sweetrobin had insisted that he must have more knights than King Tommen), so older men with wives and children had not been invited.</p>\n<p>And they came, Alayne thought proudly. They all came.</p>\n<p>It had fallen out just as Petyr said it would, the day the ravens flew. “They’re young, eager, hungry for adventure and renown. Lysa would not let them go to war. This is the next best thing. A chance to serve their lord and prove their prowess. They will come. Even Harry the Heir.” He had smoothed her hair and kissed her forehead. “What a clever daughter you are.”</p>\n<p>It was clever. The tourney, the prizes, the winged knights, it had all been her own notion. Lord Robert’s mother had filled him full of fears, but he always took courage from the tales she read him of Ser Artys Arryn, the Winged Knight of legend, founder of his line. Why not surround him with Winged Knights?  She had thought one night, after Sweetrobin had finally drifted off to sleep. His own Kingsguard, to keep him safe and make him brave. And no sooner did she tell Petyr her idea than he went out and made it happen. He will want to be there to greet Ser Harrold. Where could he have gone?</p>\n<p>Alayne swept down the tower stairs to enter the pillared gallery at the back of the Great Hall. Below her, serving men were setting up trestle tables for the evening feast, while their wives and daughters swept up the old rushes and scattered fresh ones. Lord Nestor was showing Lady Waxley his prize tapestries, with their scenes of hunt and chase. The same panels had once hung in the Red Keep of King’s Landing, when Robert sat the Iron Throne. Joffrey had them taken down and they had languished in some cellar until Petyr Baelish arranged for them to be brought to the Vale as a gift for Nestor Royce. Not only were the hangings beautiful, but the High Steward delighted in telling anyone who’d listen that they had once belonged to a king.</p>\n<p>Petyr was not in the Great Hall. Alayne crossed the gallery and descended the stair built into the thick west wall, to come out in the inner ward, where the jousting would be held. Viewing stands had raised for all those who had come to watch, with four long tilting barriers in between. Lord Nestor’s men were painting the barriers with whitewash, draping the stands with bright banners, and hanging shields on the gate the competitors would pass through when they made their entrance.</p>\n<p>At the north end of the yard, three quintains had been set up, and some of the competitors were riding at them. Alayne knew them by their shields; the bells of Belmore, green vipers for the Lynderlys, the red sledge of Breakstone, House Tollett’s black and grey pily. Ser Mychel Redfort set one quintain spinning with a perfectly placed blow. He was one of those favored to win wings.</p>\n<p>Petyr was not at the quintains, nor anywhere in the yard, but as she turned to go a woman’s voice called out. “Alayne!” cried Myranda Royce, from a carved stone bench beneath a beech tree, where she was seated between two men. She looked in need of rescue. Smiling, Alayne walked toward her friend.</p>\n<p>Myranda was wearing a grey woolen dress, a green hooded cloak, and a rather desperate look. On either side of her sat a knight. The one on her right had a grizzled beard, a bald head, and a belly that spilled over his swordbelt where his lap should have been. The one on her left was no more than eighteen, and skinny as a spear. His ginger-colored whiskers only partially served to disguise the angry red pimples that dotted his face.</p>\n<p>The bald knight wore a dark blue surcoat emblazoned with a huge pair of pink lips. The pimply-gingerlad countered with nine white seagulls on a field of brown, which marked him for a Shett of Gulltown. He was staring so intently at Myranda’s breasts that he hardly noticed Alayne until Myranda rose to hug her. “Thank you, thank you, thank you ” Randa whispered in her ear, before she turned to say, “Sers, may I present you the Lady Alayne Stone?”</p>\n<p>“The Lord Protector’s daughter,” the bald knight announced, all hearty gallantry. He rose ponderously. “And full as lovely as the tales told of her, I see.”</p>\n<p>Not to be outdone, the pimply knight hopped up and said,  “Ser Ossifer speaks truly, you are the most beautiful maid in all the Seven Kingdoms.” It might have been a sweeter courtesy had he not addressed it to her chest.</p>\n<p>“And have you seen all those maids yourself, ser?” Alayne asked him. “You are young to be so widely travelled.”</p>\n<p>He blushed, which only made his pimples look angrier.  “No, my lady.   I am from Gulltown.”</p>\n<p>And I am not, though Alayne was born there. She would need to be careful around this one. “I remember Gulltown fondly,” she told him, with a smile as vague as it was pleasant. To Myranda she said, “Do you know where my father’s gotten to, perchance?”</p>\n<p>“Let me take you to him, my lady.”</p>\n<p>“I do hope you will forgive me for depriving you of Lady Myranda’s company,” Alayne told the knights. She did not wait for a reply, but took the older girl arm-in-arm and drew her away from the bench. Only when they were out of earshot did she whisper,  “Do you really know where my father is?”</p>\n<p>“Of course not. Walk faster, my new suitors may be following.” Myranda made a face. “Ossifer Lipps is the dullest knight in the Vale, but Uther Shett aspires to his laurels. I am praying they fight a duel for my hand, and kill each other.”</p>\n<p>Alayne giggled. “Surely Lord Nestor would not seriously entertain a suit from such men.”</p>\n<p>“Oh, he might. My lord father is annoyed with me for killing my last husband and putting him to all this trouble.”</p>\n<p>“It was not your fault he died.”</p>\n<p>“There was no one else in the bed that I recall.”</p>\n<p>Alayne could not help but shutter. Myranda’s husband had died when he was making love with her. “Those Sistermen who came in yesterday were gallant,” she said, to change the subject. “If you don’t like Ser Ossifer or Ser Uther, marry one of them instead. I thought the youngest one was very handsome.”</p>\n<p>“The one in the sealskin cloak?” Randa said, incredulous.</p>\n<p>“One of his brothers, then.”</p>\n<p>Myranda rolled her eyes. “They’re from the Sisters. Did you ever know a Sisterman who could joust? They clean their swords with codfish oil and wash in tubs of cold seawater.”</p>\n<p>“Well,” Alayne said, “at least they’re clean.”</p>\n<p>“Some of them have webs between their toes. I’d sooner marry Lord Petyr. Then I’d be your mother. How little is his finger, I ask you?”</p>\n<p>Alayne did not dignify that question with an answer. “Lady Waynwood will be here soon, with her sons.”</p>\n<p>“Is that a promise or a threat?” Myranda said. “The first Lady Waynwood must have been a mare, I think. How else to explain why all the Waynwood men are horse-faced? If I were ever to wed a Waynwood, he would have to swear a vow to don his helm whenever he wished to fuck me, and keep the visor closed.” She gave Alayne a pinch on the arm. “My Harry will be with them, though. I notice that you left him out. I shall never forgive you for stealing him away from me. He’s the boy I want to marry.”</p>\n<p>“The betrothal was my father’s doing,”  Alayne protested, as she had a hundred times before.  She is only teasing, she told herself… but behind the japes, she could hear the hurt.</p>\n<p>Myranda stopped to gaze across the yard at the knights at their practice. “Now there’s the very sort of husband I need.”</p>\n<p>A few feet away, two knights were fighting with blunted practice swords. Their blades crashed together twice, then slipped past each other only to be blocked by upraised shields, but the bigger man gave ground at the impact. Alayne could not see the front of his shield from where she stood, but his attacker bore three ravens in flight, each clutching a red heart in its claws. Three hearts and three ravens.</p>\n<p>She knew right then how the fight would end.</p>\n<p>A few moments later and the big man sprawled dazed in the dust with his helm askew. When his squire undid the fastenings to bare his head, there was blood trickling down his scalp. If the swords had not been blunted, there would be brains as well. That last head blow had been so hard Alayne had winced in sympathy when it fell. Myranda Royce considered the victor thoughtfully.  “Do you think if I asked nicely Ser Lyn would kill my suitors for me?”</p>\n<p>“He might, for a plump bag of gold.” Ser Lyn Corbray was forever desperately short of coin, all the Vale knew that.</p>\n<p>“Alas, all I have is a plump pair of teats. Though with Ser Lyn, a plump sausage under my skirts would serve me better.”</p>\n<p>Alayne’s giggle drew Corbray’s attention. He handed his shield to his loutish squire, removed his helm and quilted coif.  “Ladies.” His long brown hair was plastered to his brow by sweat.</p>\n<p>“Well struck, Ser Lyn,” Alayne called out. “Though I fear you’ve knocked poor Ser Owen insensible.”</p>\n<p>Corbray glanced back to where his foe was being helped from the yard by his squire. “He had no sense to start with, or he should not have tried me.”</p>\n<p>There is truth in that, Alayne thought, but some demon of mischief was in her that morning, so she gave Ser Lyn a thrust of her own. Smiling sweetly, she said, “My lord father tells me your brother’s new wife is with child.”</p>\n<p>Corbray gave her a dark look. “Lyonel sends his regrets. He remains at Heart’s Home with his peddler’s daughter, watching her belly swell as if he were the first man who ever got a wench pregnant.”</p>\n<p>Oh, that’s an open wound, thought Alayne. Lyonel Corbray’s first wife had given him nothing but a frail, sickly babe who died in infancy, and during all those years Ser Lyn had remained his brother’s heir. When the poor woman finally died, however, Petyr Baelish had stepped in and brokered a new marriage for Lord Corbray. The second Lady Corbray was sixteen, the daughter of a wealthy Gulltown merchant, but she had come with an immense dowry, and men said she was a tall, strapping, healthy girl, with big breasts and good, wide hips. And fertile too, it seems.</p>\n<p>“We are all praying that the Mother grants Lady Corbray an easy labor and a healthy child,” said Myranda.</p>\n<p>Alayne could not help herself. She smiled and said, “My father is always pleased to be of service to one of Lord Robert’s leal bannermen. I’m sure he would be most delighted to help broker a marriage for you as well, Ser Lyn.”</p>\n<p>“How kind of him.” Corbray’s lips drew back in something that might have been meant as a smile, though it gave Alayne a chill. “But what need have I for heirs when I am landless and like to remain so, thanks to our Lord Protector?  No.  Tell your lord father I need none of his brood mares.”</p>\n<p>The venom in his voice was so thick that for a moment she almost forgot that Lyn Corbray was actually her father’s catspaw, bought and paid for. Or was he?  Perhaps, instead of being Petyr’s man pretending to be Petyr’s foe, he was actually his foe pretending to be his man pretending to be his foe.</p>\n<p>Just thinking about it was enough to make her head spin. Alayne turned abruptly from the yard… and bumped into a short, sharp-faced man with a brush of orange hair who had come up behind her.  His hand shot out and caught her arm before she could fall.   “My lady.  My pardons if I took you unawares.”</p>\n<p>“The fault was mine. I did not see you standing there.”</p>\n<p>“We mice are quiet creatures.” Ser Shadrich was so short that he might have been taken for a squire, but his face belonged to a much older man. She saw long leagues in the wrinkles at the corner of his mouth, old battles in the scar beneath his ear, and a hardness behind the eyes that no boy would ever have. This was a man grown. Even Randa overtopped him, though.</p>\n<p>“Will you be seeking wings?” the Royce girl said.</p>\n<p>“A mouse with wings would be a silly sight.”</p>\n<p>“Perhaps you will try the melee instead?” Alayne suggested.  The melee was an afterthought, a sop for all the brothers, uncles, fathers, and friends who had accompanied the competitors to the Gates of the Moon to see them win their silver wings, but there would be prizes for the champions, and a chance to win ransoms.</p>\n<p>“A good melee is all a hedge knight can hope for, unless he stumbles on a bag of dragons. And that’s not likely, is it?”</p>\n<p>“I suppose not. But now you must excuse us, ser, we need to find my lord father. “</p>\n<p>Horns sounded from atop the wall.  “Too late,” Myranda said. “They’re here.  We shall need to do the honors by ourselves.”  She grinned.   “Last one to the gate must marry Uther Shett.”</p>\n<p>They made a race of it, dashing headlong across the yard and past the stables, skirts flapping, whilst knights and serving men alike looked on, and pigs and chickens scattered before them. It was most unladylike, but Alayne sound found herself laughing. For just a little while, as she ran, she forget who she was, and where, and found herself remembering bright cold days at Winterfell, when she would race through Winterfell with her friend Jeyne Poole, with Arya running after them trying to keep up.</p>\n<p>By the time they arrived at the gatehouse, both of them were red-faced and panting. Myranda had lost her cloak somewhere along the way. They were just in time. The portcullis had been raised, and a column of riders twenty strong were passing underneath. At their head rode Anya Waynwood, Lady of Ironoaks, stern and slim, her grey-brown hair bound up in a scarf. Her riding cloak was heavy green wool trimmed with brown fur, and clasped at the throat by a niello brooch in the shape of the broken wheel of her House.</p>\n<p>Myranda Royce stepped forward and sketched a curtsy. “Lady Anya. Welcome to the Gates of the Moon.”</p>\n<p>“Lady Myranda. Lady Alayne.” Anya Waynwood inclined her head to each of them in turn. “It is good of you to greet us. Allow me to present my grandson, Ser Roland Waynwood.”  She nodded at the knight who had spoken.  “And this is my youngest son, Ser Wallace Waynwood.  And of course my ward, Ser Harrold Hardyng.”</p>\n<p>Harry the Heir, Alayne thought. My husband-to-be, if he will have me.  A sudden terror filled her.  She wondered if her face was red. Don’t stare at him, she reminded herself, don’t stare, don’t gape, don’t gawk.  Look away. Her hair must be a frightful mess after all that running.  It took all her will to stop herself from trying to tuck the loose strands back into place. Never mind your stupid hair.  Your hair doesn’t matter.  It’s him that matters.  Him, and the Waynwoods.</p>\n<p>Ser Roland was the oldest of the three, though no more than five-and-twenty. He was taller and more muscular than Ser Wallace, but both were long-faced and lantern-jawed, with stringy brown hair and pinched noses.  Horsefaced and homely, Alayne thought.</p>\n<p>Harry, though…</p>\n<p>My Harry.  My lord, my lover, my betrothed.</p>\n<p>Ser Harrold Hardyng looked every inch a lord-in-waiting; clean-limbed and handsome, straight as a lance, hard with muscle. Men old enough to have known Jon Arryn in his youth said Ser Harrold had his look, she knew. He had a mop of sandy blond hair, pale blue eyes, an aquiline nose. Joffrey was comely too, though, she reminded herself.   A comely monster, that’s what he was.  Little Lord Tyrion was kinder, twisted though he was.</p>\n<p>Harry was staring at her. He knows who I am, she realized, and he does not seem pleased to see me. It was only then that she took note of his heraldry. Though his surcoat and horse trappings were patterned in the red-and-white diamonds of House Hardyng, his shield was quartered. The arms of Hardyng and Waynwood were displayed in the first and third quarters, respectively, but in the second and fourth quarters he bore the moon-and-falcon of House Arryn, sky blue and cream. Sweetrobin will not like that.</p>\n<p>Ser Wallace said, “Are we the l-l-last?”</p>\n<p>“You are, sers,” replied Myranda Royce, taking absolutely no notice of his stammer.</p>\n<p>“Wh-wh-when will the t-t-tilts commence?”</p>\n<p>“Oh, soon, I pray,” said Randa. “Some of the competitors have been here for almost a moon’s turn, partaking of my father’s meat and mead. All good fellows, and very brave… but they do eat rather a lot.”</p>\n<p>The Waynwoods laughed, and even Harry the Heir cracked a thin smile. “It was snowing in the passes, else we would have been here sooner,” said Lady Anya.</p>\n<p>“Had we known such beauty awaited us at the Gates, we would have flown,” Ser Roland said.  Though his words were addressed to Myranda Royce, he smiled at Alayne as he said them.</p>\n<p>“To fly you would need wings,” Randa replied, “and there are some knights here who might have a thing to say concerning that.”</p>\n<p>“I look forward to a spirited discussion.” Ser Roland swung down from his horse, turned to Alayne, and smiled.  “I had heard that Lord Littlefinger’s daughter was fair of face and full of grace, but no one ever told me that she was a thief.”</p>\n<p>“You wrong me, ser. I am no thief!”</p>\n<p>Ser Roland placed his hand over his heart. “Then how do you explain this hole in my chest, from where you stole my heart?”</p>\n<p>“He is only t-teasing you, my lady,” stammered Ser Wallace. “My n-n-nephew never had a h-h-heart.”</p>\n<p>“The Waynwood wheel has a broken spoke, and we have my nuncle here.” Ser Roland gave Wallace a whap behind the ear.  “Squires should be quiet when knights are speaking.”</p>\n<p>Ser Wallace reddened.  “I am no more a s-squire, my lady.  My n-nephew knows full well that I was k-k-kni-k-k-kni –“</p>\n<p>“Dubbed?” Alayne suggested gently.</p>\n<p>“Dubbed,” said Wallace Waynwood, gratefully.</p>\n<p>Robb would be his age, if he were still alive, she could not help but think, but Robb died a king, and this is just a boy.</p>\n<p>“My lord father has assigned you rooms in the East Tower,” Lady Myranda was telling Lady Waynwood, “but I fear your knights will need to share a bed. The Gates of the Moon were never meant to house so many noble visitors.”</p>\n<p>“You are in the Falcon Tower, Ser Harrold,” Alayne put in. Far away from Sweetrobin. That was intentional, she knew. Petyr Baelish did not leave such things to chance. “If it please you, I will show you to your chambers myself.” This time her eyes met Harry’s.  She smiled just for him, and said a silent prayer to the Maiden. Please, he doesn’t need to love me, just make him like me, just a little, that would be enough for now.</p>\n<p>Ser Harrold looked down at her coldly. “Why should it please me to be escorted anywhere by Littlefinger’s bastard?”</p>\n<p>All three Waynwoods looked at him askance. “You are a guest here, Harry,” Lady Anya reminded him, in a frosty voice. “See that you remember that.”</p>\n<p>A lady’s armor is her courtesy. Alayne could feel the blood rushing to her face. No tears, she prayed. Please, please, I must not cry. “As you wish, ser. And now if you will excuse me, Littlefinger’s bastard must find her lord father and let him know that you have come, so we can begin the tourney on the morrow.”  And may your horse stumble, Harry the Heir, so you fall on your stupid head in your first tilt. She showed the Waynwoods a stone face as they blurted out awkward apologies for their companion. When they were done she turned and fled.</p>\n<p>Near the keep, she ran headlong into Ser Lothor Brune and almost knocked him off his feet. “Harry the Heir?  Harry the Arse, I say. He’s just some upjumped squire.”</p>\n<p>Alayne was so grateful that she hugged him. “Thank you. Have you seen my father, ser?”</p>\n<p>“Down in the vaults, ” Ser Lothar said, “inspecting Lord Nestor’s granaries with Lord Grafton and Lord Belmore.”</p>\n<p>The vaults were large and dark and filthy. Alayne lit a taper and clutched her skirt as she made the descent. Near the bottom, she heard Lord Grafton’s booming voice, and followed.”The merchants are clamoring to buy, and the lords are clamoring to sell,” the Gulltowner was saying when she found them.  Though not a tall man, Grafton was wide, with thick arms and shoulders.  His hair was a dirty blond mop.  “How am I to stop that, my lord?”</p>\n<p>“Post guardsmen on the docks. If need be, seize the ships. How does not matter, so long as no food leaves the Vale. “</p>\n<p>“These prices, though,”  protested fat Lord Belmore,”  these prices are more than fair.”</p>\n<p>“You say more than fair, my lord.  I say less than we would wish.  Wait.  If need be, buy the food yourself and keep it stored.  Winter is coming.  Prices must go higher.”</p>\n<p>“Perhaps,”  said Belmore, doubtfully.</p>\n<p>“Bronze Yohn will not wait, ”  Grafton complained.  “He need not ship through Gulltown, he has his own ports.  Whilst we are hoarding our harvest, Royce and the other Lords Declarant will turn theirs into silver, you may be sure of that.”</p>\n<p>“Let us hope so,”  said Petyr.  “When their granaries are empty, they will need every scrap of that silver to buy sustenance from us.  And now if you will excuse me, my lord, it would seem my daughter has need of me.”</p>\n<p>“Lady Alayne,” Lord Grafton said. “You look bright-eyed this morning.”</p>\n<p>“You are kind to say so, my lord. Father, I am sorry to disturb you, but I thought you would want to know that the Waynwoods have arrived.”</p>\n<p>“And is Ser Harrold with them?”</p>\n<p>Horrible Ser Harrold.  “ He is.”</p>\n<p>Lord Belmore laughed. “I never thought Royce would let him come. Is he blind, or merely stupid?”</p>\n<p>“He is honorable.  Sometimes it amounts to the same thing.  If he denied the lad the chance to prove himself, it could create a rift between them, so why not let him tilt?  The boy is nowise skilled enough to win a place amongst the Winged Knights.”</p>\n<p>“I suppose not,” said Belmore, grudgingly.  Lord Grafton kissed Alayne on the hand, and the two lords went off, leaving her alone with her lord father.</p>\n<p>“Come,” Petyr said, “walk with me.”  He took her by the arm and led her deeper into the vaults, past an empty dungeon.  “And how was your first meeting with Harry the Heir?”</p>\n<p>“He’s horrible.”</p>\n<p>“The world is full of horrors, sweet.  By now you ought to know that.  You’ve seen enough of them.”</p>\n<p>“Yes,” she said, “but why must he be so cruel?  He called me your bastard.  Right in the yard, in front of everyone.”</p>\n<p>“So far as he knows, that’s who you are.  This betrothal was never his idea, and Bronze Yohn has no doubt warned him against my wiles.  You are my daughter.  He does not trust you, and he believes that you’re beneath him.”</p>\n<p>“Well, I’m not.  He may think he’s some great knight, but Ser Lothor says he’s just some upjumped squire.”</p>\n<p>Petyr put his arm around her.  “So he is, but he is Robert’s heir as well.  Bringing Harry here was the first step in our plan, but now we need to keep him, and only you can do that.  He has a weakness for a pretty face, and whose face is prettier than yours?  Charm him.  Entrance him.  Bewitch him.”</p>\n<p>“I don’t know how,”  she said miserably.</p>\n<p>“Oh, I think you do,” said Littlefinger, with one of those smiles that did not reach his eyes.  “You will be the most beautiful woman in the hall tonight, as lovely as your lady mother at your age.  I cannot seat you on the dais, but you’ll have a place of honor above the salt and underneath a wall sconce.  The fire will be shining in your hair, so everyone will see how fair of face you are.  Keep a good long spoon on hand to beat the squires off, sweetling.  You will not want green boys underfoot when the knights come round to beg you for your favor.”</p>\n<p>“Who would ask to wear a bastard’s favor?”</p>\n<p>“Harry, if he has the wits the gods gave a goose… but do not give it to him.  Choose some other gallant, and favor him instead.  You do not want to seem too eager.”</p>\n<p>“No,” Alayne said.</p>\n<p>“Lady Waynwood will insist that Harry dance with you, I can promise you that much.  That will be your chance. Smile at the boy.  Touch him when you speak.  Tease him, to pique his pride.  If he seems to be responding, tell him that you are feeling faint, and ask him to take you outside for a breath of fresh air.  No knight could refuse such a request from a fair maiden.”</p>\n<p>“Yes,” she said, “but he thinks that I’m a bastard.”</p>\n<p>“A beautiful bastard, and the Lord Protector’s daughter.”  Petyr drew her close and kissed her on both cheeks.  “The night belongs to you, sweetling, Remember that, always.”</p>\n<p>“I’ll try, father,” she said.</p>\n<p>The feast proved to be everything her father promised.</p>\n<p>Sixty-four dishes were served, in honor of the sixty-four competitors who had come so far to contest for silver wings before their lord. From the rivers and the lakes came pike and trout and salmon, from the seas crabs and cod and herring. Ducks there were, and capons, peacocks in their plumage and swans in almond milk. Suckling pigs were served up crackling with apples in their mouths, and three huge aurochs were roasted whole above firepits in the castle yard, since they were too big to get through the kitchen doors. Loaves of hot bread filled the trestle tables in Lord Nestor’s hall, and massive wheels of cheese were brought up from the vaults.  The butter was fresh-churned, and there were leeks and carrots, roasted onions, beets, turnips, parsnips.  And best of all, Lord Nestor’s cooks prepared a splendid subtlety, a lemon cake in the shape of the Giant’s Lance, twelve feet tall and adorned with an Eyrie made of sugar.</p>\n<p>For me, Alayne thought, as they wheeled it out.  Sweetrobin loved lemon cakes too, but only after she told him that they were her favorites.  The cake had required every lemon in the Vale, but Petyr had promised that he would send to Dorne for more.</p>\n<p>There were gifts as well, splendid gifts.  Each of the competitors received a cloak of cloth-of-silver and a lapis brooch in the shape of a pair of falcon’s wings.  Fine steel daggers were given to the brothers, fathers, and friends who had come to watch them tilt.  For their mothers, sisters, and ladies fair there were bolts of silk and Myrish lace.</p>\n<p>“Lord Nestor has an open hand,” Alayne heard Ser Edmund Breakstone say.  “An open hand and a little finger,” Lady Waynwood replied, with a nod toward Petyr Baelish.   Breakstone was not slow to take her meaning.  The true source of this largesse was not Lord Nestor, but the Lord Protector.</p>\n<p>When the last course had been served and cleared, the tables were lifted from their trestles to clear the floor for dancing, and musicians were brought in.</p>\n<p>“Are there no singers?” asked Ben Coldwater.</p>\n<p>“The little lord cannot abide them,” Ser Lymond Lynderly replied.  “Not since Marillion.”</p>\n<p>“Ah… that was the man who murdered Lady Lysa, yes?”</p>\n<p>Alayne spoke up. “His singing pleased her greatly, and she showed him too much favor, perhaps.  When she wed my father he went mad and pushed her out the Moon Door.  Lord Robert has hated singing ever since.  He is still fond of music, though.”</p>\n<p>“As am I,” Coldwater said.  Rising, he offered Alayne his hand.  “Would you honor me with this dance, my lady?”</p>\n<p>“You’re very kind,” she said, as he led her to the floor.</p>\n<p>He was her first partner of the evening, but far from the last.  Just as Petyr had promised, the young knights flocked around her, vying for her favor.  After Ben came Andrew Tollett, handsome Ser Byron, red-nosed Ser Morgarth, and Ser Shadrich the Mad Mouse.  Then Ser Albar Royce, Myranda’s stout dull brother and Lord Nestor’s heir.  She danced with all three Sunderlands, none of whom had webs between their fingers, though she could not vouch for their toes.  Uther Shett appeared to pay her slimy compliments as he trod upon her feet, but Ser Targon the Halfwild proved to be the soul of courtesy.  After that Ser Roland Waynwood swept her up and made her laugh with mocking comments about half the other knights in the hall.  His uncle Wallace took a turn as well and tried to do the same, but the words would not come.  Alayne finally took pity on him and began to chatter happily, to spare him the embarrassment.  When the dance was done she excused herself, and went back to her place to have a drink of wine.</p>\n<p>And there he stood, Harry the Heir himself; tall, handsome, scowling.  “Lady Alayne. May I partner you in this dance?”</p>\n<p>She considered for a moment. “No. I don’t think so.”</p>\n<p>Color rose to his cheeks.  “I was unforgiveably rude to you in the yard.  You must forgive me.”</p>\n<p>“Must?” She tossed her hair, took a sip of wine, made him wait.  “How can you forgive someone who is unforgiveably rude?  Will you explain that to me, ser?”</p>\n<p>Ser Harrold looked confused. “Please.  One dance.”</p>\n<p>Charm him.  Entrance him.  Bewitch him.  “If you insist.”</p>\n<p>He nodded, offered his arm, led her out onto the floor.  As they waited for the music to resume, Alayne glanced at the dais, where Lord Robert sat staring at them.  Please, she prayed, don’t let him start to twitch and shake.  Not here.  Not now.  Maester Coleman would have made certain that he drank a strong dose of sweetmilk before the feast, but even so.</p>\n<p>Then the musicians took up a tune, and she was dancing.</p>\n<p>Say something, she urged herself.  You will never make Ser Harry love you if you don’t have the courage to talk him.  Should she tell him what a good dancer he was?  No, he’s probably heard that a dozen times tonight.  Besides, Petyr said that I should not seem eager.  Instead she said, “I have heard that you are about to be a father.”  It was not something most girls would say to their almost-betrothed, but she wanted to see if Ser Harrold would lie.</p>\n<p>“For the second time. My daughter Alys is two years old.”</p>\n<p>Your bastard daughter Alys, Alayne thought, but what she said was, “That one had a different mother, though.”</p>\n<p>“Yes. Cissy was a pretty thing when I tumbled her, but childbirth left her as fat as a cow, so Lady Anya arranged for her to marry one of her men-at-arms.  It is different with Saffron.”</p>\n<p>“Saffron?”  Alayne tried not to laugh.  “Truly?”</p>\n<p>Ser Harrold had the grace to blush.  “Her father says she is more precious to him than gold.  He’s rich, the richest man in Gulltown.  A fortune in spices.”</p>\n<p>“What will you name the babe?” she asked.  “Cinnamon if she’s a girl?  Cloves if he’s a boy?”</p>\n<p>That almost made him stumble.  “My lady japes.”</p>\n<p>“Oh, no.”  Petyr will howl when I tell him what I said.</p>\n<p>“Saffron is very beautiful, I’ll have you know.  Tall and slim, with big brown eyes and hair like honey.”</p>\n<p>Alayne raised her head.  “More beautiful than me?”</p>\n<p>Ser Harrold studied her face. “You are comely enough, I grant you.  When Lady Anya first told me of this match, I was afraid that you might look like your father.”</p>\n<p>“Little pointy beard and all?”  Alayne laughed.</p>\n<p>“I never meant… “</p>\n<p>“I hope you joust better than you talk.”</p>\n<p>For a moment he looked shocked.  But as the song was ending, he burst into a laugh.  “No one told me you were clever.”</p>\n<p>He has good teeth, she thought, straight and white.  And when he smiles, he has the nicest dimples.  She ran one finger down his cheek.  “Should we ever wed, you’ll have to send Saffron back to her father.  I’ll be all the spice you’ll want.”</p>\n<p>He grinned.  “I will hold you to that promise, my lady.  Until that day, may I wear your favor in the tourney?”</p>\n<p>“You may not.  It is promised to… another.”  She was not sure who as yet, but she knew she would find someone.</p>\n","excerpt":"<h2 id=\"ALAYNE-EXCERPT-FROM-THE-WINDS-OF-WINTER\"><a href=\"#ALAYNE-EXCERPT-FROM-THE-WINDS-OF-WINTER\" class=\"headerlink\" title=\"ALAYNE--EXCERPT FROM THE WINDS OF WINTER\"></a>ALAYNE--EXCERPT FROM THE WINDS OF WINTER</h2><p>She was reading her little lord a tale of the Winged Knight when Mya Stone came knocking on the door of his bedchamber, clad in boots and riding leathers and smelling strongly of the stable. Mya had straw in her hair and a scowl on her face. That scowl comes of having Mychel Redfort near, Alayne knew.</p>\n<p>“Your lordship,” Mya informed Lord Robert, “Lady Waynwood’s banners have been seen an hour down the road. She will be here soon, with your cousin Harry. Will you want to greet them?”</p>\n<p>Why did she have to mention Harry? Alayne thought. We will never get Sweetrobin out of bed now. The boy slapped a pillow. “Send them away. I never asked them here.”<br>","more":"<br>Mya looked nonplussed. No one in the Vale was better at handling a mule, but lordlings were another matter. “They were invited,” she said uncertainly, “for the tourney. I don’t… “</p>\n<p>Alayne closed her book.  “Thank you, Mya. Let me talk with Lord Robert, if you would.”</p>\n<p>Relief plain on her face, Mya fled without another word.</p>\n<p>“I hate that Harry,” Sweetrobin said when she was gone. “He calls me cousin, but he’s just waiting for me to die so he can take the Eyrie. He thinks I don’t know, but I do.”</p>\n<p>“Your lordship should not believe such nonsense,” Alayne said. “I’m sure Ser Harrold loves you well.” And if the gods are good, he will love me too. Her tummy gave a little flutter.</p>\n<p>“He doesn’t,” Lord Robert insisted. “He wants my father’s castle, that’s all, so he pretends.” The boy clutched the blanket to his pimply chest. “I don’t want you to marry him, Alayne. I am the Lord of the Eyrie, and I forbid it.” He sounded as if he were about to cry. “You should marry me instead. We could sleep in the same bed every night, and you could read me stories.”</p>\n<p>No man can wed me so long as my dwarf husband still lives somewhere in this world. Queen Cersei had collected the head of a dozen dwarfs, Petyr claimed, but none were Tyrion’s. “Sweetrobin, you must not say such things. You are the Lord of the Eyrie and Defender of the Vale, and you must wed a highborn lady and father a son to sit in the High Hall of House Arryn after you are gone.”</p>\n<p>Robert wiped his nose. “But I want — “</p>\n<p>She put a finger to his lips. “I know what you want, but it cannot be. I am no fit wife for you. I am bastard born.”</p>\n<p>“I don’t care. I love you best of anyone. “</p>\n<p>You are such a little fool.  “Your lords bannermen will care. Some call my father upjumped and ambitious. If you were to take me to wife, they would say that he made you do it, that it was no will of yours. The Lords Declarant might take arms against him once again, and he and I should both be put to death.”</p>\n<p>“I wouldn’t let them hurt you!” Lord Robert said. “If they try I will make them all fly.” His hand began to tremble.</p>\n<p>Alayne stroked his fingers. “There, my Sweetrobin, be still now.” When the shaking passed, she said, “You must have a proper wife, a trueborn maid of noble birth.”</p>\n<p>“No. I want to marry you, Alayne.”</p>\n<p>Once your lady mother intended that very thing, but I was trueborn then, and noble. “My lord is kind to say so.” Alayne smoothed his hair. Lady Lysa had never let the servants touch it, and after she had died Robert had suffered terrible shaking fits whenever anyone came near him with a blade, so it had been allowed to grow until it tumbled over his round shoulders and halfway down his flabby white chest. He does have pretty hair.  If the gods are good and he lives long enough to wed, his wife will admire his hair, surely.  That much she will love about him. “Any child of ours would be baseborn. Only a trueborn child of House Arryn can displace Ser Harrold as your heir. My father will find a proper wife for you, some highborn girl much prettier than me. You’ll hunt and hawk together, and she’ll give you her favor to wear in tournaments. Before long, you will have forgotten me entirely.”</p>\n<p>“I won’t!”</p>\n<p>“You will. You must.” Her voice was firm, but gentle.</p>\n<p>“The Lord of the Eyrie can do as he likes. Can’t I still love you, even if I have to marry her? Ser Harrold has a common woman. Benjicot says she’s carrying his bastard.”</p>\n<p>Benjicot should learn to keep his fool’s mouth shut. “Is that what you would have from me? A bastard?” She pulled her fingers from his grasp. “Would you dishonor me that way?”</p>\n<p>The boy looked stricken. “No. I never meant — “</p>\n<p>Alayne stood. “If it please my lord, I must go and find my father. Someone needs to greet Lady Waynwood.” Before her little lord could find the words to protest, she gave him a quick curtsy and fled the bedchamber, sweeping down the hall and across a covered bridge to the Lord Protector’s apartments.</p>\n<p>When she had left Petyr Baelish that morning he had been breaking his fast with old Oswell who had arrived last night from Gulltown on a lathered horse. She hoped they might still be talking, but Petyr’s solar proved empty. Someone had left a window open and a stack of papers had blown onto the floor. The sun was slanting through the thick yellow windows, and dust motes danced in the light like tiny golden insects. Though snow had blanketed the heights of the Giant’s Lance above, below the mountain the autumn lingered and winter wheat was ripening in the fields.  Outside the window she could hear the laughter of the washerwomen at the well, the din of steel on steel from the ward where the knights were at their drills. Good sounds.</p>\n<p>Alayne loved it here. She felt alive again, for the first since her father… since Lord Eddard Stark had died.</p>\n<p>She closed the window, gathered up the fallen papers, and stacked them on the table. One was a list of the competitors. Four-and-sixty knights had been invited to vie for places amongst Lord Robert Arryn’s  new Brotherhood of Winged Knights, and four­ and-sixty knights had come to tilt for the right to wear falcon’s wings upon their warhelms and guard their lord.</p>\n<p>The competitors came from all over the Vale, from the mountain valleys and the coast, from Gulltown and the Bloody Gate, even the Three Sisters. Though a few were promised, only three were wed; the eight victors would be expected to spend the next three years at Lord Robert’s side, as his own personal guard (Alayne had suggested seven, like the Kingsguard, but Sweetrobin had insisted that he must have more knights than King Tommen), so older men with wives and children had not been invited.</p>\n<p>And they came, Alayne thought proudly. They all came.</p>\n<p>It had fallen out just as Petyr said it would, the day the ravens flew. “They’re young, eager, hungry for adventure and renown. Lysa would not let them go to war. This is the next best thing. A chance to serve their lord and prove their prowess. They will come. Even Harry the Heir.” He had smoothed her hair and kissed her forehead. “What a clever daughter you are.”</p>\n<p>It was clever. The tourney, the prizes, the winged knights, it had all been her own notion. Lord Robert’s mother had filled him full of fears, but he always took courage from the tales she read him of Ser Artys Arryn, the Winged Knight of legend, founder of his line. Why not surround him with Winged Knights?  She had thought one night, after Sweetrobin had finally drifted off to sleep. His own Kingsguard, to keep him safe and make him brave. And no sooner did she tell Petyr her idea than he went out and made it happen. He will want to be there to greet Ser Harrold. Where could he have gone?</p>\n<p>Alayne swept down the tower stairs to enter the pillared gallery at the back of the Great Hall. Below her, serving men were setting up trestle tables for the evening feast, while their wives and daughters swept up the old rushes and scattered fresh ones. Lord Nestor was showing Lady Waxley his prize tapestries, with their scenes of hunt and chase. The same panels had once hung in the Red Keep of King’s Landing, when Robert sat the Iron Throne. Joffrey had them taken down and they had languished in some cellar until Petyr Baelish arranged for them to be brought to the Vale as a gift for Nestor Royce. Not only were the hangings beautiful, but the High Steward delighted in telling anyone who’d listen that they had once belonged to a king.</p>\n<p>Petyr was not in the Great Hall. Alayne crossed the gallery and descended the stair built into the thick west wall, to come out in the inner ward, where the jousting would be held. Viewing stands had raised for all those who had come to watch, with four long tilting barriers in between. Lord Nestor’s men were painting the barriers with whitewash, draping the stands with bright banners, and hanging shields on the gate the competitors would pass through when they made their entrance.</p>\n<p>At the north end of the yard, three quintains had been set up, and some of the competitors were riding at them. Alayne knew them by their shields; the bells of Belmore, green vipers for the Lynderlys, the red sledge of Breakstone, House Tollett’s black and grey pily. Ser Mychel Redfort set one quintain spinning with a perfectly placed blow. He was one of those favored to win wings.</p>\n<p>Petyr was not at the quintains, nor anywhere in the yard, but as she turned to go a woman’s voice called out. “Alayne!” cried Myranda Royce, from a carved stone bench beneath a beech tree, where she was seated between two men. She looked in need of rescue. Smiling, Alayne walked toward her friend.</p>\n<p>Myranda was wearing a grey woolen dress, a green hooded cloak, and a rather desperate look. On either side of her sat a knight. The one on her right had a grizzled beard, a bald head, and a belly that spilled over his swordbelt where his lap should have been. The one on her left was no more than eighteen, and skinny as a spear. His ginger-colored whiskers only partially served to disguise the angry red pimples that dotted his face.</p>\n<p>The bald knight wore a dark blue surcoat emblazoned with a huge pair of pink lips. The pimply-gingerlad countered with nine white seagulls on a field of brown, which marked him for a Shett of Gulltown. He was staring so intently at Myranda’s breasts that he hardly noticed Alayne until Myranda rose to hug her. “Thank you, thank you, thank you ” Randa whispered in her ear, before she turned to say, “Sers, may I present you the Lady Alayne Stone?”</p>\n<p>“The Lord Protector’s daughter,” the bald knight announced, all hearty gallantry. He rose ponderously. “And full as lovely as the tales told of her, I see.”</p>\n<p>Not to be outdone, the pimply knight hopped up and said,  “Ser Ossifer speaks truly, you are the most beautiful maid in all the Seven Kingdoms.” It might have been a sweeter courtesy had he not addressed it to her chest.</p>\n<p>“And have you seen all those maids yourself, ser?” Alayne asked him. “You are young to be so widely travelled.”</p>\n<p>He blushed, which only made his pimples look angrier.  “No, my lady.   I am from Gulltown.”</p>\n<p>And I am not, though Alayne was born there. She would need to be careful around this one. “I remember Gulltown fondly,” she told him, with a smile as vague as it was pleasant. To Myranda she said, “Do you know where my father’s gotten to, perchance?”</p>\n<p>“Let me take you to him, my lady.”</p>\n<p>“I do hope you will forgive me for depriving you of Lady Myranda’s company,” Alayne told the knights. She did not wait for a reply, but took the older girl arm-in-arm and drew her away from the bench. Only when they were out of earshot did she whisper,  “Do you really know where my father is?”</p>\n<p>“Of course not. Walk faster, my new suitors may be following.” Myranda made a face. “Ossifer Lipps is the dullest knight in the Vale, but Uther Shett aspires to his laurels. I am praying they fight a duel for my hand, and kill each other.”</p>\n<p>Alayne giggled. “Surely Lord Nestor would not seriously entertain a suit from such men.”</p>\n<p>“Oh, he might. My lord father is annoyed with me for killing my last husband and putting him to all this trouble.”</p>\n<p>“It was not your fault he died.”</p>\n<p>“There was no one else in the bed that I recall.”</p>\n<p>Alayne could not help but shutter. Myranda’s husband had died when he was making love with her. “Those Sistermen who came in yesterday were gallant,” she said, to change the subject. “If you don’t like Ser Ossifer or Ser Uther, marry one of them instead. I thought the youngest one was very handsome.”</p>\n<p>“The one in the sealskin cloak?” Randa said, incredulous.</p>\n<p>“One of his brothers, then.”</p>\n<p>Myranda rolled her eyes. “They’re from the Sisters. Did you ever know a Sisterman who could joust? They clean their swords with codfish oil and wash in tubs of cold seawater.”</p>\n<p>“Well,” Alayne said, “at least they’re clean.”</p>\n<p>“Some of them have webs between their toes. I’d sooner marry Lord Petyr. Then I’d be your mother. How little is his finger, I ask you?”</p>\n<p>Alayne did not dignify that question with an answer. “Lady Waynwood will be here soon, with her sons.”</p>\n<p>“Is that a promise or a threat?” Myranda said. “The first Lady Waynwood must have been a mare, I think. How else to explain why all the Waynwood men are horse-faced? If I were ever to wed a Waynwood, he would have to swear a vow to don his helm whenever he wished to fuck me, and keep the visor closed.” She gave Alayne a pinch on the arm. “My Harry will be with them, though. I notice that you left him out. I shall never forgive you for stealing him away from me. He’s the boy I want to marry.”</p>\n<p>“The betrothal was my father’s doing,”  Alayne protested, as she had a hundred times before.  She is only teasing, she told herself… but behind the japes, she could hear the hurt.</p>\n<p>Myranda stopped to gaze across the yard at the knights at their practice. “Now there’s the very sort of husband I need.”</p>\n<p>A few feet away, two knights were fighting with blunted practice swords. Their blades crashed together twice, then slipped past each other only to be blocked by upraised shields, but the bigger man gave ground at the impact. Alayne could not see the front of his shield from where she stood, but his attacker bore three ravens in flight, each clutching a red heart in its claws. Three hearts and three ravens.</p>\n<p>She knew right then how the fight would end.</p>\n<p>A few moments later and the big man sprawled dazed in the dust with his helm askew. When his squire undid the fastenings to bare his head, there was blood trickling down his scalp. If the swords had not been blunted, there would be brains as well. That last head blow had been so hard Alayne had winced in sympathy when it fell. Myranda Royce considered the victor thoughtfully.  “Do you think if I asked nicely Ser Lyn would kill my suitors for me?”</p>\n<p>“He might, for a plump bag of gold.” Ser Lyn Corbray was forever desperately short of coin, all the Vale knew that.</p>\n<p>“Alas, all I have is a plump pair of teats. Though with Ser Lyn, a plump sausage under my skirts would serve me better.”</p>\n<p>Alayne’s giggle drew Corbray’s attention. He handed his shield to his loutish squire, removed his helm and quilted coif.  “Ladies.” His long brown hair was plastered to his brow by sweat.</p>\n<p>“Well struck, Ser Lyn,” Alayne called out. “Though I fear you’ve knocked poor Ser Owen insensible.”</p>\n<p>Corbray glanced back to where his foe was being helped from the yard by his squire. “He had no sense to start with, or he should not have tried me.”</p>\n<p>There is truth in that, Alayne thought, but some demon of mischief was in her that morning, so she gave Ser Lyn a thrust of her own. Smiling sweetly, she said, “My lord father tells me your brother’s new wife is with child.”</p>\n<p>Corbray gave her a dark look. “Lyonel sends his regrets. He remains at Heart’s Home with his peddler’s daughter, watching her belly swell as if he were the first man who ever got a wench pregnant.”</p>\n<p>Oh, that’s an open wound, thought Alayne. Lyonel Corbray’s first wife had given him nothing but a frail, sickly babe who died in infancy, and during all those years Ser Lyn had remained his brother’s heir. When the poor woman finally died, however, Petyr Baelish had stepped in and brokered a new marriage for Lord Corbray. The second Lady Corbray was sixteen, the daughter of a wealthy Gulltown merchant, but she had come with an immense dowry, and men said she was a tall, strapping, healthy girl, with big breasts and good, wide hips. And fertile too, it seems.</p>\n<p>“We are all praying that the Mother grants Lady Corbray an easy labor and a healthy child,” said Myranda.</p>\n<p>Alayne could not help herself. She smiled and said, “My father is always pleased to be of service to one of Lord Robert’s leal bannermen. I’m sure he would be most delighted to help broker a marriage for you as well, Ser Lyn.”</p>\n<p>“How kind of him.” Corbray’s lips drew back in something that might have been meant as a smile, though it gave Alayne a chill. “But what need have I for heirs when I am landless and like to remain so, thanks to our Lord Protector?  No.  Tell your lord father I need none of his brood mares.”</p>\n<p>The venom in his voice was so thick that for a moment she almost forgot that Lyn Corbray was actually her father’s catspaw, bought and paid for. Or was he?  Perhaps, instead of being Petyr’s man pretending to be Petyr’s foe, he was actually his foe pretending to be his man pretending to be his foe.</p>\n<p>Just thinking about it was enough to make her head spin. Alayne turned abruptly from the yard… and bumped into a short, sharp-faced man with a brush of orange hair who had come up behind her.  His hand shot out and caught her arm before she could fall.   “My lady.  My pardons if I took you unawares.”</p>\n<p>“The fault was mine. I did not see you standing there.”</p>\n<p>“We mice are quiet creatures.” Ser Shadrich was so short that he might have been taken for a squire, but his face belonged to a much older man. She saw long leagues in the wrinkles at the corner of his mouth, old battles in the scar beneath his ear, and a hardness behind the eyes that no boy would ever have. This was a man grown. Even Randa overtopped him, though.</p>\n<p>“Will you be seeking wings?” the Royce girl said.</p>\n<p>“A mouse with wings would be a silly sight.”</p>\n<p>“Perhaps you will try the melee instead?” Alayne suggested.  The melee was an afterthought, a sop for all the brothers, uncles, fathers, and friends who had accompanied the competitors to the Gates of the Moon to see them win their silver wings, but there would be prizes for the champions, and a chance to win ransoms.</p>\n<p>“A good melee is all a hedge knight can hope for, unless he stumbles on a bag of dragons. And that’s not likely, is it?”</p>\n<p>“I suppose not. But now you must excuse us, ser, we need to find my lord father. “</p>\n<p>Horns sounded from atop the wall.  “Too late,” Myranda said. “They’re here.  We shall need to do the honors by ourselves.”  She grinned.   “Last one to the gate must marry Uther Shett.”</p>\n<p>They made a race of it, dashing headlong across the yard and past the stables, skirts flapping, whilst knights and serving men alike looked on, and pigs and chickens scattered before them. It was most unladylike, but Alayne sound found herself laughing. For just a little while, as she ran, she forget who she was, and where, and found herself remembering bright cold days at Winterfell, when she would race through Winterfell with her friend Jeyne Poole, with Arya running after them trying to keep up.</p>\n<p>By the time they arrived at the gatehouse, both of them were red-faced and panting. Myranda had lost her cloak somewhere along the way. They were just in time. The portcullis had been raised, and a column of riders twenty strong were passing underneath. At their head rode Anya Waynwood, Lady of Ironoaks, stern and slim, her grey-brown hair bound up in a scarf. Her riding cloak was heavy green wool trimmed with brown fur, and clasped at the throat by a niello brooch in the shape of the broken wheel of her House.</p>\n<p>Myranda Royce stepped forward and sketched a curtsy. “Lady Anya. Welcome to the Gates of the Moon.”</p>\n<p>“Lady Myranda. Lady Alayne.” Anya Waynwood inclined her head to each of them in turn. “It is good of you to greet us. Allow me to present my grandson, Ser Roland Waynwood.”  She nodded at the knight who had spoken.  “And this is my youngest son, Ser Wallace Waynwood.  And of course my ward, Ser Harrold Hardyng.”</p>\n<p>Harry the Heir, Alayne thought. My husband-to-be, if he will have me.  A sudden terror filled her.  She wondered if her face was red. Don’t stare at him, she reminded herself, don’t stare, don’t gape, don’t gawk.  Look away. Her hair must be a frightful mess after all that running.  It took all her will to stop herself from trying to tuck the loose strands back into place. Never mind your stupid hair.  Your hair doesn’t matter.  It’s him that matters.  Him, and the Waynwoods.</p>\n<p>Ser Roland was the oldest of the three, though no more than five-and-twenty. He was taller and more muscular than Ser Wallace, but both were long-faced and lantern-jawed, with stringy brown hair and pinched noses.  Horsefaced and homely, Alayne thought.</p>\n<p>Harry, though…</p>\n<p>My Harry.  My lord, my lover, my betrothed.</p>\n<p>Ser Harrold Hardyng looked every inch a lord-in-waiting; clean-limbed and handsome, straight as a lance, hard with muscle. Men old enough to have known Jon Arryn in his youth said Ser Harrold had his look, she knew. He had a mop of sandy blond hair, pale blue eyes, an aquiline nose. Joffrey was comely too, though, she reminded herself.   A comely monster, that’s what he was.  Little Lord Tyrion was kinder, twisted though he was.</p>\n<p>Harry was staring at her. He knows who I am, she realized, and he does not seem pleased to see me. It was only then that she took note of his heraldry. Though his surcoat and horse trappings were patterned in the red-and-white diamonds of House Hardyng, his shield was quartered. The arms of Hardyng and Waynwood were displayed in the first and third quarters, respectively, but in the second and fourth quarters he bore the moon-and-falcon of House Arryn, sky blue and cream. Sweetrobin will not like that.</p>\n<p>Ser Wallace said, “Are we the l-l-last?”</p>\n<p>“You are, sers,” replied Myranda Royce, taking absolutely no notice of his stammer.</p>\n<p>“Wh-wh-when will the t-t-tilts commence?”</p>\n<p>“Oh, soon, I pray,” said Randa. “Some of the competitors have been here for almost a moon’s turn, partaking of my father’s meat and mead. All good fellows, and very brave… but they do eat rather a lot.”</p>\n<p>The Waynwoods laughed, and even Harry the Heir cracked a thin smile. “It was snowing in the passes, else we would have been here sooner,” said Lady Anya.</p>\n<p>“Had we known such beauty awaited us at the Gates, we would have flown,” Ser Roland said.  Though his words were addressed to Myranda Royce, he smiled at Alayne as he said them.</p>\n<p>“To fly you would need wings,” Randa replied, “and there are some knights here who might have a thing to say concerning that.”</p>\n<p>“I look forward to a spirited discussion.” Ser Roland swung down from his horse, turned to Alayne, and smiled.  “I had heard that Lord Littlefinger’s daughter was fair of face and full of grace, but no one ever told me that she was a thief.”</p>\n<p>“You wrong me, ser. I am no thief!”</p>\n<p>Ser Roland placed his hand over his heart. “Then how do you explain this hole in my chest, from where you stole my heart?”</p>\n<p>“He is only t-teasing you, my lady,” stammered Ser Wallace. “My n-n-nephew never had a h-h-heart.”</p>\n<p>“The Waynwood wheel has a broken spoke, and we have my nuncle here.” Ser Roland gave Wallace a whap behind the ear.  “Squires should be quiet when knights are speaking.”</p>\n<p>Ser Wallace reddened.  “I am no more a s-squire, my lady.  My n-nephew knows full well that I was k-k-kni-k-k-kni –“</p>\n<p>“Dubbed?” Alayne suggested gently.</p>\n<p>“Dubbed,” said Wallace Waynwood, gratefully.</p>\n<p>Robb would be his age, if he were still alive, she could not help but think, but Robb died a king, and this is just a boy.</p>\n<p>“My lord father has assigned you rooms in the East Tower,” Lady Myranda was telling Lady Waynwood, “but I fear your knights will need to share a bed. The Gates of the Moon were never meant to house so many noble visitors.”</p>\n<p>“You are in the Falcon Tower, Ser Harrold,” Alayne put in. Far away from Sweetrobin. That was intentional, she knew. Petyr Baelish did not leave such things to chance. “If it please you, I will show you to your chambers myself.” This time her eyes met Harry’s.  She smiled just for him, and said a silent prayer to the Maiden. Please, he doesn’t need to love me, just make him like me, just a little, that would be enough for now.</p>\n<p>Ser Harrold looked down at her coldly. “Why should it please me to be escorted anywhere by Littlefinger’s bastard?”</p>\n<p>All three Waynwoods looked at him askance. “You are a guest here, Harry,” Lady Anya reminded him, in a frosty voice. “See that you remember that.”</p>\n<p>A lady’s armor is her courtesy. Alayne could feel the blood rushing to her face. No tears, she prayed. Please, please, I must not cry. “As you wish, ser. And now if you will excuse me, Littlefinger’s bastard must find her lord father and let him know that you have come, so we can begin the tourney on the morrow.”  And may your horse stumble, Harry the Heir, so you fall on your stupid head in your first tilt. She showed the Waynwoods a stone face as they blurted out awkward apologies for their companion. When they were done she turned and fled.</p>\n<p>Near the keep, she ran headlong into Ser Lothor Brune and almost knocked him off his feet. “Harry the Heir?  Harry the Arse, I say. He’s just some upjumped squire.”</p>\n<p>Alayne was so grateful that she hugged him. “Thank you. Have you seen my father, ser?”</p>\n<p>“Down in the vaults, ” Ser Lothar said, “inspecting Lord Nestor’s granaries with Lord Grafton and Lord Belmore.”</p>\n<p>The vaults were large and dark and filthy. Alayne lit a taper and clutched her skirt as she made the descent. Near the bottom, she heard Lord Grafton’s booming voice, and followed.”The merchants are clamoring to buy, and the lords are clamoring to sell,” the Gulltowner was saying when she found them.  Though not a tall man, Grafton was wide, with thick arms and shoulders.  His hair was a dirty blond mop.  “How am I to stop that, my lord?”</p>\n<p>“Post guardsmen on the docks. If need be, seize the ships. How does not matter, so long as no food leaves the Vale. “</p>\n<p>“These prices, though,”  protested fat Lord Belmore,”  these prices are more than fair.”</p>\n<p>“You say more than fair, my lord.  I say less than we would wish.  Wait.  If need be, buy the food yourself and keep it stored.  Winter is coming.  Prices must go higher.”</p>\n<p>“Perhaps,”  said Belmore, doubtfully.</p>\n<p>“Bronze Yohn will not wait, ”  Grafton complained.  “He need not ship through Gulltown, he has his own ports.  Whilst we are hoarding our harvest, Royce and the other Lords Declarant will turn theirs into silver, you may be sure of that.”</p>\n<p>“Let us hope so,”  said Petyr.  “When their granaries are empty, they will need every scrap of that silver to buy sustenance from us.  And now if you will excuse me, my lord, it would seem my daughter has need of me.”</p>\n<p>“Lady Alayne,” Lord Grafton said. “You look bright-eyed this morning.”</p>\n<p>“You are kind to say so, my lord. Father, I am sorry to disturb you, but I thought you would want to know that the Waynwoods have arrived.”</p>\n<p>“And is Ser Harrold with them?”</p>\n<p>Horrible Ser Harrold.  “ He is.”</p>\n<p>Lord Belmore laughed. “I never thought Royce would let him come. Is he blind, or merely stupid?”</p>\n<p>“He is honorable.  Sometimes it amounts to the same thing.  If he denied the lad the chance to prove himself, it could create a rift between them, so why not let him tilt?  The boy is nowise skilled enough to win a place amongst the Winged Knights.”</p>\n<p>“I suppose not,” said Belmore, grudgingly.  Lord Grafton kissed Alayne on the hand, and the two lords went off, leaving her alone with her lord father.</p>\n<p>“Come,” Petyr said, “walk with me.”  He took her by the arm and led her deeper into the vaults, past an empty dungeon.  “And how was your first meeting with Harry the Heir?”</p>\n<p>“He’s horrible.”</p>\n<p>“The world is full of horrors, sweet.  By now you ought to know that.  You’ve seen enough of them.”</p>\n<p>“Yes,” she said, “but why must he be so cruel?  He called me your bastard.  Right in the yard, in front of everyone.”</p>\n<p>“So far as he knows, that’s who you are.  This betrothal was never his idea, and Bronze Yohn has no doubt warned him against my wiles.  You are my daughter.  He does not trust you, and he believes that you’re beneath him.”</p>\n<p>“Well, I’m not.  He may think he’s some great knight, but Ser Lothor says he’s just some upjumped squire.”</p>\n<p>Petyr put his arm around her.  “So he is, but he is Robert’s heir as well.  Bringing Harry here was the first step in our plan, but now we need to keep him, and only you can do that.  He has a weakness for a pretty face, and whose face is prettier than yours?  Charm him.  Entrance him.  Bewitch him.”</p>\n<p>“I don’t know how,”  she said miserably.</p>\n<p>“Oh, I think you do,” said Littlefinger, with one of those smiles that did not reach his eyes.  “You will be the most beautiful woman in the hall tonight, as lovely as your lady mother at your age.  I cannot seat you on the dais, but you’ll have a place of honor above the salt and underneath a wall sconce.  The fire will be shining in your hair, so everyone will see how fair of face you are.  Keep a good long spoon on hand to beat the squires off, sweetling.  You will not want green boys underfoot when the knights come round to beg you for your favor.”</p>\n<p>“Who would ask to wear a bastard’s favor?”</p>\n<p>“Harry, if he has the wits the gods gave a goose… but do not give it to him.  Choose some other gallant, and favor him instead.  You do not want to seem too eager.”</p>\n<p>“No,” Alayne said.</p>\n<p>“Lady Waynwood will insist that Harry dance with you, I can promise you that much.  That will be your chance. Smile at the boy.  Touch him when you speak.  Tease him, to pique his pride.  If he seems to be responding, tell him that you are feeling faint, and ask him to take you outside for a breath of fresh air.  No knight could refuse such a request from a fair maiden.”</p>\n<p>“Yes,” she said, “but he thinks that I’m a bastard.”</p>\n<p>“A beautiful bastard, and the Lord Protector’s daughter.”  Petyr drew her close and kissed her on both cheeks.  “The night belongs to you, sweetling, Remember that, always.”</p>\n<p>“I’ll try, father,” she said.</p>\n<p>The feast proved to be everything her father promised.</p>\n<p>Sixty-four dishes were served, in honor of the sixty-four competitors who had come so far to contest for silver wings before their lord. From the rivers and the lakes came pike and trout and salmon, from the seas crabs and cod and herring. Ducks there were, and capons, peacocks in their plumage and swans in almond milk. Suckling pigs were served up crackling with apples in their mouths, and three huge aurochs were roasted whole above firepits in the castle yard, since they were too big to get through the kitchen doors. Loaves of hot bread filled the trestle tables in Lord Nestor’s hall, and massive wheels of cheese were brought up from the vaults.  The butter was fresh-churned, and there were leeks and carrots, roasted onions, beets, turnips, parsnips.  And best of all, Lord Nestor’s cooks prepared a splendid subtlety, a lemon cake in the shape of the Giant’s Lance, twelve feet tall and adorned with an Eyrie made of sugar.</p>\n<p>For me, Alayne thought, as they wheeled it out.  Sweetrobin loved lemon cakes too, but only after she told him that they were her favorites.  The cake had required every lemon in the Vale, but Petyr had promised that he would send to Dorne for more.</p>\n<p>There were gifts as well, splendid gifts.  Each of the competitors received a cloak of cloth-of-silver and a lapis brooch in the shape of a pair of falcon’s wings.  Fine steel daggers were given to the brothers, fathers, and friends who had come to watch them tilt.  For their mothers, sisters, and ladies fair there were bolts of silk and Myrish lace.</p>\n<p>“Lord Nestor has an open hand,” Alayne heard Ser Edmund Breakstone say.  “An open hand and a little finger,” Lady Waynwood replied, with a nod toward Petyr Baelish.   Breakstone was not slow to take her meaning.  The true source of this largesse was not Lord Nestor, but the Lord Protector.</p>\n<p>When the last course had been served and cleared, the tables were lifted from their trestles to clear the floor for dancing, and musicians were brought in.</p>\n<p>“Are there no singers?” asked Ben Coldwater.</p>\n<p>“The little lord cannot abide them,” Ser Lymond Lynderly replied.  “Not since Marillion.”</p>\n<p>“Ah… that was the man who murdered Lady Lysa, yes?”</p>\n<p>Alayne spoke up. “His singing pleased her greatly, and she showed him too much favor, perhaps.  When she wed my father he went mad and pushed her out the Moon Door.  Lord Robert has hated singing ever since.  He is still fond of music, though.”</p>\n<p>“As am I,” Coldwater said.  Rising, he offered Alayne his hand.  “Would you honor me with this dance, my lady?”</p>\n<p>“You’re very kind,” she said, as he led her to the floor.</p>\n<p>He was her first partner of the evening, but far from the last.  Just as Petyr had promised, the young knights flocked around her, vying for her favor.  After Ben came Andrew Tollett, handsome Ser Byron, red-nosed Ser Morgarth, and Ser Shadrich the Mad Mouse.  Then Ser Albar Royce, Myranda’s stout dull brother and Lord Nestor’s heir.  She danced with all three Sunderlands, none of whom had webs between their fingers, though she could not vouch for their toes.  Uther Shett appeared to pay her slimy compliments as he trod upon her feet, but Ser Targon the Halfwild proved to be the soul of courtesy.  After that Ser Roland Waynwood swept her up and made her laugh with mocking comments about half the other knights in the hall.  His uncle Wallace took a turn as well and tried to do the same, but the words would not come.  Alayne finally took pity on him and began to chatter happily, to spare him the embarrassment.  When the dance was done she excused herself, and went back to her place to have a drink of wine.</p>\n<p>And there he stood, Harry the Heir himself; tall, handsome, scowling.  “Lady Alayne. May I partner you in this dance?”</p>\n<p>She considered for a moment. “No. I don’t think so.”</p>\n<p>Color rose to his cheeks.  “I was unforgiveably rude to you in the yard.  You must forgive me.”</p>\n<p>“Must?” She tossed her hair, took a sip of wine, made him wait.  “How can you forgive someone who is unforgiveably rude?  Will you explain that to me, ser?”</p>\n<p>Ser Harrold looked confused. “Please.  One dance.”</p>\n<p>Charm him.  Entrance him.  Bewitch him.  “If you insist.”</p>\n<p>He nodded, offered his arm, led her out onto the floor.  As they waited for the music to resume, Alayne glanced at the dais, where Lord Robert sat staring at them.  Please, she prayed, don’t let him start to twitch and shake.  Not here.  Not now.  Maester Coleman would have made certain that he drank a strong dose of sweetmilk before the feast, but even so.</p>\n<p>Then the musicians took up a tune, and she was dancing.</p>\n<p>Say something, she urged herself.  You will never make Ser Harry love you if you don’t have the courage to talk him.  Should she tell him what a good dancer he was?  No, he’s probably heard that a dozen times tonight.  Besides, Petyr said that I should not seem eager.  Instead she said, “I have heard that you are about to be a father.”  It was not something most girls would say to their almost-betrothed, but she wanted to see if Ser Harrold would lie.</p>\n<p>“For the second time. My daughter Alys is two years old.”</p>\n<p>Your bastard daughter Alys, Alayne thought, but what she said was, “That one had a different mother, though.”</p>\n<p>“Yes. Cissy was a pretty thing when I tumbled her, but childbirth left her as fat as a cow, so Lady Anya arranged for her to marry one of her men-at-arms.  It is different with Saffron.”</p>\n<p>“Saffron?”  Alayne tried not to laugh.  “Truly?”</p>\n<p>Ser Harrold had the grace to blush.  “Her father says she is more precious to him than gold.  He’s rich, the richest man in Gulltown.  A fortune in spices.”</p>\n<p>“What will you name the babe?” she asked.  “Cinnamon if she’s a girl?  Cloves if he’s a boy?”</p>\n<p>That almost made him stumble.  “My lady japes.”</p>\n<p>“Oh, no.”  Petyr will howl when I tell him what I said.</p>\n<p>“Saffron is very beautiful, I’ll have you know.  Tall and slim, with big brown eyes and hair like honey.”</p>\n<p>Alayne raised her head.  “More beautiful than me?”</p>\n<p>Ser Harrold studied her face. “You are comely enough, I grant you.  When Lady Anya first told me of this match, I was afraid that you might look like your father.”</p>\n<p>“Little pointy beard and all?”  Alayne laughed.</p>\n<p>“I never meant… “</p>\n<p>“I hope you joust better than you talk.”</p>\n<p>For a moment he looked shocked.  But as the song was ending, he burst into a laugh.  “No one told me you were clever.”</p>\n<p>He has good teeth, she thought, straight and white.  And when he smiles, he has the nicest dimples.  She ran one finger down his cheek.  “Should we ever wed, you’ll have to send Saffron back to her father.  I’ll be all the spice you’ll want.”</p>\n<p>He grinned.  “I will hold you to that promise, my lady.  Until that day, may I wear your favor in the tourney?”</p>\n<p>“You may not.  It is promised to… another.”  She was not sure who as yet, but she knew she would find someone.</p>"},{"title":"Docker在PHP中的实践过程","date":"2017-09-18T12:59:36.000Z","update":null,"comments":0,"_content":"最近微服务很火，很多人都在尝试，我们公司也在这段时间尝试着来时间微服务化，其中就涉及到Docker。\n在实践docker中踩了很多坑，也对Docker有了更多的认识，下面记录一下。\n<!--more-->\n\nDocker在打包Spring boot项目时候，因为Spring boot内部集成了tomcat并且提供了直接打包成jar包的方式，[Spring boot如何打包](https://docs.spring.io/spring-boot/docs/current/reference/html/build-tool-plugins-maven-plugin.html)。\n\nDockerfile文件如下：\n```Java\nFROM java:8\n\nCOPY target/your-project-name.jar /app.jar\nEXPOSE 8080\nENTRYPOINT [\"java\",\"-jar\",\"/app.jar\"]\n\n```\n\n因为公司中还有一个之前的PHP项目，所以也需要对PHP进行打包，查了很多资料，最后在实践中发现，PHP项目需要一个nginx来管理网络，用如何的Dockerfile文件打包的话就会有问题。\n```java\nFROM php:7.0-cli\nRUN apt-get update && apt-get install -y \\\n        libfreetype6-dev \\\n        libjpeg62-turbo-dev \\\n        libmcrypt-dev \\\n        libpng12-dev \\\n    && docker-php-ext-install -j$(nproc) iconv mcrypt \\\n    && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n    && docker-php-ext-install -j$(nproc) gd\nFROM php:7.1-fpm\nRUN pecl install -o -f redis \\\n    &&  rm -rf /tmp/pear \\\n    &&  docker-php-ext-enable redis\nRUN docker-php-ext-install  mysqli pdo pdo_mysql\n\nEXPOSE 80\n\nCOPY . /php\nWORKDIR /php\n```\n经过再三查找资料，发现这么一篇文章：\nhttp://geekyplatypus.com/dockerise-your-php-application-with-nginx-and-php7-fpm/\n在里面找到了解决办法，使用docker-compose就好了，docker-compose.yml文件如下：\n```yml\nversion: '2'\n\nservices:\n    web:\n        image: nginx:latest\n        ports:\n            - \"8080:80\"\n        volumes:\n            - ./:/php\n            - ./site.conf:/etc/nginx/conf.d/default.conf\n        networks:\n            - code-network\n    php:\n        image: php:fpm\n        volumes:\n            - ./:/php\n        networks:\n            - code-network\n\nnetworks:\n    code-network:\n        driver: bridge\n\n```\n上面提到的site.conf文件如下：\n```conf\nserver {\n    listen 80;\n    index index.php index.html;\n    server_name localhost;\n    error_log  /var/log/nginx/error.log;\n    access_log /var/log/nginx/access.log;\n    root /php;\n\n    location ~ \\.php$ {\n        try_files $uri =404;\n        fastcgi_split_path_info ^(.+\\.php)(/.+)$;\n        fastcgi_pass php:9000;\n        fastcgi_index index.php;\n        include fastcgi_params;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        fastcgi_param PATH_INFO $fastcgi_path_info;\n    }\n}\n```\n直接在命令行执行：\n```\n  $sudo docker-compose up\n```\n就可以看看到运行的结果了，可是因为我们是直接部署到阿里云容器服务上面的，docker-compose这种方式就有了缺陷，因为阿里云容器服务不支持``server``这种方式，不得已最终经过查询，找到了：\nhttps://hub.docker.com/r/richarvey/nginx-php-fpm/\n\n直接使用如下Dockerfile就可以了：\n```Java\nFROM richarvey/nginx-php-fpm:latest\n\nMAINTAINER Ric Harvey <ric@ngd.io>\n\nENV PHPREDIS_VERSION 3.0.0\nRUN mkdir -p /usr/src/php/ext/redis \\\n    && curl -L https://github.com/phpredis/phpredis/archive/$PHPREDIS_VERSION.tar.gz | tar xvz -C /usr/src/php/ext/redis --strip 1 \\\n    && echo 'redis' >> /usr/src/php-available-exts \\\n    && docker-php-ext-install redis\n\nEXPOSE 80\n\nADD ./ /var/www/html/\n```\n\n既然当初选择了Docker这种方式，就要想办法吃透这门技术，否则在生产环境中的话出了问题就麻烦了。以上对与PHP的Docker化的实践过程，盯着一行行的日志信息查找原因，因为对PHP不是特别熟，还向PHP的同事请教了很多问题。\n记录下来面的日后再遇到，虽然以上内容没有针对每个Docker的技术点进行介绍，找时间把每个技术点都记录下来。简单来说就是，PHP必须要搭配nginx使用。\n","source":"_posts/docker-php.md","raw":"---\ntitle: Docker在PHP中的实践过程\ndate: 2017-09-18 20:59:36\ntags: Docker\nupdate:\ncomments: false\n---\n最近微服务很火，很多人都在尝试，我们公司也在这段时间尝试着来时间微服务化，其中就涉及到Docker。\n在实践docker中踩了很多坑，也对Docker有了更多的认识，下面记录一下。\n<!--more-->\n\nDocker在打包Spring boot项目时候，因为Spring boot内部集成了tomcat并且提供了直接打包成jar包的方式，[Spring boot如何打包](https://docs.spring.io/spring-boot/docs/current/reference/html/build-tool-plugins-maven-plugin.html)。\n\nDockerfile文件如下：\n```Java\nFROM java:8\n\nCOPY target/your-project-name.jar /app.jar\nEXPOSE 8080\nENTRYPOINT [\"java\",\"-jar\",\"/app.jar\"]\n\n```\n\n因为公司中还有一个之前的PHP项目，所以也需要对PHP进行打包，查了很多资料，最后在实践中发现，PHP项目需要一个nginx来管理网络，用如何的Dockerfile文件打包的话就会有问题。\n```java\nFROM php:7.0-cli\nRUN apt-get update && apt-get install -y \\\n        libfreetype6-dev \\\n        libjpeg62-turbo-dev \\\n        libmcrypt-dev \\\n        libpng12-dev \\\n    && docker-php-ext-install -j$(nproc) iconv mcrypt \\\n    && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n    && docker-php-ext-install -j$(nproc) gd\nFROM php:7.1-fpm\nRUN pecl install -o -f redis \\\n    &&  rm -rf /tmp/pear \\\n    &&  docker-php-ext-enable redis\nRUN docker-php-ext-install  mysqli pdo pdo_mysql\n\nEXPOSE 80\n\nCOPY . /php\nWORKDIR /php\n```\n经过再三查找资料，发现这么一篇文章：\nhttp://geekyplatypus.com/dockerise-your-php-application-with-nginx-and-php7-fpm/\n在里面找到了解决办法，使用docker-compose就好了，docker-compose.yml文件如下：\n```yml\nversion: '2'\n\nservices:\n    web:\n        image: nginx:latest\n        ports:\n            - \"8080:80\"\n        volumes:\n            - ./:/php\n            - ./site.conf:/etc/nginx/conf.d/default.conf\n        networks:\n            - code-network\n    php:\n        image: php:fpm\n        volumes:\n            - ./:/php\n        networks:\n            - code-network\n\nnetworks:\n    code-network:\n        driver: bridge\n\n```\n上面提到的site.conf文件如下：\n```conf\nserver {\n    listen 80;\n    index index.php index.html;\n    server_name localhost;\n    error_log  /var/log/nginx/error.log;\n    access_log /var/log/nginx/access.log;\n    root /php;\n\n    location ~ \\.php$ {\n        try_files $uri =404;\n        fastcgi_split_path_info ^(.+\\.php)(/.+)$;\n        fastcgi_pass php:9000;\n        fastcgi_index index.php;\n        include fastcgi_params;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        fastcgi_param PATH_INFO $fastcgi_path_info;\n    }\n}\n```\n直接在命令行执行：\n```\n  $sudo docker-compose up\n```\n就可以看看到运行的结果了，可是因为我们是直接部署到阿里云容器服务上面的，docker-compose这种方式就有了缺陷，因为阿里云容器服务不支持``server``这种方式，不得已最终经过查询，找到了：\nhttps://hub.docker.com/r/richarvey/nginx-php-fpm/\n\n直接使用如下Dockerfile就可以了：\n```Java\nFROM richarvey/nginx-php-fpm:latest\n\nMAINTAINER Ric Harvey <ric@ngd.io>\n\nENV PHPREDIS_VERSION 3.0.0\nRUN mkdir -p /usr/src/php/ext/redis \\\n    && curl -L https://github.com/phpredis/phpredis/archive/$PHPREDIS_VERSION.tar.gz | tar xvz -C /usr/src/php/ext/redis --strip 1 \\\n    && echo 'redis' >> /usr/src/php-available-exts \\\n    && docker-php-ext-install redis\n\nEXPOSE 80\n\nADD ./ /var/www/html/\n```\n\n既然当初选择了Docker这种方式，就要想办法吃透这门技术，否则在生产环境中的话出了问题就麻烦了。以上对与PHP的Docker化的实践过程，盯着一行行的日志信息查找原因，因为对PHP不是特别熟，还向PHP的同事请教了很多问题。\n记录下来面的日后再遇到，虽然以上内容没有针对每个Docker的技术点进行介绍，找时间把每个技术点都记录下来。简单来说就是，PHP必须要搭配nginx使用。\n","slug":"docker-php","published":1,"updated":"2017-09-18T07:23:48.000Z","layout":"post","photos":[],"link":"","_id":"cjr66widd0019metpdl30a8wa","content":"<p>最近微服务很火，很多人都在尝试，我们公司也在这段时间尝试着来时间微服务化，其中就涉及到Docker。<br>在实践docker中踩了很多坑，也对Docker有了更多的认识，下面记录一下。<br><a id=\"more\"></a></p>\n<p>Docker在打包Spring boot项目时候，因为Spring boot内部集成了tomcat并且提供了直接打包成jar包的方式，<a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/build-tool-plugins-maven-plugin.html\" target=\"_blank\" rel=\"external\">Spring boot如何打包</a>。</p>\n<p>Dockerfile文件如下：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">FROM java:<span class=\"number\">8</span></div><div class=\"line\"></div><div class=\"line\">COPY target/your-project-name.jar /app.jar</div><div class=\"line\">EXPOSE <span class=\"number\">8080</span></div><div class=\"line\">ENTRYPOINT [<span class=\"string\">\"java\"</span>,<span class=\"string\">\"-jar\"</span>,<span class=\"string\">\"/app.jar\"</span>]</div></pre></td></tr></table></figure></p>\n<p>因为公司中还有一个之前的PHP项目，所以也需要对PHP进行打包，查了很多资料，最后在实践中发现，PHP项目需要一个nginx来管理网络，用如何的Dockerfile文件打包的话就会有问题。<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\">FROM php:<span class=\"number\">7.0</span>-cli</div><div class=\"line\">RUN apt-get update &amp;&amp; apt-get install -y \\</div><div class=\"line\">        libfreetype6-dev \\</div><div class=\"line\">        libjpeg62-turbo-dev \\</div><div class=\"line\">        libmcrypt-dev \\</div><div class=\"line\">        libpng12-dev \\</div><div class=\"line\">    &amp;&amp; docker-php-ext-install -j$(nproc) iconv mcrypt \\</div><div class=\"line\">    &amp;&amp; docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\</div><div class=\"line\">    &amp;&amp; docker-php-ext-install -j$(nproc) gd</div><div class=\"line\">FROM php:<span class=\"number\">7.1</span>-fpm</div><div class=\"line\">RUN pecl install -o -f redis \\</div><div class=\"line\">    &amp;&amp;  rm -rf /tmp/pear \\</div><div class=\"line\">    &amp;&amp;  docker-php-ext-enable redis</div><div class=\"line\">RUN docker-php-ext-install  mysqli pdo pdo_mysql</div><div class=\"line\"></div><div class=\"line\">EXPOSE <span class=\"number\">80</span></div><div class=\"line\"></div><div class=\"line\">COPY . /php</div><div class=\"line\">WORKDIR /php</div></pre></td></tr></table></figure></p>\n<p>经过再三查找资料，发现这么一篇文章：<br><a href=\"http://geekyplatypus.com/dockerise-your-php-application-with-nginx-and-php7-fpm/\" target=\"_blank\" rel=\"external\">http://geekyplatypus.com/dockerise-your-php-application-with-nginx-and-php7-fpm/</a><br>在里面找到了解决办法，使用docker-compose就好了，docker-compose.yml文件如下：<br><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'2'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"attr\">services:</span></div><div class=\"line\"><span class=\"attr\">    web:</span></div><div class=\"line\"><span class=\"attr\">        image:</span> nginx:latest</div><div class=\"line\"><span class=\"attr\">        ports:</span></div><div class=\"line\"><span class=\"bullet\">            -</span> <span class=\"string\">\"8080:80\"</span></div><div class=\"line\"><span class=\"attr\">        volumes:</span></div><div class=\"line\"><span class=\"bullet\">            -</span> ./:/php</div><div class=\"line\"><span class=\"bullet\">            -</span> ./site.conf:/etc/nginx/conf.d/default.conf</div><div class=\"line\"><span class=\"attr\">        networks:</span></div><div class=\"line\"><span class=\"bullet\">            -</span> code-network</div><div class=\"line\"><span class=\"attr\">    php:</span></div><div class=\"line\"><span class=\"attr\">        image:</span> php:fpm</div><div class=\"line\"><span class=\"attr\">        volumes:</span></div><div class=\"line\"><span class=\"bullet\">            -</span> ./:/php</div><div class=\"line\"><span class=\"attr\">        networks:</span></div><div class=\"line\"><span class=\"bullet\">            -</span> code-network</div><div class=\"line\"></div><div class=\"line\"><span class=\"attr\">networks:</span></div><div class=\"line\"><span class=\"attr\">    code-network:</span></div><div class=\"line\"><span class=\"attr\">        driver:</span> bridge</div></pre></td></tr></table></figure></p>\n<p>上面提到的site.conf文件如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\">server &#123;</div><div class=\"line\">    listen 80;</div><div class=\"line\">    index index.php index.html;</div><div class=\"line\">    server_name localhost;</div><div class=\"line\">    error_log  /var/log/nginx/error.log;</div><div class=\"line\">    access_log /var/log/nginx/access.log;</div><div class=\"line\">    root /php;</div><div class=\"line\"></div><div class=\"line\">    location ~ \\.php$ &#123;</div><div class=\"line\">        try_files $uri =404;</div><div class=\"line\">        fastcgi_split_path_info ^(.+\\.php)(/.+)$;</div><div class=\"line\">        fastcgi_pass php:9000;</div><div class=\"line\">        fastcgi_index index.php;</div><div class=\"line\">        include fastcgi_params;</div><div class=\"line\">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</div><div class=\"line\">        fastcgi_param PATH_INFO $fastcgi_path_info;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>直接在命令行执行：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$sudo docker-compose up</div></pre></td></tr></table></figure></p>\n<p>就可以看看到运行的结果了，可是因为我们是直接部署到阿里云容器服务上面的，docker-compose这种方式就有了缺陷，因为阿里云容器服务不支持<code>server</code>这种方式，不得已最终经过查询，找到了：<br><a href=\"https://hub.docker.com/r/richarvey/nginx-php-fpm/\" target=\"_blank\" rel=\"external\">https://hub.docker.com/r/richarvey/nginx-php-fpm/</a></p>\n<p>直接使用如下Dockerfile就可以了：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">FROM richarvey/nginx-php-fpm:latest</div><div class=\"line\"></div><div class=\"line\">MAINTAINER Ric Harvey &lt;ric<span class=\"meta\">@ngd</span>.io&gt;</div><div class=\"line\"></div><div class=\"line\">ENV PHPREDIS_VERSION <span class=\"number\">3.0</span>.0</div><div class=\"line\">RUN mkdir -p /usr/src/php/ext/redis \\</div><div class=\"line\">    &amp;&amp; curl -L https:<span class=\"comment\">//github.com/phpredis/phpredis/archive/$PHPREDIS_VERSION.tar.gz | tar xvz -C /usr/src/php/ext/redis --strip 1 \\</span></div><div class=\"line\">    &amp;&amp; echo <span class=\"string\">'redis'</span> &gt;&gt; /usr/src/php-available-exts \\</div><div class=\"line\">    &amp;&amp; docker-php-ext-install redis</div><div class=\"line\"></div><div class=\"line\">EXPOSE <span class=\"number\">80</span></div><div class=\"line\"></div><div class=\"line\">ADD ./ /var/www/html/</div></pre></td></tr></table></figure></p>\n<p>既然当初选择了Docker这种方式，就要想办法吃透这门技术，否则在生产环境中的话出了问题就麻烦了。以上对与PHP的Docker化的实践过程，盯着一行行的日志信息查找原因，因为对PHP不是特别熟，还向PHP的同事请教了很多问题。<br>记录下来面的日后再遇到，虽然以上内容没有针对每个Docker的技术点进行介绍，找时间把每个技术点都记录下来。简单来说就是，PHP必须要搭配nginx使用。</p>\n","excerpt":"<p>最近微服务很火，很多人都在尝试，我们公司也在这段时间尝试着来时间微服务化，其中就涉及到Docker。<br>在实践docker中踩了很多坑，也对Docker有了更多的认识，下面记录一下。<br>","more":"</p>\n<p>Docker在打包Spring boot项目时候，因为Spring boot内部集成了tomcat并且提供了直接打包成jar包的方式，<a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/build-tool-plugins-maven-plugin.html\">Spring boot如何打包</a>。</p>\n<p>Dockerfile文件如下：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">FROM java:<span class=\"number\">8</span></div><div class=\"line\"></div><div class=\"line\">COPY target/your-project-name.jar /app.jar</div><div class=\"line\">EXPOSE <span class=\"number\">8080</span></div><div class=\"line\">ENTRYPOINT [<span class=\"string\">\"java\"</span>,<span class=\"string\">\"-jar\"</span>,<span class=\"string\">\"/app.jar\"</span>]</div></pre></td></tr></table></figure></p>\n<p>因为公司中还有一个之前的PHP项目，所以也需要对PHP进行打包，查了很多资料，最后在实践中发现，PHP项目需要一个nginx来管理网络，用如何的Dockerfile文件打包的话就会有问题。<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\">FROM php:<span class=\"number\">7.0</span>-cli</div><div class=\"line\">RUN apt-get update &amp;&amp; apt-get install -y \\</div><div class=\"line\">        libfreetype6-dev \\</div><div class=\"line\">        libjpeg62-turbo-dev \\</div><div class=\"line\">        libmcrypt-dev \\</div><div class=\"line\">        libpng12-dev \\</div><div class=\"line\">    &amp;&amp; docker-php-ext-install -j$(nproc) iconv mcrypt \\</div><div class=\"line\">    &amp;&amp; docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\</div><div class=\"line\">    &amp;&amp; docker-php-ext-install -j$(nproc) gd</div><div class=\"line\">FROM php:<span class=\"number\">7.1</span>-fpm</div><div class=\"line\">RUN pecl install -o -f redis \\</div><div class=\"line\">    &amp;&amp;  rm -rf /tmp/pear \\</div><div class=\"line\">    &amp;&amp;  docker-php-ext-enable redis</div><div class=\"line\">RUN docker-php-ext-install  mysqli pdo pdo_mysql</div><div class=\"line\"></div><div class=\"line\">EXPOSE <span class=\"number\">80</span></div><div class=\"line\"></div><div class=\"line\">COPY . /php</div><div class=\"line\">WORKDIR /php</div></pre></td></tr></table></figure></p>\n<p>经过再三查找资料，发现这么一篇文章：<br><a href=\"http://geekyplatypus.com/dockerise-your-php-application-with-nginx-and-php7-fpm/\">http://geekyplatypus.com/dockerise-your-php-application-with-nginx-and-php7-fpm/</a><br>在里面找到了解决办法，使用docker-compose就好了，docker-compose.yml文件如下：<br><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'2'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"attr\">services:</span></div><div class=\"line\"><span class=\"attr\">    web:</span></div><div class=\"line\"><span class=\"attr\">        image:</span> nginx:latest</div><div class=\"line\"><span class=\"attr\">        ports:</span></div><div class=\"line\"><span class=\"bullet\">            -</span> <span class=\"string\">\"8080:80\"</span></div><div class=\"line\"><span class=\"attr\">        volumes:</span></div><div class=\"line\"><span class=\"bullet\">            -</span> ./:/php</div><div class=\"line\"><span class=\"bullet\">            -</span> ./site.conf:/etc/nginx/conf.d/default.conf</div><div class=\"line\"><span class=\"attr\">        networks:</span></div><div class=\"line\"><span class=\"bullet\">            -</span> code-network</div><div class=\"line\"><span class=\"attr\">    php:</span></div><div class=\"line\"><span class=\"attr\">        image:</span> php:fpm</div><div class=\"line\"><span class=\"attr\">        volumes:</span></div><div class=\"line\"><span class=\"bullet\">            -</span> ./:/php</div><div class=\"line\"><span class=\"attr\">        networks:</span></div><div class=\"line\"><span class=\"bullet\">            -</span> code-network</div><div class=\"line\"></div><div class=\"line\"><span class=\"attr\">networks:</span></div><div class=\"line\"><span class=\"attr\">    code-network:</span></div><div class=\"line\"><span class=\"attr\">        driver:</span> bridge</div></pre></td></tr></table></figure></p>\n<p>上面提到的site.conf文件如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\">server &#123;</div><div class=\"line\">    listen 80;</div><div class=\"line\">    index index.php index.html;</div><div class=\"line\">    server_name localhost;</div><div class=\"line\">    error_log  /var/log/nginx/error.log;</div><div class=\"line\">    access_log /var/log/nginx/access.log;</div><div class=\"line\">    root /php;</div><div class=\"line\"></div><div class=\"line\">    location ~ \\.php$ &#123;</div><div class=\"line\">        try_files $uri =404;</div><div class=\"line\">        fastcgi_split_path_info ^(.+\\.php)(/.+)$;</div><div class=\"line\">        fastcgi_pass php:9000;</div><div class=\"line\">        fastcgi_index index.php;</div><div class=\"line\">        include fastcgi_params;</div><div class=\"line\">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</div><div class=\"line\">        fastcgi_param PATH_INFO $fastcgi_path_info;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>直接在命令行执行：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$sudo docker-compose up</div></pre></td></tr></table></figure></p>\n<p>就可以看看到运行的结果了，可是因为我们是直接部署到阿里云容器服务上面的，docker-compose这种方式就有了缺陷，因为阿里云容器服务不支持<code>server</code>这种方式，不得已最终经过查询，找到了：<br><a href=\"https://hub.docker.com/r/richarvey/nginx-php-fpm/\">https://hub.docker.com/r/richarvey/nginx-php-fpm/</a></p>\n<p>直接使用如下Dockerfile就可以了：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">FROM richarvey/nginx-php-fpm:latest</div><div class=\"line\"></div><div class=\"line\">MAINTAINER Ric Harvey &lt;ric<span class=\"meta\">@ngd</span>.io&gt;</div><div class=\"line\"></div><div class=\"line\">ENV PHPREDIS_VERSION <span class=\"number\">3.0</span>.0</div><div class=\"line\">RUN mkdir -p /usr/src/php/ext/redis \\</div><div class=\"line\">    &amp;&amp; curl -L https:<span class=\"comment\">//github.com/phpredis/phpredis/archive/$PHPREDIS_VERSION.tar.gz | tar xvz -C /usr/src/php/ext/redis --strip 1 \\</span></div><div class=\"line\">    &amp;&amp; echo <span class=\"string\">'redis'</span> &gt;&gt; /usr/src/php-available-exts \\</div><div class=\"line\">    &amp;&amp; docker-php-ext-install redis</div><div class=\"line\"></div><div class=\"line\">EXPOSE <span class=\"number\">80</span></div><div class=\"line\"></div><div class=\"line\">ADD ./ /var/www/html/</div></pre></td></tr></table></figure></p>\n<p>既然当初选择了Docker这种方式，就要想办法吃透这门技术，否则在生产环境中的话出了问题就麻烦了。以上对与PHP的Docker化的实践过程，盯着一行行的日志信息查找原因，因为对PHP不是特别熟，还向PHP的同事请教了很多问题。<br>记录下来面的日后再遇到，虽然以上内容没有针对每个Docker的技术点进行介绍，找时间把每个技术点都记录下来。简单来说就是，PHP必须要搭配nginx使用。</p>"},{"title":"Gson序列化","date":"2017-03-20T17:09:43.000Z","comments":0,"_content":"最近项目中遇到一个问题，就是Gson解析的时候遇到一个为空的数组，这种时候如果忽略后台优雅地解决这个问题呢？答案就是——Gson 的序列化和反序列化：\n<!--more-->\n```java\npublic class ResultDeserializer implements JsonDeserializer<BaseResult> {\n    @Override\n    public BaseResult deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context) throws JsonParseException {\n        JsonObject obj = json.getAsJsonObject();\n        //下面添加你要做的事情\n        if (obj.get(\"result\") != null) {\n            if (obj.get(\"result\").isJsonObject() && obj.getAsJsonObject(\"result\").has(\"message\") && obj.getAsJsonObject(\"result\").entrySet().size() == 1) {\n                obj.getAsJsonObject(\"result\").remove(\"message\");\n            }\n            if (obj.get(\"result\").toString().equals(\"{}\")) {\n                obj.remove(\"result\");\n            }\n        }\n\n        BaseResult baseResult = new Gson().fromJson(json, typeOfT);\n        if (obj.has(\"success\")&&obj.get(\"success\").getAsString().equals(\"true\")) {\n            baseResult.setSuccess(true);\n        } else {\n            baseResult.setSuccess(false);\n        }\n        if (obj.isJsonNull()) {\n            baseResult.setSuccess(false);\n        }\n        baseResult.setErrorcode(obj.has(\"errorcode\") ? obj.get(\"errorcode\").getAsString() : \"\");\n        baseResult.setErrorcode(obj.has(\"error\") ? obj.get(\"errorcode\").getAsString() : \"\");\n        return baseResult;\n    }\n}\n```\n然后注册一下这个typeadapter\n```java\nGson gson=new GsonBuilder()\n      .registerTypeAdapter(BaseResult.class, new ResultDeserializer())\n      .create();\n```\n然后就好了，你可以写一个范型的Bean的基础类，然后就可以在全局使用了,比如：\n```java\npublic class BaseResult<T> implements Serializable {\n    private Boolean success;\n    private String errorcode;\n    private String error;\n    private T result;\n}\n```\n\n\n``registerTypeAdapter`` 还支持多种类型的，找时间可以去研究一下：\n\n- JsonSerializer &lt;?>\n- JsonDeserializer &lt;?>\n- InstanceCreator &lt;?>\n- TypeAdapter &lt;?>\n","source":"_posts/gson-typeadapter.md","raw":"---\ntitle: Gson序列化\ndate: 2017-03-21 01:09:43\ntags: android\ncomments: false\n---\n最近项目中遇到一个问题，就是Gson解析的时候遇到一个为空的数组，这种时候如果忽略后台优雅地解决这个问题呢？答案就是——Gson 的序列化和反序列化：\n<!--more-->\n```java\npublic class ResultDeserializer implements JsonDeserializer<BaseResult> {\n    @Override\n    public BaseResult deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context) throws JsonParseException {\n        JsonObject obj = json.getAsJsonObject();\n        //下面添加你要做的事情\n        if (obj.get(\"result\") != null) {\n            if (obj.get(\"result\").isJsonObject() && obj.getAsJsonObject(\"result\").has(\"message\") && obj.getAsJsonObject(\"result\").entrySet().size() == 1) {\n                obj.getAsJsonObject(\"result\").remove(\"message\");\n            }\n            if (obj.get(\"result\").toString().equals(\"{}\")) {\n                obj.remove(\"result\");\n            }\n        }\n\n        BaseResult baseResult = new Gson().fromJson(json, typeOfT);\n        if (obj.has(\"success\")&&obj.get(\"success\").getAsString().equals(\"true\")) {\n            baseResult.setSuccess(true);\n        } else {\n            baseResult.setSuccess(false);\n        }\n        if (obj.isJsonNull()) {\n            baseResult.setSuccess(false);\n        }\n        baseResult.setErrorcode(obj.has(\"errorcode\") ? obj.get(\"errorcode\").getAsString() : \"\");\n        baseResult.setErrorcode(obj.has(\"error\") ? obj.get(\"errorcode\").getAsString() : \"\");\n        return baseResult;\n    }\n}\n```\n然后注册一下这个typeadapter\n```java\nGson gson=new GsonBuilder()\n      .registerTypeAdapter(BaseResult.class, new ResultDeserializer())\n      .create();\n```\n然后就好了，你可以写一个范型的Bean的基础类，然后就可以在全局使用了,比如：\n```java\npublic class BaseResult<T> implements Serializable {\n    private Boolean success;\n    private String errorcode;\n    private String error;\n    private T result;\n}\n```\n\n\n``registerTypeAdapter`` 还支持多种类型的，找时间可以去研究一下：\n\n- JsonSerializer &lt;?>\n- JsonDeserializer &lt;?>\n- InstanceCreator &lt;?>\n- TypeAdapter &lt;?>\n","slug":"gson-typeadapter","published":1,"updated":"2017-07-10T06:55:37.000Z","layout":"post","photos":[],"link":"","_id":"cjr66widf001cmetpm0k1vp8u","content":"<p>最近项目中遇到一个问题，就是Gson解析的时候遇到一个为空的数组，这种时候如果忽略后台优雅地解决这个问题呢？答案就是——Gson 的序列化和反序列化：<br><a id=\"more\"></a><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ResultDeserializer</span> <span class=\"keyword\">implements</span> <span class=\"title\">JsonDeserializer</span>&lt;<span class=\"title\">BaseResult</span>&gt; </span>&#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> BaseResult <span class=\"title\">deserialize</span><span class=\"params\">(JsonElement json, Type typeOfT, JsonDeserializationContext context)</span> <span class=\"keyword\">throws</span> JsonParseException </span>&#123;</div><div class=\"line\">        JsonObject obj = json.getAsJsonObject();</div><div class=\"line\">        <span class=\"comment\">//下面添加你要做的事情</span></div><div class=\"line\">        <span class=\"keyword\">if</span> (obj.get(<span class=\"string\">\"result\"</span>) != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (obj.get(<span class=\"string\">\"result\"</span>).isJsonObject() &amp;&amp; obj.getAsJsonObject(<span class=\"string\">\"result\"</span>).has(<span class=\"string\">\"message\"</span>) &amp;&amp; obj.getAsJsonObject(<span class=\"string\">\"result\"</span>).entrySet().size() == <span class=\"number\">1</span>) &#123;</div><div class=\"line\">                obj.getAsJsonObject(<span class=\"string\">\"result\"</span>).remove(<span class=\"string\">\"message\"</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">if</span> (obj.get(<span class=\"string\">\"result\"</span>).toString().equals(<span class=\"string\">\"&#123;&#125;\"</span>)) &#123;</div><div class=\"line\">                obj.remove(<span class=\"string\">\"result\"</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        BaseResult baseResult = <span class=\"keyword\">new</span> Gson().fromJson(json, typeOfT);</div><div class=\"line\">        <span class=\"keyword\">if</span> (obj.has(<span class=\"string\">\"success\"</span>)&amp;&amp;obj.get(<span class=\"string\">\"success\"</span>).getAsString().equals(<span class=\"string\">\"true\"</span>)) &#123;</div><div class=\"line\">            baseResult.setSuccess(<span class=\"keyword\">true</span>);</div><div class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">            baseResult.setSuccess(<span class=\"keyword\">false</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">if</span> (obj.isJsonNull()) &#123;</div><div class=\"line\">            baseResult.setSuccess(<span class=\"keyword\">false</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">        baseResult.setErrorcode(obj.has(<span class=\"string\">\"errorcode\"</span>) ? obj.get(<span class=\"string\">\"errorcode\"</span>).getAsString() : <span class=\"string\">\"\"</span>);</div><div class=\"line\">        baseResult.setErrorcode(obj.has(<span class=\"string\">\"error\"</span>) ? obj.get(<span class=\"string\">\"errorcode\"</span>).getAsString() : <span class=\"string\">\"\"</span>);</div><div class=\"line\">        <span class=\"keyword\">return</span> baseResult;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>然后注册一下这个typeadapter<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">Gson gson=<span class=\"keyword\">new</span> GsonBuilder()</div><div class=\"line\">      .registerTypeAdapter(BaseResult.class, <span class=\"keyword\">new</span> ResultDeserializer())</div><div class=\"line\">      .create();</div></pre></td></tr></table></figure></p>\n<p>然后就好了，你可以写一个范型的Bean的基础类，然后就可以在全局使用了,比如：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BaseResult</span>&lt;<span class=\"title\">T</span>&gt; <span class=\"keyword\">implements</span> <span class=\"title\">Serializable</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> Boolean success;</div><div class=\"line\">    <span class=\"keyword\">private</span> String errorcode;</div><div class=\"line\">    <span class=\"keyword\">private</span> String error;</div><div class=\"line\">    <span class=\"keyword\">private</span> T result;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p><code>registerTypeAdapter</code> 还支持多种类型的，找时间可以去研究一下：</p>\n<ul>\n<li>JsonSerializer &lt;?&gt;</li>\n<li>JsonDeserializer &lt;?&gt;</li>\n<li>InstanceCreator &lt;?&gt;</li>\n<li>TypeAdapter &lt;?&gt;</li>\n</ul>\n","excerpt":"<p>最近项目中遇到一个问题，就是Gson解析的时候遇到一个为空的数组，这种时候如果忽略后台优雅地解决这个问题呢？答案就是——Gson 的序列化和反序列化：<br>","more":"<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ResultDeserializer</span> <span class=\"keyword\">implements</span> <span class=\"title\">JsonDeserializer</span>&lt;<span class=\"title\">BaseResult</span>&gt; </span>&#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> BaseResult <span class=\"title\">deserialize</span><span class=\"params\">(JsonElement json, Type typeOfT, JsonDeserializationContext context)</span> <span class=\"keyword\">throws</span> JsonParseException </span>&#123;</div><div class=\"line\">        JsonObject obj = json.getAsJsonObject();</div><div class=\"line\">        <span class=\"comment\">//下面添加你要做的事情</span></div><div class=\"line\">        <span class=\"keyword\">if</span> (obj.get(<span class=\"string\">\"result\"</span>) != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (obj.get(<span class=\"string\">\"result\"</span>).isJsonObject() &amp;&amp; obj.getAsJsonObject(<span class=\"string\">\"result\"</span>).has(<span class=\"string\">\"message\"</span>) &amp;&amp; obj.getAsJsonObject(<span class=\"string\">\"result\"</span>).entrySet().size() == <span class=\"number\">1</span>) &#123;</div><div class=\"line\">                obj.getAsJsonObject(<span class=\"string\">\"result\"</span>).remove(<span class=\"string\">\"message\"</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">if</span> (obj.get(<span class=\"string\">\"result\"</span>).toString().equals(<span class=\"string\">\"&#123;&#125;\"</span>)) &#123;</div><div class=\"line\">                obj.remove(<span class=\"string\">\"result\"</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        BaseResult baseResult = <span class=\"keyword\">new</span> Gson().fromJson(json, typeOfT);</div><div class=\"line\">        <span class=\"keyword\">if</span> (obj.has(<span class=\"string\">\"success\"</span>)&amp;&amp;obj.get(<span class=\"string\">\"success\"</span>).getAsString().equals(<span class=\"string\">\"true\"</span>)) &#123;</div><div class=\"line\">            baseResult.setSuccess(<span class=\"keyword\">true</span>);</div><div class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">            baseResult.setSuccess(<span class=\"keyword\">false</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">if</span> (obj.isJsonNull()) &#123;</div><div class=\"line\">            baseResult.setSuccess(<span class=\"keyword\">false</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">        baseResult.setErrorcode(obj.has(<span class=\"string\">\"errorcode\"</span>) ? obj.get(<span class=\"string\">\"errorcode\"</span>).getAsString() : <span class=\"string\">\"\"</span>);</div><div class=\"line\">        baseResult.setErrorcode(obj.has(<span class=\"string\">\"error\"</span>) ? obj.get(<span class=\"string\">\"errorcode\"</span>).getAsString() : <span class=\"string\">\"\"</span>);</div><div class=\"line\">        <span class=\"keyword\">return</span> baseResult;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>然后注册一下这个typeadapter<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">Gson gson=<span class=\"keyword\">new</span> GsonBuilder()</div><div class=\"line\">      .registerTypeAdapter(BaseResult.class, <span class=\"keyword\">new</span> ResultDeserializer())</div><div class=\"line\">      .create();</div></pre></td></tr></table></figure></p>\n<p>然后就好了，你可以写一个范型的Bean的基础类，然后就可以在全局使用了,比如：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BaseResult</span>&lt;<span class=\"title\">T</span>&gt; <span class=\"keyword\">implements</span> <span class=\"title\">Serializable</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> Boolean success;</div><div class=\"line\">    <span class=\"keyword\">private</span> String errorcode;</div><div class=\"line\">    <span class=\"keyword\">private</span> String error;</div><div class=\"line\">    <span class=\"keyword\">private</span> T result;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p><code>registerTypeAdapter</code> 还支持多种类型的，找时间可以去研究一下：</p>\n<ul>\n<li>JsonSerializer &lt;?&gt;</li>\n<li>JsonDeserializer &lt;?&gt;</li>\n<li>InstanceCreator &lt;?&gt;</li>\n<li>TypeAdapter &lt;?&gt;</li>\n</ul>"},{"title":"RecyclerView","date":"2016-04-20T13:13:42.000Z","comments":0,"_content":"最新在项目中使用了Android L出现的新控件RecyclerView，把学习的过程都贴出来，便于日后查询。\n\n![Android L](http://img.blog.csdn.net/20160416104439646)\n\n<!--more-->\n\nRecyclerView提供了四种配置：\n> - RecyclerView.LayoutManager\n> - RecyclerView.Adapter< VH extends RecyclerView.ViewHolder >\n> - RecyclerView.ItemDecoration\n> - RecyclerView.ItemAnimator\n\n##  **RecyclerView.LayoutManager**\n一共有三种布局，分别是：\n> - GridLayoutManager      网格布局\n> - LinearLayoutManager   线性布局\n> - StaggeredGridLayoutManager     瀑布流布局\n\n##  **RecyclerView.ItemDecoration**\n可以绘制特殊的RecyclerView的视图，放一篇参考文章<http://blog.csdn.net/lmj623565791/article/details/45059587>\n\n## **RecyclerView.ItemAnimator**\n动画效果，可以指定RecyclerView在添加删除Item时的动画效果。同样，放一篇参考效果\n<https://github.com/wasabeef/recyclerview-animators>\n\n## **RecyclerView.Adapter< VH extends RecyclerView.ViewHolder >**\nRecyclerView的Adapter相比较listview的adapter，强制把ViewHolder分离了出来，有几个方法需要重写：\n```java\npublic class RecyclerViewAdapter extends RecyclerView.Adapter<RecyclerViewAdapter.ViewHolder> {\n    private Context context;\n    private List<String> list;\n\n    public RankRecyclerViewAdpter(Context context, List<String> list) {\n        this.context = context;\n        this.list = list;\n    }\n\n    @Override\n    public RecyclerView.ViewHolder onCreateViewHolder(ViewGroup parent, int viewType) {\n        View v = LayoutInflater.from(parent.getContext()).inflate(R.layout.item_layout, parent, false);\n        return new ViewHolder(v);\n    }\n\n    @Override\n    public void onBindViewHolder(ViewHolder viewHolder, int position) {\n        viewHolder.textView.setText(list.get(position));\n    }\n\n    @Override\n    public int getItemCount() {\n        return list.size();\n    }\n\n    public class ViewHolder extends RecyclerView.ViewHolder {\n        public TextView textView;\n        public ViewHolder(View View) {\n            super(view);\n            textView= (TextView) itemView.findViewById(R.id.textView);\n        }\n    }\n}\n```\n\n有几个问题需要注意：\n> - layout中放的应该是`android.support.v7.widget.RecyclerView` 不然会报错。\n> - `getItemCount()` 的返回值不能为空，不然不会执行`onBindViewHolder`\n> - RecyclerView必须指定LayoutManger，不然同样会报错。\n\n## **RecyclerView的点击事件**\n官方文档中并没有给我们类似ListView的`OnItemClickListener`回调方法，由于RecyclerView比ListView更高级，所以它并没有行或者列的概念，子View可以任意布局，每个子View处理自己的onClick事件，也就是说在Adapter中给子view的rootview设置点击回调。我们今天所要实现的是另外一种方式，类似ListView的`OnItemClickListener`的方式。通过文档我们知道RecyclerView留给开发者一个`RecyclerView.OnItemTouchListener`接口，我们要做的就是实现它，实现点击的回调和长按回调。当然了，这种方式只是一个开始，我们还可以拓展为各种复杂的手势操作的回调。\n参考自：<http://blog.csdn.net/hlglinglong/article/details/44981889>\n```java\npublic class RecyclerItemClickListener implements RecyclerView.OnItemTouchListener{  \n    private View childView;  \n    private RecyclerView touchView;  \n    public RecyclerItemClickListener(Context context, final OnItemClickListener mListener) {  \n        mGestureDetector = new GestureDetector(context, new GestureDetector.SimpleOnGestureListener(){  \n            @Override  \n            public boolean onSingleTapUp(MotionEvent ev) {  \n                if (childView != null && mListener != null) {  \n                    mListener.onItemClick(childView, touchView.getChildPosition(childView));  \n                }  \n                return true;  \n            }  \n            @Override  \n            public void onLongPress(MotionEvent ev) {  \n                if (childView != null && mListener != null) {  \n                    mListener.onLongClick(childView, touchView.getChildPosition(childView));  \n                }  \n            }  \n        });  \n    }  \n\n    GestureDetector mGestureDetector;  \n\n    public interface OnItemClickListener {  \n        public void onItemClick(View view, int position);  \n        public void onLongClick(View view, int posotion);  \n    }  \n\n    @Override  \n    public boolean onInterceptTouchEvent(RecyclerView recyclerView, MotionEvent motionEvent) {  \n        mGestureDetector.onTouchEvent(motionEvent);  \n        childView = recyclerView.findChildViewUnder(motionEvent.getX(), motionEvent.getY());  \n        touchView = recyclerView;  \n        return false;  \n    }  \n\n    @Override  \n    public void onTouchEvent(RecyclerView recyclerView, MotionEvent motionEvent) {  \n\n    }  \n}\n```\n\n## **类似listview的`addHeaderView`和`addFooterView`**\n\nRecyclerView同样没有提供类似listview的`addHeaderView`和`addFooterView` 方法，不过我们可以自定义，参考文章：\n<https://github.com/dingdingyr/HeaderAndFooterRecyclerView->\n原理就是：\n```java\n\t\tGridLayoutManager manager = new GridLayoutManager(this, 2);\n        manager.setSpanSizeLookup(new GridLayoutManager.SpanSizeLookup() {\n            @Override\n            public int getSpanSize(int position) {\n                return adapter.getItemViewType()? manager.getSpanCount() : 1;\n            }\n        });\n```\nGirdLayout可以设置显示的行数，我们可以根据我们要显示的Item类型来指定这个值。\n\n**还有一个问题，那就是在更新apdater的时候不推荐使用`notifyDataSetChanged()` ，因为`notifyDataSetChanged()` 会强制刷新整个视图，如果插入新的数据可以使用 `public final void notifyItemRangeInserted(int positionStart, int itemCount);`。**\n","source":"_posts/recyclerview.md","raw":"---\ntitle: RecyclerView\ndate: 2016-04-20 21:13:42\ntags: android\ncomments: false\n---\n最新在项目中使用了Android L出现的新控件RecyclerView，把学习的过程都贴出来，便于日后查询。\n\n![Android L](http://img.blog.csdn.net/20160416104439646)\n\n<!--more-->\n\nRecyclerView提供了四种配置：\n> - RecyclerView.LayoutManager\n> - RecyclerView.Adapter< VH extends RecyclerView.ViewHolder >\n> - RecyclerView.ItemDecoration\n> - RecyclerView.ItemAnimator\n\n##  **RecyclerView.LayoutManager**\n一共有三种布局，分别是：\n> - GridLayoutManager      网格布局\n> - LinearLayoutManager   线性布局\n> - StaggeredGridLayoutManager     瀑布流布局\n\n##  **RecyclerView.ItemDecoration**\n可以绘制特殊的RecyclerView的视图，放一篇参考文章<http://blog.csdn.net/lmj623565791/article/details/45059587>\n\n## **RecyclerView.ItemAnimator**\n动画效果，可以指定RecyclerView在添加删除Item时的动画效果。同样，放一篇参考效果\n<https://github.com/wasabeef/recyclerview-animators>\n\n## **RecyclerView.Adapter< VH extends RecyclerView.ViewHolder >**\nRecyclerView的Adapter相比较listview的adapter，强制把ViewHolder分离了出来，有几个方法需要重写：\n```java\npublic class RecyclerViewAdapter extends RecyclerView.Adapter<RecyclerViewAdapter.ViewHolder> {\n    private Context context;\n    private List<String> list;\n\n    public RankRecyclerViewAdpter(Context context, List<String> list) {\n        this.context = context;\n        this.list = list;\n    }\n\n    @Override\n    public RecyclerView.ViewHolder onCreateViewHolder(ViewGroup parent, int viewType) {\n        View v = LayoutInflater.from(parent.getContext()).inflate(R.layout.item_layout, parent, false);\n        return new ViewHolder(v);\n    }\n\n    @Override\n    public void onBindViewHolder(ViewHolder viewHolder, int position) {\n        viewHolder.textView.setText(list.get(position));\n    }\n\n    @Override\n    public int getItemCount() {\n        return list.size();\n    }\n\n    public class ViewHolder extends RecyclerView.ViewHolder {\n        public TextView textView;\n        public ViewHolder(View View) {\n            super(view);\n            textView= (TextView) itemView.findViewById(R.id.textView);\n        }\n    }\n}\n```\n\n有几个问题需要注意：\n> - layout中放的应该是`android.support.v7.widget.RecyclerView` 不然会报错。\n> - `getItemCount()` 的返回值不能为空，不然不会执行`onBindViewHolder`\n> - RecyclerView必须指定LayoutManger，不然同样会报错。\n\n## **RecyclerView的点击事件**\n官方文档中并没有给我们类似ListView的`OnItemClickListener`回调方法，由于RecyclerView比ListView更高级，所以它并没有行或者列的概念，子View可以任意布局，每个子View处理自己的onClick事件，也就是说在Adapter中给子view的rootview设置点击回调。我们今天所要实现的是另外一种方式，类似ListView的`OnItemClickListener`的方式。通过文档我们知道RecyclerView留给开发者一个`RecyclerView.OnItemTouchListener`接口，我们要做的就是实现它，实现点击的回调和长按回调。当然了，这种方式只是一个开始，我们还可以拓展为各种复杂的手势操作的回调。\n参考自：<http://blog.csdn.net/hlglinglong/article/details/44981889>\n```java\npublic class RecyclerItemClickListener implements RecyclerView.OnItemTouchListener{  \n    private View childView;  \n    private RecyclerView touchView;  \n    public RecyclerItemClickListener(Context context, final OnItemClickListener mListener) {  \n        mGestureDetector = new GestureDetector(context, new GestureDetector.SimpleOnGestureListener(){  \n            @Override  \n            public boolean onSingleTapUp(MotionEvent ev) {  \n                if (childView != null && mListener != null) {  \n                    mListener.onItemClick(childView, touchView.getChildPosition(childView));  \n                }  \n                return true;  \n            }  \n            @Override  \n            public void onLongPress(MotionEvent ev) {  \n                if (childView != null && mListener != null) {  \n                    mListener.onLongClick(childView, touchView.getChildPosition(childView));  \n                }  \n            }  \n        });  \n    }  \n\n    GestureDetector mGestureDetector;  \n\n    public interface OnItemClickListener {  \n        public void onItemClick(View view, int position);  \n        public void onLongClick(View view, int posotion);  \n    }  \n\n    @Override  \n    public boolean onInterceptTouchEvent(RecyclerView recyclerView, MotionEvent motionEvent) {  \n        mGestureDetector.onTouchEvent(motionEvent);  \n        childView = recyclerView.findChildViewUnder(motionEvent.getX(), motionEvent.getY());  \n        touchView = recyclerView;  \n        return false;  \n    }  \n\n    @Override  \n    public void onTouchEvent(RecyclerView recyclerView, MotionEvent motionEvent) {  \n\n    }  \n}\n```\n\n## **类似listview的`addHeaderView`和`addFooterView`**\n\nRecyclerView同样没有提供类似listview的`addHeaderView`和`addFooterView` 方法，不过我们可以自定义，参考文章：\n<https://github.com/dingdingyr/HeaderAndFooterRecyclerView->\n原理就是：\n```java\n\t\tGridLayoutManager manager = new GridLayoutManager(this, 2);\n        manager.setSpanSizeLookup(new GridLayoutManager.SpanSizeLookup() {\n            @Override\n            public int getSpanSize(int position) {\n                return adapter.getItemViewType()? manager.getSpanCount() : 1;\n            }\n        });\n```\nGirdLayout可以设置显示的行数，我们可以根据我们要显示的Item类型来指定这个值。\n\n**还有一个问题，那就是在更新apdater的时候不推荐使用`notifyDataSetChanged()` ，因为`notifyDataSetChanged()` 会强制刷新整个视图，如果插入新的数据可以使用 `public final void notifyItemRangeInserted(int positionStart, int itemCount);`。**\n","slug":"recyclerview","published":1,"updated":"2017-04-15T14:05:59.000Z","layout":"post","photos":[],"link":"","_id":"cjr66widi001emetpmh1unefs","content":"<p>最新在项目中使用了Android L出现的新控件RecyclerView，把学习的过程都贴出来，便于日后查询。</p>\n<p><img src=\"http://img.blog.csdn.net/20160416104439646\" alt=\"Android L\"></p>\n<a id=\"more\"></a>\n<p>RecyclerView提供了四种配置：</p>\n<blockquote>\n<ul>\n<li>RecyclerView.LayoutManager</li>\n<li>RecyclerView.Adapter&lt; VH extends RecyclerView.ViewHolder &gt;</li>\n<li>RecyclerView.ItemDecoration</li>\n<li>RecyclerView.ItemAnimator</li>\n</ul>\n</blockquote>\n<h2 id=\"RecyclerView-LayoutManager\"><a href=\"#RecyclerView-LayoutManager\" class=\"headerlink\" title=\"RecyclerView.LayoutManager\"></a><strong>RecyclerView.LayoutManager</strong></h2><p>一共有三种布局，分别是：</p>\n<blockquote>\n<ul>\n<li>GridLayoutManager      网格布局</li>\n<li>LinearLayoutManager   线性布局</li>\n<li>StaggeredGridLayoutManager     瀑布流布局</li>\n</ul>\n</blockquote>\n<h2 id=\"RecyclerView-ItemDecoration\"><a href=\"#RecyclerView-ItemDecoration\" class=\"headerlink\" title=\"RecyclerView.ItemDecoration\"></a><strong>RecyclerView.ItemDecoration</strong></h2><p>可以绘制特殊的RecyclerView的视图，放一篇参考文章<a href=\"http://blog.csdn.net/lmj623565791/article/details/45059587\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/lmj623565791/article/details/45059587</a></p>\n<h2 id=\"RecyclerView-ItemAnimator\"><a href=\"#RecyclerView-ItemAnimator\" class=\"headerlink\" title=\"RecyclerView.ItemAnimator\"></a><strong>RecyclerView.ItemAnimator</strong></h2><p>动画效果，可以指定RecyclerView在添加删除Item时的动画效果。同样，放一篇参考效果<br><a href=\"https://github.com/wasabeef/recyclerview-animators\" target=\"_blank\" rel=\"external\">https://github.com/wasabeef/recyclerview-animators</a></p>\n<h2 id=\"RecyclerView-Adapter-lt-VH-extends-RecyclerView-ViewHolder-gt\"><a href=\"#RecyclerView-Adapter-lt-VH-extends-RecyclerView-ViewHolder-gt\" class=\"headerlink\" title=\"RecyclerView.Adapter&lt; VH extends RecyclerView.ViewHolder &gt;\"></a><strong>RecyclerView.Adapter&lt; VH extends RecyclerView.ViewHolder &gt;</strong></h2><p>RecyclerView的Adapter相比较listview的adapter，强制把ViewHolder分离了出来，有几个方法需要重写：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RecyclerViewAdapter</span> <span class=\"keyword\">extends</span> <span class=\"title\">RecyclerView</span>.<span class=\"title\">Adapter</span>&lt;<span class=\"title\">RecyclerViewAdapter</span>.<span class=\"title\">ViewHolder</span>&gt; </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> Context context;</div><div class=\"line\">    <span class=\"keyword\">private</span> List&lt;String&gt; list;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">RankRecyclerViewAdpter</span><span class=\"params\">(Context context, List&lt;String&gt; list)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.context = context;</div><div class=\"line\">        <span class=\"keyword\">this</span>.list = list;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"keyword\">public</span> RecyclerView.<span class=\"function\">ViewHolder <span class=\"title\">onCreateViewHolder</span><span class=\"params\">(ViewGroup parent, <span class=\"keyword\">int</span> viewType)</span> </span>&#123;</div><div class=\"line\">        View v = LayoutInflater.from(parent.getContext()).inflate(R.layout.item_layout, parent, <span class=\"keyword\">false</span>);</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ViewHolder(v);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onBindViewHolder</span><span class=\"params\">(ViewHolder viewHolder, <span class=\"keyword\">int</span> position)</span> </span>&#123;</div><div class=\"line\">        viewHolder.textView.setText(list.get(position));</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getItemCount</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> list.size();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ViewHolder</span> <span class=\"keyword\">extends</span> <span class=\"title\">RecyclerView</span>.<span class=\"title\">ViewHolder</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">public</span> TextView textView;</div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ViewHolder</span><span class=\"params\">(View View)</span> </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">super</span>(view);</div><div class=\"line\">            textView= (TextView) itemView.findViewById(R.id.textView);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>有几个问题需要注意：</p>\n<blockquote>\n<ul>\n<li>layout中放的应该是<code>android.support.v7.widget.RecyclerView</code> 不然会报错。</li>\n<li><code>getItemCount()</code> 的返回值不能为空，不然不会执行<code>onBindViewHolder</code></li>\n<li>RecyclerView必须指定LayoutManger，不然同样会报错。</li>\n</ul>\n</blockquote>\n<h2 id=\"RecyclerView的点击事件\"><a href=\"#RecyclerView的点击事件\" class=\"headerlink\" title=\"RecyclerView的点击事件\"></a><strong>RecyclerView的点击事件</strong></h2><p>官方文档中并没有给我们类似ListView的<code>OnItemClickListener</code>回调方法，由于RecyclerView比ListView更高级，所以它并没有行或者列的概念，子View可以任意布局，每个子View处理自己的onClick事件，也就是说在Adapter中给子view的rootview设置点击回调。我们今天所要实现的是另外一种方式，类似ListView的<code>OnItemClickListener</code>的方式。通过文档我们知道RecyclerView留给开发者一个<code>RecyclerView.OnItemTouchListener</code>接口，我们要做的就是实现它，实现点击的回调和长按回调。当然了，这种方式只是一个开始，我们还可以拓展为各种复杂的手势操作的回调。<br>参考自：<a href=\"http://blog.csdn.net/hlglinglong/article/details/44981889\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/hlglinglong/article/details/44981889</a><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RecyclerItemClickListener</span> <span class=\"keyword\">implements</span> <span class=\"title\">RecyclerView</span>.<span class=\"title\">OnItemTouchListener</span></span>&#123;  </div><div class=\"line\">    <span class=\"keyword\">private</span> View childView;  </div><div class=\"line\">    <span class=\"keyword\">private</span> RecyclerView touchView;  </div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">RecyclerItemClickListener</span><span class=\"params\">(Context context, <span class=\"keyword\">final</span> OnItemClickListener mListener)</span> </span>&#123;  </div><div class=\"line\">        mGestureDetector = <span class=\"keyword\">new</span> GestureDetector(context, <span class=\"keyword\">new</span> GestureDetector.SimpleOnGestureListener()&#123;  </div><div class=\"line\">            <span class=\"meta\">@Override</span>  </div><div class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onSingleTapUp</span><span class=\"params\">(MotionEvent ev)</span> </span>&#123;  </div><div class=\"line\">                <span class=\"keyword\">if</span> (childView != <span class=\"keyword\">null</span> &amp;&amp; mListener != <span class=\"keyword\">null</span>) &#123;  </div><div class=\"line\">                    mListener.onItemClick(childView, touchView.getChildPosition(childView));  </div><div class=\"line\">                &#125;  </div><div class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;  </div><div class=\"line\">            &#125;  </div><div class=\"line\">            <span class=\"meta\">@Override</span>  </div><div class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onLongPress</span><span class=\"params\">(MotionEvent ev)</span> </span>&#123;  </div><div class=\"line\">                <span class=\"keyword\">if</span> (childView != <span class=\"keyword\">null</span> &amp;&amp; mListener != <span class=\"keyword\">null</span>) &#123;  </div><div class=\"line\">                    mListener.onLongClick(childView, touchView.getChildPosition(childView));  </div><div class=\"line\">                &#125;  </div><div class=\"line\">            &#125;  </div><div class=\"line\">        &#125;);  </div><div class=\"line\">    &#125;  </div><div class=\"line\"></div><div class=\"line\">    GestureDetector mGestureDetector;  </div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">OnItemClickListener</span> </span>&#123;  </div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onItemClick</span><span class=\"params\">(View view, <span class=\"keyword\">int</span> position)</span></span>;  </div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onLongClick</span><span class=\"params\">(View view, <span class=\"keyword\">int</span> posotion)</span></span>;  </div><div class=\"line\">    &#125;  </div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span>  </div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onInterceptTouchEvent</span><span class=\"params\">(RecyclerView recyclerView, MotionEvent motionEvent)</span> </span>&#123;  </div><div class=\"line\">        mGestureDetector.onTouchEvent(motionEvent);  </div><div class=\"line\">        childView = recyclerView.findChildViewUnder(motionEvent.getX(), motionEvent.getY());  </div><div class=\"line\">        touchView = recyclerView;  </div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;  </div><div class=\"line\">    &#125;  </div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span>  </div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onTouchEvent</span><span class=\"params\">(RecyclerView recyclerView, MotionEvent motionEvent)</span> </span>&#123;  </div><div class=\"line\"></div><div class=\"line\">    &#125;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h2 id=\"类似listview的addHeaderView和addFooterView\"><a href=\"#类似listview的addHeaderView和addFooterView\" class=\"headerlink\" title=\"类似listview的addHeaderView和addFooterView\"></a><strong>类似listview的<code>addHeaderView</code>和<code>addFooterView</code></strong></h2><p>RecyclerView同样没有提供类似listview的<code>addHeaderView</code>和<code>addFooterView</code> 方法，不过我们可以自定义，参考文章：<br><a href=\"https://github.com/dingdingyr/HeaderAndFooterRecyclerView-\" target=\"_blank\" rel=\"external\">https://github.com/dingdingyr/HeaderAndFooterRecyclerView-</a><br>原理就是：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">GridLayoutManager manager = <span class=\"keyword\">new</span> GridLayoutManager(<span class=\"keyword\">this</span>, <span class=\"number\">2</span>);</div><div class=\"line\">      manager.setSpanSizeLookup(<span class=\"keyword\">new</span> GridLayoutManager.SpanSizeLookup() &#123;</div><div class=\"line\">          <span class=\"meta\">@Override</span></div><div class=\"line\">          <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getSpanSize</span><span class=\"params\">(<span class=\"keyword\">int</span> position)</span> </span>&#123;</div><div class=\"line\">              <span class=\"keyword\">return</span> adapter.getItemViewType()? manager.getSpanCount() : <span class=\"number\">1</span>;</div><div class=\"line\">          &#125;</div><div class=\"line\">      &#125;);</div></pre></td></tr></table></figure></p>\n<p>GirdLayout可以设置显示的行数，我们可以根据我们要显示的Item类型来指定这个值。</p>\n<p><strong>还有一个问题，那就是在更新apdater的时候不推荐使用<code>notifyDataSetChanged()</code> ，因为<code>notifyDataSetChanged()</code> 会强制刷新整个视图，如果插入新的数据可以使用 <code>public final void notifyItemRangeInserted(int positionStart, int itemCount);</code>。</strong></p>\n","excerpt":"<p>最新在项目中使用了Android L出现的新控件RecyclerView，把学习的过程都贴出来，便于日后查询。</p>\n<p><img src=\"http://img.blog.csdn.net/20160416104439646\" alt=\"Android L\"></p>","more":"<p>RecyclerView提供了四种配置：</p>\n<blockquote>\n<ul>\n<li>RecyclerView.LayoutManager</li>\n<li>RecyclerView.Adapter&lt; VH extends RecyclerView.ViewHolder &gt;</li>\n<li>RecyclerView.ItemDecoration</li>\n<li>RecyclerView.ItemAnimator</li>\n</ul>\n</blockquote>\n<h2 id=\"RecyclerView-LayoutManager\"><a href=\"#RecyclerView-LayoutManager\" class=\"headerlink\" title=\"RecyclerView.LayoutManager\"></a><strong>RecyclerView.LayoutManager</strong></h2><p>一共有三种布局，分别是：</p>\n<blockquote>\n<ul>\n<li>GridLayoutManager      网格布局</li>\n<li>LinearLayoutManager   线性布局</li>\n<li>StaggeredGridLayoutManager     瀑布流布局</li>\n</ul>\n</blockquote>\n<h2 id=\"RecyclerView-ItemDecoration\"><a href=\"#RecyclerView-ItemDecoration\" class=\"headerlink\" title=\"RecyclerView.ItemDecoration\"></a><strong>RecyclerView.ItemDecoration</strong></h2><p>可以绘制特殊的RecyclerView的视图，放一篇参考文章<a href=\"http://blog.csdn.net/lmj623565791/article/details/45059587\">http://blog.csdn.net/lmj623565791/article/details/45059587</a></p>\n<h2 id=\"RecyclerView-ItemAnimator\"><a href=\"#RecyclerView-ItemAnimator\" class=\"headerlink\" title=\"RecyclerView.ItemAnimator\"></a><strong>RecyclerView.ItemAnimator</strong></h2><p>动画效果，可以指定RecyclerView在添加删除Item时的动画效果。同样，放一篇参考效果<br><a href=\"https://github.com/wasabeef/recyclerview-animators\">https://github.com/wasabeef/recyclerview-animators</a></p>\n<h2 id=\"RecyclerView-Adapter-lt-VH-extends-RecyclerView-ViewHolder-gt\"><a href=\"#RecyclerView-Adapter-lt-VH-extends-RecyclerView-ViewHolder-gt\" class=\"headerlink\" title=\"RecyclerView.Adapter&lt; VH extends RecyclerView.ViewHolder &gt;\"></a><strong>RecyclerView.Adapter&lt; VH extends RecyclerView.ViewHolder &gt;</strong></h2><p>RecyclerView的Adapter相比较listview的adapter，强制把ViewHolder分离了出来，有几个方法需要重写：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RecyclerViewAdapter</span> <span class=\"keyword\">extends</span> <span class=\"title\">RecyclerView</span>.<span class=\"title\">Adapter</span>&lt;<span class=\"title\">RecyclerViewAdapter</span>.<span class=\"title\">ViewHolder</span>&gt; </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> Context context;</div><div class=\"line\">    <span class=\"keyword\">private</span> List&lt;String&gt; list;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">RankRecyclerViewAdpter</span><span class=\"params\">(Context context, List&lt;String&gt; list)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.context = context;</div><div class=\"line\">        <span class=\"keyword\">this</span>.list = list;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"keyword\">public</span> RecyclerView.<span class=\"function\">ViewHolder <span class=\"title\">onCreateViewHolder</span><span class=\"params\">(ViewGroup parent, <span class=\"keyword\">int</span> viewType)</span> </span>&#123;</div><div class=\"line\">        View v = LayoutInflater.from(parent.getContext()).inflate(R.layout.item_layout, parent, <span class=\"keyword\">false</span>);</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ViewHolder(v);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onBindViewHolder</span><span class=\"params\">(ViewHolder viewHolder, <span class=\"keyword\">int</span> position)</span> </span>&#123;</div><div class=\"line\">        viewHolder.textView.setText(list.get(position));</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getItemCount</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> list.size();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ViewHolder</span> <span class=\"keyword\">extends</span> <span class=\"title\">RecyclerView</span>.<span class=\"title\">ViewHolder</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">public</span> TextView textView;</div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ViewHolder</span><span class=\"params\">(View View)</span> </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">super</span>(view);</div><div class=\"line\">            textView= (TextView) itemView.findViewById(R.id.textView);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>有几个问题需要注意：</p>\n<blockquote>\n<ul>\n<li>layout中放的应该是<code>android.support.v7.widget.RecyclerView</code> 不然会报错。</li>\n<li><code>getItemCount()</code> 的返回值不能为空，不然不会执行<code>onBindViewHolder</code></li>\n<li>RecyclerView必须指定LayoutManger，不然同样会报错。</li>\n</ul>\n</blockquote>\n<h2 id=\"RecyclerView的点击事件\"><a href=\"#RecyclerView的点击事件\" class=\"headerlink\" title=\"RecyclerView的点击事件\"></a><strong>RecyclerView的点击事件</strong></h2><p>官方文档中并没有给我们类似ListView的<code>OnItemClickListener</code>回调方法，由于RecyclerView比ListView更高级，所以它并没有行或者列的概念，子View可以任意布局，每个子View处理自己的onClick事件，也就是说在Adapter中给子view的rootview设置点击回调。我们今天所要实现的是另外一种方式，类似ListView的<code>OnItemClickListener</code>的方式。通过文档我们知道RecyclerView留给开发者一个<code>RecyclerView.OnItemTouchListener</code>接口，我们要做的就是实现它，实现点击的回调和长按回调。当然了，这种方式只是一个开始，我们还可以拓展为各种复杂的手势操作的回调。<br>参考自：<a href=\"http://blog.csdn.net/hlglinglong/article/details/44981889\">http://blog.csdn.net/hlglinglong/article/details/44981889</a><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RecyclerItemClickListener</span> <span class=\"keyword\">implements</span> <span class=\"title\">RecyclerView</span>.<span class=\"title\">OnItemTouchListener</span></span>&#123;  </div><div class=\"line\">    <span class=\"keyword\">private</span> View childView;  </div><div class=\"line\">    <span class=\"keyword\">private</span> RecyclerView touchView;  </div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">RecyclerItemClickListener</span><span class=\"params\">(Context context, <span class=\"keyword\">final</span> OnItemClickListener mListener)</span> </span>&#123;  </div><div class=\"line\">        mGestureDetector = <span class=\"keyword\">new</span> GestureDetector(context, <span class=\"keyword\">new</span> GestureDetector.SimpleOnGestureListener()&#123;  </div><div class=\"line\">            <span class=\"meta\">@Override</span>  </div><div class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onSingleTapUp</span><span class=\"params\">(MotionEvent ev)</span> </span>&#123;  </div><div class=\"line\">                <span class=\"keyword\">if</span> (childView != <span class=\"keyword\">null</span> &amp;&amp; mListener != <span class=\"keyword\">null</span>) &#123;  </div><div class=\"line\">                    mListener.onItemClick(childView, touchView.getChildPosition(childView));  </div><div class=\"line\">                &#125;  </div><div class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;  </div><div class=\"line\">            &#125;  </div><div class=\"line\">            <span class=\"meta\">@Override</span>  </div><div class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onLongPress</span><span class=\"params\">(MotionEvent ev)</span> </span>&#123;  </div><div class=\"line\">                <span class=\"keyword\">if</span> (childView != <span class=\"keyword\">null</span> &amp;&amp; mListener != <span class=\"keyword\">null</span>) &#123;  </div><div class=\"line\">                    mListener.onLongClick(childView, touchView.getChildPosition(childView));  </div><div class=\"line\">                &#125;  </div><div class=\"line\">            &#125;  </div><div class=\"line\">        &#125;);  </div><div class=\"line\">    &#125;  </div><div class=\"line\"></div><div class=\"line\">    GestureDetector mGestureDetector;  </div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">OnItemClickListener</span> </span>&#123;  </div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onItemClick</span><span class=\"params\">(View view, <span class=\"keyword\">int</span> position)</span></span>;  </div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onLongClick</span><span class=\"params\">(View view, <span class=\"keyword\">int</span> posotion)</span></span>;  </div><div class=\"line\">    &#125;  </div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span>  </div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onInterceptTouchEvent</span><span class=\"params\">(RecyclerView recyclerView, MotionEvent motionEvent)</span> </span>&#123;  </div><div class=\"line\">        mGestureDetector.onTouchEvent(motionEvent);  </div><div class=\"line\">        childView = recyclerView.findChildViewUnder(motionEvent.getX(), motionEvent.getY());  </div><div class=\"line\">        touchView = recyclerView;  </div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;  </div><div class=\"line\">    &#125;  </div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span>  </div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onTouchEvent</span><span class=\"params\">(RecyclerView recyclerView, MotionEvent motionEvent)</span> </span>&#123;  </div><div class=\"line\"></div><div class=\"line\">    &#125;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h2 id=\"类似listview的addHeaderView和addFooterView\"><a href=\"#类似listview的addHeaderView和addFooterView\" class=\"headerlink\" title=\"类似listview的addHeaderView和addFooterView\"></a><strong>类似listview的<code>addHeaderView</code>和<code>addFooterView</code></strong></h2><p>RecyclerView同样没有提供类似listview的<code>addHeaderView</code>和<code>addFooterView</code> 方法，不过我们可以自定义，参考文章：<br><a href=\"https://github.com/dingdingyr/HeaderAndFooterRecyclerView-\">https://github.com/dingdingyr/HeaderAndFooterRecyclerView-</a><br>原理就是：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">GridLayoutManager manager = <span class=\"keyword\">new</span> GridLayoutManager(<span class=\"keyword\">this</span>, <span class=\"number\">2</span>);</div><div class=\"line\">      manager.setSpanSizeLookup(<span class=\"keyword\">new</span> GridLayoutManager.SpanSizeLookup() &#123;</div><div class=\"line\">          <span class=\"meta\">@Override</span></div><div class=\"line\">          <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getSpanSize</span><span class=\"params\">(<span class=\"keyword\">int</span> position)</span> </span>&#123;</div><div class=\"line\">              <span class=\"keyword\">return</span> adapter.getItemViewType()? manager.getSpanCount() : <span class=\"number\">1</span>;</div><div class=\"line\">          &#125;</div><div class=\"line\">      &#125;);</div></pre></td></tr></table></figure></p>\n<p>GirdLayout可以设置显示的行数，我们可以根据我们要显示的Item类型来指定这个值。</p>\n<p><strong>还有一个问题，那就是在更新apdater的时候不推荐使用<code>notifyDataSetChanged()</code> ，因为<code>notifyDataSetChanged()</code> 会强制刷新整个视图，如果插入新的数据可以使用 <code>public final void notifyItemRangeInserted(int positionStart, int itemCount);</code>。</strong></p>"},{"title":"右键新建md文件","date":"2017-07-10T06:10:28.000Z","comments":0,"_content":"因为经常使用markdown，所以会遇到新建``.md`` 文件的时候，会很麻烦。记录下Windows下右键新建``.md`` 文件的方法：\n<!--more-->\n1. 打开注册表 ``regedit`` ，在目录 ``HKEY_CLASSES_ROOT`` 下新建``.md`` 项，然后把默认值修改为``.md``。\n![这里写图片描述](http://img.blog.csdn.net/20170509131503696?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n2.  然后在``.md`` 项下再新建项``ShellNew`` ，然后在该项下面新建字符串值``FileName`` ，该字符值选择为，你新建的模板地址，比如我存放模板的位置是``C:\\Users\\user\\AppData\\Local\\atom\\markdown.md``\n![这里写图片描述](http://img.blog.csdn.net/20170509131552978?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n至于Mac党，推荐一个应用[Easy New File](https://itunes.apple.com/cn/app/easy-new-file/id1162194131?mt=12)，也不贵蛮好用的，下面是设置界面。\n![这里写图片描述](http://img.blog.csdn.net/20170710141632960?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n","source":"_posts/right-lick-new-md‘file.md","raw":"---\ntitle: 右键新建md文件\ndate: 2017-07-10 14:10:28\ntags: 操作\ncomments: false\n---\n因为经常使用markdown，所以会遇到新建``.md`` 文件的时候，会很麻烦。记录下Windows下右键新建``.md`` 文件的方法：\n<!--more-->\n1. 打开注册表 ``regedit`` ，在目录 ``HKEY_CLASSES_ROOT`` 下新建``.md`` 项，然后把默认值修改为``.md``。\n![这里写图片描述](http://img.blog.csdn.net/20170509131503696?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n2.  然后在``.md`` 项下再新建项``ShellNew`` ，然后在该项下面新建字符串值``FileName`` ，该字符值选择为，你新建的模板地址，比如我存放模板的位置是``C:\\Users\\user\\AppData\\Local\\atom\\markdown.md``\n![这里写图片描述](http://img.blog.csdn.net/20170509131552978?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n至于Mac党，推荐一个应用[Easy New File](https://itunes.apple.com/cn/app/easy-new-file/id1162194131?mt=12)，也不贵蛮好用的，下面是设置界面。\n![这里写图片描述](http://img.blog.csdn.net/20170710141632960?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n","slug":"right-lick-new-md‘file","published":1,"updated":"2017-07-10T06:35:14.000Z","layout":"post","photos":[],"link":"","_id":"cjr66widk001hmetpkp04r9pt","content":"<p>因为经常使用markdown，所以会遇到新建<code>.md</code> 文件的时候，会很麻烦。记录下Windows下右键新建<code>.md</code> 文件的方法：<br><a id=\"more\"></a></p>\n<ol>\n<li><p>打开注册表 <code>regedit</code> ，在目录 <code>HKEY_CLASSES_ROOT</code> 下新建<code>.md</code> 项，然后把默认值修改为<code>.md</code>。<br><img src=\"http://img.blog.csdn.net/20170509131503696?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"></p>\n</li>\n<li><p>然后在<code>.md</code> 项下再新建项<code>ShellNew</code> ，然后在该项下面新建字符串值<code>FileName</code> ，该字符值选择为，你新建的模板地址，比如我存放模板的位置是<code>C:\\Users\\user\\AppData\\Local\\atom\\markdown.md</code><br><img src=\"http://img.blog.csdn.net/20170509131552978?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"></p>\n</li>\n</ol>\n<p>至于Mac党，推荐一个应用<a href=\"https://itunes.apple.com/cn/app/easy-new-file/id1162194131?mt=12\" target=\"_blank\" rel=\"external\">Easy New File</a>，也不贵蛮好用的，下面是设置界面。<br><img src=\"http://img.blog.csdn.net/20170710141632960?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"></p>\n","excerpt":"<p>因为经常使用markdown，所以会遇到新建<code>.md</code> 文件的时候，会很麻烦。记录下Windows下右键新建<code>.md</code> 文件的方法：<br>","more":"</p>\n<ol>\n<li><p>打开注册表 <code>regedit</code> ，在目录 <code>HKEY_CLASSES_ROOT</code> 下新建<code>.md</code> 项，然后把默认值修改为<code>.md</code>。<br><img src=\"http://img.blog.csdn.net/20170509131503696?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"></p>\n</li>\n<li><p>然后在<code>.md</code> 项下再新建项<code>ShellNew</code> ，然后在该项下面新建字符串值<code>FileName</code> ，该字符值选择为，你新建的模板地址，比如我存放模板的位置是<code>C:\\Users\\user\\AppData\\Local\\atom\\markdown.md</code><br><img src=\"http://img.blog.csdn.net/20170509131552978?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"></p>\n</li>\n</ol>\n<p>至于Mac党，推荐一个应用<a href=\"https://itunes.apple.com/cn/app/easy-new-file/id1162194131?mt=12\">Easy New File</a>，也不贵蛮好用的，下面是设置界面。<br><img src=\"http://img.blog.csdn.net/20170710141632960?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"></p>"},{"title":"翻译：如何在Node.js和Express中使用MySql","date":"2016-04-15T14:57:37.000Z","comments":0,"_content":"\n## 连接到mysql数据库\n\n在这之前先安装正确的npm包：\n```JavaScript\n    npm install mysql\n```\n**mysql** 是一个非常容易使用的模块，它提供了你可能需要的所有功能。安装好后，你需要连接数据库的方法是：\n```JavaScript\nvar mysql = require('mysql')\n\nvar connection = mysql.createConnection({\n  host: 'localhost',\n  user: 'your_user',\n  password: 'some_secret',\n  database: 'database'\n})\n\nconnection.connect(function(err) {\n  if (err) throw err\n  console.log('You are now connected...')\n})\n```\n<!--more-->\n现在，你可以读写你的数据库了。\n\n## 读写mysql数据库\n\n你已经知道如何去连接你的数据库了，现在让我们看一个简单的例子：\n```JavaScript\nvar mysql = require('mysql')\n\nvar connection = mysql.createConnection({\n  host: 'localhost',\n  user: 'your_user',\n  password: 'some_secret',\n  database: 'database'\n})\n\nconnection.connect(function(err) {\n  if (err) throw err\n  console.log('You are now connected...')\n\n  connection.query('CREATE TABLE people(id int primary key, name varchar(255), age int, address text)', function(err, result) {\n    if (err) throw err\n    connection.query('INSERT INTO people (name, age, address) VALUES (?, ?, ?)', ['Larry', '41', 'California, USA'], function(err, result) {\n      if (err) throw err\n      connection.query('SELECT * FROM people', function(err, results) {\n        if (err) throw err\n        console.log(results[0].id)\n        console.log(results[0].name)\n        console.log(results[0].age)\n        console.log(results[0].address)\n      })\n    })\n  })\n})\n```\n你能够看到在上面的占位符`?`，它不仅仅使使用起来更容易，而且也是安全的。\n\n## 更换你的 *db.js* 文件\n\n虽然你看到的mysql模块非常容易，但是真实的应用有着更加复杂的需求。这就是为什么在[Connecting and Working with MongoDB](https://www.terlici.com/2015/04/03/mongodb-node-express.html)中，我们创建一个分开的文件db.js来帮助我们管理我们的连接。\n它的作用是无论何时我们不用经常键入凭证来很容易地连接数据库。它的第二个目标就是很容易运行测试。\n\n```JavaScript\nvar mysql = require('mysql')\n  , async = require('async')\n\nvar PRODUCTION_DB = 'app_prod_database'\n  , TEST_DB = 'app_test_database'\n\nexports.MODE_TEST = 'mode_test'\nexports.MODE_PRODUCTION = 'mode_production'\n\nvar state = {\n  pool: null,\n  mode: null,\n}\n\nexports.connect = function(mode, done) {\n  state.pool = mysql.createPool({\n    host: 'localhost',\n    user: 'your_user',\n    password: 'some_secret',\n    database: mode === exports.MODE_PRODUCTION ? PRODUCTION_DB : TEST_DB\n  })\n\n  state.mode = mode\n  done()\n}\n\nexports.get = function() {\n  return state.pool\n}\n\nexports.fixtures = function(data) {\n  var pool = state.pool\n  if (!pool) return done(new Error('Missing database connection.'))\n\n  var names = Object.keys(data.tables)\n  async.each(names, function(name, cb) {\n    async.each(data.tables[name], function(row, cb) {\n      var keys = Object.keys(row)\n        , values = keys.map(function(key) { return \"'\" + row[key] + \"'\" })\n\n      pool.query('INSERT INTO ' + name + ' (' + keys.join(',') + ') VALUES (' + values.join(',') + ')', cb)\n    }, cb)\n  }, done)\n}\n\nexports.drop = function(tables, done) {\n  var pool = state.pool\n  if (!pool) return done(new Error('Missing database connection.'))\n\n  async.each(tables, function(name, cb) {\n    pool.query('DELETE * FROM ' + name, cb)\n  }, done)\n}\n```\n这个db.js有点儿比我们之前的要复杂的多。\n\n首先，它提供一种方法去连接数据库。在生产模块和测试模块都能\n去连接。测试模块仅在自动化测试时运行。\n\n然后，有一个`get`方法能够一直提供给你有效的连接，也可以用来查询数据库。而且，你可以去设置密码，其他模块也可以调用这个方法。\n\n最后，有两个方法`fixtures`和`drop`，很容易地去退出测试。\n\n**drop** 清空数据，它将会帮助你的测试数据库在测试之前总是空的。\n\n**fixtures** 使用json对象，加载数据库中的数据，看一个例子：\n```JavaScript\nvar data = {\n  tables: {\n    people: [\n     {id: 1, name: \"John\", age: 32},\n     {id: 2, name: \"Peter\", age: 29},\n    ],\n    cars: [\n      {id: 1, brand: \"Jeep\", model: \"Cherokee\", owner_id: 2},\n      {id: 2, brand: \"BMW\", model: \"X5\", owner_id: 2},\n      {id: 3, brand: \"Volkswagen\", model: \"Polo\", owner_id: 1},\n    ],\n  },\n}\n\nvar db = require('./db')\ndb.connect(db.MODE_PRODUCTION, function() {\n  db.fixtures(data, function(err) {\n    if (err) return console.log(err)\n    console.log('Data has been loaded...')\n  })\n})\n```\n\n## 使用SQL搭建模块\n\n所有事情准备好了，接下来看看如何在你的应用中使用db.js。来看一个例子：\n```JavaScript\ncontrollers/\n  comments.js\n  users.js\nmodels/\n  comment.js\n  user.js\nviews/\napp.js\ndb.js\npackage.json\n```\n**app.js** 是应用的入口，也是我们将要设置数据库连接的地方。来看一个例子：\n```JavaScript\nvar db = require('./db')\n\napp.use('/comments', require('./controllers/comments'))\napp.use('/users', require('./controllers/users'))\n\n// Connect to MySQL on start\ndb.connect(db.MODE_PRODUCTION, function(err) {\n  if (err) {\n    console.log('Unable to connect to MySQL.')\n    process.exit(1)\n  } else {\n    app.listen(3000, function() {\n      console.log('Listening on port 3000...')\n    })\n  }\n})\n```\n你的应用将会通过这个模块来与数据库交互。来看一个例子：\n```JavaScript\nvar db = require('../db.js')\n\nexports.create = function(userId, text, done) {\n  var values = [userId, text, new Date().toISOString()]\n\n  db.get().query('INSERT INTO comments (user_id, text, date) VALUES(?, ?, ?)', values, function(err, result) {\n    if (err) return done(err)\n    done(null, result.insertId)\n  })\n}\n\nexports.getAll = function(done) {\n  db.get().query('SELECT * FROM comments', function (err, rows) {\n    if (err) return done(err)\n    done(null, rows)\n  })\n}\n\nexports.getAllByUser = function(userId, done) {\n  db.get().query('SELECT * FROM comments WHERE user_id = ?', userId, function (err, rows) {\n    if (err) return done(err)\n    done(null, rows)\n  })\n}\n```\n正如你看到的db.js是你完全不用带薪连接数据库的问题，甚至不用只用是否是生产环境还是测试环境。\n\n## 为读和写使用不一样的实例\n\n随着你的应用需求的增长，今天，很多应用都是面向读的。这就意味着，人们读数据少于写数据。例如，所有这一类应用的社交网站，通常你的状态只被读一次，但是然后被成千上万的人去读。在这种情况下是通常有一个主要的数据库将接受所有的写,然后同步到一些MySQL实例将只读取请求。当你有更多的用户可以很容易地添加更多数据库去读，你的应用将仍然是非常快的。\n\n但是，如何在我们的初始化中解决这个问题呢？mysql模块 **PoolCluster** 特性非常有用,它可以配置几个实例,然后连接到所有的人。看一个db.js中的例子：\n```JavaScript\nvar mysql = require('mysql')\n  , async = require('async')\n\nvar PRODUCTION_DB = 'app_prod_database'\n  , TEST_DB = 'app_test_database'\n\nexports.MODE_TEST = 'mode_test'\nexports.MODE_PRODUCTION = 'mode_production'\n\nvar state = {\n  pool: null,\n  mode: null,\n}\n\nexports.connect = function(mode, done) {\n  if (mode === exports.MODE_PRODUCTION) {\n    state.pool = mysql.createPoolCluster()\n\n    state.pool.add('WRITE', {\n      host: '192.168.0.5',\n      user: 'your_user',\n      password: 'some_secret',\n      database: PRODUCTION_DB\n    })\n\n    state.pool.add('READ1', {\n      host: '192.168.0.6',\n      user: 'your_user',\n      password: 'some_secret',\n      database: PRODUCTION_DB\n    })\n\n    state.pool.add('READ2', {\n      host: '192.168.0.7',\n      user: 'your_user',\n      password: 'some_secret',\n      database: PRODUCTION_DB\n    })\n  } else {\n    state.pool = mysql.createPool({\n      host: 'localhost',\n      user: 'your_user',\n      password: 'some_secret',\n      database: TEST_DB\n    })\n  }\n\n  state.mode = mode\n  done()\n}\n\nexports.READ = 'read'\nexports.WRITE = 'write'\n\nexports.get = function(type, done) {\n  var pool = state.pool\n  if (!pool) return done(new Error('Missing database connection.'))\n\n  if (type === exports.WRITE) {\n    state.pool.getConnection('WRITE', function (err, connection) {\n      if (err) return done(err)\n      done(null, connection)\n    })\n  } else {\n    state.pool.getConnection('READ*', function (err, connection) {\n      if (err) return done(err)\n      done(null, connection)\n    })\n  }\n}\n\nexports.fixtures = function(data) {\n  var pool = state.pool\n  if (!pool) return done(new Error('Missing database connection.'))\n\n  var names = Object.keys(data.tables)\n  async.each(names, function(name, cb) {\n    async.each(data.tables[name], function(row, cb) {\n      var keys = Object.keys(row)\n        , values = keys.map(function(key) { return \"'\" + row[key] + \"'\" })\n\n      pool.query('INSERT INTO ' + name + ' (' + keys.join(',') + ') VALUES (' + values.join(',') + ')', cb)\n    }, cb)\n  }, done)\n}\n\nexports.drop = function(tables, done) {\n  var pool = state.pool\n  if (!pool) return done(new Error('Missing database connection.'))\n\n  async.each(tables, function(name, cb) {\n    pool.query('DELETE * FROM ' + name, cb)\n  }, done)\n}\n```\n这里有三处和之前的不一样。\n\n1. 当连接在连接方法在测试模式下,做你之前所做的。然而,当你在生产模式下,添加3个更多的servers。每一个server都有一个名字，第一个是`WRITE`，另外两个是`READ1`和`READ2`。应该很清楚每一个的目的是什么。`READ1`和`READ2`是`WRITE`的奴隶,所以每次有人写数据到`WRITE`,然后很快地对`READ1`和`READ2`可用。\n2. 第二处变化是`get`方法。之前，它会立即返回一个连接。现在，它返回一个连接到回调函数作为第二个参数提供。\n3. 最后一处变化还是在`get`方法。在你连接数据库的时候，你需要告诉连接的类型 **READ** 和 **WRITE**。然后根据名称设置为服务器将提供正确的类型的连接。在这种情况下你可以看到`getConnection`提供一种模式系统,这样您就可以选择适当的数据库\n\n然后让我们看一个使用 **db.js** 的实例：\n```JavaScript\nvar db = require('../db.js')\n\nexports.create = function(userId, text, done) {\n  var values = [userId, text, new Date().toISOString()]\n\n  db.get(db.WRITE, function(err, connection) {\n    if (err) return done('Database problem')\n\n    connection.query('INSERT INTO comments (user_id, text, date) VALUES(?, ?, ?)', values, function(err, result) {\n      if (err) return done(err)\n      done(null, result.insertId)\n    })\n  })\n}\n\nexports.getAll = function(done) {\n  db.get(db.READ, function(err, connection) {\n    if (err) return done('Database problem')\n\n    connection.query('SELECT * FROM comments', function (err, rows) {\n      if (err) return done(err)\n      done(null, rows)\n    })\n  })\n}\n\nexports.getAllByUser = function(userId, done) {\n  db.get(db.READ, function(err, connection) {\n    if (err) return done('Database problem')\n\n    connection.query('SELECT * FROM comments WHERE user_id = ?', userId, function (err, rows) {\n      if (err) return done(err)\n      done(null, rows)\n    })\n  })\n}\n```\n你也可以创建一个代理连接对象,基于可以查询了解这是一个写或读,然后选择适当的连接。这样你甚至不会改变你的模块。\n\n## 最后\n\n本文翻译了<https://www.terlici.com/2015/08/13/mysql-node-express.html>的大部分，如果有错误，可以留言。\n","source":"_posts/mysql-node-express.md","raw":"---\ntitle: 翻译：如何在Node.js和Express中使用MySql\ndate: 2016-04-15 22:57:37\ntags:\n  - Node.js\n  - mysql\n  - Express\ncomments: false\n---\n\n## 连接到mysql数据库\n\n在这之前先安装正确的npm包：\n```JavaScript\n    npm install mysql\n```\n**mysql** 是一个非常容易使用的模块，它提供了你可能需要的所有功能。安装好后，你需要连接数据库的方法是：\n```JavaScript\nvar mysql = require('mysql')\n\nvar connection = mysql.createConnection({\n  host: 'localhost',\n  user: 'your_user',\n  password: 'some_secret',\n  database: 'database'\n})\n\nconnection.connect(function(err) {\n  if (err) throw err\n  console.log('You are now connected...')\n})\n```\n<!--more-->\n现在，你可以读写你的数据库了。\n\n## 读写mysql数据库\n\n你已经知道如何去连接你的数据库了，现在让我们看一个简单的例子：\n```JavaScript\nvar mysql = require('mysql')\n\nvar connection = mysql.createConnection({\n  host: 'localhost',\n  user: 'your_user',\n  password: 'some_secret',\n  database: 'database'\n})\n\nconnection.connect(function(err) {\n  if (err) throw err\n  console.log('You are now connected...')\n\n  connection.query('CREATE TABLE people(id int primary key, name varchar(255), age int, address text)', function(err, result) {\n    if (err) throw err\n    connection.query('INSERT INTO people (name, age, address) VALUES (?, ?, ?)', ['Larry', '41', 'California, USA'], function(err, result) {\n      if (err) throw err\n      connection.query('SELECT * FROM people', function(err, results) {\n        if (err) throw err\n        console.log(results[0].id)\n        console.log(results[0].name)\n        console.log(results[0].age)\n        console.log(results[0].address)\n      })\n    })\n  })\n})\n```\n你能够看到在上面的占位符`?`，它不仅仅使使用起来更容易，而且也是安全的。\n\n## 更换你的 *db.js* 文件\n\n虽然你看到的mysql模块非常容易，但是真实的应用有着更加复杂的需求。这就是为什么在[Connecting and Working with MongoDB](https://www.terlici.com/2015/04/03/mongodb-node-express.html)中，我们创建一个分开的文件db.js来帮助我们管理我们的连接。\n它的作用是无论何时我们不用经常键入凭证来很容易地连接数据库。它的第二个目标就是很容易运行测试。\n\n```JavaScript\nvar mysql = require('mysql')\n  , async = require('async')\n\nvar PRODUCTION_DB = 'app_prod_database'\n  , TEST_DB = 'app_test_database'\n\nexports.MODE_TEST = 'mode_test'\nexports.MODE_PRODUCTION = 'mode_production'\n\nvar state = {\n  pool: null,\n  mode: null,\n}\n\nexports.connect = function(mode, done) {\n  state.pool = mysql.createPool({\n    host: 'localhost',\n    user: 'your_user',\n    password: 'some_secret',\n    database: mode === exports.MODE_PRODUCTION ? PRODUCTION_DB : TEST_DB\n  })\n\n  state.mode = mode\n  done()\n}\n\nexports.get = function() {\n  return state.pool\n}\n\nexports.fixtures = function(data) {\n  var pool = state.pool\n  if (!pool) return done(new Error('Missing database connection.'))\n\n  var names = Object.keys(data.tables)\n  async.each(names, function(name, cb) {\n    async.each(data.tables[name], function(row, cb) {\n      var keys = Object.keys(row)\n        , values = keys.map(function(key) { return \"'\" + row[key] + \"'\" })\n\n      pool.query('INSERT INTO ' + name + ' (' + keys.join(',') + ') VALUES (' + values.join(',') + ')', cb)\n    }, cb)\n  }, done)\n}\n\nexports.drop = function(tables, done) {\n  var pool = state.pool\n  if (!pool) return done(new Error('Missing database connection.'))\n\n  async.each(tables, function(name, cb) {\n    pool.query('DELETE * FROM ' + name, cb)\n  }, done)\n}\n```\n这个db.js有点儿比我们之前的要复杂的多。\n\n首先，它提供一种方法去连接数据库。在生产模块和测试模块都能\n去连接。测试模块仅在自动化测试时运行。\n\n然后，有一个`get`方法能够一直提供给你有效的连接，也可以用来查询数据库。而且，你可以去设置密码，其他模块也可以调用这个方法。\n\n最后，有两个方法`fixtures`和`drop`，很容易地去退出测试。\n\n**drop** 清空数据，它将会帮助你的测试数据库在测试之前总是空的。\n\n**fixtures** 使用json对象，加载数据库中的数据，看一个例子：\n```JavaScript\nvar data = {\n  tables: {\n    people: [\n     {id: 1, name: \"John\", age: 32},\n     {id: 2, name: \"Peter\", age: 29},\n    ],\n    cars: [\n      {id: 1, brand: \"Jeep\", model: \"Cherokee\", owner_id: 2},\n      {id: 2, brand: \"BMW\", model: \"X5\", owner_id: 2},\n      {id: 3, brand: \"Volkswagen\", model: \"Polo\", owner_id: 1},\n    ],\n  },\n}\n\nvar db = require('./db')\ndb.connect(db.MODE_PRODUCTION, function() {\n  db.fixtures(data, function(err) {\n    if (err) return console.log(err)\n    console.log('Data has been loaded...')\n  })\n})\n```\n\n## 使用SQL搭建模块\n\n所有事情准备好了，接下来看看如何在你的应用中使用db.js。来看一个例子：\n```JavaScript\ncontrollers/\n  comments.js\n  users.js\nmodels/\n  comment.js\n  user.js\nviews/\napp.js\ndb.js\npackage.json\n```\n**app.js** 是应用的入口，也是我们将要设置数据库连接的地方。来看一个例子：\n```JavaScript\nvar db = require('./db')\n\napp.use('/comments', require('./controllers/comments'))\napp.use('/users', require('./controllers/users'))\n\n// Connect to MySQL on start\ndb.connect(db.MODE_PRODUCTION, function(err) {\n  if (err) {\n    console.log('Unable to connect to MySQL.')\n    process.exit(1)\n  } else {\n    app.listen(3000, function() {\n      console.log('Listening on port 3000...')\n    })\n  }\n})\n```\n你的应用将会通过这个模块来与数据库交互。来看一个例子：\n```JavaScript\nvar db = require('../db.js')\n\nexports.create = function(userId, text, done) {\n  var values = [userId, text, new Date().toISOString()]\n\n  db.get().query('INSERT INTO comments (user_id, text, date) VALUES(?, ?, ?)', values, function(err, result) {\n    if (err) return done(err)\n    done(null, result.insertId)\n  })\n}\n\nexports.getAll = function(done) {\n  db.get().query('SELECT * FROM comments', function (err, rows) {\n    if (err) return done(err)\n    done(null, rows)\n  })\n}\n\nexports.getAllByUser = function(userId, done) {\n  db.get().query('SELECT * FROM comments WHERE user_id = ?', userId, function (err, rows) {\n    if (err) return done(err)\n    done(null, rows)\n  })\n}\n```\n正如你看到的db.js是你完全不用带薪连接数据库的问题，甚至不用只用是否是生产环境还是测试环境。\n\n## 为读和写使用不一样的实例\n\n随着你的应用需求的增长，今天，很多应用都是面向读的。这就意味着，人们读数据少于写数据。例如，所有这一类应用的社交网站，通常你的状态只被读一次，但是然后被成千上万的人去读。在这种情况下是通常有一个主要的数据库将接受所有的写,然后同步到一些MySQL实例将只读取请求。当你有更多的用户可以很容易地添加更多数据库去读，你的应用将仍然是非常快的。\n\n但是，如何在我们的初始化中解决这个问题呢？mysql模块 **PoolCluster** 特性非常有用,它可以配置几个实例,然后连接到所有的人。看一个db.js中的例子：\n```JavaScript\nvar mysql = require('mysql')\n  , async = require('async')\n\nvar PRODUCTION_DB = 'app_prod_database'\n  , TEST_DB = 'app_test_database'\n\nexports.MODE_TEST = 'mode_test'\nexports.MODE_PRODUCTION = 'mode_production'\n\nvar state = {\n  pool: null,\n  mode: null,\n}\n\nexports.connect = function(mode, done) {\n  if (mode === exports.MODE_PRODUCTION) {\n    state.pool = mysql.createPoolCluster()\n\n    state.pool.add('WRITE', {\n      host: '192.168.0.5',\n      user: 'your_user',\n      password: 'some_secret',\n      database: PRODUCTION_DB\n    })\n\n    state.pool.add('READ1', {\n      host: '192.168.0.6',\n      user: 'your_user',\n      password: 'some_secret',\n      database: PRODUCTION_DB\n    })\n\n    state.pool.add('READ2', {\n      host: '192.168.0.7',\n      user: 'your_user',\n      password: 'some_secret',\n      database: PRODUCTION_DB\n    })\n  } else {\n    state.pool = mysql.createPool({\n      host: 'localhost',\n      user: 'your_user',\n      password: 'some_secret',\n      database: TEST_DB\n    })\n  }\n\n  state.mode = mode\n  done()\n}\n\nexports.READ = 'read'\nexports.WRITE = 'write'\n\nexports.get = function(type, done) {\n  var pool = state.pool\n  if (!pool) return done(new Error('Missing database connection.'))\n\n  if (type === exports.WRITE) {\n    state.pool.getConnection('WRITE', function (err, connection) {\n      if (err) return done(err)\n      done(null, connection)\n    })\n  } else {\n    state.pool.getConnection('READ*', function (err, connection) {\n      if (err) return done(err)\n      done(null, connection)\n    })\n  }\n}\n\nexports.fixtures = function(data) {\n  var pool = state.pool\n  if (!pool) return done(new Error('Missing database connection.'))\n\n  var names = Object.keys(data.tables)\n  async.each(names, function(name, cb) {\n    async.each(data.tables[name], function(row, cb) {\n      var keys = Object.keys(row)\n        , values = keys.map(function(key) { return \"'\" + row[key] + \"'\" })\n\n      pool.query('INSERT INTO ' + name + ' (' + keys.join(',') + ') VALUES (' + values.join(',') + ')', cb)\n    }, cb)\n  }, done)\n}\n\nexports.drop = function(tables, done) {\n  var pool = state.pool\n  if (!pool) return done(new Error('Missing database connection.'))\n\n  async.each(tables, function(name, cb) {\n    pool.query('DELETE * FROM ' + name, cb)\n  }, done)\n}\n```\n这里有三处和之前的不一样。\n\n1. 当连接在连接方法在测试模式下,做你之前所做的。然而,当你在生产模式下,添加3个更多的servers。每一个server都有一个名字，第一个是`WRITE`，另外两个是`READ1`和`READ2`。应该很清楚每一个的目的是什么。`READ1`和`READ2`是`WRITE`的奴隶,所以每次有人写数据到`WRITE`,然后很快地对`READ1`和`READ2`可用。\n2. 第二处变化是`get`方法。之前，它会立即返回一个连接。现在，它返回一个连接到回调函数作为第二个参数提供。\n3. 最后一处变化还是在`get`方法。在你连接数据库的时候，你需要告诉连接的类型 **READ** 和 **WRITE**。然后根据名称设置为服务器将提供正确的类型的连接。在这种情况下你可以看到`getConnection`提供一种模式系统,这样您就可以选择适当的数据库\n\n然后让我们看一个使用 **db.js** 的实例：\n```JavaScript\nvar db = require('../db.js')\n\nexports.create = function(userId, text, done) {\n  var values = [userId, text, new Date().toISOString()]\n\n  db.get(db.WRITE, function(err, connection) {\n    if (err) return done('Database problem')\n\n    connection.query('INSERT INTO comments (user_id, text, date) VALUES(?, ?, ?)', values, function(err, result) {\n      if (err) return done(err)\n      done(null, result.insertId)\n    })\n  })\n}\n\nexports.getAll = function(done) {\n  db.get(db.READ, function(err, connection) {\n    if (err) return done('Database problem')\n\n    connection.query('SELECT * FROM comments', function (err, rows) {\n      if (err) return done(err)\n      done(null, rows)\n    })\n  })\n}\n\nexports.getAllByUser = function(userId, done) {\n  db.get(db.READ, function(err, connection) {\n    if (err) return done('Database problem')\n\n    connection.query('SELECT * FROM comments WHERE user_id = ?', userId, function (err, rows) {\n      if (err) return done(err)\n      done(null, rows)\n    })\n  })\n}\n```\n你也可以创建一个代理连接对象,基于可以查询了解这是一个写或读,然后选择适当的连接。这样你甚至不会改变你的模块。\n\n## 最后\n\n本文翻译了<https://www.terlici.com/2015/08/13/mysql-node-express.html>的大部分，如果有错误，可以留言。\n","slug":"mysql-node-express","published":1,"updated":"2017-04-15T14:05:56.000Z","layout":"post","photos":[],"link":"","_id":"cjr66widl001jmetpps7ylvxb","content":"<h2 id=\"连接到mysql数据库\"><a href=\"#连接到mysql数据库\" class=\"headerlink\" title=\"连接到mysql数据库\"></a>连接到mysql数据库</h2><p>在这之前先安装正确的npm包：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install mysql</div></pre></td></tr></table></figure></p>\n<p><strong>mysql</strong> 是一个非常容易使用的模块，它提供了你可能需要的所有功能。安装好后，你需要连接数据库的方法是：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> mysql = <span class=\"built_in\">require</span>(<span class=\"string\">'mysql'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> connection = mysql.createConnection(&#123;</div><div class=\"line\">  <span class=\"attr\">host</span>: <span class=\"string\">'localhost'</span>,</div><div class=\"line\">  <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">  <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">  <span class=\"attr\">database</span>: <span class=\"string\">'database'</span></div><div class=\"line\">&#125;)</div><div class=\"line\"></div><div class=\"line\">connection.connect(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (err) <span class=\"keyword\">throw</span> err</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">'You are now connected...'</span>)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<p>现在，你可以读写你的数据库了。</p>\n<h2 id=\"读写mysql数据库\"><a href=\"#读写mysql数据库\" class=\"headerlink\" title=\"读写mysql数据库\"></a>读写mysql数据库</h2><p>你已经知道如何去连接你的数据库了，现在让我们看一个简单的例子：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> mysql = <span class=\"built_in\">require</span>(<span class=\"string\">'mysql'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> connection = mysql.createConnection(&#123;</div><div class=\"line\">  <span class=\"attr\">host</span>: <span class=\"string\">'localhost'</span>,</div><div class=\"line\">  <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">  <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">  <span class=\"attr\">database</span>: <span class=\"string\">'database'</span></div><div class=\"line\">&#125;)</div><div class=\"line\"></div><div class=\"line\">connection.connect(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (err) <span class=\"keyword\">throw</span> err</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">'You are now connected...'</span>)</div><div class=\"line\"></div><div class=\"line\">  connection.query(<span class=\"string\">'CREATE TABLE people(id int primary key, name varchar(255), age int, address text)'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, result</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">throw</span> err</div><div class=\"line\">    connection.query(<span class=\"string\">'INSERT INTO people (name, age, address) VALUES (?, ?, ?)'</span>, [<span class=\"string\">'Larry'</span>, <span class=\"string\">'41'</span>, <span class=\"string\">'California, USA'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, result</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">if</span> (err) <span class=\"keyword\">throw</span> err</div><div class=\"line\">      connection.query(<span class=\"string\">'SELECT * FROM people'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, results</span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (err) <span class=\"keyword\">throw</span> err</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(results[<span class=\"number\">0</span>].id)</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(results[<span class=\"number\">0</span>].name)</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(results[<span class=\"number\">0</span>].age)</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(results[<span class=\"number\">0</span>].address)</div><div class=\"line\">      &#125;)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure></p>\n<p>你能够看到在上面的占位符<code>?</code>，它不仅仅使使用起来更容易，而且也是安全的。</p>\n<h2 id=\"更换你的-db-js-文件\"><a href=\"#更换你的-db-js-文件\" class=\"headerlink\" title=\"更换你的 db.js 文件\"></a>更换你的 <em>db.js</em> 文件</h2><p>虽然你看到的mysql模块非常容易，但是真实的应用有着更加复杂的需求。这就是为什么在<a href=\"https://www.terlici.com/2015/04/03/mongodb-node-express.html\" target=\"_blank\" rel=\"external\">Connecting and Working with MongoDB</a>中，我们创建一个分开的文件db.js来帮助我们管理我们的连接。<br>它的作用是无论何时我们不用经常键入凭证来很容易地连接数据库。它的第二个目标就是很容易运行测试。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> mysql = <span class=\"built_in\">require</span>(<span class=\"string\">'mysql'</span>)</div><div class=\"line\">  , <span class=\"keyword\">async</span> = <span class=\"built_in\">require</span>(<span class=\"string\">'async'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> PRODUCTION_DB = <span class=\"string\">'app_prod_database'</span></div><div class=\"line\">  , TEST_DB = <span class=\"string\">'app_test_database'</span></div><div class=\"line\"></div><div class=\"line\">exports.MODE_TEST = <span class=\"string\">'mode_test'</span></div><div class=\"line\">exports.MODE_PRODUCTION = <span class=\"string\">'mode_production'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> state = &#123;</div><div class=\"line\">  <span class=\"attr\">pool</span>: <span class=\"literal\">null</span>,</div><div class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"literal\">null</span>,</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.connect = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">mode, done</span>) </span>&#123;</div><div class=\"line\">  state.pool = mysql.createPool(&#123;</div><div class=\"line\">    <span class=\"attr\">host</span>: <span class=\"string\">'localhost'</span>,</div><div class=\"line\">    <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">    <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">    <span class=\"attr\">database</span>: mode === exports.MODE_PRODUCTION ? PRODUCTION_DB : TEST_DB</div><div class=\"line\">  &#125;)</div><div class=\"line\"></div><div class=\"line\">  state.mode = mode</div><div class=\"line\">  done()</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.get = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">return</span> state.pool</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.fixtures = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> pool = state.pool</div><div class=\"line\">  <span class=\"keyword\">if</span> (!pool) <span class=\"keyword\">return</span> done(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Missing database connection.'</span>))</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> names = <span class=\"built_in\">Object</span>.keys(data.tables)</div><div class=\"line\">  <span class=\"keyword\">async</span>.each(names, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, cb</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">async</span>.each(data.tables[name], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">row, cb</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">var</span> keys = <span class=\"built_in\">Object</span>.keys(row)</div><div class=\"line\">        , values = keys.map(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">key</span>) </span>&#123; <span class=\"keyword\">return</span> <span class=\"string\">\"'\"</span> + row[key] + <span class=\"string\">\"'\"</span> &#125;)</div><div class=\"line\"></div><div class=\"line\">      pool.query(<span class=\"string\">'INSERT INTO '</span> + name + <span class=\"string\">' ('</span> + keys.join(<span class=\"string\">','</span>) + <span class=\"string\">') VALUES ('</span> + values.join(<span class=\"string\">','</span>) + <span class=\"string\">')'</span>, cb)</div><div class=\"line\">    &#125;, cb)</div><div class=\"line\">  &#125;, done)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.drop = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">tables, done</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> pool = state.pool</div><div class=\"line\">  <span class=\"keyword\">if</span> (!pool) <span class=\"keyword\">return</span> done(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Missing database connection.'</span>))</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">async</span>.each(tables, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, cb</span>) </span>&#123;</div><div class=\"line\">    pool.query(<span class=\"string\">'DELETE * FROM '</span> + name, cb)</div><div class=\"line\">  &#125;, done)</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>这个db.js有点儿比我们之前的要复杂的多。</p>\n<p>首先，它提供一种方法去连接数据库。在生产模块和测试模块都能<br>去连接。测试模块仅在自动化测试时运行。</p>\n<p>然后，有一个<code>get</code>方法能够一直提供给你有效的连接，也可以用来查询数据库。而且，你可以去设置密码，其他模块也可以调用这个方法。</p>\n<p>最后，有两个方法<code>fixtures</code>和<code>drop</code>，很容易地去退出测试。</p>\n<p><strong>drop</strong> 清空数据，它将会帮助你的测试数据库在测试之前总是空的。</p>\n<p><strong>fixtures</strong> 使用json对象，加载数据库中的数据，看一个例子：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> data = &#123;</div><div class=\"line\">  <span class=\"attr\">tables</span>: &#123;</div><div class=\"line\">    <span class=\"attr\">people</span>: [</div><div class=\"line\">     &#123;<span class=\"attr\">id</span>: <span class=\"number\">1</span>, <span class=\"attr\">name</span>: <span class=\"string\">\"John\"</span>, <span class=\"attr\">age</span>: <span class=\"number\">32</span>&#125;,</div><div class=\"line\">     &#123;<span class=\"attr\">id</span>: <span class=\"number\">2</span>, <span class=\"attr\">name</span>: <span class=\"string\">\"Peter\"</span>, <span class=\"attr\">age</span>: <span class=\"number\">29</span>&#125;,</div><div class=\"line\">    ],</div><div class=\"line\">    <span class=\"attr\">cars</span>: [</div><div class=\"line\">      &#123;<span class=\"attr\">id</span>: <span class=\"number\">1</span>, <span class=\"attr\">brand</span>: <span class=\"string\">\"Jeep\"</span>, <span class=\"attr\">model</span>: <span class=\"string\">\"Cherokee\"</span>, <span class=\"attr\">owner_id</span>: <span class=\"number\">2</span>&#125;,</div><div class=\"line\">      &#123;<span class=\"attr\">id</span>: <span class=\"number\">2</span>, <span class=\"attr\">brand</span>: <span class=\"string\">\"BMW\"</span>, <span class=\"attr\">model</span>: <span class=\"string\">\"X5\"</span>, <span class=\"attr\">owner_id</span>: <span class=\"number\">2</span>&#125;,</div><div class=\"line\">      &#123;<span class=\"attr\">id</span>: <span class=\"number\">3</span>, <span class=\"attr\">brand</span>: <span class=\"string\">\"Volkswagen\"</span>, <span class=\"attr\">model</span>: <span class=\"string\">\"Polo\"</span>, <span class=\"attr\">owner_id</span>: <span class=\"number\">1</span>&#125;,</div><div class=\"line\">    ],</div><div class=\"line\">  &#125;,</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> db = <span class=\"built_in\">require</span>(<span class=\"string\">'./db'</span>)</div><div class=\"line\">db.connect(db.MODE_PRODUCTION, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  db.fixtures(data, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> <span class=\"built_in\">console</span>.log(err)</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Data has been loaded...'</span>)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure></p>\n<h2 id=\"使用SQL搭建模块\"><a href=\"#使用SQL搭建模块\" class=\"headerlink\" title=\"使用SQL搭建模块\"></a>使用SQL搭建模块</h2><p>所有事情准备好了，接下来看看如何在你的应用中使用db.js。来看一个例子：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">controllers/</div><div class=\"line\">  comments.js</div><div class=\"line\">  users.js</div><div class=\"line\">models/</div><div class=\"line\">  comment.js</div><div class=\"line\">  user.js</div><div class=\"line\">views/</div><div class=\"line\">app.js</div><div class=\"line\">db.js</div><div class=\"line\">package.json</div></pre></td></tr></table></figure></p>\n<p><strong>app.js</strong> 是应用的入口，也是我们将要设置数据库连接的地方。来看一个例子：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> db = <span class=\"built_in\">require</span>(<span class=\"string\">'./db'</span>)</div><div class=\"line\"></div><div class=\"line\">app.use(<span class=\"string\">'/comments'</span>, <span class=\"built_in\">require</span>(<span class=\"string\">'./controllers/comments'</span>))</div><div class=\"line\">app.use(<span class=\"string\">'/users'</span>, <span class=\"built_in\">require</span>(<span class=\"string\">'./controllers/users'</span>))</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// Connect to MySQL on start</span></div><div class=\"line\">db.connect(db.MODE_PRODUCTION, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (err) &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Unable to connect to MySQL.'</span>)</div><div class=\"line\">    process.exit(<span class=\"number\">1</span>)</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    app.listen(<span class=\"number\">3000</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">      <span class=\"built_in\">console</span>.log(<span class=\"string\">'Listening on port 3000...'</span>)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure></p>\n<p>你的应用将会通过这个模块来与数据库交互。来看一个例子：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> db = <span class=\"built_in\">require</span>(<span class=\"string\">'../db.js'</span>)</div><div class=\"line\"></div><div class=\"line\">exports.create = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">userId, text, done</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> values = [userId, text, <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().toISOString()]</div><div class=\"line\"></div><div class=\"line\">  db.get().query(<span class=\"string\">'INSERT INTO comments (user_id, text, date) VALUES(?, ?, ?)'</span>, values, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, result</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">    done(<span class=\"literal\">null</span>, result.insertId)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.getAll = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">done</span>) </span>&#123;</div><div class=\"line\">  db.get().query(<span class=\"string\">'SELECT * FROM comments'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, rows</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">    done(<span class=\"literal\">null</span>, rows)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.getAllByUser = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">userId, done</span>) </span>&#123;</div><div class=\"line\">  db.get().query(<span class=\"string\">'SELECT * FROM comments WHERE user_id = ?'</span>, userId, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, rows</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">    done(<span class=\"literal\">null</span>, rows)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>正如你看到的db.js是你完全不用带薪连接数据库的问题，甚至不用只用是否是生产环境还是测试环境。</p>\n<h2 id=\"为读和写使用不一样的实例\"><a href=\"#为读和写使用不一样的实例\" class=\"headerlink\" title=\"为读和写使用不一样的实例\"></a>为读和写使用不一样的实例</h2><p>随着你的应用需求的增长，今天，很多应用都是面向读的。这就意味着，人们读数据少于写数据。例如，所有这一类应用的社交网站，通常你的状态只被读一次，但是然后被成千上万的人去读。在这种情况下是通常有一个主要的数据库将接受所有的写,然后同步到一些MySQL实例将只读取请求。当你有更多的用户可以很容易地添加更多数据库去读，你的应用将仍然是非常快的。</p>\n<p>但是，如何在我们的初始化中解决这个问题呢？mysql模块 <strong>PoolCluster</strong> 特性非常有用,它可以配置几个实例,然后连接到所有的人。看一个db.js中的例子：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> mysql = <span class=\"built_in\">require</span>(<span class=\"string\">'mysql'</span>)</div><div class=\"line\">  , <span class=\"keyword\">async</span> = <span class=\"built_in\">require</span>(<span class=\"string\">'async'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> PRODUCTION_DB = <span class=\"string\">'app_prod_database'</span></div><div class=\"line\">  , TEST_DB = <span class=\"string\">'app_test_database'</span></div><div class=\"line\"></div><div class=\"line\">exports.MODE_TEST = <span class=\"string\">'mode_test'</span></div><div class=\"line\">exports.MODE_PRODUCTION = <span class=\"string\">'mode_production'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> state = &#123;</div><div class=\"line\">  <span class=\"attr\">pool</span>: <span class=\"literal\">null</span>,</div><div class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"literal\">null</span>,</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.connect = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">mode, done</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (mode === exports.MODE_PRODUCTION) &#123;</div><div class=\"line\">    state.pool = mysql.createPoolCluster()</div><div class=\"line\"></div><div class=\"line\">    state.pool.add(<span class=\"string\">'WRITE'</span>, &#123;</div><div class=\"line\">      <span class=\"attr\">host</span>: <span class=\"string\">'192.168.0.5'</span>,</div><div class=\"line\">      <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">      <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">      <span class=\"attr\">database</span>: PRODUCTION_DB</div><div class=\"line\">    &#125;)</div><div class=\"line\"></div><div class=\"line\">    state.pool.add(<span class=\"string\">'READ1'</span>, &#123;</div><div class=\"line\">      <span class=\"attr\">host</span>: <span class=\"string\">'192.168.0.6'</span>,</div><div class=\"line\">      <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">      <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">      <span class=\"attr\">database</span>: PRODUCTION_DB</div><div class=\"line\">    &#125;)</div><div class=\"line\"></div><div class=\"line\">    state.pool.add(<span class=\"string\">'READ2'</span>, &#123;</div><div class=\"line\">      <span class=\"attr\">host</span>: <span class=\"string\">'192.168.0.7'</span>,</div><div class=\"line\">      <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">      <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">      <span class=\"attr\">database</span>: PRODUCTION_DB</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    state.pool = mysql.createPool(&#123;</div><div class=\"line\">      <span class=\"attr\">host</span>: <span class=\"string\">'localhost'</span>,</div><div class=\"line\">      <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">      <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">      <span class=\"attr\">database</span>: TEST_DB</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  state.mode = mode</div><div class=\"line\">  done()</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.READ = <span class=\"string\">'read'</span></div><div class=\"line\">exports.WRITE = <span class=\"string\">'write'</span></div><div class=\"line\"></div><div class=\"line\">exports.get = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">type, done</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> pool = state.pool</div><div class=\"line\">  <span class=\"keyword\">if</span> (!pool) <span class=\"keyword\">return</span> done(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Missing database connection.'</span>))</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">if</span> (type === exports.WRITE) &#123;</div><div class=\"line\">    state.pool.getConnection(<span class=\"string\">'WRITE'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, connection</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">      done(<span class=\"literal\">null</span>, connection)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    state.pool.getConnection(<span class=\"string\">'READ*'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, connection</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">      done(<span class=\"literal\">null</span>, connection)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.fixtures = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> pool = state.pool</div><div class=\"line\">  <span class=\"keyword\">if</span> (!pool) <span class=\"keyword\">return</span> done(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Missing database connection.'</span>))</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> names = <span class=\"built_in\">Object</span>.keys(data.tables)</div><div class=\"line\">  <span class=\"keyword\">async</span>.each(names, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, cb</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">async</span>.each(data.tables[name], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">row, cb</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">var</span> keys = <span class=\"built_in\">Object</span>.keys(row)</div><div class=\"line\">        , values = keys.map(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">key</span>) </span>&#123; <span class=\"keyword\">return</span> <span class=\"string\">\"'\"</span> + row[key] + <span class=\"string\">\"'\"</span> &#125;)</div><div class=\"line\"></div><div class=\"line\">      pool.query(<span class=\"string\">'INSERT INTO '</span> + name + <span class=\"string\">' ('</span> + keys.join(<span class=\"string\">','</span>) + <span class=\"string\">') VALUES ('</span> + values.join(<span class=\"string\">','</span>) + <span class=\"string\">')'</span>, cb)</div><div class=\"line\">    &#125;, cb)</div><div class=\"line\">  &#125;, done)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.drop = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">tables, done</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> pool = state.pool</div><div class=\"line\">  <span class=\"keyword\">if</span> (!pool) <span class=\"keyword\">return</span> done(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Missing database connection.'</span>))</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">async</span>.each(tables, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, cb</span>) </span>&#123;</div><div class=\"line\">    pool.query(<span class=\"string\">'DELETE * FROM '</span> + name, cb)</div><div class=\"line\">  &#125;, done)</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>这里有三处和之前的不一样。</p>\n<ol>\n<li>当连接在连接方法在测试模式下,做你之前所做的。然而,当你在生产模式下,添加3个更多的servers。每一个server都有一个名字，第一个是<code>WRITE</code>，另外两个是<code>READ1</code>和<code>READ2</code>。应该很清楚每一个的目的是什么。<code>READ1</code>和<code>READ2</code>是<code>WRITE</code>的奴隶,所以每次有人写数据到<code>WRITE</code>,然后很快地对<code>READ1</code>和<code>READ2</code>可用。</li>\n<li>第二处变化是<code>get</code>方法。之前，它会立即返回一个连接。现在，它返回一个连接到回调函数作为第二个参数提供。</li>\n<li>最后一处变化还是在<code>get</code>方法。在你连接数据库的时候，你需要告诉连接的类型 <strong>READ</strong> 和 <strong>WRITE</strong>。然后根据名称设置为服务器将提供正确的类型的连接。在这种情况下你可以看到<code>getConnection</code>提供一种模式系统,这样您就可以选择适当的数据库</li>\n</ol>\n<p>然后让我们看一个使用 <strong>db.js</strong> 的实例：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> db = <span class=\"built_in\">require</span>(<span class=\"string\">'../db.js'</span>)</div><div class=\"line\"></div><div class=\"line\">exports.create = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">userId, text, done</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> values = [userId, text, <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().toISOString()]</div><div class=\"line\"></div><div class=\"line\">  db.get(db.WRITE, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, connection</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(<span class=\"string\">'Database problem'</span>)</div><div class=\"line\"></div><div class=\"line\">    connection.query(<span class=\"string\">'INSERT INTO comments (user_id, text, date) VALUES(?, ?, ?)'</span>, values, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, result</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">      done(<span class=\"literal\">null</span>, result.insertId)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.getAll = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">done</span>) </span>&#123;</div><div class=\"line\">  db.get(db.READ, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, connection</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(<span class=\"string\">'Database problem'</span>)</div><div class=\"line\"></div><div class=\"line\">    connection.query(<span class=\"string\">'SELECT * FROM comments'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, rows</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">      done(<span class=\"literal\">null</span>, rows)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.getAllByUser = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">userId, done</span>) </span>&#123;</div><div class=\"line\">  db.get(db.READ, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, connection</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(<span class=\"string\">'Database problem'</span>)</div><div class=\"line\"></div><div class=\"line\">    connection.query(<span class=\"string\">'SELECT * FROM comments WHERE user_id = ?'</span>, userId, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, rows</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">      done(<span class=\"literal\">null</span>, rows)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>你也可以创建一个代理连接对象,基于可以查询了解这是一个写或读,然后选择适当的连接。这样你甚至不会改变你的模块。</p>\n<h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><p>本文翻译了<a href=\"https://www.terlici.com/2015/08/13/mysql-node-express.html\" target=\"_blank\" rel=\"external\">https://www.terlici.com/2015/08/13/mysql-node-express.html</a>的大部分，如果有错误，可以留言。</p>\n","excerpt":"<h2 id=\"连接到mysql数据库\"><a href=\"#连接到mysql数据库\" class=\"headerlink\" title=\"连接到mysql数据库\"></a>连接到mysql数据库</h2><p>在这之前先安装正确的npm包：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install mysql</div></pre></td></tr></table></figure></p>\n<p><strong>mysql</strong> 是一个非常容易使用的模块，它提供了你可能需要的所有功能。安装好后，你需要连接数据库的方法是：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> mysql = <span class=\"built_in\">require</span>(<span class=\"string\">'mysql'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> connection = mysql.createConnection(&#123;</div><div class=\"line\">  <span class=\"attr\">host</span>: <span class=\"string\">'localhost'</span>,</div><div class=\"line\">  <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">  <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">  <span class=\"attr\">database</span>: <span class=\"string\">'database'</span></div><div class=\"line\">&#125;)</div><div class=\"line\"></div><div class=\"line\">connection.connect(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (err) <span class=\"keyword\">throw</span> err</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">'You are now connected...'</span>)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure></p>","more":"<p>现在，你可以读写你的数据库了。</p>\n<h2 id=\"读写mysql数据库\"><a href=\"#读写mysql数据库\" class=\"headerlink\" title=\"读写mysql数据库\"></a>读写mysql数据库</h2><p>你已经知道如何去连接你的数据库了，现在让我们看一个简单的例子：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> mysql = <span class=\"built_in\">require</span>(<span class=\"string\">'mysql'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> connection = mysql.createConnection(&#123;</div><div class=\"line\">  <span class=\"attr\">host</span>: <span class=\"string\">'localhost'</span>,</div><div class=\"line\">  <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">  <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">  <span class=\"attr\">database</span>: <span class=\"string\">'database'</span></div><div class=\"line\">&#125;)</div><div class=\"line\"></div><div class=\"line\">connection.connect(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (err) <span class=\"keyword\">throw</span> err</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">'You are now connected...'</span>)</div><div class=\"line\"></div><div class=\"line\">  connection.query(<span class=\"string\">'CREATE TABLE people(id int primary key, name varchar(255), age int, address text)'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, result</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">throw</span> err</div><div class=\"line\">    connection.query(<span class=\"string\">'INSERT INTO people (name, age, address) VALUES (?, ?, ?)'</span>, [<span class=\"string\">'Larry'</span>, <span class=\"string\">'41'</span>, <span class=\"string\">'California, USA'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, result</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">if</span> (err) <span class=\"keyword\">throw</span> err</div><div class=\"line\">      connection.query(<span class=\"string\">'SELECT * FROM people'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, results</span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (err) <span class=\"keyword\">throw</span> err</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(results[<span class=\"number\">0</span>].id)</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(results[<span class=\"number\">0</span>].name)</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(results[<span class=\"number\">0</span>].age)</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(results[<span class=\"number\">0</span>].address)</div><div class=\"line\">      &#125;)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure></p>\n<p>你能够看到在上面的占位符<code>?</code>，它不仅仅使使用起来更容易，而且也是安全的。</p>\n<h2 id=\"更换你的-db-js-文件\"><a href=\"#更换你的-db-js-文件\" class=\"headerlink\" title=\"更换你的 db.js 文件\"></a>更换你的 <em>db.js</em> 文件</h2><p>虽然你看到的mysql模块非常容易，但是真实的应用有着更加复杂的需求。这就是为什么在<a href=\"https://www.terlici.com/2015/04/03/mongodb-node-express.html\">Connecting and Working with MongoDB</a>中，我们创建一个分开的文件db.js来帮助我们管理我们的连接。<br>它的作用是无论何时我们不用经常键入凭证来很容易地连接数据库。它的第二个目标就是很容易运行测试。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> mysql = <span class=\"built_in\">require</span>(<span class=\"string\">'mysql'</span>)</div><div class=\"line\">  , <span class=\"keyword\">async</span> = <span class=\"built_in\">require</span>(<span class=\"string\">'async'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> PRODUCTION_DB = <span class=\"string\">'app_prod_database'</span></div><div class=\"line\">  , TEST_DB = <span class=\"string\">'app_test_database'</span></div><div class=\"line\"></div><div class=\"line\">exports.MODE_TEST = <span class=\"string\">'mode_test'</span></div><div class=\"line\">exports.MODE_PRODUCTION = <span class=\"string\">'mode_production'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> state = &#123;</div><div class=\"line\">  <span class=\"attr\">pool</span>: <span class=\"literal\">null</span>,</div><div class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"literal\">null</span>,</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.connect = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">mode, done</span>) </span>&#123;</div><div class=\"line\">  state.pool = mysql.createPool(&#123;</div><div class=\"line\">    <span class=\"attr\">host</span>: <span class=\"string\">'localhost'</span>,</div><div class=\"line\">    <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">    <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">    <span class=\"attr\">database</span>: mode === exports.MODE_PRODUCTION ? PRODUCTION_DB : TEST_DB</div><div class=\"line\">  &#125;)</div><div class=\"line\"></div><div class=\"line\">  state.mode = mode</div><div class=\"line\">  done()</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.get = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">return</span> state.pool</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.fixtures = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> pool = state.pool</div><div class=\"line\">  <span class=\"keyword\">if</span> (!pool) <span class=\"keyword\">return</span> done(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Missing database connection.'</span>))</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> names = <span class=\"built_in\">Object</span>.keys(data.tables)</div><div class=\"line\">  <span class=\"keyword\">async</span>.each(names, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, cb</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">async</span>.each(data.tables[name], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">row, cb</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">var</span> keys = <span class=\"built_in\">Object</span>.keys(row)</div><div class=\"line\">        , values = keys.map(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">key</span>) </span>&#123; <span class=\"keyword\">return</span> <span class=\"string\">\"'\"</span> + row[key] + <span class=\"string\">\"'\"</span> &#125;)</div><div class=\"line\"></div><div class=\"line\">      pool.query(<span class=\"string\">'INSERT INTO '</span> + name + <span class=\"string\">' ('</span> + keys.join(<span class=\"string\">','</span>) + <span class=\"string\">') VALUES ('</span> + values.join(<span class=\"string\">','</span>) + <span class=\"string\">')'</span>, cb)</div><div class=\"line\">    &#125;, cb)</div><div class=\"line\">  &#125;, done)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.drop = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">tables, done</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> pool = state.pool</div><div class=\"line\">  <span class=\"keyword\">if</span> (!pool) <span class=\"keyword\">return</span> done(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Missing database connection.'</span>))</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">async</span>.each(tables, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, cb</span>) </span>&#123;</div><div class=\"line\">    pool.query(<span class=\"string\">'DELETE * FROM '</span> + name, cb)</div><div class=\"line\">  &#125;, done)</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>这个db.js有点儿比我们之前的要复杂的多。</p>\n<p>首先，它提供一种方法去连接数据库。在生产模块和测试模块都能<br>去连接。测试模块仅在自动化测试时运行。</p>\n<p>然后，有一个<code>get</code>方法能够一直提供给你有效的连接，也可以用来查询数据库。而且，你可以去设置密码，其他模块也可以调用这个方法。</p>\n<p>最后，有两个方法<code>fixtures</code>和<code>drop</code>，很容易地去退出测试。</p>\n<p><strong>drop</strong> 清空数据，它将会帮助你的测试数据库在测试之前总是空的。</p>\n<p><strong>fixtures</strong> 使用json对象，加载数据库中的数据，看一个例子：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> data = &#123;</div><div class=\"line\">  <span class=\"attr\">tables</span>: &#123;</div><div class=\"line\">    <span class=\"attr\">people</span>: [</div><div class=\"line\">     &#123;<span class=\"attr\">id</span>: <span class=\"number\">1</span>, <span class=\"attr\">name</span>: <span class=\"string\">\"John\"</span>, <span class=\"attr\">age</span>: <span class=\"number\">32</span>&#125;,</div><div class=\"line\">     &#123;<span class=\"attr\">id</span>: <span class=\"number\">2</span>, <span class=\"attr\">name</span>: <span class=\"string\">\"Peter\"</span>, <span class=\"attr\">age</span>: <span class=\"number\">29</span>&#125;,</div><div class=\"line\">    ],</div><div class=\"line\">    <span class=\"attr\">cars</span>: [</div><div class=\"line\">      &#123;<span class=\"attr\">id</span>: <span class=\"number\">1</span>, <span class=\"attr\">brand</span>: <span class=\"string\">\"Jeep\"</span>, <span class=\"attr\">model</span>: <span class=\"string\">\"Cherokee\"</span>, <span class=\"attr\">owner_id</span>: <span class=\"number\">2</span>&#125;,</div><div class=\"line\">      &#123;<span class=\"attr\">id</span>: <span class=\"number\">2</span>, <span class=\"attr\">brand</span>: <span class=\"string\">\"BMW\"</span>, <span class=\"attr\">model</span>: <span class=\"string\">\"X5\"</span>, <span class=\"attr\">owner_id</span>: <span class=\"number\">2</span>&#125;,</div><div class=\"line\">      &#123;<span class=\"attr\">id</span>: <span class=\"number\">3</span>, <span class=\"attr\">brand</span>: <span class=\"string\">\"Volkswagen\"</span>, <span class=\"attr\">model</span>: <span class=\"string\">\"Polo\"</span>, <span class=\"attr\">owner_id</span>: <span class=\"number\">1</span>&#125;,</div><div class=\"line\">    ],</div><div class=\"line\">  &#125;,</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> db = <span class=\"built_in\">require</span>(<span class=\"string\">'./db'</span>)</div><div class=\"line\">db.connect(db.MODE_PRODUCTION, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  db.fixtures(data, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> <span class=\"built_in\">console</span>.log(err)</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Data has been loaded...'</span>)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure></p>\n<h2 id=\"使用SQL搭建模块\"><a href=\"#使用SQL搭建模块\" class=\"headerlink\" title=\"使用SQL搭建模块\"></a>使用SQL搭建模块</h2><p>所有事情准备好了，接下来看看如何在你的应用中使用db.js。来看一个例子：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">controllers/</div><div class=\"line\">  comments.js</div><div class=\"line\">  users.js</div><div class=\"line\">models/</div><div class=\"line\">  comment.js</div><div class=\"line\">  user.js</div><div class=\"line\">views/</div><div class=\"line\">app.js</div><div class=\"line\">db.js</div><div class=\"line\">package.json</div></pre></td></tr></table></figure></p>\n<p><strong>app.js</strong> 是应用的入口，也是我们将要设置数据库连接的地方。来看一个例子：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> db = <span class=\"built_in\">require</span>(<span class=\"string\">'./db'</span>)</div><div class=\"line\"></div><div class=\"line\">app.use(<span class=\"string\">'/comments'</span>, <span class=\"built_in\">require</span>(<span class=\"string\">'./controllers/comments'</span>))</div><div class=\"line\">app.use(<span class=\"string\">'/users'</span>, <span class=\"built_in\">require</span>(<span class=\"string\">'./controllers/users'</span>))</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// Connect to MySQL on start</span></div><div class=\"line\">db.connect(db.MODE_PRODUCTION, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (err) &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'Unable to connect to MySQL.'</span>)</div><div class=\"line\">    process.exit(<span class=\"number\">1</span>)</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    app.listen(<span class=\"number\">3000</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">      <span class=\"built_in\">console</span>.log(<span class=\"string\">'Listening on port 3000...'</span>)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure></p>\n<p>你的应用将会通过这个模块来与数据库交互。来看一个例子：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> db = <span class=\"built_in\">require</span>(<span class=\"string\">'../db.js'</span>)</div><div class=\"line\"></div><div class=\"line\">exports.create = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">userId, text, done</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> values = [userId, text, <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().toISOString()]</div><div class=\"line\"></div><div class=\"line\">  db.get().query(<span class=\"string\">'INSERT INTO comments (user_id, text, date) VALUES(?, ?, ?)'</span>, values, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, result</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">    done(<span class=\"literal\">null</span>, result.insertId)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.getAll = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">done</span>) </span>&#123;</div><div class=\"line\">  db.get().query(<span class=\"string\">'SELECT * FROM comments'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, rows</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">    done(<span class=\"literal\">null</span>, rows)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.getAllByUser = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">userId, done</span>) </span>&#123;</div><div class=\"line\">  db.get().query(<span class=\"string\">'SELECT * FROM comments WHERE user_id = ?'</span>, userId, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, rows</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">    done(<span class=\"literal\">null</span>, rows)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>正如你看到的db.js是你完全不用带薪连接数据库的问题，甚至不用只用是否是生产环境还是测试环境。</p>\n<h2 id=\"为读和写使用不一样的实例\"><a href=\"#为读和写使用不一样的实例\" class=\"headerlink\" title=\"为读和写使用不一样的实例\"></a>为读和写使用不一样的实例</h2><p>随着你的应用需求的增长，今天，很多应用都是面向读的。这就意味着，人们读数据少于写数据。例如，所有这一类应用的社交网站，通常你的状态只被读一次，但是然后被成千上万的人去读。在这种情况下是通常有一个主要的数据库将接受所有的写,然后同步到一些MySQL实例将只读取请求。当你有更多的用户可以很容易地添加更多数据库去读，你的应用将仍然是非常快的。</p>\n<p>但是，如何在我们的初始化中解决这个问题呢？mysql模块 <strong>PoolCluster</strong> 特性非常有用,它可以配置几个实例,然后连接到所有的人。看一个db.js中的例子：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> mysql = <span class=\"built_in\">require</span>(<span class=\"string\">'mysql'</span>)</div><div class=\"line\">  , <span class=\"keyword\">async</span> = <span class=\"built_in\">require</span>(<span class=\"string\">'async'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> PRODUCTION_DB = <span class=\"string\">'app_prod_database'</span></div><div class=\"line\">  , TEST_DB = <span class=\"string\">'app_test_database'</span></div><div class=\"line\"></div><div class=\"line\">exports.MODE_TEST = <span class=\"string\">'mode_test'</span></div><div class=\"line\">exports.MODE_PRODUCTION = <span class=\"string\">'mode_production'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> state = &#123;</div><div class=\"line\">  <span class=\"attr\">pool</span>: <span class=\"literal\">null</span>,</div><div class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"literal\">null</span>,</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.connect = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">mode, done</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (mode === exports.MODE_PRODUCTION) &#123;</div><div class=\"line\">    state.pool = mysql.createPoolCluster()</div><div class=\"line\"></div><div class=\"line\">    state.pool.add(<span class=\"string\">'WRITE'</span>, &#123;</div><div class=\"line\">      <span class=\"attr\">host</span>: <span class=\"string\">'192.168.0.5'</span>,</div><div class=\"line\">      <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">      <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">      <span class=\"attr\">database</span>: PRODUCTION_DB</div><div class=\"line\">    &#125;)</div><div class=\"line\"></div><div class=\"line\">    state.pool.add(<span class=\"string\">'READ1'</span>, &#123;</div><div class=\"line\">      <span class=\"attr\">host</span>: <span class=\"string\">'192.168.0.6'</span>,</div><div class=\"line\">      <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">      <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">      <span class=\"attr\">database</span>: PRODUCTION_DB</div><div class=\"line\">    &#125;)</div><div class=\"line\"></div><div class=\"line\">    state.pool.add(<span class=\"string\">'READ2'</span>, &#123;</div><div class=\"line\">      <span class=\"attr\">host</span>: <span class=\"string\">'192.168.0.7'</span>,</div><div class=\"line\">      <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">      <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">      <span class=\"attr\">database</span>: PRODUCTION_DB</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    state.pool = mysql.createPool(&#123;</div><div class=\"line\">      <span class=\"attr\">host</span>: <span class=\"string\">'localhost'</span>,</div><div class=\"line\">      <span class=\"attr\">user</span>: <span class=\"string\">'your_user'</span>,</div><div class=\"line\">      <span class=\"attr\">password</span>: <span class=\"string\">'some_secret'</span>,</div><div class=\"line\">      <span class=\"attr\">database</span>: TEST_DB</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  state.mode = mode</div><div class=\"line\">  done()</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.READ = <span class=\"string\">'read'</span></div><div class=\"line\">exports.WRITE = <span class=\"string\">'write'</span></div><div class=\"line\"></div><div class=\"line\">exports.get = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">type, done</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> pool = state.pool</div><div class=\"line\">  <span class=\"keyword\">if</span> (!pool) <span class=\"keyword\">return</span> done(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Missing database connection.'</span>))</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">if</span> (type === exports.WRITE) &#123;</div><div class=\"line\">    state.pool.getConnection(<span class=\"string\">'WRITE'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, connection</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">      done(<span class=\"literal\">null</span>, connection)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    state.pool.getConnection(<span class=\"string\">'READ*'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, connection</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">      done(<span class=\"literal\">null</span>, connection)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.fixtures = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> pool = state.pool</div><div class=\"line\">  <span class=\"keyword\">if</span> (!pool) <span class=\"keyword\">return</span> done(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Missing database connection.'</span>))</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> names = <span class=\"built_in\">Object</span>.keys(data.tables)</div><div class=\"line\">  <span class=\"keyword\">async</span>.each(names, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, cb</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">async</span>.each(data.tables[name], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">row, cb</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">var</span> keys = <span class=\"built_in\">Object</span>.keys(row)</div><div class=\"line\">        , values = keys.map(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">key</span>) </span>&#123; <span class=\"keyword\">return</span> <span class=\"string\">\"'\"</span> + row[key] + <span class=\"string\">\"'\"</span> &#125;)</div><div class=\"line\"></div><div class=\"line\">      pool.query(<span class=\"string\">'INSERT INTO '</span> + name + <span class=\"string\">' ('</span> + keys.join(<span class=\"string\">','</span>) + <span class=\"string\">') VALUES ('</span> + values.join(<span class=\"string\">','</span>) + <span class=\"string\">')'</span>, cb)</div><div class=\"line\">    &#125;, cb)</div><div class=\"line\">  &#125;, done)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.drop = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">tables, done</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> pool = state.pool</div><div class=\"line\">  <span class=\"keyword\">if</span> (!pool) <span class=\"keyword\">return</span> done(<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">'Missing database connection.'</span>))</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">async</span>.each(tables, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, cb</span>) </span>&#123;</div><div class=\"line\">    pool.query(<span class=\"string\">'DELETE * FROM '</span> + name, cb)</div><div class=\"line\">  &#125;, done)</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>这里有三处和之前的不一样。</p>\n<ol>\n<li>当连接在连接方法在测试模式下,做你之前所做的。然而,当你在生产模式下,添加3个更多的servers。每一个server都有一个名字，第一个是<code>WRITE</code>，另外两个是<code>READ1</code>和<code>READ2</code>。应该很清楚每一个的目的是什么。<code>READ1</code>和<code>READ2</code>是<code>WRITE</code>的奴隶,所以每次有人写数据到<code>WRITE</code>,然后很快地对<code>READ1</code>和<code>READ2</code>可用。</li>\n<li>第二处变化是<code>get</code>方法。之前，它会立即返回一个连接。现在，它返回一个连接到回调函数作为第二个参数提供。</li>\n<li>最后一处变化还是在<code>get</code>方法。在你连接数据库的时候，你需要告诉连接的类型 <strong>READ</strong> 和 <strong>WRITE</strong>。然后根据名称设置为服务器将提供正确的类型的连接。在这种情况下你可以看到<code>getConnection</code>提供一种模式系统,这样您就可以选择适当的数据库</li>\n</ol>\n<p>然后让我们看一个使用 <strong>db.js</strong> 的实例：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> db = <span class=\"built_in\">require</span>(<span class=\"string\">'../db.js'</span>)</div><div class=\"line\"></div><div class=\"line\">exports.create = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">userId, text, done</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">var</span> values = [userId, text, <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().toISOString()]</div><div class=\"line\"></div><div class=\"line\">  db.get(db.WRITE, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, connection</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(<span class=\"string\">'Database problem'</span>)</div><div class=\"line\"></div><div class=\"line\">    connection.query(<span class=\"string\">'INSERT INTO comments (user_id, text, date) VALUES(?, ?, ?)'</span>, values, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, result</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">      done(<span class=\"literal\">null</span>, result.insertId)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.getAll = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">done</span>) </span>&#123;</div><div class=\"line\">  db.get(db.READ, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, connection</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(<span class=\"string\">'Database problem'</span>)</div><div class=\"line\"></div><div class=\"line\">    connection.query(<span class=\"string\">'SELECT * FROM comments'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, rows</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">      done(<span class=\"literal\">null</span>, rows)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.getAllByUser = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">userId, done</span>) </span>&#123;</div><div class=\"line\">  db.get(db.READ, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, connection</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(<span class=\"string\">'Database problem'</span>)</div><div class=\"line\"></div><div class=\"line\">    connection.query(<span class=\"string\">'SELECT * FROM comments WHERE user_id = ?'</span>, userId, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">err, rows</span>) </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">if</span> (err) <span class=\"keyword\">return</span> done(err)</div><div class=\"line\">      done(<span class=\"literal\">null</span>, rows)</div><div class=\"line\">    &#125;)</div><div class=\"line\">  &#125;)</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>你也可以创建一个代理连接对象,基于可以查询了解这是一个写或读,然后选择适当的连接。这样你甚至不会改变你的模块。</p>\n<h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><p>本文翻译了<a href=\"https://www.terlici.com/2015/08/13/mysql-node-express.html\">https://www.terlici.com/2015/08/13/mysql-node-express.html</a>的大部分，如果有错误，可以留言。</p>"},{"title":"获取软键盘高度和生成9-patch","date":"2016-08-24T15:30:49.000Z","comments":0,"_content":"最近在做一个类似聊天的功能，所以需要获取到软键盘的高度来控制界面的显示，同时有一些手机上面有虚拟按键，在界面布局的时候需要注意。下面的代码就是一段获取手机软键盘高度的办法。\n<!-- more -->\n```java\n\tRect r = new Rect();\n\tgetWindow().getDecorView().getWindowVisibleDisplayFrame(r);\n\tDisplayMetrics metrics = new DisplayMetrics();\n\tgetWindowManager().getDefaultDisplay().getMetrics(metrics);\n\t//屏幕的高度，不包含虚拟按键\n\tint screenHeight = metrics.heightPixels;\n\t//屏幕真实的高度，包含虚拟按键\n\tgetWindowManager().getDefaultDisplay().getRealMetrics(metrics);\n\t//虚拟按键的高度\n\tint virtualHight = metrics.heightPixels - screenHeight;\n\tint statusBarHeight=getStatusBarHeight(context);\n\t// 在不显示软键盘时，heightDiff等于状态栏的高度\n\t// 在显示软键盘时，heightDiff会变大，等于软键盘加状态栏的高度。\n\t// 所以heightDiff大于状态栏高度时表示软键盘出现了，\n\t// 这时可算出软键盘的高度，即heightDiff减去状态栏的高度\n\tif (heightDiff > statusBarHeight) {\n\t\tkeyboardHeight = heightDiff - statusBarHeight;\n\t}\n\n\tif (isShowKeyboard) {\n\t\t// 如果软键盘是弹出的状态，并且heightDiff小于等于状态栏高度，\n\t\tif (heightDiff <= statusBarHeight) {\n\t\t\t// 说明这时软键盘已经收起\n\t\t\tisShowKeyboard=false;\n\t\t}\n\t} else {\n        // 如果软键盘是收起的状态，并且heightDiff大于状态栏高度，\n        if (heightDiff > statusBarHeight) {\n         // 说明这时软键盘已经弹出\n         isShowKeyboard=true;\n\t\t}\n\t}\n```\n有一个 **ViewTreeObserver** 的类，可以用来监听view状态的变化，包括焦点改变、开始绘制、触摸事件等等的变化，如果要想控制某个控件的高度，可以利用这个类来实现，如下所示：\n```java\n\tview.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {\n\t\t\t /**\n\t         * Callback method to be invoked when the global layout state or the visibility of views\n\t         * within the view tree changes\n\t         */\n            @Override\n            public void onGlobalLayout() {\n                //这里放你要实现的效果。\n            }\n        });\n```\n下面是获取手机状态栏高度的办法\n```java\n\t// 获取手机状态栏高度\n    public static int getStatusBarHeight(Context context) {\n        Class<?> c = null;\n        Object obj = null;\n        Field field = null;\n        int x = 0, statusBarHeight = 0;\n        try {\n            c = Class.forName(\"com.android.internal.R$dimen\");\n            obj = c.newInstance();\n            field = c.getField(\"status_bar_height\");\n            x=Integer.parseInt(field.get(obj).toString());\n            statusBarHeight = context.getResources().getDimensionPixelSize(x);\n        } catch (Exception e1) {\n            e1.printStackTrace();\n        }\n        return statusBarHeight;\n    }\n```\n对于聊天框，一开始想的是自定义控件的办法，后来在网上找到了**9-patch**，可以自动拉伸图片，需要用到的是**.png**的图片，可以找美工切好图，在Android studio上，右键选择图片，可以自动生成**xx.9.png**的文件，如下图：\n![xx.9.png](http://img.blog.csdn.net/20160824174835941)\n\n在```\\sdk\\tools\\``` 下面有 **draw9patch**  命令，如果你配置了路径了，可以直接在命令行使用**draw9patch**打开。至于如何配置路径，这里就不赘述了。打开之后导入图片就能生成 **9-Patch** ，如下图：\n![draw9patch](http://img.blog.csdn.net/20160824204210485)\n\n下面就是最终效果了，需要注意的是，生成的 **xx.9.png** 文件需保存在 **drawable** 的目录下面，然后就可以直接调用了。\n在工具上，有边线可以直接拖动，多试验几次找到最合适自己的，如图所示黑色阴影是要显示的区域的边距，两条绿色区域的交叉处就是最后会被拉伸的地方，右边就是最后被拉伸的效果图。\n![效果](http://img.blog.csdn.net/20160824174900410)\n","source":"_posts/soft-keyboard-and-9-patch.md","raw":"---\ntitle: 获取软键盘高度和生成9-patch\ndate: 2016-08-24 23:30:49\ntags: Android\ncomments: false\n---\n最近在做一个类似聊天的功能，所以需要获取到软键盘的高度来控制界面的显示，同时有一些手机上面有虚拟按键，在界面布局的时候需要注意。下面的代码就是一段获取手机软键盘高度的办法。\n<!-- more -->\n```java\n\tRect r = new Rect();\n\tgetWindow().getDecorView().getWindowVisibleDisplayFrame(r);\n\tDisplayMetrics metrics = new DisplayMetrics();\n\tgetWindowManager().getDefaultDisplay().getMetrics(metrics);\n\t//屏幕的高度，不包含虚拟按键\n\tint screenHeight = metrics.heightPixels;\n\t//屏幕真实的高度，包含虚拟按键\n\tgetWindowManager().getDefaultDisplay().getRealMetrics(metrics);\n\t//虚拟按键的高度\n\tint virtualHight = metrics.heightPixels - screenHeight;\n\tint statusBarHeight=getStatusBarHeight(context);\n\t// 在不显示软键盘时，heightDiff等于状态栏的高度\n\t// 在显示软键盘时，heightDiff会变大，等于软键盘加状态栏的高度。\n\t// 所以heightDiff大于状态栏高度时表示软键盘出现了，\n\t// 这时可算出软键盘的高度，即heightDiff减去状态栏的高度\n\tif (heightDiff > statusBarHeight) {\n\t\tkeyboardHeight = heightDiff - statusBarHeight;\n\t}\n\n\tif (isShowKeyboard) {\n\t\t// 如果软键盘是弹出的状态，并且heightDiff小于等于状态栏高度，\n\t\tif (heightDiff <= statusBarHeight) {\n\t\t\t// 说明这时软键盘已经收起\n\t\t\tisShowKeyboard=false;\n\t\t}\n\t} else {\n        // 如果软键盘是收起的状态，并且heightDiff大于状态栏高度，\n        if (heightDiff > statusBarHeight) {\n         // 说明这时软键盘已经弹出\n         isShowKeyboard=true;\n\t\t}\n\t}\n```\n有一个 **ViewTreeObserver** 的类，可以用来监听view状态的变化，包括焦点改变、开始绘制、触摸事件等等的变化，如果要想控制某个控件的高度，可以利用这个类来实现，如下所示：\n```java\n\tview.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {\n\t\t\t /**\n\t         * Callback method to be invoked when the global layout state or the visibility of views\n\t         * within the view tree changes\n\t         */\n            @Override\n            public void onGlobalLayout() {\n                //这里放你要实现的效果。\n            }\n        });\n```\n下面是获取手机状态栏高度的办法\n```java\n\t// 获取手机状态栏高度\n    public static int getStatusBarHeight(Context context) {\n        Class<?> c = null;\n        Object obj = null;\n        Field field = null;\n        int x = 0, statusBarHeight = 0;\n        try {\n            c = Class.forName(\"com.android.internal.R$dimen\");\n            obj = c.newInstance();\n            field = c.getField(\"status_bar_height\");\n            x=Integer.parseInt(field.get(obj).toString());\n            statusBarHeight = context.getResources().getDimensionPixelSize(x);\n        } catch (Exception e1) {\n            e1.printStackTrace();\n        }\n        return statusBarHeight;\n    }\n```\n对于聊天框，一开始想的是自定义控件的办法，后来在网上找到了**9-patch**，可以自动拉伸图片，需要用到的是**.png**的图片，可以找美工切好图，在Android studio上，右键选择图片，可以自动生成**xx.9.png**的文件，如下图：\n![xx.9.png](http://img.blog.csdn.net/20160824174835941)\n\n在```\\sdk\\tools\\``` 下面有 **draw9patch**  命令，如果你配置了路径了，可以直接在命令行使用**draw9patch**打开。至于如何配置路径，这里就不赘述了。打开之后导入图片就能生成 **9-Patch** ，如下图：\n![draw9patch](http://img.blog.csdn.net/20160824204210485)\n\n下面就是最终效果了，需要注意的是，生成的 **xx.9.png** 文件需保存在 **drawable** 的目录下面，然后就可以直接调用了。\n在工具上，有边线可以直接拖动，多试验几次找到最合适自己的，如图所示黑色阴影是要显示的区域的边距，两条绿色区域的交叉处就是最后会被拉伸的地方，右边就是最后被拉伸的效果图。\n![效果](http://img.blog.csdn.net/20160824174900410)\n","slug":"soft-keyboard-and-9-patch","published":1,"updated":"2017-04-15T14:06:03.000Z","layout":"post","photos":[],"link":"","_id":"cjr66widn001lmetpt5c5t9lh","content":"<p>最近在做一个类似聊天的功能，所以需要获取到软键盘的高度来控制界面的显示，同时有一些手机上面有虚拟按键，在界面布局的时候需要注意。下面的代码就是一段获取手机软键盘高度的办法。<br><a id=\"more\"></a><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div></pre></td><td class=\"code\"><pre><div class=\"line\">Rect r = <span class=\"keyword\">new</span> Rect();</div><div class=\"line\">getWindow().getDecorView().getWindowVisibleDisplayFrame(r);</div><div class=\"line\">DisplayMetrics metrics = <span class=\"keyword\">new</span> DisplayMetrics();</div><div class=\"line\">getWindowManager().getDefaultDisplay().getMetrics(metrics);</div><div class=\"line\"><span class=\"comment\">//屏幕的高度，不包含虚拟按键</span></div><div class=\"line\"><span class=\"keyword\">int</span> screenHeight = metrics.heightPixels;</div><div class=\"line\"><span class=\"comment\">//屏幕真实的高度，包含虚拟按键</span></div><div class=\"line\">getWindowManager().getDefaultDisplay().getRealMetrics(metrics);</div><div class=\"line\"><span class=\"comment\">//虚拟按键的高度</span></div><div class=\"line\"><span class=\"keyword\">int</span> virtualHight = metrics.heightPixels - screenHeight;</div><div class=\"line\"><span class=\"keyword\">int</span> statusBarHeight=getStatusBarHeight(context);</div><div class=\"line\"><span class=\"comment\">// 在不显示软键盘时，heightDiff等于状态栏的高度</span></div><div class=\"line\"><span class=\"comment\">// 在显示软键盘时，heightDiff会变大，等于软键盘加状态栏的高度。</span></div><div class=\"line\"><span class=\"comment\">// 所以heightDiff大于状态栏高度时表示软键盘出现了，</span></div><div class=\"line\"><span class=\"comment\">// 这时可算出软键盘的高度，即heightDiff减去状态栏的高度</span></div><div class=\"line\"><span class=\"keyword\">if</span> (heightDiff &gt; statusBarHeight) &#123;</div><div class=\"line\">\tkeyboardHeight = heightDiff - statusBarHeight;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> (isShowKeyboard) &#123;</div><div class=\"line\">\t<span class=\"comment\">// 如果软键盘是弹出的状态，并且heightDiff小于等于状态栏高度，</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> (heightDiff &lt;= statusBarHeight) &#123;</div><div class=\"line\">\t\t<span class=\"comment\">// 说明这时软键盘已经收起</span></div><div class=\"line\">\t\tisShowKeyboard=<span class=\"keyword\">false</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">       <span class=\"comment\">// 如果软键盘是收起的状态，并且heightDiff大于状态栏高度，</span></div><div class=\"line\">       <span class=\"keyword\">if</span> (heightDiff &gt; statusBarHeight) &#123;</div><div class=\"line\">        <span class=\"comment\">// 说明这时软键盘已经弹出</span></div><div class=\"line\">        isShowKeyboard=<span class=\"keyword\">true</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>有一个 <strong>ViewTreeObserver</strong> 的类，可以用来监听view状态的变化，包括焦点改变、开始绘制、触摸事件等等的变化，如果要想控制某个控件的高度，可以利用这个类来实现，如下所示：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">view.getViewTreeObserver().addOnGlobalLayoutListener(<span class=\"keyword\">new</span> ViewTreeObserver.OnGlobalLayoutListener() &#123;</div><div class=\"line\">\t\t <span class=\"comment\">/**</span></div><div class=\"line\">         * Callback method to be invoked when the global layout state or the visibility of views</div><div class=\"line\">         * within the view tree changes</div><div class=\"line\">         */</div><div class=\"line\">           <span class=\"meta\">@Override</span></div><div class=\"line\">           <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onGlobalLayout</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">               <span class=\"comment\">//这里放你要实现的效果。</span></div><div class=\"line\">           &#125;</div><div class=\"line\">       &#125;);</div></pre></td></tr></table></figure></p>\n<p>下面是获取手机状态栏高度的办法<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// 获取手机状态栏高度</span></div><div class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">getStatusBarHeight</span><span class=\"params\">(Context context)</span> </span>&#123;</div><div class=\"line\">       Class&lt;?&gt; c = <span class=\"keyword\">null</span>;</div><div class=\"line\">       Object obj = <span class=\"keyword\">null</span>;</div><div class=\"line\">       Field field = <span class=\"keyword\">null</span>;</div><div class=\"line\">       <span class=\"keyword\">int</span> x = <span class=\"number\">0</span>, statusBarHeight = <span class=\"number\">0</span>;</div><div class=\"line\">       <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">           c = Class.forName(<span class=\"string\">\"com.android.internal.R$dimen\"</span>);</div><div class=\"line\">           obj = c.newInstance();</div><div class=\"line\">           field = c.getField(<span class=\"string\">\"status_bar_height\"</span>);</div><div class=\"line\">           x=Integer.parseInt(field.get(obj).toString());</div><div class=\"line\">           statusBarHeight = context.getResources().getDimensionPixelSize(x);</div><div class=\"line\">       &#125; <span class=\"keyword\">catch</span> (Exception e1) &#123;</div><div class=\"line\">           e1.printStackTrace();</div><div class=\"line\">       &#125;</div><div class=\"line\">       <span class=\"keyword\">return</span> statusBarHeight;</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure></p>\n<p>对于聊天框，一开始想的是自定义控件的办法，后来在网上找到了<strong>9-patch</strong>，可以自动拉伸图片，需要用到的是<strong>.png</strong>的图片，可以找美工切好图，在Android studio上，右键选择图片，可以自动生成<strong>xx.9.png</strong>的文件，如下图：<br><img src=\"http://img.blog.csdn.net/20160824174835941\" alt=\"xx.9.png\"></p>\n<p>在<code>\\sdk\\tools\\</code> 下面有 <strong>draw9patch</strong>  命令，如果你配置了路径了，可以直接在命令行使用<strong>draw9patch</strong>打开。至于如何配置路径，这里就不赘述了。打开之后导入图片就能生成 <strong>9-Patch</strong> ，如下图：<br><img src=\"http://img.blog.csdn.net/20160824204210485\" alt=\"draw9patch\"></p>\n<p>下面就是最终效果了，需要注意的是，生成的 <strong>xx.9.png</strong> 文件需保存在 <strong>drawable</strong> 的目录下面，然后就可以直接调用了。<br>在工具上，有边线可以直接拖动，多试验几次找到最合适自己的，如图所示黑色阴影是要显示的区域的边距，两条绿色区域的交叉处就是最后会被拉伸的地方，右边就是最后被拉伸的效果图。<br><img src=\"http://img.blog.csdn.net/20160824174900410\" alt=\"效果\"></p>\n","excerpt":"<p>最近在做一个类似聊天的功能，所以需要获取到软键盘的高度来控制界面的显示，同时有一些手机上面有虚拟按键，在界面布局的时候需要注意。下面的代码就是一段获取手机软键盘高度的办法。<br>","more":"<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div></pre></td><td class=\"code\"><pre><div class=\"line\">Rect r = <span class=\"keyword\">new</span> Rect();</div><div class=\"line\">getWindow().getDecorView().getWindowVisibleDisplayFrame(r);</div><div class=\"line\">DisplayMetrics metrics = <span class=\"keyword\">new</span> DisplayMetrics();</div><div class=\"line\">getWindowManager().getDefaultDisplay().getMetrics(metrics);</div><div class=\"line\"><span class=\"comment\">//屏幕的高度，不包含虚拟按键</span></div><div class=\"line\"><span class=\"keyword\">int</span> screenHeight = metrics.heightPixels;</div><div class=\"line\"><span class=\"comment\">//屏幕真实的高度，包含虚拟按键</span></div><div class=\"line\">getWindowManager().getDefaultDisplay().getRealMetrics(metrics);</div><div class=\"line\"><span class=\"comment\">//虚拟按键的高度</span></div><div class=\"line\"><span class=\"keyword\">int</span> virtualHight = metrics.heightPixels - screenHeight;</div><div class=\"line\"><span class=\"keyword\">int</span> statusBarHeight=getStatusBarHeight(context);</div><div class=\"line\"><span class=\"comment\">// 在不显示软键盘时，heightDiff等于状态栏的高度</span></div><div class=\"line\"><span class=\"comment\">// 在显示软键盘时，heightDiff会变大，等于软键盘加状态栏的高度。</span></div><div class=\"line\"><span class=\"comment\">// 所以heightDiff大于状态栏高度时表示软键盘出现了，</span></div><div class=\"line\"><span class=\"comment\">// 这时可算出软键盘的高度，即heightDiff减去状态栏的高度</span></div><div class=\"line\"><span class=\"keyword\">if</span> (heightDiff &gt; statusBarHeight) &#123;</div><div class=\"line\">\tkeyboardHeight = heightDiff - statusBarHeight;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> (isShowKeyboard) &#123;</div><div class=\"line\">\t<span class=\"comment\">// 如果软键盘是弹出的状态，并且heightDiff小于等于状态栏高度，</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> (heightDiff &lt;= statusBarHeight) &#123;</div><div class=\"line\">\t\t<span class=\"comment\">// 说明这时软键盘已经收起</span></div><div class=\"line\">\t\tisShowKeyboard=<span class=\"keyword\">false</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">       <span class=\"comment\">// 如果软键盘是收起的状态，并且heightDiff大于状态栏高度，</span></div><div class=\"line\">       <span class=\"keyword\">if</span> (heightDiff &gt; statusBarHeight) &#123;</div><div class=\"line\">        <span class=\"comment\">// 说明这时软键盘已经弹出</span></div><div class=\"line\">        isShowKeyboard=<span class=\"keyword\">true</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>有一个 <strong>ViewTreeObserver</strong> 的类，可以用来监听view状态的变化，包括焦点改变、开始绘制、触摸事件等等的变化，如果要想控制某个控件的高度，可以利用这个类来实现，如下所示：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">view.getViewTreeObserver().addOnGlobalLayoutListener(<span class=\"keyword\">new</span> ViewTreeObserver.OnGlobalLayoutListener() &#123;</div><div class=\"line\">\t\t <span class=\"comment\">/**</div><div class=\"line\">         * Callback method to be invoked when the global layout state or the visibility of views</div><div class=\"line\">         * within the view tree changes</div><div class=\"line\">         */</span></div><div class=\"line\">           <span class=\"meta\">@Override</span></div><div class=\"line\">           <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onGlobalLayout</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">               <span class=\"comment\">//这里放你要实现的效果。</span></div><div class=\"line\">           &#125;</div><div class=\"line\">       &#125;);</div></pre></td></tr></table></figure></p>\n<p>下面是获取手机状态栏高度的办法<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// 获取手机状态栏高度</span></div><div class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">getStatusBarHeight</span><span class=\"params\">(Context context)</span> </span>&#123;</div><div class=\"line\">       Class&lt;?&gt; c = <span class=\"keyword\">null</span>;</div><div class=\"line\">       Object obj = <span class=\"keyword\">null</span>;</div><div class=\"line\">       Field field = <span class=\"keyword\">null</span>;</div><div class=\"line\">       <span class=\"keyword\">int</span> x = <span class=\"number\">0</span>, statusBarHeight = <span class=\"number\">0</span>;</div><div class=\"line\">       <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">           c = Class.forName(<span class=\"string\">\"com.android.internal.R$dimen\"</span>);</div><div class=\"line\">           obj = c.newInstance();</div><div class=\"line\">           field = c.getField(<span class=\"string\">\"status_bar_height\"</span>);</div><div class=\"line\">           x=Integer.parseInt(field.get(obj).toString());</div><div class=\"line\">           statusBarHeight = context.getResources().getDimensionPixelSize(x);</div><div class=\"line\">       &#125; <span class=\"keyword\">catch</span> (Exception e1) &#123;</div><div class=\"line\">           e1.printStackTrace();</div><div class=\"line\">       &#125;</div><div class=\"line\">       <span class=\"keyword\">return</span> statusBarHeight;</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure></p>\n<p>对于聊天框，一开始想的是自定义控件的办法，后来在网上找到了<strong>9-patch</strong>，可以自动拉伸图片，需要用到的是<strong>.png</strong>的图片，可以找美工切好图，在Android studio上，右键选择图片，可以自动生成<strong>xx.9.png</strong>的文件，如下图：<br><img src=\"http://img.blog.csdn.net/20160824174835941\" alt=\"xx.9.png\"></p>\n<p>在<code>\\sdk\\tools\\</code> 下面有 <strong>draw9patch</strong>  命令，如果你配置了路径了，可以直接在命令行使用<strong>draw9patch</strong>打开。至于如何配置路径，这里就不赘述了。打开之后导入图片就能生成 <strong>9-Patch</strong> ，如下图：<br><img src=\"http://img.blog.csdn.net/20160824204210485\" alt=\"draw9patch\"></p>\n<p>下面就是最终效果了，需要注意的是，生成的 <strong>xx.9.png</strong> 文件需保存在 <strong>drawable</strong> 的目录下面，然后就可以直接调用了。<br>在工具上，有边线可以直接拖动，多试验几次找到最合适自己的，如图所示黑色阴影是要显示的区域的边距，两条绿色区域的交叉处就是最后会被拉伸的地方，右边就是最后被拉伸的效果图。<br><img src=\"http://img.blog.csdn.net/20160824174900410\" alt=\"效果\"></p>"},{"title":"Spirng boot maven多模块打包踩坑","date":"2017-11-02T02:42:28.000Z","_content":"最近折腾了两次spring boot在maven下的多模块打包，踩了很多坑，现在记录如下。\n<!-- more -->\n项目目录：\n- 项目 P\n- 模块 A\n- 模块 B\n- 公有基础模块 C\n- Mybatis基础模块 M\n\n# 父pom.xml文件：\n```xml\n  <!--版本号-->\n  <groupId>com.parent</groupId>\n  <artifactId>demo</artifactId>\n  <version>0.0.1-SNAPSHOT</version>\n\n  <!--管理所有的模块-->\n  <modules>\n    <modules>C</modules>\n    <modules>M</modules>\n  </modules>\n\n  <!--指定项目的spring boot的版本-->\n  <parent>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter-parent</artifactId>\n      <version>2.0.0.M5</version>\n  </parent>\n\n  <!--指定项目中公有的模块-->\n  <dependencyManagement>\n    <dependencies>\n      <dependency>\n        <groupId>com.module</groupId>\n        <artifactId>c</artifactId>\n        <version>${project.version}</version>\n      </dependency>\n      <dependency>\n        <groupId>com.module</groupId>\n        <artifactId>m</artifactId>\n        <version>${project.version}</version>\n      </dependency>\n    </dependencies>\n  </dependencyManagement>\n\n  <!--指定jdk的版本为1.8，默认为1.6-->\n  <properties>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>\n    <java.version>1.8</java.version>\n  </properties>\n\n  <!--指定项目中公有的依赖-->\n  <dependencies>\n    <dependency>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter</artifactId>\n    </dependency>\n  </dependencies>\n\n  <!--指定使用maven打包-->\n  <build>\n    <plugins>\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-compiler-plugin</artifactId>\n        <version>3.1</version>\n          <configuration>\n            <source>${java.version}</source>\n            <target>${java.version}</target>\n            </configuration>\n      </plugin>\n\n      <plugin>\n          <groupId>org.apache.maven.plugins</groupId>\n          <artifactId>maven-surefire-plugin</artifactId>\n          <version>2.19.1</version>\n            <configuration>\n              <skipTests>true</skipTests>    <!--默认关掉单元测试 -->\n            </configuration>\n      </plugin>\n    </plugins>\n  </build>\n```\n# 模块A的pom.xml\n```xml\n  <groupId>com.module</groupId>\n  <artifactId>a</artifactId>\n  <version>0.0.1-SNAPSHOT</version>\n  <packaging>jar</packaging>\n\n  <!--指定父模块，需要注意的是，这里要指定父模块pom.xml的相对路径-->\n  <parent>\n    <groupId>com.parent</groupId>\n    <artifactId>demo</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <relativePath>../pom.xml</relativePath>\n  </parent>\n\n  <!--spring boot打包的话需要指定一个唯一的入门-->\n  <build>\n\t\t<plugins>\n\t\t\t<plugin>\n\t\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t\t<artifactId>spring-boot-maven-plugin</artifactId>\n          <configuration>\n            <!-- 指定该Main Class为全局的唯一入口 -->\n            <mainClass>com.module.a.Application</mainClass>\n            <layout>ZIP</layout>\n          </configuration>\n          <executions>\n            <execution>\n              <goals>\n                <goal>repackage</goal><!--可以把依赖的包都打包到生成的Jar包中-->\n              </goals>\n            </execution>\n          </executions>\n      </plugin>\n\t\t</plugins>\n\t</build>\n```\n# 模块B的pom.xml\n同A即可\n\n# 模块C的pom.xml\n如果是共有模块的话，不需要打包，否则会报错，因为其他模块在打包的时候会自动添加依赖进去，如果这里打包了，其他的模块就找不到该依赖了。\n```xml\n  <groupId>com.module</groupId>\n\t<artifactId>c</artifactId>\n\t<version>0.0.1-SNAPSHOT</version>\n\t<packaging>jar</packaging>\n\n  <!--指定父模块，需要注意的是，这里要指定父模块pom.xml的相对路径-->\n  <parent>\n    <groupId>com.parent</groupId>\n    <artifactId>demo</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <relativePath>../pom.xml</relativePath>\n  </parent>\n```\n\n# 模块M的pom.xml\n如果项目中使用的Mybatis的话，肯定是作为一个单独的模块来处理的，这个Mybatis是需要打包的\n```xml\n  <groupId>com.module</groupId>\n  <artifactId>m</artifactId>\n  <version>0.0.1-SNAPSHOT</version>\n  <packaging>jar</packaging>\n\n  <!--指定父模块，需要注意的是，这里要指定父模块pom.xml的相对路径-->\n  <parent>\n    <groupId>com.parent</groupId>\n    <artifactId>demo</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <relativePath>../pom.xml</relativePath>\n  </parent>\n\n  <!--mybatis的打包方式-->\n  <build>\n\t\t<plugins>\n\t\t\t<plugin>\n\t\t\t\t<groupId>org.mybatis.generator</groupId>\n\t\t\t\t<artifactId>mybatis-generator-maven-plugin</artifactId>\n\t\t\t\t<version>1.3.5</version>\n\t\t\t\t<executions>\n\t\t\t\t\t<execution>\n\t\t\t\t\t\t<id>Generate MyBatis Artifacts</id>\n\t\t\t\t\t\t<phase>none</phase>\n\t\t\t\t\t\t<goals>\n\t\t\t\t\t\t\t<goal>generate</goal>\n\t\t\t\t\t\t</goals>\n\t\t\t\t\t</execution>\n\t\t\t\t</executions>\n\t\t\t\t<configuration>\n\t\t\t\t\t<overwrite>true</overwrite>\n\t\t\t\t</configuration>\n\t\t\t</plugin>\n\t\t</plugins>\n\t</build>\n```\n# 打包\n按照上面的配置好以后，执行下面的命令就好了\n```\n  mvn clean package\n```\n\n但是如果使用了多个模块，上面的命令是会吧全部的模块都执行打包的，如果只是打包某个模块的话，可以用\n```\n  mvn -pl A -am install\n```\n","source":"_posts/spring-boot-multi-module.md","raw":"---\ntitle: Spirng boot maven多模块打包踩坑\ntags: spring boot\n\ndate: 2017-11-02 10:42:28\n---\n最近折腾了两次spring boot在maven下的多模块打包，踩了很多坑，现在记录如下。\n<!-- more -->\n项目目录：\n- 项目 P\n- 模块 A\n- 模块 B\n- 公有基础模块 C\n- Mybatis基础模块 M\n\n# 父pom.xml文件：\n```xml\n  <!--版本号-->\n  <groupId>com.parent</groupId>\n  <artifactId>demo</artifactId>\n  <version>0.0.1-SNAPSHOT</version>\n\n  <!--管理所有的模块-->\n  <modules>\n    <modules>C</modules>\n    <modules>M</modules>\n  </modules>\n\n  <!--指定项目的spring boot的版本-->\n  <parent>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter-parent</artifactId>\n      <version>2.0.0.M5</version>\n  </parent>\n\n  <!--指定项目中公有的模块-->\n  <dependencyManagement>\n    <dependencies>\n      <dependency>\n        <groupId>com.module</groupId>\n        <artifactId>c</artifactId>\n        <version>${project.version}</version>\n      </dependency>\n      <dependency>\n        <groupId>com.module</groupId>\n        <artifactId>m</artifactId>\n        <version>${project.version}</version>\n      </dependency>\n    </dependencies>\n  </dependencyManagement>\n\n  <!--指定jdk的版本为1.8，默认为1.6-->\n  <properties>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>\n    <java.version>1.8</java.version>\n  </properties>\n\n  <!--指定项目中公有的依赖-->\n  <dependencies>\n    <dependency>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter</artifactId>\n    </dependency>\n  </dependencies>\n\n  <!--指定使用maven打包-->\n  <build>\n    <plugins>\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-compiler-plugin</artifactId>\n        <version>3.1</version>\n          <configuration>\n            <source>${java.version}</source>\n            <target>${java.version}</target>\n            </configuration>\n      </plugin>\n\n      <plugin>\n          <groupId>org.apache.maven.plugins</groupId>\n          <artifactId>maven-surefire-plugin</artifactId>\n          <version>2.19.1</version>\n            <configuration>\n              <skipTests>true</skipTests>    <!--默认关掉单元测试 -->\n            </configuration>\n      </plugin>\n    </plugins>\n  </build>\n```\n# 模块A的pom.xml\n```xml\n  <groupId>com.module</groupId>\n  <artifactId>a</artifactId>\n  <version>0.0.1-SNAPSHOT</version>\n  <packaging>jar</packaging>\n\n  <!--指定父模块，需要注意的是，这里要指定父模块pom.xml的相对路径-->\n  <parent>\n    <groupId>com.parent</groupId>\n    <artifactId>demo</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <relativePath>../pom.xml</relativePath>\n  </parent>\n\n  <!--spring boot打包的话需要指定一个唯一的入门-->\n  <build>\n\t\t<plugins>\n\t\t\t<plugin>\n\t\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t\t<artifactId>spring-boot-maven-plugin</artifactId>\n          <configuration>\n            <!-- 指定该Main Class为全局的唯一入口 -->\n            <mainClass>com.module.a.Application</mainClass>\n            <layout>ZIP</layout>\n          </configuration>\n          <executions>\n            <execution>\n              <goals>\n                <goal>repackage</goal><!--可以把依赖的包都打包到生成的Jar包中-->\n              </goals>\n            </execution>\n          </executions>\n      </plugin>\n\t\t</plugins>\n\t</build>\n```\n# 模块B的pom.xml\n同A即可\n\n# 模块C的pom.xml\n如果是共有模块的话，不需要打包，否则会报错，因为其他模块在打包的时候会自动添加依赖进去，如果这里打包了，其他的模块就找不到该依赖了。\n```xml\n  <groupId>com.module</groupId>\n\t<artifactId>c</artifactId>\n\t<version>0.0.1-SNAPSHOT</version>\n\t<packaging>jar</packaging>\n\n  <!--指定父模块，需要注意的是，这里要指定父模块pom.xml的相对路径-->\n  <parent>\n    <groupId>com.parent</groupId>\n    <artifactId>demo</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <relativePath>../pom.xml</relativePath>\n  </parent>\n```\n\n# 模块M的pom.xml\n如果项目中使用的Mybatis的话，肯定是作为一个单独的模块来处理的，这个Mybatis是需要打包的\n```xml\n  <groupId>com.module</groupId>\n  <artifactId>m</artifactId>\n  <version>0.0.1-SNAPSHOT</version>\n  <packaging>jar</packaging>\n\n  <!--指定父模块，需要注意的是，这里要指定父模块pom.xml的相对路径-->\n  <parent>\n    <groupId>com.parent</groupId>\n    <artifactId>demo</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <relativePath>../pom.xml</relativePath>\n  </parent>\n\n  <!--mybatis的打包方式-->\n  <build>\n\t\t<plugins>\n\t\t\t<plugin>\n\t\t\t\t<groupId>org.mybatis.generator</groupId>\n\t\t\t\t<artifactId>mybatis-generator-maven-plugin</artifactId>\n\t\t\t\t<version>1.3.5</version>\n\t\t\t\t<executions>\n\t\t\t\t\t<execution>\n\t\t\t\t\t\t<id>Generate MyBatis Artifacts</id>\n\t\t\t\t\t\t<phase>none</phase>\n\t\t\t\t\t\t<goals>\n\t\t\t\t\t\t\t<goal>generate</goal>\n\t\t\t\t\t\t</goals>\n\t\t\t\t\t</execution>\n\t\t\t\t</executions>\n\t\t\t\t<configuration>\n\t\t\t\t\t<overwrite>true</overwrite>\n\t\t\t\t</configuration>\n\t\t\t</plugin>\n\t\t</plugins>\n\t</build>\n```\n# 打包\n按照上面的配置好以后，执行下面的命令就好了\n```\n  mvn clean package\n```\n\n但是如果使用了多个模块，上面的命令是会吧全部的模块都执行打包的，如果只是打包某个模块的话，可以用\n```\n  mvn -pl A -am install\n```\n","slug":"spring-boot-multi-module","published":1,"updated":"2018-02-05T06:30:37.543Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjr66wido001ometp9a1qe34g","content":"<p>最近折腾了两次spring boot在maven下的多模块打包，踩了很多坑，现在记录如下。<br><a id=\"more\"></a><br>项目目录：</p>\n<ul>\n<li>项目 P</li>\n<li>模块 A</li>\n<li>模块 B</li>\n<li>公有基础模块 C</li>\n<li>Mybatis基础模块 M</li>\n</ul>\n<h1 id=\"父pom-xml文件：\"><a href=\"#父pom-xml文件：\" class=\"headerlink\" title=\"父pom.xml文件：\"></a>父pom.xml文件：</h1><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!--版本号--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.parent<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>demo<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!--管理所有的模块--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">modules</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">modules</span>&gt;</span>C<span class=\"tag\">&lt;/<span class=\"name\">modules</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">modules</span>&gt;</span>M<span class=\"tag\">&lt;/<span class=\"name\">modules</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">modules</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!--指定项目的spring boot的版本--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.0.M5<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!--指定项目中公有的模块--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencyManagement</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.module<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>c<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.module<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>m<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencyManagement</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!--指定jdk的版本为1.8，默认为1.6--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.build.sourceEncoding</span>&gt;</span>        <span class=\"tag\">&lt;<span class=\"name\">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.reporting.outputEncoding</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">java.version</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">java.version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!--指定项目中公有的依赖--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!--指定使用maven打包--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.maven.plugins<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>maven-compiler-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">source</span>&gt;</span>$&#123;java.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">source</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">target</span>&gt;</span>$&#123;java.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">target</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.maven.plugins<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>maven-surefire-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.19.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">skipTests</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">skipTests</span>&gt;</span>    <span class=\"comment\">&lt;!--默认关掉单元测试 --&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></div></pre></td></tr></table></figure>\n<h1 id=\"模块A的pom-xml\"><a href=\"#模块A的pom-xml\" class=\"headerlink\" title=\"模块A的pom.xml\"></a>模块A的pom.xml</h1><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div></pre></td><td class=\"code\"><pre><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.module<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>a<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">packaging</span>&gt;</span>jar<span class=\"tag\">&lt;/<span class=\"name\">packaging</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">&lt;!--指定父模块，需要注意的是，这里要指定父模块pom.xml的相对路径--&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.parent<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>demo<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>&gt;</span>../pom.xml<span class=\"tag\">&lt;/<span class=\"name\">relativePath</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">&lt;!--spring boot打包的话需要指定一个唯一的入门--&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">           <span class=\"comment\">&lt;!-- 指定该Main Class为全局的唯一入口 --&gt;</span></div><div class=\"line\">           <span class=\"tag\">&lt;<span class=\"name\">mainClass</span>&gt;</span>com.module.a.Application<span class=\"tag\">&lt;/<span class=\"name\">mainClass</span>&gt;</span></div><div class=\"line\">           <span class=\"tag\">&lt;<span class=\"name\">layout</span>&gt;</span>ZIP<span class=\"tag\">&lt;/<span class=\"name\">layout</span>&gt;</span></div><div class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">           <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">             <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">               <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>repackage<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span><span class=\"comment\">&lt;!--可以把依赖的包都打包到生成的Jar包中--&gt;</span></div><div class=\"line\">             <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">           <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">     <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></div></pre></td></tr></table></figure>\n<h1 id=\"模块B的pom-xml\"><a href=\"#模块B的pom-xml\" class=\"headerlink\" title=\"模块B的pom.xml\"></a>模块B的pom.xml</h1><p>同A即可</p>\n<h1 id=\"模块C的pom-xml\"><a href=\"#模块C的pom-xml\" class=\"headerlink\" title=\"模块C的pom.xml\"></a>模块C的pom.xml</h1><p>如果是共有模块的话，不需要打包，否则会报错，因为其他模块在打包的时候会自动添加依赖进去，如果这里打包了，其他的模块就找不到该依赖了。<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.module<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>c<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">packaging</span>&gt;</span>jar<span class=\"tag\">&lt;/<span class=\"name\">packaging</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">&lt;!--指定父模块，需要注意的是，这里要指定父模块pom.xml的相对路径--&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.parent<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>demo<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>&gt;</span>../pom.xml<span class=\"tag\">&lt;/<span class=\"name\">relativePath</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h1 id=\"模块M的pom-xml\"><a href=\"#模块M的pom-xml\" class=\"headerlink\" title=\"模块M的pom.xml\"></a>模块M的pom.xml</h1><p>如果项目中使用的Mybatis的话，肯定是作为一个单独的模块来处理的，这个Mybatis是需要打包的<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.module<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>m<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">packaging</span>&gt;</span>jar<span class=\"tag\">&lt;/<span class=\"name\">packaging</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">&lt;!--指定父模块，需要注意的是，这里要指定父模块pom.xml的相对路径--&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.parent<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>demo<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>&gt;</span>../pom.xml<span class=\"tag\">&lt;/<span class=\"name\">relativePath</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">&lt;!--mybatis的打包方式--&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis.generator<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.3.5<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>Generate MyBatis Artifacts<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></div><div class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>none<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></div><div class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">\t\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>generate<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></div><div class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">\t\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">overwrite</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">overwrite</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h1 id=\"打包\"><a href=\"#打包\" class=\"headerlink\" title=\"打包\"></a>打包</h1><p>按照上面的配置好以后，执行下面的命令就好了<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mvn clean package</div></pre></td></tr></table></figure></p>\n<p>但是如果使用了多个模块，上面的命令是会吧全部的模块都执行打包的，如果只是打包某个模块的话，可以用<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mvn -pl A -am install</div></pre></td></tr></table></figure></p>\n","excerpt":"<p>最近折腾了两次spring boot在maven下的多模块打包，踩了很多坑，现在记录如下。<br>","more":"<br>项目目录：</p>\n<ul>\n<li>项目 P</li>\n<li>模块 A</li>\n<li>模块 B</li>\n<li>公有基础模块 C</li>\n<li>Mybatis基础模块 M</li>\n</ul>\n<h1 id=\"父pom-xml文件：\"><a href=\"#父pom-xml文件：\" class=\"headerlink\" title=\"父pom.xml文件：\"></a>父pom.xml文件：</h1><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!--版本号--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.parent<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>demo<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!--管理所有的模块--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">modules</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">modules</span>&gt;</span>C<span class=\"tag\">&lt;/<span class=\"name\">modules</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">modules</span>&gt;</span>M<span class=\"tag\">&lt;/<span class=\"name\">modules</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">modules</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!--指定项目的spring boot的版本--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.0.M5<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!--指定项目中公有的模块--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencyManagement</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.module<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>c<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.module<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>m<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencyManagement</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!--指定jdk的版本为1.8，默认为1.6--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.build.sourceEncoding</span>&gt;</span>        <span class=\"tag\">&lt;<span class=\"name\">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.reporting.outputEncoding</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">java.version</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">java.version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!--指定项目中公有的依赖--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!--指定使用maven打包--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.maven.plugins<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>maven-compiler-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">source</span>&gt;</span>$&#123;java.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">source</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">target</span>&gt;</span>$&#123;java.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">target</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.maven.plugins<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>maven-surefire-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.19.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">skipTests</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">skipTests</span>&gt;</span>    <span class=\"comment\">&lt;!--默认关掉单元测试 --&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></div></pre></td></tr></table></figure>\n<h1 id=\"模块A的pom-xml\"><a href=\"#模块A的pom-xml\" class=\"headerlink\" title=\"模块A的pom.xml\"></a>模块A的pom.xml</h1><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div></pre></td><td class=\"code\"><pre><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.module<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>a<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">packaging</span>&gt;</span>jar<span class=\"tag\">&lt;/<span class=\"name\">packaging</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">&lt;!--指定父模块，需要注意的是，这里要指定父模块pom.xml的相对路径--&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.parent<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>demo<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>&gt;</span>../pom.xml<span class=\"tag\">&lt;/<span class=\"name\">relativePath</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">&lt;!--spring boot打包的话需要指定一个唯一的入门--&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">           <span class=\"comment\">&lt;!-- 指定该Main Class为全局的唯一入口 --&gt;</span></div><div class=\"line\">           <span class=\"tag\">&lt;<span class=\"name\">mainClass</span>&gt;</span>com.module.a.Application<span class=\"tag\">&lt;/<span class=\"name\">mainClass</span>&gt;</span></div><div class=\"line\">           <span class=\"tag\">&lt;<span class=\"name\">layout</span>&gt;</span>ZIP<span class=\"tag\">&lt;/<span class=\"name\">layout</span>&gt;</span></div><div class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">           <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">             <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">               <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>repackage<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span><span class=\"comment\">&lt;!--可以把依赖的包都打包到生成的Jar包中--&gt;</span></div><div class=\"line\">             <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">           <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">     <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></div></pre></td></tr></table></figure>\n<h1 id=\"模块B的pom-xml\"><a href=\"#模块B的pom-xml\" class=\"headerlink\" title=\"模块B的pom.xml\"></a>模块B的pom.xml</h1><p>同A即可</p>\n<h1 id=\"模块C的pom-xml\"><a href=\"#模块C的pom-xml\" class=\"headerlink\" title=\"模块C的pom.xml\"></a>模块C的pom.xml</h1><p>如果是共有模块的话，不需要打包，否则会报错，因为其他模块在打包的时候会自动添加依赖进去，如果这里打包了，其他的模块就找不到该依赖了。<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.module<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>c<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">packaging</span>&gt;</span>jar<span class=\"tag\">&lt;/<span class=\"name\">packaging</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">&lt;!--指定父模块，需要注意的是，这里要指定父模块pom.xml的相对路径--&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.parent<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>demo<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>&gt;</span>../pom.xml<span class=\"tag\">&lt;/<span class=\"name\">relativePath</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h1 id=\"模块M的pom-xml\"><a href=\"#模块M的pom-xml\" class=\"headerlink\" title=\"模块M的pom.xml\"></a>模块M的pom.xml</h1><p>如果项目中使用的Mybatis的话，肯定是作为一个单独的模块来处理的，这个Mybatis是需要打包的<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.module<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>m<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">packaging</span>&gt;</span>jar<span class=\"tag\">&lt;/<span class=\"name\">packaging</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">&lt;!--指定父模块，需要注意的是，这里要指定父模块pom.xml的相对路径--&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.parent<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>demo<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>&gt;</span>../pom.xml<span class=\"tag\">&lt;/<span class=\"name\">relativePath</span>&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">&lt;!--mybatis的打包方式--&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis.generator<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.3.5<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>Generate MyBatis Artifacts<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></div><div class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>none<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></div><div class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">\t\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>generate<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></div><div class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">\t\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">overwrite</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">overwrite</span>&gt;</span></div><div class=\"line\">\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h1 id=\"打包\"><a href=\"#打包\" class=\"headerlink\" title=\"打包\"></a>打包</h1><p>按照上面的配置好以后，执行下面的命令就好了<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mvn clean package</div></pre></td></tr></table></figure></p>\n<p>但是如果使用了多个模块，上面的命令是会吧全部的模块都执行打包的，如果只是打包某个模块的话，可以用<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mvn -pl A -am install</div></pre></td></tr></table></figure></p>"},{"title":"Android微信支付踩坑全记录","date":"2017-04-04T16:00:00.000Z","comments":0,"_content":"首先吐槽一下，微信支付的文档和微信提供的demo实在是惨不忍睹，折腾了好久才终于搞定了，如果还是有问题，请仔细检查请求的参数是否正确，一般都是漏掉了某个参数的名称之类的。\n<!--more-->\n\n### 1. 首先第一步，获取应用的MD5签名信息\n![这里写图片描述](http://img.blog.csdn.net/20170330180057671?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n如果你没有配置keytool的环境，那么也可以直接使用 [微信提供的获取包签名的信息](https://res.wx.qq.com/open/zh_CN/htmledition/res/dev/download/sdk/Gen_Signature_Android2.apk)\n### 2.  申请过程就不提了，千万注意，应用包名和签名信息一定要填对，一开始我的签名信息弄错了，折腾了好久。\n\n### 3. 申请好了之后，现在开始接入\n- [首先在gradle中导入](https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&t=resource/res_list&verify=1&id=open1419319167&token=&lang=zh_CN)：\n```grandle\ndependencies {\n   compile 'com.tencent.mm.opensdk:wechat-sdk-android-without-mta:+'\n}\n```\n- 注册APPID\n```gradle\nfinal IWXAPI msgApi = WXAPIFactory.createWXAPI(context, null);\n// 将该app注册到微信\nmsgApi.registerApp(\"wxd930ea5d5a258f4f\");\n```\n\n- [统一下单](https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=9_1)，目的是获取微信返回给我们的``prepay_id``\n- URL地址：https://api.mch.weixin.qq.com/pay/unifiedorder\n- 需要注意的是，该URL需要用post的方式发起请求\n- 在[签名](https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=4_3)的时候，参数名要按照ASCII码从小到大排序\n```java\npublic String getOderXml() {\n       Map<String, String> oderMap = new HashMap<>();\n       oderMap.put(\"appid\", appid); //\n       oderMap.put(\"mch_id\", mch_id);//\n       oderMap.put(\"device_info\", device_info);//-\n       oderMap.put(\"nonce_str\", nonce_str);//\n       oderMap.put(\"trade_type\", trade_type);\n       oderMap.put(\"body\", body);\n       oderMap.put(\"detail\", detail);\n       oderMap.put(\"out_trade_no\", out_trade_no);\n       oderMap.put(\"total_fee\", total_fee);\n       oderMap.put(\"spbill_create_ip\", spbill_create_ip);\n       oderMap.put(\"time_start\", time_start);\n       oderMap.put(\"notify_url\", notify_url);\n\n       //拼接字符串加上key值，然后对sign进行md5解密，之后再转成大写\n       //将集合M内非空参数值的参数按照参数名ASCII码从小到大排序\n       StringBuilder sign = new StringBuilder();\n       TreeSet<String> set = new TreeSet<>(new Comparator<String>() {\n           @Override\n           public int compare(String lhs, String rhs) {\n               int i = rhs.compareTo(lhs);\n               if (i > 0) {\n                   return -1;\n               } else if (i < 0) {\n                   return 1;\n               } else {\n                   return i;\n               }\n           }\n       });\n       set.addAll(oderMap.keySet());\n\n       for (String str : set) {\n           sign.append(str).append(\"=\").append(oderMap.get(str)).append(\"&\");\n       }\n       sign.append(\"key\").append(\"=\").append(WechatUtil.KEY);\n       oderMap.put(\"sign\", StringUtil.md5(sign.toString()).toUpperCase());\n\n       //拼接成xml格式的字符串\n       StringBuilder stringBuilder = new StringBuilder();\n       stringBuilder.append(\"<xml>\");\n       set.clear();\n       set.addAll(oderMap.keySet());\n       for (String s : set) {\n           stringBuilder.append(\"<\").append(s).append(\">\");\n           stringBuilder.append(oderMap.get(s));\n           stringBuilder.append(\"</\").append(s).append(\">\");\n       }\n       stringBuilder.append(\"</xml>\");\n       return stringBuilder.toString();\n   }\n\n```\n```java\n//处理微信返回的xml数据\npublic OderResult xmlToResult(String xml) {\n       XmlPullParser pullParser = Xml.newPullParser();\n       InputStream ins = new ByteArrayInputStream(xml.getBytes());\n       OderResult result = new OderResult();\n       try {\n           pullParser.setInput(ins, \"utf-8\");\n           int eventType = pullParser.getEventType();\n           while (XmlPullParser.END_DOCUMENT != eventType) {\n               switch (eventType) {\n                   case XmlPullParser.START_TAG:\n                       if (\"return_code\".equals(pullParser.getName())) {\n                           result.setReturn_code(pullParser.nextText());\n                       }\n                       if (\"return_msg\".equals(pullParser.getName())) {\n                           result.setReturn_msg(pullParser.nextText());\n                       }\n                       if (\"appid\".equals(pullParser.getName())) {\n                           result.setAppid(pullParser.nextText());\n                       }\n                       if (\"mch_id\".equals(pullParser.getName())) {\n                           result.setMch_id(pullParser.nextText());\n                       }\n                       if (\"device_info\".equals(pullParser.getName())) {\n                           result.setDevice_info(pullParser.nextText());\n                       }\n                       if (\"nonce_str\".equals(pullParser.getName())) {\n                           result.setNonce_str(pullParser.nextText());\n                       }\n                       if (\"sign\".equals(pullParser.getName())) {\n                           result.setSign(pullParser.nextText());\n                       }\n                       if (\"prepay_id\".equals(pullParser.getName())) {\n                           result.setPrepay_id(pullParser.nextText());\n                       }\n                       if (\"trade_type\".equals(pullParser.getName())) {\n                           result.setTrade_type(pullParser.nextText());\n                       }\n                       if (\"result_code\".equals(pullParser.getName())) {\n                           result.setResult_code(pullParser.nextText());\n                       }\n                       break;\n                   case XmlPullParser.END_TAG:\n                       break;\n                   default:\n                       break;\n               }\n               eventType = pullParser.next();\n           }\n       } catch (XmlPullParserException e) {\n           e.printStackTrace();\n       } catch (IOException e) {\n           e.printStackTrace();\n       }\n       return result;\n   }\n```\n```java\n//随机字符串，不长于32位\n   public String getRandom() {\n       SimpleDateFormat format = new SimpleDateFormat(\"yyMMddHHmmss\", Locale.getDefault());\n       Date date = new Date();\n       String key = format.format(date);\n       Random r = new Random();\n       key = key + r.nextLong();\n       key = StringUtil.md5(key);\n       return key;\n   }\n```\n- [调起支付](https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=9_12)，签名的办法同上面的处理就好了\n```java\nIWXAPI api;\nPayReq request = new PayReq();\nrequest.appId = \"wxd930ea5d5a258f4f\";\nrequest.partnerId = \"1900000109\";\nrequest.prepayId= \"1101000000140415649af9fc314aa427\",;\nrequest.packageValue = \"Sign=WXPay\";\nrequest.nonceStr= \"1101000000140429eb40476f8896f4c9\";\nrequest.timeStamp= \"1398746574\";\nrequest.sign= \"7FFECB600D7157C5AA49810D2D8F28BC2811827B\";\napi.sendReq(request);\n```\n- 支付结果回调，实现一个``.wxapi.WXPayEntryActivity``(包名或类名不一致会造成无法回调)。如果不需要显示这个，直接finish就好了。\n```xml\n<activity\n           android:name=\".wxapi.WXPayEntryActivity\"\n           android:exported=\"true\" />\n```\n```java\npublic class WXPayEntryActivity extends Activity implements IWXAPIEventHandler {\n    private IWXAPI api;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        api = WXAPIFactory.createWXAPI(this, WechatUtil.APPID, false);\n        api.handleIntent(getIntent(), this);\n    }\n\n    @Override\n    public void onReq(BaseReq baseReq) {\n\n    }\n\n    @Override\n    protected void onNewIntent(Intent intent) {\n        super.onNewIntent(intent);\n        setIntent(intent);\n        api.handleIntent(intent, this);\n    }\n\n    @Override\n    public void onResp(BaseResp baseResp) {\n\n        if (baseResp.getType() == ConstantsAPI.COMMAND_PAY_BY_WX) {\n            if (baseResp.errCode == BaseResp.ErrCode.ERR_COMM) {\n                showToast(\"微信支付失败\");\n            } else if (baseResp.errCode == BaseResp.ErrCode.ERR_USER_CANCEL) {\n                showToast(\"用户取消\");\n            } else if (baseResp.errCode == BaseResp.ErrCode.ERR_OK) {\n                showToast(\"微信支付成功\");\n            }\n        }\n    }\n}\n```\n- 如果返回的是失败，请再仔细检查调起支付的参数是否正确，进行sign签名的参数是否正确，如果还是不行，请再检查一遍，微信支付的错误信息太少了，之后成功和失败，如果统一下单成功了的话，那么就是一定是你们调起支付的参数错误，请一定要的仔细检查，重要的事重复三遍。\n- 如果是统一下单的时候有问题，请确认后台返回给你的订单号是否是唯一的，参数是否正确，sign的时候时候按照要求签名，微信平台填的是否是MD5签名，发起请求的方式是否为post，是否传送的是XML数据，如果是使用Retrofit发起请求，可以这样子：\n```java\nnew Retrofit.Builder()\n             .baseUrl(\"https://api.mch.weixin.qq.com/pay/\")\n             .addConverterFactory(StringConverterFactory.create())\n             .build()\n             .create(API.class)\n             .oder(RequestBody.create(MediaType.parse(\"text/plain\"), oder)).enqueue(new Callback<String>() {\n         @Override\n         public void onResponse(Call<String> call, Response<String> response) {\n             if (response.body() != null) {\n                 OderResult result = xmlToResult(response.body());\n                 if (result.getReturn_code().equals(\"SUCCESS\")) {\n                     if (result.getResult_code().equals(\"SUCCESS\")) {\n\n                     }\n                 } else {\n\n                 }\n             }\n\n         }\n\n         @Override\n         public void onFailure(Call<String> call, Throwable t) {\n\n         }\n     });\n```\n```java\nprivate interface API {\n        @POST(\"unifiedorder\")\n        Call<String> oder(@Body RequestBody oder);\n    }\n```\n","source":"_posts/wechatpay.md","raw":"---\ntitle: Android微信支付踩坑全记录\ndate: 2017-04-05 00:00:00\ntags: android\ncomments: false\n---\n首先吐槽一下，微信支付的文档和微信提供的demo实在是惨不忍睹，折腾了好久才终于搞定了，如果还是有问题，请仔细检查请求的参数是否正确，一般都是漏掉了某个参数的名称之类的。\n<!--more-->\n\n### 1. 首先第一步，获取应用的MD5签名信息\n![这里写图片描述](http://img.blog.csdn.net/20170330180057671?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n如果你没有配置keytool的环境，那么也可以直接使用 [微信提供的获取包签名的信息](https://res.wx.qq.com/open/zh_CN/htmledition/res/dev/download/sdk/Gen_Signature_Android2.apk)\n### 2.  申请过程就不提了，千万注意，应用包名和签名信息一定要填对，一开始我的签名信息弄错了，折腾了好久。\n\n### 3. 申请好了之后，现在开始接入\n- [首先在gradle中导入](https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&t=resource/res_list&verify=1&id=open1419319167&token=&lang=zh_CN)：\n```grandle\ndependencies {\n   compile 'com.tencent.mm.opensdk:wechat-sdk-android-without-mta:+'\n}\n```\n- 注册APPID\n```gradle\nfinal IWXAPI msgApi = WXAPIFactory.createWXAPI(context, null);\n// 将该app注册到微信\nmsgApi.registerApp(\"wxd930ea5d5a258f4f\");\n```\n\n- [统一下单](https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=9_1)，目的是获取微信返回给我们的``prepay_id``\n- URL地址：https://api.mch.weixin.qq.com/pay/unifiedorder\n- 需要注意的是，该URL需要用post的方式发起请求\n- 在[签名](https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=4_3)的时候，参数名要按照ASCII码从小到大排序\n```java\npublic String getOderXml() {\n       Map<String, String> oderMap = new HashMap<>();\n       oderMap.put(\"appid\", appid); //\n       oderMap.put(\"mch_id\", mch_id);//\n       oderMap.put(\"device_info\", device_info);//-\n       oderMap.put(\"nonce_str\", nonce_str);//\n       oderMap.put(\"trade_type\", trade_type);\n       oderMap.put(\"body\", body);\n       oderMap.put(\"detail\", detail);\n       oderMap.put(\"out_trade_no\", out_trade_no);\n       oderMap.put(\"total_fee\", total_fee);\n       oderMap.put(\"spbill_create_ip\", spbill_create_ip);\n       oderMap.put(\"time_start\", time_start);\n       oderMap.put(\"notify_url\", notify_url);\n\n       //拼接字符串加上key值，然后对sign进行md5解密，之后再转成大写\n       //将集合M内非空参数值的参数按照参数名ASCII码从小到大排序\n       StringBuilder sign = new StringBuilder();\n       TreeSet<String> set = new TreeSet<>(new Comparator<String>() {\n           @Override\n           public int compare(String lhs, String rhs) {\n               int i = rhs.compareTo(lhs);\n               if (i > 0) {\n                   return -1;\n               } else if (i < 0) {\n                   return 1;\n               } else {\n                   return i;\n               }\n           }\n       });\n       set.addAll(oderMap.keySet());\n\n       for (String str : set) {\n           sign.append(str).append(\"=\").append(oderMap.get(str)).append(\"&\");\n       }\n       sign.append(\"key\").append(\"=\").append(WechatUtil.KEY);\n       oderMap.put(\"sign\", StringUtil.md5(sign.toString()).toUpperCase());\n\n       //拼接成xml格式的字符串\n       StringBuilder stringBuilder = new StringBuilder();\n       stringBuilder.append(\"<xml>\");\n       set.clear();\n       set.addAll(oderMap.keySet());\n       for (String s : set) {\n           stringBuilder.append(\"<\").append(s).append(\">\");\n           stringBuilder.append(oderMap.get(s));\n           stringBuilder.append(\"</\").append(s).append(\">\");\n       }\n       stringBuilder.append(\"</xml>\");\n       return stringBuilder.toString();\n   }\n\n```\n```java\n//处理微信返回的xml数据\npublic OderResult xmlToResult(String xml) {\n       XmlPullParser pullParser = Xml.newPullParser();\n       InputStream ins = new ByteArrayInputStream(xml.getBytes());\n       OderResult result = new OderResult();\n       try {\n           pullParser.setInput(ins, \"utf-8\");\n           int eventType = pullParser.getEventType();\n           while (XmlPullParser.END_DOCUMENT != eventType) {\n               switch (eventType) {\n                   case XmlPullParser.START_TAG:\n                       if (\"return_code\".equals(pullParser.getName())) {\n                           result.setReturn_code(pullParser.nextText());\n                       }\n                       if (\"return_msg\".equals(pullParser.getName())) {\n                           result.setReturn_msg(pullParser.nextText());\n                       }\n                       if (\"appid\".equals(pullParser.getName())) {\n                           result.setAppid(pullParser.nextText());\n                       }\n                       if (\"mch_id\".equals(pullParser.getName())) {\n                           result.setMch_id(pullParser.nextText());\n                       }\n                       if (\"device_info\".equals(pullParser.getName())) {\n                           result.setDevice_info(pullParser.nextText());\n                       }\n                       if (\"nonce_str\".equals(pullParser.getName())) {\n                           result.setNonce_str(pullParser.nextText());\n                       }\n                       if (\"sign\".equals(pullParser.getName())) {\n                           result.setSign(pullParser.nextText());\n                       }\n                       if (\"prepay_id\".equals(pullParser.getName())) {\n                           result.setPrepay_id(pullParser.nextText());\n                       }\n                       if (\"trade_type\".equals(pullParser.getName())) {\n                           result.setTrade_type(pullParser.nextText());\n                       }\n                       if (\"result_code\".equals(pullParser.getName())) {\n                           result.setResult_code(pullParser.nextText());\n                       }\n                       break;\n                   case XmlPullParser.END_TAG:\n                       break;\n                   default:\n                       break;\n               }\n               eventType = pullParser.next();\n           }\n       } catch (XmlPullParserException e) {\n           e.printStackTrace();\n       } catch (IOException e) {\n           e.printStackTrace();\n       }\n       return result;\n   }\n```\n```java\n//随机字符串，不长于32位\n   public String getRandom() {\n       SimpleDateFormat format = new SimpleDateFormat(\"yyMMddHHmmss\", Locale.getDefault());\n       Date date = new Date();\n       String key = format.format(date);\n       Random r = new Random();\n       key = key + r.nextLong();\n       key = StringUtil.md5(key);\n       return key;\n   }\n```\n- [调起支付](https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=9_12)，签名的办法同上面的处理就好了\n```java\nIWXAPI api;\nPayReq request = new PayReq();\nrequest.appId = \"wxd930ea5d5a258f4f\";\nrequest.partnerId = \"1900000109\";\nrequest.prepayId= \"1101000000140415649af9fc314aa427\",;\nrequest.packageValue = \"Sign=WXPay\";\nrequest.nonceStr= \"1101000000140429eb40476f8896f4c9\";\nrequest.timeStamp= \"1398746574\";\nrequest.sign= \"7FFECB600D7157C5AA49810D2D8F28BC2811827B\";\napi.sendReq(request);\n```\n- 支付结果回调，实现一个``.wxapi.WXPayEntryActivity``(包名或类名不一致会造成无法回调)。如果不需要显示这个，直接finish就好了。\n```xml\n<activity\n           android:name=\".wxapi.WXPayEntryActivity\"\n           android:exported=\"true\" />\n```\n```java\npublic class WXPayEntryActivity extends Activity implements IWXAPIEventHandler {\n    private IWXAPI api;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        api = WXAPIFactory.createWXAPI(this, WechatUtil.APPID, false);\n        api.handleIntent(getIntent(), this);\n    }\n\n    @Override\n    public void onReq(BaseReq baseReq) {\n\n    }\n\n    @Override\n    protected void onNewIntent(Intent intent) {\n        super.onNewIntent(intent);\n        setIntent(intent);\n        api.handleIntent(intent, this);\n    }\n\n    @Override\n    public void onResp(BaseResp baseResp) {\n\n        if (baseResp.getType() == ConstantsAPI.COMMAND_PAY_BY_WX) {\n            if (baseResp.errCode == BaseResp.ErrCode.ERR_COMM) {\n                showToast(\"微信支付失败\");\n            } else if (baseResp.errCode == BaseResp.ErrCode.ERR_USER_CANCEL) {\n                showToast(\"用户取消\");\n            } else if (baseResp.errCode == BaseResp.ErrCode.ERR_OK) {\n                showToast(\"微信支付成功\");\n            }\n        }\n    }\n}\n```\n- 如果返回的是失败，请再仔细检查调起支付的参数是否正确，进行sign签名的参数是否正确，如果还是不行，请再检查一遍，微信支付的错误信息太少了，之后成功和失败，如果统一下单成功了的话，那么就是一定是你们调起支付的参数错误，请一定要的仔细检查，重要的事重复三遍。\n- 如果是统一下单的时候有问题，请确认后台返回给你的订单号是否是唯一的，参数是否正确，sign的时候时候按照要求签名，微信平台填的是否是MD5签名，发起请求的方式是否为post，是否传送的是XML数据，如果是使用Retrofit发起请求，可以这样子：\n```java\nnew Retrofit.Builder()\n             .baseUrl(\"https://api.mch.weixin.qq.com/pay/\")\n             .addConverterFactory(StringConverterFactory.create())\n             .build()\n             .create(API.class)\n             .oder(RequestBody.create(MediaType.parse(\"text/plain\"), oder)).enqueue(new Callback<String>() {\n         @Override\n         public void onResponse(Call<String> call, Response<String> response) {\n             if (response.body() != null) {\n                 OderResult result = xmlToResult(response.body());\n                 if (result.getReturn_code().equals(\"SUCCESS\")) {\n                     if (result.getResult_code().equals(\"SUCCESS\")) {\n\n                     }\n                 } else {\n\n                 }\n             }\n\n         }\n\n         @Override\n         public void onFailure(Call<String> call, Throwable t) {\n\n         }\n     });\n```\n```java\nprivate interface API {\n        @POST(\"unifiedorder\")\n        Call<String> oder(@Body RequestBody oder);\n    }\n```\n","slug":"wechatpay","published":1,"updated":"2017-04-15T14:06:14.000Z","layout":"post","photos":[],"link":"","_id":"cjr66widp001qmetpzet2d0ke","content":"<p>首先吐槽一下，微信支付的文档和微信提供的demo实在是惨不忍睹，折腾了好久才终于搞定了，如果还是有问题，请仔细检查请求的参数是否正确，一般都是漏掉了某个参数的名称之类的。<br><a id=\"more\"></a></p>\n<h3 id=\"1-首先第一步，获取应用的MD5签名信息\"><a href=\"#1-首先第一步，获取应用的MD5签名信息\" class=\"headerlink\" title=\"1. 首先第一步，获取应用的MD5签名信息\"></a>1. 首先第一步，获取应用的MD5签名信息</h3><p><img src=\"http://img.blog.csdn.net/20170330180057671?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"><br>如果你没有配置keytool的环境，那么也可以直接使用 <a href=\"https://res.wx.qq.com/open/zh_CN/htmledition/res/dev/download/sdk/Gen_Signature_Android2.apk\" target=\"_blank\" rel=\"external\">微信提供的获取包签名的信息</a></p>\n<h3 id=\"2-申请过程就不提了，千万注意，应用包名和签名信息一定要填对，一开始我的签名信息弄错了，折腾了好久。\"><a href=\"#2-申请过程就不提了，千万注意，应用包名和签名信息一定要填对，一开始我的签名信息弄错了，折腾了好久。\" class=\"headerlink\" title=\"2.  申请过程就不提了，千万注意，应用包名和签名信息一定要填对，一开始我的签名信息弄错了，折腾了好久。\"></a>2.  申请过程就不提了，千万注意，应用包名和签名信息一定要填对，一开始我的签名信息弄错了，折腾了好久。</h3><h3 id=\"3-申请好了之后，现在开始接入\"><a href=\"#3-申请好了之后，现在开始接入\" class=\"headerlink\" title=\"3. 申请好了之后，现在开始接入\"></a>3. 申请好了之后，现在开始接入</h3><ul>\n<li><p><a href=\"https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&amp;t=resource/res_list&amp;verify=1&amp;id=open1419319167&amp;token=&amp;lang=zh_CN\" target=\"_blank\" rel=\"external\">首先在gradle中导入</a>：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">dependencies &#123;</div><div class=\"line\">   compile &apos;com.tencent.mm.opensdk:wechat-sdk-android-without-mta:+&apos;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n</li>\n<li><p>注册APPID</p>\n<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">final</span> IWXAPI msgApi = WXAPIFactory.createWXAPI(context, <span class=\"keyword\">null</span>);</div><div class=\"line\"><span class=\"comment\">// 将该app注册到微信</span></div><div class=\"line\">msgApi.registerApp(<span class=\"string\">\"wxd930ea5d5a258f4f\"</span>);</div></pre></td></tr></table></figure>\n</li>\n<li><p><a href=\"https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=9_1\" target=\"_blank\" rel=\"external\">统一下单</a>，目的是获取微信返回给我们的<code>prepay_id</code></p>\n</li>\n<li>URL地址：<a href=\"https://api.mch.weixin.qq.com/pay/unifiedorder\" target=\"_blank\" rel=\"external\">https://api.mch.weixin.qq.com/pay/unifiedorder</a></li>\n<li>需要注意的是，该URL需要用post的方式发起请求</li>\n<li>在<a href=\"https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=4_3\" target=\"_blank\" rel=\"external\">签名</a>的时候，参数名要按照ASCII码从小到大排序<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getOderXml</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">       Map&lt;String, String&gt; oderMap = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"appid\"</span>, appid); <span class=\"comment\">//</span></div><div class=\"line\">       oderMap.put(<span class=\"string\">\"mch_id\"</span>, mch_id);<span class=\"comment\">//</span></div><div class=\"line\">       oderMap.put(<span class=\"string\">\"device_info\"</span>, device_info);<span class=\"comment\">//-</span></div><div class=\"line\">       oderMap.put(<span class=\"string\">\"nonce_str\"</span>, nonce_str);<span class=\"comment\">//</span></div><div class=\"line\">       oderMap.put(<span class=\"string\">\"trade_type\"</span>, trade_type);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"body\"</span>, body);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"detail\"</span>, detail);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"out_trade_no\"</span>, out_trade_no);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"total_fee\"</span>, total_fee);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"spbill_create_ip\"</span>, spbill_create_ip);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"time_start\"</span>, time_start);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"notify_url\"</span>, notify_url);</div><div class=\"line\"></div><div class=\"line\">       <span class=\"comment\">//拼接字符串加上key值，然后对sign进行md5解密，之后再转成大写</span></div><div class=\"line\">       <span class=\"comment\">//将集合M内非空参数值的参数按照参数名ASCII码从小到大排序</span></div><div class=\"line\">       StringBuilder sign = <span class=\"keyword\">new</span> StringBuilder();</div><div class=\"line\">       TreeSet&lt;String&gt; set = <span class=\"keyword\">new</span> TreeSet&lt;&gt;(<span class=\"keyword\">new</span> Comparator&lt;String&gt;() &#123;</div><div class=\"line\">           <span class=\"meta\">@Override</span></div><div class=\"line\">           <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">compare</span><span class=\"params\">(String lhs, String rhs)</span> </span>&#123;</div><div class=\"line\">               <span class=\"keyword\">int</span> i = rhs.compareTo(lhs);</div><div class=\"line\">               <span class=\"keyword\">if</span> (i &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">                   <span class=\"keyword\">return</span> -<span class=\"number\">1</span>;</div><div class=\"line\">               &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i &lt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">                   <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</div><div class=\"line\">               &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                   <span class=\"keyword\">return</span> i;</div><div class=\"line\">               &#125;</div><div class=\"line\">           &#125;</div><div class=\"line\">       &#125;);</div><div class=\"line\">       set.addAll(oderMap.keySet());</div><div class=\"line\"></div><div class=\"line\">       <span class=\"keyword\">for</span> (String str : set) &#123;</div><div class=\"line\">           sign.append(str).append(<span class=\"string\">\"=\"</span>).append(oderMap.get(str)).append(<span class=\"string\">\"&amp;\"</span>);</div><div class=\"line\">       &#125;</div><div class=\"line\">       sign.append(<span class=\"string\">\"key\"</span>).append(<span class=\"string\">\"=\"</span>).append(WechatUtil.KEY);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"sign\"</span>, StringUtil.md5(sign.toString()).toUpperCase());</div><div class=\"line\"></div><div class=\"line\">       <span class=\"comment\">//拼接成xml格式的字符串</span></div><div class=\"line\">       StringBuilder stringBuilder = <span class=\"keyword\">new</span> StringBuilder();</div><div class=\"line\">       stringBuilder.append(<span class=\"string\">\"&lt;xml&gt;\"</span>);</div><div class=\"line\">       set.clear();</div><div class=\"line\">       set.addAll(oderMap.keySet());</div><div class=\"line\">       <span class=\"keyword\">for</span> (String s : set) &#123;</div><div class=\"line\">           stringBuilder.append(<span class=\"string\">\"&lt;\"</span>).append(s).append(<span class=\"string\">\"&gt;\"</span>);</div><div class=\"line\">           stringBuilder.append(oderMap.get(s));</div><div class=\"line\">           stringBuilder.append(<span class=\"string\">\"&lt;/\"</span>).append(s).append(<span class=\"string\">\"&gt;\"</span>);</div><div class=\"line\">       &#125;</div><div class=\"line\">       stringBuilder.append(<span class=\"string\">\"&lt;/xml&gt;\"</span>);</div><div class=\"line\">       <span class=\"keyword\">return</span> stringBuilder.toString();</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//处理微信返回的xml数据</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> OderResult <span class=\"title\">xmlToResult</span><span class=\"params\">(String xml)</span> </span>&#123;</div><div class=\"line\">       XmlPullParser pullParser = Xml.newPullParser();</div><div class=\"line\">       InputStream ins = <span class=\"keyword\">new</span> ByteArrayInputStream(xml.getBytes());</div><div class=\"line\">       OderResult result = <span class=\"keyword\">new</span> OderResult();</div><div class=\"line\">       <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">           pullParser.setInput(ins, <span class=\"string\">\"utf-8\"</span>);</div><div class=\"line\">           <span class=\"keyword\">int</span> eventType = pullParser.getEventType();</div><div class=\"line\">           <span class=\"keyword\">while</span> (XmlPullParser.END_DOCUMENT != eventType) &#123;</div><div class=\"line\">               <span class=\"keyword\">switch</span> (eventType) &#123;</div><div class=\"line\">                   <span class=\"keyword\">case</span> XmlPullParser.START_TAG:</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"return_code\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setReturn_code(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"return_msg\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setReturn_msg(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"appid\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setAppid(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"mch_id\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setMch_id(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"device_info\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setDevice_info(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"nonce_str\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setNonce_str(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"sign\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setSign(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"prepay_id\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setPrepay_id(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"trade_type\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setTrade_type(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"result_code\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setResult_code(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">break</span>;</div><div class=\"line\">                   <span class=\"keyword\">case</span> XmlPullParser.END_TAG:</div><div class=\"line\">                       <span class=\"keyword\">break</span>;</div><div class=\"line\">                   <span class=\"keyword\">default</span>:</div><div class=\"line\">                       <span class=\"keyword\">break</span>;</div><div class=\"line\">               &#125;</div><div class=\"line\">               eventType = pullParser.next();</div><div class=\"line\">           &#125;</div><div class=\"line\">       &#125; <span class=\"keyword\">catch</span> (XmlPullParserException e) &#123;</div><div class=\"line\">           e.printStackTrace();</div><div class=\"line\">       &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</div><div class=\"line\">           e.printStackTrace();</div><div class=\"line\">       &#125;</div><div class=\"line\">       <span class=\"keyword\">return</span> result;</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//随机字符串，不长于32位</span></div><div class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getRandom</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">       SimpleDateFormat format = <span class=\"keyword\">new</span> SimpleDateFormat(<span class=\"string\">\"yyMMddHHmmss\"</span>, Locale.getDefault());</div><div class=\"line\">       Date date = <span class=\"keyword\">new</span> Date();</div><div class=\"line\">       String key = format.format(date);</div><div class=\"line\">       Random r = <span class=\"keyword\">new</span> Random();</div><div class=\"line\">       key = key + r.nextLong();</div><div class=\"line\">       key = StringUtil.md5(key);</div><div class=\"line\">       <span class=\"keyword\">return</span> key;</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure>\n<ul>\n<li><p><a href=\"https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=9_12\" target=\"_blank\" rel=\"external\">调起支付</a>，签名的办法同上面的处理就好了</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">IWXAPI api;</div><div class=\"line\">PayReq request = <span class=\"keyword\">new</span> PayReq();</div><div class=\"line\">request.appId = <span class=\"string\">\"wxd930ea5d5a258f4f\"</span>;</div><div class=\"line\">request.partnerId = <span class=\"string\">\"1900000109\"</span>;</div><div class=\"line\">request.prepayId= <span class=\"string\">\"1101000000140415649af9fc314aa427\"</span>,;</div><div class=\"line\">request.packageValue = <span class=\"string\">\"Sign=WXPay\"</span>;</div><div class=\"line\">request.nonceStr= <span class=\"string\">\"1101000000140429eb40476f8896f4c9\"</span>;</div><div class=\"line\">request.timeStamp= <span class=\"string\">\"1398746574\"</span>;</div><div class=\"line\">request.sign= <span class=\"string\">\"7FFECB600D7157C5AA49810D2D8F28BC2811827B\"</span>;</div><div class=\"line\">api.sendReq(request);</div></pre></td></tr></table></figure>\n</li>\n<li><p>支付结果回调，实现一个<code>.wxapi.WXPayEntryActivity</code>(包名或类名不一致会造成无法回调)。如果不需要显示这个，直接finish就好了。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">activity</span></span></div><div class=\"line\">           <span class=\"attr\">android:name</span>=<span class=\"string\">\".wxapi.WXPayEntryActivity\"</span></div><div class=\"line\">           <span class=\"attr\">android:exported</span>=<span class=\"string\">\"true\"</span> /&gt;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WXPayEntryActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">Activity</span> <span class=\"keyword\">implements</span> <span class=\"title\">IWXAPIEventHandler</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> IWXAPI api;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</div><div class=\"line\">        api = WXAPIFactory.createWXAPI(<span class=\"keyword\">this</span>, WechatUtil.APPID, <span class=\"keyword\">false</span>);</div><div class=\"line\">        api.handleIntent(getIntent(), <span class=\"keyword\">this</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onReq</span><span class=\"params\">(BaseReq baseReq)</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onNewIntent</span><span class=\"params\">(Intent intent)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onNewIntent(intent);</div><div class=\"line\">        setIntent(intent);</div><div class=\"line\">        api.handleIntent(intent, <span class=\"keyword\">this</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onResp</span><span class=\"params\">(BaseResp baseResp)</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">if</span> (baseResp.getType() == ConstantsAPI.COMMAND_PAY_BY_WX) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (baseResp.errCode == BaseResp.ErrCode.ERR_COMM) &#123;</div><div class=\"line\">                showToast(<span class=\"string\">\"微信支付失败\"</span>);</div><div class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (baseResp.errCode == BaseResp.ErrCode.ERR_USER_CANCEL) &#123;</div><div class=\"line\">                showToast(<span class=\"string\">\"用户取消\"</span>);</div><div class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (baseResp.errCode == BaseResp.ErrCode.ERR_OK) &#123;</div><div class=\"line\">                showToast(<span class=\"string\">\"微信支付成功\"</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li>如果返回的是失败，请再仔细检查调起支付的参数是否正确，进行sign签名的参数是否正确，如果还是不行，请再检查一遍，微信支付的错误信息太少了，之后成功和失败，如果统一下单成功了的话，那么就是一定是你们调起支付的参数错误，请一定要的仔细检查，重要的事重复三遍。</li>\n<li>如果是统一下单的时候有问题，请确认后台返回给你的订单号是否是唯一的，参数是否正确，sign的时候时候按照要求签名，微信平台填的是否是MD5签名，发起请求的方式是否为post，是否传送的是XML数据，如果是使用Retrofit发起请求，可以这样子：<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">new</span> Retrofit.Builder()</div><div class=\"line\">             .baseUrl(<span class=\"string\">\"https://api.mch.weixin.qq.com/pay/\"</span>)</div><div class=\"line\">             .addConverterFactory(StringConverterFactory.create())</div><div class=\"line\">             .build()</div><div class=\"line\">             .create(API.class)</div><div class=\"line\">             .oder(RequestBody.create(MediaType.parse(<span class=\"string\">\"text/plain\"</span>), oder)).enqueue(<span class=\"keyword\">new</span> Callback&lt;String&gt;() &#123;</div><div class=\"line\">         <span class=\"meta\">@Override</span></div><div class=\"line\">         <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onResponse</span><span class=\"params\">(Call&lt;String&gt; call, Response&lt;String&gt; response)</span> </span>&#123;</div><div class=\"line\">             <span class=\"keyword\">if</span> (response.body() != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                 OderResult result = xmlToResult(response.body());</div><div class=\"line\">                 <span class=\"keyword\">if</span> (result.getReturn_code().equals(<span class=\"string\">\"SUCCESS\"</span>)) &#123;</div><div class=\"line\">                     <span class=\"keyword\">if</span> (result.getResult_code().equals(<span class=\"string\">\"SUCCESS\"</span>)) &#123;</div><div class=\"line\"></div><div class=\"line\">                     &#125;</div><div class=\"line\">                 &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\"></div><div class=\"line\">                 &#125;</div><div class=\"line\">             &#125;</div><div class=\"line\"></div><div class=\"line\">         &#125;</div><div class=\"line\"></div><div class=\"line\">         <span class=\"meta\">@Override</span></div><div class=\"line\">         <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span><span class=\"params\">(Call&lt;String&gt; call, Throwable t)</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">         &#125;</div><div class=\"line\">     &#125;);</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">API</span> </span>&#123;</div><div class=\"line\">        <span class=\"meta\">@POST</span>(<span class=\"string\">\"unifiedorder\"</span>)</div><div class=\"line\">        <span class=\"function\">Call&lt;String&gt; <span class=\"title\">oder</span><span class=\"params\">(@Body RequestBody oder)</span></span>;</div><div class=\"line\">    &#125;</div></pre></td></tr></table></figure>\n","excerpt":"<p>首先吐槽一下，微信支付的文档和微信提供的demo实在是惨不忍睹，折腾了好久才终于搞定了，如果还是有问题，请仔细检查请求的参数是否正确，一般都是漏掉了某个参数的名称之类的。<br>","more":"</p>\n<h3 id=\"1-首先第一步，获取应用的MD5签名信息\"><a href=\"#1-首先第一步，获取应用的MD5签名信息\" class=\"headerlink\" title=\"1. 首先第一步，获取应用的MD5签名信息\"></a>1. 首先第一步，获取应用的MD5签名信息</h3><p><img src=\"http://img.blog.csdn.net/20170330180057671?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvU2VyX0JhZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"><br>如果你没有配置keytool的环境，那么也可以直接使用 <a href=\"https://res.wx.qq.com/open/zh_CN/htmledition/res/dev/download/sdk/Gen_Signature_Android2.apk\">微信提供的获取包签名的信息</a></p>\n<h3 id=\"2-申请过程就不提了，千万注意，应用包名和签名信息一定要填对，一开始我的签名信息弄错了，折腾了好久。\"><a href=\"#2-申请过程就不提了，千万注意，应用包名和签名信息一定要填对，一开始我的签名信息弄错了，折腾了好久。\" class=\"headerlink\" title=\"2.  申请过程就不提了，千万注意，应用包名和签名信息一定要填对，一开始我的签名信息弄错了，折腾了好久。\"></a>2.  申请过程就不提了，千万注意，应用包名和签名信息一定要填对，一开始我的签名信息弄错了，折腾了好久。</h3><h3 id=\"3-申请好了之后，现在开始接入\"><a href=\"#3-申请好了之后，现在开始接入\" class=\"headerlink\" title=\"3. 申请好了之后，现在开始接入\"></a>3. 申请好了之后，现在开始接入</h3><ul>\n<li><p><a href=\"https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&amp;t=resource/res_list&amp;verify=1&amp;id=open1419319167&amp;token=&amp;lang=zh_CN\">首先在gradle中导入</a>：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">dependencies &#123;</div><div class=\"line\">   compile &apos;com.tencent.mm.opensdk:wechat-sdk-android-without-mta:+&apos;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n</li>\n<li><p>注册APPID</p>\n<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">final</span> IWXAPI msgApi = WXAPIFactory.createWXAPI(context, <span class=\"keyword\">null</span>);</div><div class=\"line\"><span class=\"comment\">// 将该app注册到微信</span></div><div class=\"line\">msgApi.registerApp(<span class=\"string\">\"wxd930ea5d5a258f4f\"</span>);</div></pre></td></tr></table></figure>\n</li>\n<li><p><a href=\"https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=9_1\">统一下单</a>，目的是获取微信返回给我们的<code>prepay_id</code></p>\n</li>\n<li>URL地址：<a href=\"https://api.mch.weixin.qq.com/pay/unifiedorder\">https://api.mch.weixin.qq.com/pay/unifiedorder</a></li>\n<li>需要注意的是，该URL需要用post的方式发起请求</li>\n<li>在<a href=\"https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=4_3\">签名</a>的时候，参数名要按照ASCII码从小到大排序<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getOderXml</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">       Map&lt;String, String&gt; oderMap = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"appid\"</span>, appid); <span class=\"comment\">//</span></div><div class=\"line\">       oderMap.put(<span class=\"string\">\"mch_id\"</span>, mch_id);<span class=\"comment\">//</span></div><div class=\"line\">       oderMap.put(<span class=\"string\">\"device_info\"</span>, device_info);<span class=\"comment\">//-</span></div><div class=\"line\">       oderMap.put(<span class=\"string\">\"nonce_str\"</span>, nonce_str);<span class=\"comment\">//</span></div><div class=\"line\">       oderMap.put(<span class=\"string\">\"trade_type\"</span>, trade_type);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"body\"</span>, body);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"detail\"</span>, detail);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"out_trade_no\"</span>, out_trade_no);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"total_fee\"</span>, total_fee);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"spbill_create_ip\"</span>, spbill_create_ip);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"time_start\"</span>, time_start);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"notify_url\"</span>, notify_url);</div><div class=\"line\"></div><div class=\"line\">       <span class=\"comment\">//拼接字符串加上key值，然后对sign进行md5解密，之后再转成大写</span></div><div class=\"line\">       <span class=\"comment\">//将集合M内非空参数值的参数按照参数名ASCII码从小到大排序</span></div><div class=\"line\">       StringBuilder sign = <span class=\"keyword\">new</span> StringBuilder();</div><div class=\"line\">       TreeSet&lt;String&gt; set = <span class=\"keyword\">new</span> TreeSet&lt;&gt;(<span class=\"keyword\">new</span> Comparator&lt;String&gt;() &#123;</div><div class=\"line\">           <span class=\"meta\">@Override</span></div><div class=\"line\">           <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">compare</span><span class=\"params\">(String lhs, String rhs)</span> </span>&#123;</div><div class=\"line\">               <span class=\"keyword\">int</span> i = rhs.compareTo(lhs);</div><div class=\"line\">               <span class=\"keyword\">if</span> (i &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">                   <span class=\"keyword\">return</span> -<span class=\"number\">1</span>;</div><div class=\"line\">               &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i &lt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">                   <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</div><div class=\"line\">               &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                   <span class=\"keyword\">return</span> i;</div><div class=\"line\">               &#125;</div><div class=\"line\">           &#125;</div><div class=\"line\">       &#125;);</div><div class=\"line\">       set.addAll(oderMap.keySet());</div><div class=\"line\"></div><div class=\"line\">       <span class=\"keyword\">for</span> (String str : set) &#123;</div><div class=\"line\">           sign.append(str).append(<span class=\"string\">\"=\"</span>).append(oderMap.get(str)).append(<span class=\"string\">\"&amp;\"</span>);</div><div class=\"line\">       &#125;</div><div class=\"line\">       sign.append(<span class=\"string\">\"key\"</span>).append(<span class=\"string\">\"=\"</span>).append(WechatUtil.KEY);</div><div class=\"line\">       oderMap.put(<span class=\"string\">\"sign\"</span>, StringUtil.md5(sign.toString()).toUpperCase());</div><div class=\"line\"></div><div class=\"line\">       <span class=\"comment\">//拼接成xml格式的字符串</span></div><div class=\"line\">       StringBuilder stringBuilder = <span class=\"keyword\">new</span> StringBuilder();</div><div class=\"line\">       stringBuilder.append(<span class=\"string\">\"&lt;xml&gt;\"</span>);</div><div class=\"line\">       set.clear();</div><div class=\"line\">       set.addAll(oderMap.keySet());</div><div class=\"line\">       <span class=\"keyword\">for</span> (String s : set) &#123;</div><div class=\"line\">           stringBuilder.append(<span class=\"string\">\"&lt;\"</span>).append(s).append(<span class=\"string\">\"&gt;\"</span>);</div><div class=\"line\">           stringBuilder.append(oderMap.get(s));</div><div class=\"line\">           stringBuilder.append(<span class=\"string\">\"&lt;/\"</span>).append(s).append(<span class=\"string\">\"&gt;\"</span>);</div><div class=\"line\">       &#125;</div><div class=\"line\">       stringBuilder.append(<span class=\"string\">\"&lt;/xml&gt;\"</span>);</div><div class=\"line\">       <span class=\"keyword\">return</span> stringBuilder.toString();</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//处理微信返回的xml数据</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> OderResult <span class=\"title\">xmlToResult</span><span class=\"params\">(String xml)</span> </span>&#123;</div><div class=\"line\">       XmlPullParser pullParser = Xml.newPullParser();</div><div class=\"line\">       InputStream ins = <span class=\"keyword\">new</span> ByteArrayInputStream(xml.getBytes());</div><div class=\"line\">       OderResult result = <span class=\"keyword\">new</span> OderResult();</div><div class=\"line\">       <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">           pullParser.setInput(ins, <span class=\"string\">\"utf-8\"</span>);</div><div class=\"line\">           <span class=\"keyword\">int</span> eventType = pullParser.getEventType();</div><div class=\"line\">           <span class=\"keyword\">while</span> (XmlPullParser.END_DOCUMENT != eventType) &#123;</div><div class=\"line\">               <span class=\"keyword\">switch</span> (eventType) &#123;</div><div class=\"line\">                   <span class=\"keyword\">case</span> XmlPullParser.START_TAG:</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"return_code\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setReturn_code(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"return_msg\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setReturn_msg(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"appid\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setAppid(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"mch_id\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setMch_id(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"device_info\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setDevice_info(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"nonce_str\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setNonce_str(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"sign\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setSign(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"prepay_id\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setPrepay_id(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"trade_type\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setTrade_type(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">if</span> (<span class=\"string\">\"result_code\"</span>.equals(pullParser.getName())) &#123;</div><div class=\"line\">                           result.setResult_code(pullParser.nextText());</div><div class=\"line\">                       &#125;</div><div class=\"line\">                       <span class=\"keyword\">break</span>;</div><div class=\"line\">                   <span class=\"keyword\">case</span> XmlPullParser.END_TAG:</div><div class=\"line\">                       <span class=\"keyword\">break</span>;</div><div class=\"line\">                   <span class=\"keyword\">default</span>:</div><div class=\"line\">                       <span class=\"keyword\">break</span>;</div><div class=\"line\">               &#125;</div><div class=\"line\">               eventType = pullParser.next();</div><div class=\"line\">           &#125;</div><div class=\"line\">       &#125; <span class=\"keyword\">catch</span> (XmlPullParserException e) &#123;</div><div class=\"line\">           e.printStackTrace();</div><div class=\"line\">       &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</div><div class=\"line\">           e.printStackTrace();</div><div class=\"line\">       &#125;</div><div class=\"line\">       <span class=\"keyword\">return</span> result;</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//随机字符串，不长于32位</span></div><div class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getRandom</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">       SimpleDateFormat format = <span class=\"keyword\">new</span> SimpleDateFormat(<span class=\"string\">\"yyMMddHHmmss\"</span>, Locale.getDefault());</div><div class=\"line\">       Date date = <span class=\"keyword\">new</span> Date();</div><div class=\"line\">       String key = format.format(date);</div><div class=\"line\">       Random r = <span class=\"keyword\">new</span> Random();</div><div class=\"line\">       key = key + r.nextLong();</div><div class=\"line\">       key = StringUtil.md5(key);</div><div class=\"line\">       <span class=\"keyword\">return</span> key;</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure>\n<ul>\n<li><p><a href=\"https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=9_12\">调起支付</a>，签名的办法同上面的处理就好了</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">IWXAPI api;</div><div class=\"line\">PayReq request = <span class=\"keyword\">new</span> PayReq();</div><div class=\"line\">request.appId = <span class=\"string\">\"wxd930ea5d5a258f4f\"</span>;</div><div class=\"line\">request.partnerId = <span class=\"string\">\"1900000109\"</span>;</div><div class=\"line\">request.prepayId= <span class=\"string\">\"1101000000140415649af9fc314aa427\"</span>,;</div><div class=\"line\">request.packageValue = <span class=\"string\">\"Sign=WXPay\"</span>;</div><div class=\"line\">request.nonceStr= <span class=\"string\">\"1101000000140429eb40476f8896f4c9\"</span>;</div><div class=\"line\">request.timeStamp= <span class=\"string\">\"1398746574\"</span>;</div><div class=\"line\">request.sign= <span class=\"string\">\"7FFECB600D7157C5AA49810D2D8F28BC2811827B\"</span>;</div><div class=\"line\">api.sendReq(request);</div></pre></td></tr></table></figure>\n</li>\n<li><p>支付结果回调，实现一个<code>.wxapi.WXPayEntryActivity</code>(包名或类名不一致会造成无法回调)。如果不需要显示这个，直接finish就好了。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">activity</span></div><div class=\"line\">           <span class=\"attr\">android:name</span>=<span class=\"string\">\".wxapi.WXPayEntryActivity\"</span></div><div class=\"line\">           <span class=\"attr\">android:exported</span>=<span class=\"string\">\"true\"</span> /&gt;</span></div></pre></td></tr></table></figure>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WXPayEntryActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">Activity</span> <span class=\"keyword\">implements</span> <span class=\"title\">IWXAPIEventHandler</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> IWXAPI api;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</div><div class=\"line\">        api = WXAPIFactory.createWXAPI(<span class=\"keyword\">this</span>, WechatUtil.APPID, <span class=\"keyword\">false</span>);</div><div class=\"line\">        api.handleIntent(getIntent(), <span class=\"keyword\">this</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onReq</span><span class=\"params\">(BaseReq baseReq)</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onNewIntent</span><span class=\"params\">(Intent intent)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onNewIntent(intent);</div><div class=\"line\">        setIntent(intent);</div><div class=\"line\">        api.handleIntent(intent, <span class=\"keyword\">this</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onResp</span><span class=\"params\">(BaseResp baseResp)</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">if</span> (baseResp.getType() == ConstantsAPI.COMMAND_PAY_BY_WX) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (baseResp.errCode == BaseResp.ErrCode.ERR_COMM) &#123;</div><div class=\"line\">                showToast(<span class=\"string\">\"微信支付失败\"</span>);</div><div class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (baseResp.errCode == BaseResp.ErrCode.ERR_USER_CANCEL) &#123;</div><div class=\"line\">                showToast(<span class=\"string\">\"用户取消\"</span>);</div><div class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (baseResp.errCode == BaseResp.ErrCode.ERR_OK) &#123;</div><div class=\"line\">                showToast(<span class=\"string\">\"微信支付成功\"</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li>如果返回的是失败，请再仔细检查调起支付的参数是否正确，进行sign签名的参数是否正确，如果还是不行，请再检查一遍，微信支付的错误信息太少了，之后成功和失败，如果统一下单成功了的话，那么就是一定是你们调起支付的参数错误，请一定要的仔细检查，重要的事重复三遍。</li>\n<li>如果是统一下单的时候有问题，请确认后台返回给你的订单号是否是唯一的，参数是否正确，sign的时候时候按照要求签名，微信平台填的是否是MD5签名，发起请求的方式是否为post，是否传送的是XML数据，如果是使用Retrofit发起请求，可以这样子：<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">new</span> Retrofit.Builder()</div><div class=\"line\">             .baseUrl(<span class=\"string\">\"https://api.mch.weixin.qq.com/pay/\"</span>)</div><div class=\"line\">             .addConverterFactory(StringConverterFactory.create())</div><div class=\"line\">             .build()</div><div class=\"line\">             .create(API.class)</div><div class=\"line\">             .oder(RequestBody.create(MediaType.parse(<span class=\"string\">\"text/plain\"</span>), oder)).enqueue(<span class=\"keyword\">new</span> Callback&lt;String&gt;() &#123;</div><div class=\"line\">         <span class=\"meta\">@Override</span></div><div class=\"line\">         <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onResponse</span><span class=\"params\">(Call&lt;String&gt; call, Response&lt;String&gt; response)</span> </span>&#123;</div><div class=\"line\">             <span class=\"keyword\">if</span> (response.body() != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                 OderResult result = xmlToResult(response.body());</div><div class=\"line\">                 <span class=\"keyword\">if</span> (result.getReturn_code().equals(<span class=\"string\">\"SUCCESS\"</span>)) &#123;</div><div class=\"line\">                     <span class=\"keyword\">if</span> (result.getResult_code().equals(<span class=\"string\">\"SUCCESS\"</span>)) &#123;</div><div class=\"line\"></div><div class=\"line\">                     &#125;</div><div class=\"line\">                 &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\"></div><div class=\"line\">                 &#125;</div><div class=\"line\">             &#125;</div><div class=\"line\"></div><div class=\"line\">         &#125;</div><div class=\"line\"></div><div class=\"line\">         <span class=\"meta\">@Override</span></div><div class=\"line\">         <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span><span class=\"params\">(Call&lt;String&gt; call, Throwable t)</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">         &#125;</div><div class=\"line\">     &#125;);</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">API</span> </span>&#123;</div><div class=\"line\">        <span class=\"meta\">@POST</span>(<span class=\"string\">\"unifiedorder\"</span>)</div><div class=\"line\">        <span class=\"function\">Call&lt;String&gt; <span class=\"title\">oder</span><span class=\"params\">(@Body RequestBody oder)</span></span>;</div><div class=\"line\">    &#125;</div></pre></td></tr></table></figure>"},{"title":"《数据的本质：无人不是分析师》摘抄","comments":0,"date":"2018-03-22T02:23:54.000Z","_content":"# 简述\n偶然间在书店看到的这本书，看到到这本书，正好翻到关于介绍马云团队的介绍的时候，觉得这本书蛮有趣的。事实上，一个企业的领头人的视野基本也就决定了企业后续的发展程度，也恰好最近在思考究竟什么样的企业适合自己，工作究竟是为了什么。是为了获得成就感，还是为了获得一份糊口，如何推销自己让自己变得更加强大而有用，我能利用的资源又能达到多少，是把自己作为一个商品去推销，还是和之前一样，把自己作为一个独立的人格去特立独行，这些都是我想思考，但是目前却没有很好的答案的问题。 ``与其思而不得，不如弃而远行`` 。于是便有了与这本书的的相识。\n<!--more-->\n这是一本车品觉关于自己从业经历中关于数据化的一些思考与经验，如果想从这本书得到非常具体的操作指南是不现实的，但是这本书却能带来很多的启发性，关于数据化的思考，关于数据化的发展，关于数据化的落地。现在把自己觉得好玩的一些部分摘抄如下：\n\n# 摘抄\n1. 数据的价值，必须来自场景。\n2. 在信息爆炸时代，拥有大量信息可能是灾难而不一定是好事，也不等于你有能力使用它。\n3. 一切数据收集活动的出发点都来自业务需要或者可以应对未来的业务发展。\n4. 数据分析的工作最终必须落在产品上。\n5. 数据是虚的，解决方案才是实在的，没有场景做目标的大数据如同一盘散沙，但太实相的大数据又不够灵活。\n6. 昨日的成功是今天的起点。\n7. 关注业务决策的过程，从问题中寻找数据化的机会。\n8. 未来没有一家公司，不是数据公司。\n9. 未来，人与人之间的差别，拼的是他可使用的数据量和算法。\n10. 大数据要成为企业核心资产的前提是，数据必须具有足够的流通性，而在这之前，要确保数据拥有方一直到数据最终使用方的中间过程有一个非常好的利益关系，这样，数据流通或是共享的价值链才会成立。\n11. 争取一把手的支持必不可少，\n12. 认知计算将为人类带来革命性的改变。\n13. 机器将变得越来越聪明。它们无疑将重新定义传统的生产方法、管理架构、服务形式，甚至重塑政府与民众之间的关系。\n14. 大数据领域有一种方式叫“peoplefindpeople”（人找人），即你只需要告诉它一个目标名单，它就能找到近似这个名单的人给你，而无须你预先描述目标特征。\n15. 运用数据把决策前置，既是一种技术较量，也是一场组织变革。\n16. 任何你以为数据不能告诉你的东西，数据却都能告诉你。\n17. 是的，我们在恍然大悟的时候总是很开心。终于懂了，原来是这样的啊。你知道了就是你的？未必！往往我们缺乏一个过程。什么过程？反思？不，反思只是基础，是一个非常表面的步骤，我们真正要做的是内化。反思，是你对一件事的感受，但感受远远不够。\n18. 学习如何去学习是一个人生课题，\n19. 共时面，时间链，关键词。\n20. 内化（ps：是的只有一个词，这本书也就只能记一个词了，记在这里是为了提醒自己，内化的重要性）\n21. 我会用市场营销组合里的4P理论分析自己的定位。\n    * Promotion（促销或宣传）。作为产品，你功能再好，也需要让市场知道你的存在，不然只能被市场埋没。\n    * Price（价格）。你必须对自己有一个认知，给自己定一个合理的价格。必须在价位上做到不卑不亢，如果妄自菲薄，别说你会被市场背叛，你自己也会背叛你。\n    * Place（渠道或地点）。你若开一家餐馆，你将餐厅开在垃圾堆旁谁会去吃啊？但你又不能超出预算，你将一家云吞面店开在香港铜锣湾，光租金你就回不了本，不是吗？所以，必须对自己有一个合适的定位。\n    * Product（产品）。顾名思义，前三个P，都是以产品为中心的。将自己比作产品，你的功能是什么？这个功能的需求正在增加还是减少呢？一个能配合自身能力的“产品”必须不断创新，适应市场而又配合先天的优势，就能在“市场”上脱颖而出。\n21. 细细解释教授的话就是，你的出现，会改变别人吗？能否影响别人？你的潜能，是否可以改变别人，改变别人的生活、行为、想法，甚至未来的经历？\n","source":"_posts/《数据的本质：无人不是分析师》摘抄.md","raw":"---\ntitle: 《数据的本质：无人不是分析师》摘抄\ntags: 随笔\ncomments: false\ncategories: 随笔\ndate: 2018-03-22 10:23:54\n---\n# 简述\n偶然间在书店看到的这本书，看到到这本书，正好翻到关于介绍马云团队的介绍的时候，觉得这本书蛮有趣的。事实上，一个企业的领头人的视野基本也就决定了企业后续的发展程度，也恰好最近在思考究竟什么样的企业适合自己，工作究竟是为了什么。是为了获得成就感，还是为了获得一份糊口，如何推销自己让自己变得更加强大而有用，我能利用的资源又能达到多少，是把自己作为一个商品去推销，还是和之前一样，把自己作为一个独立的人格去特立独行，这些都是我想思考，但是目前却没有很好的答案的问题。 ``与其思而不得，不如弃而远行`` 。于是便有了与这本书的的相识。\n<!--more-->\n这是一本车品觉关于自己从业经历中关于数据化的一些思考与经验，如果想从这本书得到非常具体的操作指南是不现实的，但是这本书却能带来很多的启发性，关于数据化的思考，关于数据化的发展，关于数据化的落地。现在把自己觉得好玩的一些部分摘抄如下：\n\n# 摘抄\n1. 数据的价值，必须来自场景。\n2. 在信息爆炸时代，拥有大量信息可能是灾难而不一定是好事，也不等于你有能力使用它。\n3. 一切数据收集活动的出发点都来自业务需要或者可以应对未来的业务发展。\n4. 数据分析的工作最终必须落在产品上。\n5. 数据是虚的，解决方案才是实在的，没有场景做目标的大数据如同一盘散沙，但太实相的大数据又不够灵活。\n6. 昨日的成功是今天的起点。\n7. 关注业务决策的过程，从问题中寻找数据化的机会。\n8. 未来没有一家公司，不是数据公司。\n9. 未来，人与人之间的差别，拼的是他可使用的数据量和算法。\n10. 大数据要成为企业核心资产的前提是，数据必须具有足够的流通性，而在这之前，要确保数据拥有方一直到数据最终使用方的中间过程有一个非常好的利益关系，这样，数据流通或是共享的价值链才会成立。\n11. 争取一把手的支持必不可少，\n12. 认知计算将为人类带来革命性的改变。\n13. 机器将变得越来越聪明。它们无疑将重新定义传统的生产方法、管理架构、服务形式，甚至重塑政府与民众之间的关系。\n14. 大数据领域有一种方式叫“peoplefindpeople”（人找人），即你只需要告诉它一个目标名单，它就能找到近似这个名单的人给你，而无须你预先描述目标特征。\n15. 运用数据把决策前置，既是一种技术较量，也是一场组织变革。\n16. 任何你以为数据不能告诉你的东西，数据却都能告诉你。\n17. 是的，我们在恍然大悟的时候总是很开心。终于懂了，原来是这样的啊。你知道了就是你的？未必！往往我们缺乏一个过程。什么过程？反思？不，反思只是基础，是一个非常表面的步骤，我们真正要做的是内化。反思，是你对一件事的感受，但感受远远不够。\n18. 学习如何去学习是一个人生课题，\n19. 共时面，时间链，关键词。\n20. 内化（ps：是的只有一个词，这本书也就只能记一个词了，记在这里是为了提醒自己，内化的重要性）\n21. 我会用市场营销组合里的4P理论分析自己的定位。\n    * Promotion（促销或宣传）。作为产品，你功能再好，也需要让市场知道你的存在，不然只能被市场埋没。\n    * Price（价格）。你必须对自己有一个认知，给自己定一个合理的价格。必须在价位上做到不卑不亢，如果妄自菲薄，别说你会被市场背叛，你自己也会背叛你。\n    * Place（渠道或地点）。你若开一家餐馆，你将餐厅开在垃圾堆旁谁会去吃啊？但你又不能超出预算，你将一家云吞面店开在香港铜锣湾，光租金你就回不了本，不是吗？所以，必须对自己有一个合适的定位。\n    * Product（产品）。顾名思义，前三个P，都是以产品为中心的。将自己比作产品，你的功能是什么？这个功能的需求正在增加还是减少呢？一个能配合自身能力的“产品”必须不断创新，适应市场而又配合先天的优势，就能在“市场”上脱颖而出。\n21. 细细解释教授的话就是，你的出现，会改变别人吗？能否影响别人？你的潜能，是否可以改变别人，改变别人的生活、行为、想法，甚至未来的经历？\n","slug":"《数据的本质：无人不是分析师》摘抄","published":1,"updated":"2018-06-12T16:29:38.307Z","layout":"post","photos":[],"link":"","_id":"cjr66wids001tmetp1egdidym","content":"<h1 id=\"简述\"><a href=\"#简述\" class=\"headerlink\" title=\"简述\"></a>简述</h1><p>偶然间在书店看到的这本书，看到到这本书，正好翻到关于介绍马云团队的介绍的时候，觉得这本书蛮有趣的。事实上，一个企业的领头人的视野基本也就决定了企业后续的发展程度，也恰好最近在思考究竟什么样的企业适合自己，工作究竟是为了什么。是为了获得成就感，还是为了获得一份糊口，如何推销自己让自己变得更加强大而有用，我能利用的资源又能达到多少，是把自己作为一个商品去推销，还是和之前一样，把自己作为一个独立的人格去特立独行，这些都是我想思考，但是目前却没有很好的答案的问题。 <code>与其思而不得，不如弃而远行</code> 。于是便有了与这本书的的相识。<br><a id=\"more\"></a><br>这是一本车品觉关于自己从业经历中关于数据化的一些思考与经验，如果想从这本书得到非常具体的操作指南是不现实的，但是这本书却能带来很多的启发性，关于数据化的思考，关于数据化的发展，关于数据化的落地。现在把自己觉得好玩的一些部分摘抄如下：</p>\n<h1 id=\"摘抄\"><a href=\"#摘抄\" class=\"headerlink\" title=\"摘抄\"></a>摘抄</h1><ol>\n<li>数据的价值，必须来自场景。</li>\n<li>在信息爆炸时代，拥有大量信息可能是灾难而不一定是好事，也不等于你有能力使用它。</li>\n<li>一切数据收集活动的出发点都来自业务需要或者可以应对未来的业务发展。</li>\n<li>数据分析的工作最终必须落在产品上。</li>\n<li>数据是虚的，解决方案才是实在的，没有场景做目标的大数据如同一盘散沙，但太实相的大数据又不够灵活。</li>\n<li>昨日的成功是今天的起点。</li>\n<li>关注业务决策的过程，从问题中寻找数据化的机会。</li>\n<li>未来没有一家公司，不是数据公司。</li>\n<li>未来，人与人之间的差别，拼的是他可使用的数据量和算法。</li>\n<li>大数据要成为企业核心资产的前提是，数据必须具有足够的流通性，而在这之前，要确保数据拥有方一直到数据最终使用方的中间过程有一个非常好的利益关系，这样，数据流通或是共享的价值链才会成立。</li>\n<li>争取一把手的支持必不可少，</li>\n<li>认知计算将为人类带来革命性的改变。</li>\n<li>机器将变得越来越聪明。它们无疑将重新定义传统的生产方法、管理架构、服务形式，甚至重塑政府与民众之间的关系。</li>\n<li>大数据领域有一种方式叫“peoplefindpeople”（人找人），即你只需要告诉它一个目标名单，它就能找到近似这个名单的人给你，而无须你预先描述目标特征。</li>\n<li>运用数据把决策前置，既是一种技术较量，也是一场组织变革。</li>\n<li>任何你以为数据不能告诉你的东西，数据却都能告诉你。</li>\n<li>是的，我们在恍然大悟的时候总是很开心。终于懂了，原来是这样的啊。你知道了就是你的？未必！往往我们缺乏一个过程。什么过程？反思？不，反思只是基础，是一个非常表面的步骤，我们真正要做的是内化。反思，是你对一件事的感受，但感受远远不够。</li>\n<li>学习如何去学习是一个人生课题，</li>\n<li>共时面，时间链，关键词。</li>\n<li>内化（ps：是的只有一个词，这本书也就只能记一个词了，记在这里是为了提醒自己，内化的重要性）</li>\n<li>我会用市场营销组合里的4P理论分析自己的定位。<ul>\n<li>Promotion（促销或宣传）。作为产品，你功能再好，也需要让市场知道你的存在，不然只能被市场埋没。</li>\n<li>Price（价格）。你必须对自己有一个认知，给自己定一个合理的价格。必须在价位上做到不卑不亢，如果妄自菲薄，别说你会被市场背叛，你自己也会背叛你。</li>\n<li>Place（渠道或地点）。你若开一家餐馆，你将餐厅开在垃圾堆旁谁会去吃啊？但你又不能超出预算，你将一家云吞面店开在香港铜锣湾，光租金你就回不了本，不是吗？所以，必须对自己有一个合适的定位。</li>\n<li>Product（产品）。顾名思义，前三个P，都是以产品为中心的。将自己比作产品，你的功能是什么？这个功能的需求正在增加还是减少呢？一个能配合自身能力的“产品”必须不断创新，适应市场而又配合先天的优势，就能在“市场”上脱颖而出。</li>\n</ul>\n</li>\n<li>细细解释教授的话就是，你的出现，会改变别人吗？能否影响别人？你的潜能，是否可以改变别人，改变别人的生活、行为、想法，甚至未来的经历？</li>\n</ol>\n","excerpt":"<h1 id=\"简述\"><a href=\"#简述\" class=\"headerlink\" title=\"简述\"></a>简述</h1><p>偶然间在书店看到的这本书，看到到这本书，正好翻到关于介绍马云团队的介绍的时候，觉得这本书蛮有趣的。事实上，一个企业的领头人的视野基本也就决定了企业后续的发展程度，也恰好最近在思考究竟什么样的企业适合自己，工作究竟是为了什么。是为了获得成就感，还是为了获得一份糊口，如何推销自己让自己变得更加强大而有用，我能利用的资源又能达到多少，是把自己作为一个商品去推销，还是和之前一样，把自己作为一个独立的人格去特立独行，这些都是我想思考，但是目前却没有很好的答案的问题。 <code>与其思而不得，不如弃而远行</code> 。于是便有了与这本书的的相识。<br>","more":"<br>这是一本车品觉关于自己从业经历中关于数据化的一些思考与经验，如果想从这本书得到非常具体的操作指南是不现实的，但是这本书却能带来很多的启发性，关于数据化的思考，关于数据化的发展，关于数据化的落地。现在把自己觉得好玩的一些部分摘抄如下：</p>\n<h1 id=\"摘抄\"><a href=\"#摘抄\" class=\"headerlink\" title=\"摘抄\"></a>摘抄</h1><ol>\n<li>数据的价值，必须来自场景。</li>\n<li>在信息爆炸时代，拥有大量信息可能是灾难而不一定是好事，也不等于你有能力使用它。</li>\n<li>一切数据收集活动的出发点都来自业务需要或者可以应对未来的业务发展。</li>\n<li>数据分析的工作最终必须落在产品上。</li>\n<li>数据是虚的，解决方案才是实在的，没有场景做目标的大数据如同一盘散沙，但太实相的大数据又不够灵活。</li>\n<li>昨日的成功是今天的起点。</li>\n<li>关注业务决策的过程，从问题中寻找数据化的机会。</li>\n<li>未来没有一家公司，不是数据公司。</li>\n<li>未来，人与人之间的差别，拼的是他可使用的数据量和算法。</li>\n<li>大数据要成为企业核心资产的前提是，数据必须具有足够的流通性，而在这之前，要确保数据拥有方一直到数据最终使用方的中间过程有一个非常好的利益关系，这样，数据流通或是共享的价值链才会成立。</li>\n<li>争取一把手的支持必不可少，</li>\n<li>认知计算将为人类带来革命性的改变。</li>\n<li>机器将变得越来越聪明。它们无疑将重新定义传统的生产方法、管理架构、服务形式，甚至重塑政府与民众之间的关系。</li>\n<li>大数据领域有一种方式叫“peoplefindpeople”（人找人），即你只需要告诉它一个目标名单，它就能找到近似这个名单的人给你，而无须你预先描述目标特征。</li>\n<li>运用数据把决策前置，既是一种技术较量，也是一场组织变革。</li>\n<li>任何你以为数据不能告诉你的东西，数据却都能告诉你。</li>\n<li>是的，我们在恍然大悟的时候总是很开心。终于懂了，原来是这样的啊。你知道了就是你的？未必！往往我们缺乏一个过程。什么过程？反思？不，反思只是基础，是一个非常表面的步骤，我们真正要做的是内化。反思，是你对一件事的感受，但感受远远不够。</li>\n<li>学习如何去学习是一个人生课题，</li>\n<li>共时面，时间链，关键词。</li>\n<li>内化（ps：是的只有一个词，这本书也就只能记一个词了，记在这里是为了提醒自己，内化的重要性）</li>\n<li>我会用市场营销组合里的4P理论分析自己的定位。<ul>\n<li>Promotion（促销或宣传）。作为产品，你功能再好，也需要让市场知道你的存在，不然只能被市场埋没。</li>\n<li>Price（价格）。你必须对自己有一个认知，给自己定一个合理的价格。必须在价位上做到不卑不亢，如果妄自菲薄，别说你会被市场背叛，你自己也会背叛你。</li>\n<li>Place（渠道或地点）。你若开一家餐馆，你将餐厅开在垃圾堆旁谁会去吃啊？但你又不能超出预算，你将一家云吞面店开在香港铜锣湾，光租金你就回不了本，不是吗？所以，必须对自己有一个合适的定位。</li>\n<li>Product（产品）。顾名思义，前三个P，都是以产品为中心的。将自己比作产品，你的功能是什么？这个功能的需求正在增加还是减少呢？一个能配合自身能力的“产品”必须不断创新，适应市场而又配合先天的优势，就能在“市场”上脱颖而出。</li>\n</ul>\n</li>\n<li>细细解释教授的话就是，你的出现，会改变别人吗？能否影响别人？你的潜能，是否可以改变别人，改变别人的生活、行为、想法，甚至未来的经历？</li>\n</ol>"},{"title":"《知识的错觉》摘抄","comments":0,"date":"2018-03-22T06:38:54.000Z","_content":"《知识的错觉》是上上周看完，眼看这一周又要结束了，我却依然没有完成关于这本书的一些思考评论。事实上，我的草稿箱中，躺着好几篇文章有待完成，有的我觉得已经不需要再去惦记了，因为不需要去完成了，有的还在思考怎么写一下，只是开了一个头就再没有下文了。总是试着去写点儿什么，可是到头来，我不过是在重复自己的过往经历，这种无意义的重复并不会为我带来什么新的体验，只不过是让一些反复思考过的东西输出出来，然后去进行下一波的思考。\n<!--more-->\n闲言少叙，《知识的错觉》是一本能够培养对认知科学兴趣的畅销书，说是畅销书，就一定不会有非常深入的见解。但是这本书我却觉得非常值得一读，因为这本书会让我们意识到很多显而易见但是不会去关注的一些事实，作为一本畅销书，是非常合格的。\n\n#  摘抄\n1. 人类的心智并不是一台计算机，生来就是用于储藏海量信息的。我们的心智经过演化成为一个懂得灵活变通的问题解决专家，学会只提取最有用的信息并举一反三地应用于新情势，引导我们做出决定。于是，个人极少耗费大脑资源储存细枝末节的信息。\n2. 只有在你能通过因果机制的推理足以看到未来社会变迁的时候，比如当你看到死亡的威胁近在眼前时，才会花时间学习某项有用的技能或者工艺。\n3. 由因导果时人们会忽略其他潜在因素，是因为他们的心理模拟已经应接不暇了，但逆向地由果导因时，我们根本无法进行心理模拟。（即，由因导果时预测式的正向推理，由果导因是诊断式的逆向推理）\n4. 反事实的思考能力使得人们能够同时做出非凡和平凡的行为。\n5. 心理学家指出，故事构建了我们从个体自我到集体成员的身份认同。我们讲述关于过去的故事，我们追忆往昔并赋予它们浪漫色彩。我们讲述关于未来的故事，我们畅想未来并赋予它们奇幻色彩。我们还讲诉关于现在的故事，我们构建出自我并开始白日做梦。所有这一切都是关于挖掘原因和预见结果的。我们是怎么来的？我们要去哪儿？此时此刻，我应该采取什么行动？\n6. 故此，人们对任何东西都知之甚少（出乎意料，太出乎意料了）。事实上，我们知道的特别少，只是刚刚够罢了。\n7. 人们进门的时候也会用到光流。假设你想从门的正中央穿过，而不会撞到门框，一种方法是预测你与门之间的距离、门的宽度，并算好应以多大的角度从门中间穿过。出色的老式人工智能机器人就会这么干。这需要进行大量的计算和判断。如果你这位机器人时间有限，进行这类估算可能就心有余而力不足了。这里有个更快捷简单的办法：穿过门口的过程中确保两侧的门框以相同的速度靠近你（更确切地说：确保你两侧的光流是对称的）。仅此而已。如果你能这样做，你走进哪个房间都不会撞疼肩膀。而人们平日里就是这样做的。我们知道，事实就是如此，因为在利用虚拟现实技术创造的情境中，如果人为地提高某侧光流的速度，人们则不再走在走廊的正中间，他们将移步光流较慢的那一侧。\n8. 这些例子说明了心智的一项关键特质：其演化历程不是个体独自奋斗之路，而是群体协作的过程。连思维的演化都是彼此相依，结合在一起的。\n9. 人类的不可思议之处在于，至少当我们保持一致时，我们表征的是同一片小小的世界，即使各自持有不同的信息碎片。这反映了集体性知识的第二个特性：共同体中持有不同知识片段的成员之间必须能包容共存。\n 10. 知识的错觉之所以会发生是因为我们活在一个知识共同体当中，而且我们无法区分哪些知识是内化了的，哪些根本不在我们脑袋里。我们自以为那些有关事物运行规则的知识是印在自己脑袋里的，而事实上我们从周遭环境及他人身上获取了很多。这既是认知的特征也是认知的死结。我们知识库的绝大部分都存储于这世界和我们的社群里。多数人的理解力仅限于意识到知识就在那里。高级的理解力通常还包括知道可以去哪里获取知识。只有名副其实的饱学之士才真的把可用的学识存在他们自己的记忆体里。\n11. 这就是活在知识共同体中的代价之一：我们与那些只能通过他人的知识和体验而了解之事失之交臂。\n12. 人类是为技术变革而生的。我们的躯体和大脑生来就有将新工具融入日常活动的本领，仿佛它们就是我们肢体的延伸一样。\n13. 这引发了深度错觉：当我对个人理解力进行自评时，他人的想法也被纳入其中，因而，我对自己的理解力的自我评价比实际上更好。\n14. 因为技术并不了解系统所要实现之目标，它无法与人类共享意向性，总会出差错的威胁从未消失。当技术失效而人类毫无防备之时，灾难会随之降临。\n15. 在可预见的未来，技术将缺少一项促使人类成功的秘诀：共享意向性的能力。因此，技术不会成为知识共同体中人类的平等伙伴，它仍然是一个从属工具。\n16. 不止如此，当我们对知识共同体的利用到了游刃有余的境界时，世界上将有越来越多的专业知识随时听任我们调遣。\n17. 但是，如果人们在一开始对其机制就没什么头绪的话，对真相也就没那么抗拒了。\n18. 给出原因而非因果性的解释会导向完全不同的行为：受试者既没有降低对理解程度的打分，也丝毫没有要缓和立场极端性的意思。\n19. 我们不在乎某项政策的成败得失，其背后承载的价值观才是真正重要的。\n20. 因此，我们探讨的因果性解释对缓和立场是简单而有效的良方这一结论，只适用于某些立场判断基于后果而非价值观的特定议题。\n21. 理解的错觉源于人们对熟悉和识别这两个概念的混淆。\n22. 懂得留意你的未知，而不是盯着已知的部分。要想做到这一点，你必须放下一些傲慢身段，接受你对自己的未知一无所知这一点。找出你的未知，不过就是个关于你的知识边界在哪里，以及探求边界之外有什么的问题。\n23. 了解某人之未知的一个好办法，就是通过从事某个学科的实际工作来了解这个学科。\n24. 同时，这也意味着要教授批判思考的能力，促进沟通和意见的交换，而非仅盯着事实本身。这是一种自由教育的价值观，与你为了获取职业技能而进行的学习截然相反。\n25. 因为选项的鼓励与否操纵在别人手里。\n26. 应对未知比已知某些东西更有价值。\n27. 人际关系也与此类似：如果在相处当中遇到问题，我们自以为了解状况，这激励我们试着去解决问题。\n","source":"_posts/《知识的错觉》摘抄.md","raw":"---\ntitle: 《知识的错觉》摘抄\ntags: 随笔\ncomments: false\ncategories: 随笔\ndate: 2018-03-22 14:38:54\n---\n《知识的错觉》是上上周看完，眼看这一周又要结束了，我却依然没有完成关于这本书的一些思考评论。事实上，我的草稿箱中，躺着好几篇文章有待完成，有的我觉得已经不需要再去惦记了，因为不需要去完成了，有的还在思考怎么写一下，只是开了一个头就再没有下文了。总是试着去写点儿什么，可是到头来，我不过是在重复自己的过往经历，这种无意义的重复并不会为我带来什么新的体验，只不过是让一些反复思考过的东西输出出来，然后去进行下一波的思考。\n<!--more-->\n闲言少叙，《知识的错觉》是一本能够培养对认知科学兴趣的畅销书，说是畅销书，就一定不会有非常深入的见解。但是这本书我却觉得非常值得一读，因为这本书会让我们意识到很多显而易见但是不会去关注的一些事实，作为一本畅销书，是非常合格的。\n\n#  摘抄\n1. 人类的心智并不是一台计算机，生来就是用于储藏海量信息的。我们的心智经过演化成为一个懂得灵活变通的问题解决专家，学会只提取最有用的信息并举一反三地应用于新情势，引导我们做出决定。于是，个人极少耗费大脑资源储存细枝末节的信息。\n2. 只有在你能通过因果机制的推理足以看到未来社会变迁的时候，比如当你看到死亡的威胁近在眼前时，才会花时间学习某项有用的技能或者工艺。\n3. 由因导果时人们会忽略其他潜在因素，是因为他们的心理模拟已经应接不暇了，但逆向地由果导因时，我们根本无法进行心理模拟。（即，由因导果时预测式的正向推理，由果导因是诊断式的逆向推理）\n4. 反事实的思考能力使得人们能够同时做出非凡和平凡的行为。\n5. 心理学家指出，故事构建了我们从个体自我到集体成员的身份认同。我们讲述关于过去的故事，我们追忆往昔并赋予它们浪漫色彩。我们讲述关于未来的故事，我们畅想未来并赋予它们奇幻色彩。我们还讲诉关于现在的故事，我们构建出自我并开始白日做梦。所有这一切都是关于挖掘原因和预见结果的。我们是怎么来的？我们要去哪儿？此时此刻，我应该采取什么行动？\n6. 故此，人们对任何东西都知之甚少（出乎意料，太出乎意料了）。事实上，我们知道的特别少，只是刚刚够罢了。\n7. 人们进门的时候也会用到光流。假设你想从门的正中央穿过，而不会撞到门框，一种方法是预测你与门之间的距离、门的宽度，并算好应以多大的角度从门中间穿过。出色的老式人工智能机器人就会这么干。这需要进行大量的计算和判断。如果你这位机器人时间有限，进行这类估算可能就心有余而力不足了。这里有个更快捷简单的办法：穿过门口的过程中确保两侧的门框以相同的速度靠近你（更确切地说：确保你两侧的光流是对称的）。仅此而已。如果你能这样做，你走进哪个房间都不会撞疼肩膀。而人们平日里就是这样做的。我们知道，事实就是如此，因为在利用虚拟现实技术创造的情境中，如果人为地提高某侧光流的速度，人们则不再走在走廊的正中间，他们将移步光流较慢的那一侧。\n8. 这些例子说明了心智的一项关键特质：其演化历程不是个体独自奋斗之路，而是群体协作的过程。连思维的演化都是彼此相依，结合在一起的。\n9. 人类的不可思议之处在于，至少当我们保持一致时，我们表征的是同一片小小的世界，即使各自持有不同的信息碎片。这反映了集体性知识的第二个特性：共同体中持有不同知识片段的成员之间必须能包容共存。\n 10. 知识的错觉之所以会发生是因为我们活在一个知识共同体当中，而且我们无法区分哪些知识是内化了的，哪些根本不在我们脑袋里。我们自以为那些有关事物运行规则的知识是印在自己脑袋里的，而事实上我们从周遭环境及他人身上获取了很多。这既是认知的特征也是认知的死结。我们知识库的绝大部分都存储于这世界和我们的社群里。多数人的理解力仅限于意识到知识就在那里。高级的理解力通常还包括知道可以去哪里获取知识。只有名副其实的饱学之士才真的把可用的学识存在他们自己的记忆体里。\n11. 这就是活在知识共同体中的代价之一：我们与那些只能通过他人的知识和体验而了解之事失之交臂。\n12. 人类是为技术变革而生的。我们的躯体和大脑生来就有将新工具融入日常活动的本领，仿佛它们就是我们肢体的延伸一样。\n13. 这引发了深度错觉：当我对个人理解力进行自评时，他人的想法也被纳入其中，因而，我对自己的理解力的自我评价比实际上更好。\n14. 因为技术并不了解系统所要实现之目标，它无法与人类共享意向性，总会出差错的威胁从未消失。当技术失效而人类毫无防备之时，灾难会随之降临。\n15. 在可预见的未来，技术将缺少一项促使人类成功的秘诀：共享意向性的能力。因此，技术不会成为知识共同体中人类的平等伙伴，它仍然是一个从属工具。\n16. 不止如此，当我们对知识共同体的利用到了游刃有余的境界时，世界上将有越来越多的专业知识随时听任我们调遣。\n17. 但是，如果人们在一开始对其机制就没什么头绪的话，对真相也就没那么抗拒了。\n18. 给出原因而非因果性的解释会导向完全不同的行为：受试者既没有降低对理解程度的打分，也丝毫没有要缓和立场极端性的意思。\n19. 我们不在乎某项政策的成败得失，其背后承载的价值观才是真正重要的。\n20. 因此，我们探讨的因果性解释对缓和立场是简单而有效的良方这一结论，只适用于某些立场判断基于后果而非价值观的特定议题。\n21. 理解的错觉源于人们对熟悉和识别这两个概念的混淆。\n22. 懂得留意你的未知，而不是盯着已知的部分。要想做到这一点，你必须放下一些傲慢身段，接受你对自己的未知一无所知这一点。找出你的未知，不过就是个关于你的知识边界在哪里，以及探求边界之外有什么的问题。\n23. 了解某人之未知的一个好办法，就是通过从事某个学科的实际工作来了解这个学科。\n24. 同时，这也意味着要教授批判思考的能力，促进沟通和意见的交换，而非仅盯着事实本身。这是一种自由教育的价值观，与你为了获取职业技能而进行的学习截然相反。\n25. 因为选项的鼓励与否操纵在别人手里。\n26. 应对未知比已知某些东西更有价值。\n27. 人际关系也与此类似：如果在相处当中遇到问题，我们自以为了解状况，这激励我们试着去解决问题。\n","slug":"《知识的错觉》摘抄","published":1,"updated":"2018-06-12T16:29:41.747Z","layout":"post","photos":[],"link":"","_id":"cjr66widt001vmetpavvo8sk0","content":"<p>《知识的错觉》是上上周看完，眼看这一周又要结束了，我却依然没有完成关于这本书的一些思考评论。事实上，我的草稿箱中，躺着好几篇文章有待完成，有的我觉得已经不需要再去惦记了，因为不需要去完成了，有的还在思考怎么写一下，只是开了一个头就再没有下文了。总是试着去写点儿什么，可是到头来，我不过是在重复自己的过往经历，这种无意义的重复并不会为我带来什么新的体验，只不过是让一些反复思考过的东西输出出来，然后去进行下一波的思考。<br><a id=\"more\"></a><br>闲言少叙，《知识的错觉》是一本能够培养对认知科学兴趣的畅销书，说是畅销书，就一定不会有非常深入的见解。但是这本书我却觉得非常值得一读，因为这本书会让我们意识到很多显而易见但是不会去关注的一些事实，作为一本畅销书，是非常合格的。</p>\n<h1 id=\"摘抄\"><a href=\"#摘抄\" class=\"headerlink\" title=\"摘抄\"></a>摘抄</h1><ol>\n<li>人类的心智并不是一台计算机，生来就是用于储藏海量信息的。我们的心智经过演化成为一个懂得灵活变通的问题解决专家，学会只提取最有用的信息并举一反三地应用于新情势，引导我们做出决定。于是，个人极少耗费大脑资源储存细枝末节的信息。</li>\n<li>只有在你能通过因果机制的推理足以看到未来社会变迁的时候，比如当你看到死亡的威胁近在眼前时，才会花时间学习某项有用的技能或者工艺。</li>\n<li>由因导果时人们会忽略其他潜在因素，是因为他们的心理模拟已经应接不暇了，但逆向地由果导因时，我们根本无法进行心理模拟。（即，由因导果时预测式的正向推理，由果导因是诊断式的逆向推理）</li>\n<li>反事实的思考能力使得人们能够同时做出非凡和平凡的行为。</li>\n<li>心理学家指出，故事构建了我们从个体自我到集体成员的身份认同。我们讲述关于过去的故事，我们追忆往昔并赋予它们浪漫色彩。我们讲述关于未来的故事，我们畅想未来并赋予它们奇幻色彩。我们还讲诉关于现在的故事，我们构建出自我并开始白日做梦。所有这一切都是关于挖掘原因和预见结果的。我们是怎么来的？我们要去哪儿？此时此刻，我应该采取什么行动？</li>\n<li>故此，人们对任何东西都知之甚少（出乎意料，太出乎意料了）。事实上，我们知道的特别少，只是刚刚够罢了。</li>\n<li>人们进门的时候也会用到光流。假设你想从门的正中央穿过，而不会撞到门框，一种方法是预测你与门之间的距离、门的宽度，并算好应以多大的角度从门中间穿过。出色的老式人工智能机器人就会这么干。这需要进行大量的计算和判断。如果你这位机器人时间有限，进行这类估算可能就心有余而力不足了。这里有个更快捷简单的办法：穿过门口的过程中确保两侧的门框以相同的速度靠近你（更确切地说：确保你两侧的光流是对称的）。仅此而已。如果你能这样做，你走进哪个房间都不会撞疼肩膀。而人们平日里就是这样做的。我们知道，事实就是如此，因为在利用虚拟现实技术创造的情境中，如果人为地提高某侧光流的速度，人们则不再走在走廊的正中间，他们将移步光流较慢的那一侧。</li>\n<li>这些例子说明了心智的一项关键特质：其演化历程不是个体独自奋斗之路，而是群体协作的过程。连思维的演化都是彼此相依，结合在一起的。</li>\n<li>人类的不可思议之处在于，至少当我们保持一致时，我们表征的是同一片小小的世界，即使各自持有不同的信息碎片。这反映了集体性知识的第二个特性：共同体中持有不同知识片段的成员之间必须能包容共存。<ol>\n<li>知识的错觉之所以会发生是因为我们活在一个知识共同体当中，而且我们无法区分哪些知识是内化了的，哪些根本不在我们脑袋里。我们自以为那些有关事物运行规则的知识是印在自己脑袋里的，而事实上我们从周遭环境及他人身上获取了很多。这既是认知的特征也是认知的死结。我们知识库的绝大部分都存储于这世界和我们的社群里。多数人的理解力仅限于意识到知识就在那里。高级的理解力通常还包括知道可以去哪里获取知识。只有名副其实的饱学之士才真的把可用的学识存在他们自己的记忆体里。</li>\n</ol>\n</li>\n<li>这就是活在知识共同体中的代价之一：我们与那些只能通过他人的知识和体验而了解之事失之交臂。</li>\n<li>人类是为技术变革而生的。我们的躯体和大脑生来就有将新工具融入日常活动的本领，仿佛它们就是我们肢体的延伸一样。</li>\n<li>这引发了深度错觉：当我对个人理解力进行自评时，他人的想法也被纳入其中，因而，我对自己的理解力的自我评价比实际上更好。</li>\n<li>因为技术并不了解系统所要实现之目标，它无法与人类共享意向性，总会出差错的威胁从未消失。当技术失效而人类毫无防备之时，灾难会随之降临。</li>\n<li>在可预见的未来，技术将缺少一项促使人类成功的秘诀：共享意向性的能力。因此，技术不会成为知识共同体中人类的平等伙伴，它仍然是一个从属工具。</li>\n<li>不止如此，当我们对知识共同体的利用到了游刃有余的境界时，世界上将有越来越多的专业知识随时听任我们调遣。</li>\n<li>但是，如果人们在一开始对其机制就没什么头绪的话，对真相也就没那么抗拒了。</li>\n<li>给出原因而非因果性的解释会导向完全不同的行为：受试者既没有降低对理解程度的打分，也丝毫没有要缓和立场极端性的意思。</li>\n<li>我们不在乎某项政策的成败得失，其背后承载的价值观才是真正重要的。</li>\n<li>因此，我们探讨的因果性解释对缓和立场是简单而有效的良方这一结论，只适用于某些立场判断基于后果而非价值观的特定议题。</li>\n<li>理解的错觉源于人们对熟悉和识别这两个概念的混淆。</li>\n<li>懂得留意你的未知，而不是盯着已知的部分。要想做到这一点，你必须放下一些傲慢身段，接受你对自己的未知一无所知这一点。找出你的未知，不过就是个关于你的知识边界在哪里，以及探求边界之外有什么的问题。</li>\n<li>了解某人之未知的一个好办法，就是通过从事某个学科的实际工作来了解这个学科。</li>\n<li>同时，这也意味着要教授批判思考的能力，促进沟通和意见的交换，而非仅盯着事实本身。这是一种自由教育的价值观，与你为了获取职业技能而进行的学习截然相反。</li>\n<li>因为选项的鼓励与否操纵在别人手里。</li>\n<li>应对未知比已知某些东西更有价值。</li>\n<li>人际关系也与此类似：如果在相处当中遇到问题，我们自以为了解状况，这激励我们试着去解决问题。</li>\n</ol>\n","excerpt":"<p>《知识的错觉》是上上周看完，眼看这一周又要结束了，我却依然没有完成关于这本书的一些思考评论。事实上，我的草稿箱中，躺着好几篇文章有待完成，有的我觉得已经不需要再去惦记了，因为不需要去完成了，有的还在思考怎么写一下，只是开了一个头就再没有下文了。总是试着去写点儿什么，可是到头来，我不过是在重复自己的过往经历，这种无意义的重复并不会为我带来什么新的体验，只不过是让一些反复思考过的东西输出出来，然后去进行下一波的思考。<br>","more":"<br>闲言少叙，《知识的错觉》是一本能够培养对认知科学兴趣的畅销书，说是畅销书，就一定不会有非常深入的见解。但是这本书我却觉得非常值得一读，因为这本书会让我们意识到很多显而易见但是不会去关注的一些事实，作为一本畅销书，是非常合格的。</p>\n<h1 id=\"摘抄\"><a href=\"#摘抄\" class=\"headerlink\" title=\"摘抄\"></a>摘抄</h1><ol>\n<li>人类的心智并不是一台计算机，生来就是用于储藏海量信息的。我们的心智经过演化成为一个懂得灵活变通的问题解决专家，学会只提取最有用的信息并举一反三地应用于新情势，引导我们做出决定。于是，个人极少耗费大脑资源储存细枝末节的信息。</li>\n<li>只有在你能通过因果机制的推理足以看到未来社会变迁的时候，比如当你看到死亡的威胁近在眼前时，才会花时间学习某项有用的技能或者工艺。</li>\n<li>由因导果时人们会忽略其他潜在因素，是因为他们的心理模拟已经应接不暇了，但逆向地由果导因时，我们根本无法进行心理模拟。（即，由因导果时预测式的正向推理，由果导因是诊断式的逆向推理）</li>\n<li>反事实的思考能力使得人们能够同时做出非凡和平凡的行为。</li>\n<li>心理学家指出，故事构建了我们从个体自我到集体成员的身份认同。我们讲述关于过去的故事，我们追忆往昔并赋予它们浪漫色彩。我们讲述关于未来的故事，我们畅想未来并赋予它们奇幻色彩。我们还讲诉关于现在的故事，我们构建出自我并开始白日做梦。所有这一切都是关于挖掘原因和预见结果的。我们是怎么来的？我们要去哪儿？此时此刻，我应该采取什么行动？</li>\n<li>故此，人们对任何东西都知之甚少（出乎意料，太出乎意料了）。事实上，我们知道的特别少，只是刚刚够罢了。</li>\n<li>人们进门的时候也会用到光流。假设你想从门的正中央穿过，而不会撞到门框，一种方法是预测你与门之间的距离、门的宽度，并算好应以多大的角度从门中间穿过。出色的老式人工智能机器人就会这么干。这需要进行大量的计算和判断。如果你这位机器人时间有限，进行这类估算可能就心有余而力不足了。这里有个更快捷简单的办法：穿过门口的过程中确保两侧的门框以相同的速度靠近你（更确切地说：确保你两侧的光流是对称的）。仅此而已。如果你能这样做，你走进哪个房间都不会撞疼肩膀。而人们平日里就是这样做的。我们知道，事实就是如此，因为在利用虚拟现实技术创造的情境中，如果人为地提高某侧光流的速度，人们则不再走在走廊的正中间，他们将移步光流较慢的那一侧。</li>\n<li>这些例子说明了心智的一项关键特质：其演化历程不是个体独自奋斗之路，而是群体协作的过程。连思维的演化都是彼此相依，结合在一起的。</li>\n<li>人类的不可思议之处在于，至少当我们保持一致时，我们表征的是同一片小小的世界，即使各自持有不同的信息碎片。这反映了集体性知识的第二个特性：共同体中持有不同知识片段的成员之间必须能包容共存。<ol>\n<li>知识的错觉之所以会发生是因为我们活在一个知识共同体当中，而且我们无法区分哪些知识是内化了的，哪些根本不在我们脑袋里。我们自以为那些有关事物运行规则的知识是印在自己脑袋里的，而事实上我们从周遭环境及他人身上获取了很多。这既是认知的特征也是认知的死结。我们知识库的绝大部分都存储于这世界和我们的社群里。多数人的理解力仅限于意识到知识就在那里。高级的理解力通常还包括知道可以去哪里获取知识。只有名副其实的饱学之士才真的把可用的学识存在他们自己的记忆体里。</li>\n</ol>\n</li>\n<li>这就是活在知识共同体中的代价之一：我们与那些只能通过他人的知识和体验而了解之事失之交臂。</li>\n<li>人类是为技术变革而生的。我们的躯体和大脑生来就有将新工具融入日常活动的本领，仿佛它们就是我们肢体的延伸一样。</li>\n<li>这引发了深度错觉：当我对个人理解力进行自评时，他人的想法也被纳入其中，因而，我对自己的理解力的自我评价比实际上更好。</li>\n<li>因为技术并不了解系统所要实现之目标，它无法与人类共享意向性，总会出差错的威胁从未消失。当技术失效而人类毫无防备之时，灾难会随之降临。</li>\n<li>在可预见的未来，技术将缺少一项促使人类成功的秘诀：共享意向性的能力。因此，技术不会成为知识共同体中人类的平等伙伴，它仍然是一个从属工具。</li>\n<li>不止如此，当我们对知识共同体的利用到了游刃有余的境界时，世界上将有越来越多的专业知识随时听任我们调遣。</li>\n<li>但是，如果人们在一开始对其机制就没什么头绪的话，对真相也就没那么抗拒了。</li>\n<li>给出原因而非因果性的解释会导向完全不同的行为：受试者既没有降低对理解程度的打分，也丝毫没有要缓和立场极端性的意思。</li>\n<li>我们不在乎某项政策的成败得失，其背后承载的价值观才是真正重要的。</li>\n<li>因此，我们探讨的因果性解释对缓和立场是简单而有效的良方这一结论，只适用于某些立场判断基于后果而非价值观的特定议题。</li>\n<li>理解的错觉源于人们对熟悉和识别这两个概念的混淆。</li>\n<li>懂得留意你的未知，而不是盯着已知的部分。要想做到这一点，你必须放下一些傲慢身段，接受你对自己的未知一无所知这一点。找出你的未知，不过就是个关于你的知识边界在哪里，以及探求边界之外有什么的问题。</li>\n<li>了解某人之未知的一个好办法，就是通过从事某个学科的实际工作来了解这个学科。</li>\n<li>同时，这也意味着要教授批判思考的能力，促进沟通和意见的交换，而非仅盯着事实本身。这是一种自由教育的价值观，与你为了获取职业技能而进行的学习截然相反。</li>\n<li>因为选项的鼓励与否操纵在别人手里。</li>\n<li>应对未知比已知某些东西更有价值。</li>\n<li>人际关系也与此类似：如果在相处当中遇到问题，我们自以为了解状况，这激励我们试着去解决问题。</li>\n</ol>"},{"title":"相遇","comments":0,"date":"2018-03-07T01:48:38.000Z","_content":"我是对的吗？我不止一次地问过自己这个问题，问题的出现源于多年来的心结，一个无法解开的心结。直到，一场突如其来的相遇，回答了我这个问题。\n<!--more-->\n# 再次相遇\n因为公司解散，我选择短期内出去走走，于是，一次意外的相遇就这样开始了。知道她在西安读研，但是很多年没有见过，我不能确定，我还能否从人群里把她快速的识别出来。在过去的时间里，我对她的了解也不是很多，自从高二文理分班之后，仅有的交集也就仅限于因为源于几个相同朋友圈的交流，慢慢地就只是变成了微信朋友圈里的一个人。\n\n再次相遇，一起约在了陕西省历史博物馆，那天她比我早到了会儿，确切来说，是因为我迟到了，多年未见，第一次相约就迟到了，该是给别人留下多坏的印象啊。我记得那天她穿了一件很普通的毛衣，没有穿外套，好像是黄色的，还好我们还能相互认出来，寒暄了会儿就没有什么可说的话了。这就是一次普通的久别重逢，那个时候我心中关于工作、关于感情没有一件能坚持下去的，也没有一件能够让我炫耀的，阴郁始终伴随着我的那段时光，于是沉默寡言就变成了我的标配，而且因为刚从华山上下来，在山上冻了一晚上，还没有完全缓过来，状态也算不上很好。\n\n然后，逛了会儿博物馆，意外地我突然想开玩笑，有一个我自己记得特别深刻，就是到了一个被人们投了很多硬币的地方，其实我蛮讨厌别人乱投硬币的行为的，我对她开玩笑说，“来，让我们把这些硬币拿走吧，偷走别人的梦想，正好坐公交要投币”。她就一直笑我中二，笑了好长时间，看着她在笑，我也跟着笑了起来。哪怕是我每年都要聚会的那帮朋友，我都好久没有看到别人很开心地笑了，也好久没有被人逗笑了，这便成了我对她的第一次深刻印象。是啊，这句话是那么的中二，可是她的反应却让我意外，意外的惊喜，意外的意外。\n\n然后一起去逛碑林博物馆、钟楼、鼓楼、回民街，在鼓楼上，相会加对方的网易音乐的关注和微博，在搜网易音乐的时候是可以直接使用手机号加的，但是我的列表没有直接出现她，哪怕我给网易开了通讯录的权限，依然没有看到她，这就很尴尬了，约出来的是一个连相互的手机号都没有的人，她直接补了一句“好尴尬”，我把这句理解成了化解尴尬的意思，我不得已选择直接去通讯录复制手机号，证明我还是有她手机号的。“好尴尬”，变成了一件小事，已经过去了，但是给我留下了很深刻的印象，因为一般的女孩子都不会直接说对方很尴尬这种话的，尤其还是好久没有相遇的两个人，即便很尴尬，也不会直接说出来，我把这种行为理解成了直接坦率，这便成了我对她的第二个深刻印象。\n\n人和人之间，需要发生多少事情才算是彻底了解呢？也许一两次，也许一辈子，不一而足，无法界定。她做到只是自己生活中的样子，并不是特意做给谁看的，但是于我而言，意义就多了起来。\n\n# 离别\n在和她再次相遇之后，因为她还要上课，所以我自己一个人去了兵马俑，回来的第二天，也就是留在陕西的最后一天，我去了她的学校。自从大学毕业之后，就再没有回到过大学课堂了，遇见了她的同学，她的老师，然后一起随便吃了一顿也就结束了在陕西的行程。唯一的意外应该是离开的时候，差点儿就赶不上离开的火车了，以及她们学校的厕所超级破，还不如我们村里面的茅坑。\n\n她是把我作为一个久别重逢的老同学来招待的，我也没有想太多，甚至中午的时候，她把我丢在一边跑去午休去了，是啊，那个时候谁会想到后面会发生那么多事情，也就是简简单单地一次相遇罢了，估计结束之后也不会有更多的交集，何必在意那么多呢。晚上我接到了我妈妈的电话，点名要吃凉粉，还被她吐槽。\n\n离别的来临，也没什么特别的伤感，也没什么特别的惊讶，蛮平淡的一天。但很意外地，离别的来临，我居然多了一丝留恋，说不清道不明，回味与遗忘开始有了冲突，故事也就有了开始。\n\n# 心结\n心结的答案呢？没有办法写出来，也无法知道写出来的究竟还是不是一个合格的心结。期待能够续写心结。或者说，这篇文章的第三部分，我不知道该怎么写，还是戛然而止吧。\n","source":"_posts/相遇.md","raw":"---\ntitle: 相遇\ntags: 随笔\ncomments: false\ncategories: 随笔\ndate: 2018-03-07 09:48:38\n---\n我是对的吗？我不止一次地问过自己这个问题，问题的出现源于多年来的心结，一个无法解开的心结。直到，一场突如其来的相遇，回答了我这个问题。\n<!--more-->\n# 再次相遇\n因为公司解散，我选择短期内出去走走，于是，一次意外的相遇就这样开始了。知道她在西安读研，但是很多年没有见过，我不能确定，我还能否从人群里把她快速的识别出来。在过去的时间里，我对她的了解也不是很多，自从高二文理分班之后，仅有的交集也就仅限于因为源于几个相同朋友圈的交流，慢慢地就只是变成了微信朋友圈里的一个人。\n\n再次相遇，一起约在了陕西省历史博物馆，那天她比我早到了会儿，确切来说，是因为我迟到了，多年未见，第一次相约就迟到了，该是给别人留下多坏的印象啊。我记得那天她穿了一件很普通的毛衣，没有穿外套，好像是黄色的，还好我们还能相互认出来，寒暄了会儿就没有什么可说的话了。这就是一次普通的久别重逢，那个时候我心中关于工作、关于感情没有一件能坚持下去的，也没有一件能够让我炫耀的，阴郁始终伴随着我的那段时光，于是沉默寡言就变成了我的标配，而且因为刚从华山上下来，在山上冻了一晚上，还没有完全缓过来，状态也算不上很好。\n\n然后，逛了会儿博物馆，意外地我突然想开玩笑，有一个我自己记得特别深刻，就是到了一个被人们投了很多硬币的地方，其实我蛮讨厌别人乱投硬币的行为的，我对她开玩笑说，“来，让我们把这些硬币拿走吧，偷走别人的梦想，正好坐公交要投币”。她就一直笑我中二，笑了好长时间，看着她在笑，我也跟着笑了起来。哪怕是我每年都要聚会的那帮朋友，我都好久没有看到别人很开心地笑了，也好久没有被人逗笑了，这便成了我对她的第一次深刻印象。是啊，这句话是那么的中二，可是她的反应却让我意外，意外的惊喜，意外的意外。\n\n然后一起去逛碑林博物馆、钟楼、鼓楼、回民街，在鼓楼上，相会加对方的网易音乐的关注和微博，在搜网易音乐的时候是可以直接使用手机号加的，但是我的列表没有直接出现她，哪怕我给网易开了通讯录的权限，依然没有看到她，这就很尴尬了，约出来的是一个连相互的手机号都没有的人，她直接补了一句“好尴尬”，我把这句理解成了化解尴尬的意思，我不得已选择直接去通讯录复制手机号，证明我还是有她手机号的。“好尴尬”，变成了一件小事，已经过去了，但是给我留下了很深刻的印象，因为一般的女孩子都不会直接说对方很尴尬这种话的，尤其还是好久没有相遇的两个人，即便很尴尬，也不会直接说出来，我把这种行为理解成了直接坦率，这便成了我对她的第二个深刻印象。\n\n人和人之间，需要发生多少事情才算是彻底了解呢？也许一两次，也许一辈子，不一而足，无法界定。她做到只是自己生活中的样子，并不是特意做给谁看的，但是于我而言，意义就多了起来。\n\n# 离别\n在和她再次相遇之后，因为她还要上课，所以我自己一个人去了兵马俑，回来的第二天，也就是留在陕西的最后一天，我去了她的学校。自从大学毕业之后，就再没有回到过大学课堂了，遇见了她的同学，她的老师，然后一起随便吃了一顿也就结束了在陕西的行程。唯一的意外应该是离开的时候，差点儿就赶不上离开的火车了，以及她们学校的厕所超级破，还不如我们村里面的茅坑。\n\n她是把我作为一个久别重逢的老同学来招待的，我也没有想太多，甚至中午的时候，她把我丢在一边跑去午休去了，是啊，那个时候谁会想到后面会发生那么多事情，也就是简简单单地一次相遇罢了，估计结束之后也不会有更多的交集，何必在意那么多呢。晚上我接到了我妈妈的电话，点名要吃凉粉，还被她吐槽。\n\n离别的来临，也没什么特别的伤感，也没什么特别的惊讶，蛮平淡的一天。但很意外地，离别的来临，我居然多了一丝留恋，说不清道不明，回味与遗忘开始有了冲突，故事也就有了开始。\n\n# 心结\n心结的答案呢？没有办法写出来，也无法知道写出来的究竟还是不是一个合格的心结。期待能够续写心结。或者说，这篇文章的第三部分，我不知道该怎么写，还是戛然而止吧。\n","slug":"相遇","published":1,"updated":"2018-06-12T16:31:14.025Z","layout":"post","photos":[],"link":"","_id":"cjr66widu001ymetpud8u2tdz","content":"<p>我是对的吗？我不止一次地问过自己这个问题，问题的出现源于多年来的心结，一个无法解开的心结。直到，一场突如其来的相遇，回答了我这个问题。<br><a id=\"more\"></a></p>\n<h1 id=\"再次相遇\"><a href=\"#再次相遇\" class=\"headerlink\" title=\"再次相遇\"></a>再次相遇</h1><p>因为公司解散，我选择短期内出去走走，于是，一次意外的相遇就这样开始了。知道她在西安读研，但是很多年没有见过，我不能确定，我还能否从人群里把她快速的识别出来。在过去的时间里，我对她的了解也不是很多，自从高二文理分班之后，仅有的交集也就仅限于因为源于几个相同朋友圈的交流，慢慢地就只是变成了微信朋友圈里的一个人。</p>\n<p>再次相遇，一起约在了陕西省历史博物馆，那天她比我早到了会儿，确切来说，是因为我迟到了，多年未见，第一次相约就迟到了，该是给别人留下多坏的印象啊。我记得那天她穿了一件很普通的毛衣，没有穿外套，好像是黄色的，还好我们还能相互认出来，寒暄了会儿就没有什么可说的话了。这就是一次普通的久别重逢，那个时候我心中关于工作、关于感情没有一件能坚持下去的，也没有一件能够让我炫耀的，阴郁始终伴随着我的那段时光，于是沉默寡言就变成了我的标配，而且因为刚从华山上下来，在山上冻了一晚上，还没有完全缓过来，状态也算不上很好。</p>\n<p>然后，逛了会儿博物馆，意外地我突然想开玩笑，有一个我自己记得特别深刻，就是到了一个被人们投了很多硬币的地方，其实我蛮讨厌别人乱投硬币的行为的，我对她开玩笑说，“来，让我们把这些硬币拿走吧，偷走别人的梦想，正好坐公交要投币”。她就一直笑我中二，笑了好长时间，看着她在笑，我也跟着笑了起来。哪怕是我每年都要聚会的那帮朋友，我都好久没有看到别人很开心地笑了，也好久没有被人逗笑了，这便成了我对她的第一次深刻印象。是啊，这句话是那么的中二，可是她的反应却让我意外，意外的惊喜，意外的意外。</p>\n<p>然后一起去逛碑林博物馆、钟楼、鼓楼、回民街，在鼓楼上，相会加对方的网易音乐的关注和微博，在搜网易音乐的时候是可以直接使用手机号加的，但是我的列表没有直接出现她，哪怕我给网易开了通讯录的权限，依然没有看到她，这就很尴尬了，约出来的是一个连相互的手机号都没有的人，她直接补了一句“好尴尬”，我把这句理解成了化解尴尬的意思，我不得已选择直接去通讯录复制手机号，证明我还是有她手机号的。“好尴尬”，变成了一件小事，已经过去了，但是给我留下了很深刻的印象，因为一般的女孩子都不会直接说对方很尴尬这种话的，尤其还是好久没有相遇的两个人，即便很尴尬，也不会直接说出来，我把这种行为理解成了直接坦率，这便成了我对她的第二个深刻印象。</p>\n<p>人和人之间，需要发生多少事情才算是彻底了解呢？也许一两次，也许一辈子，不一而足，无法界定。她做到只是自己生活中的样子，并不是特意做给谁看的，但是于我而言，意义就多了起来。</p>\n<h1 id=\"离别\"><a href=\"#离别\" class=\"headerlink\" title=\"离别\"></a>离别</h1><p>在和她再次相遇之后，因为她还要上课，所以我自己一个人去了兵马俑，回来的第二天，也就是留在陕西的最后一天，我去了她的学校。自从大学毕业之后，就再没有回到过大学课堂了，遇见了她的同学，她的老师，然后一起随便吃了一顿也就结束了在陕西的行程。唯一的意外应该是离开的时候，差点儿就赶不上离开的火车了，以及她们学校的厕所超级破，还不如我们村里面的茅坑。</p>\n<p>她是把我作为一个久别重逢的老同学来招待的，我也没有想太多，甚至中午的时候，她把我丢在一边跑去午休去了，是啊，那个时候谁会想到后面会发生那么多事情，也就是简简单单地一次相遇罢了，估计结束之后也不会有更多的交集，何必在意那么多呢。晚上我接到了我妈妈的电话，点名要吃凉粉，还被她吐槽。</p>\n<p>离别的来临，也没什么特别的伤感，也没什么特别的惊讶，蛮平淡的一天。但很意外地，离别的来临，我居然多了一丝留恋，说不清道不明，回味与遗忘开始有了冲突，故事也就有了开始。</p>\n<h1 id=\"心结\"><a href=\"#心结\" class=\"headerlink\" title=\"心结\"></a>心结</h1><p>心结的答案呢？没有办法写出来，也无法知道写出来的究竟还是不是一个合格的心结。期待能够续写心结。或者说，这篇文章的第三部分，我不知道该怎么写，还是戛然而止吧。</p>\n","excerpt":"<p>我是对的吗？我不止一次地问过自己这个问题，问题的出现源于多年来的心结，一个无法解开的心结。直到，一场突如其来的相遇，回答了我这个问题。<br>","more":"</p>\n<h1 id=\"再次相遇\"><a href=\"#再次相遇\" class=\"headerlink\" title=\"再次相遇\"></a>再次相遇</h1><p>因为公司解散，我选择短期内出去走走，于是，一次意外的相遇就这样开始了。知道她在西安读研，但是很多年没有见过，我不能确定，我还能否从人群里把她快速的识别出来。在过去的时间里，我对她的了解也不是很多，自从高二文理分班之后，仅有的交集也就仅限于因为源于几个相同朋友圈的交流，慢慢地就只是变成了微信朋友圈里的一个人。</p>\n<p>再次相遇，一起约在了陕西省历史博物馆，那天她比我早到了会儿，确切来说，是因为我迟到了，多年未见，第一次相约就迟到了，该是给别人留下多坏的印象啊。我记得那天她穿了一件很普通的毛衣，没有穿外套，好像是黄色的，还好我们还能相互认出来，寒暄了会儿就没有什么可说的话了。这就是一次普通的久别重逢，那个时候我心中关于工作、关于感情没有一件能坚持下去的，也没有一件能够让我炫耀的，阴郁始终伴随着我的那段时光，于是沉默寡言就变成了我的标配，而且因为刚从华山上下来，在山上冻了一晚上，还没有完全缓过来，状态也算不上很好。</p>\n<p>然后，逛了会儿博物馆，意外地我突然想开玩笑，有一个我自己记得特别深刻，就是到了一个被人们投了很多硬币的地方，其实我蛮讨厌别人乱投硬币的行为的，我对她开玩笑说，“来，让我们把这些硬币拿走吧，偷走别人的梦想，正好坐公交要投币”。她就一直笑我中二，笑了好长时间，看着她在笑，我也跟着笑了起来。哪怕是我每年都要聚会的那帮朋友，我都好久没有看到别人很开心地笑了，也好久没有被人逗笑了，这便成了我对她的第一次深刻印象。是啊，这句话是那么的中二，可是她的反应却让我意外，意外的惊喜，意外的意外。</p>\n<p>然后一起去逛碑林博物馆、钟楼、鼓楼、回民街，在鼓楼上，相会加对方的网易音乐的关注和微博，在搜网易音乐的时候是可以直接使用手机号加的，但是我的列表没有直接出现她，哪怕我给网易开了通讯录的权限，依然没有看到她，这就很尴尬了，约出来的是一个连相互的手机号都没有的人，她直接补了一句“好尴尬”，我把这句理解成了化解尴尬的意思，我不得已选择直接去通讯录复制手机号，证明我还是有她手机号的。“好尴尬”，变成了一件小事，已经过去了，但是给我留下了很深刻的印象，因为一般的女孩子都不会直接说对方很尴尬这种话的，尤其还是好久没有相遇的两个人，即便很尴尬，也不会直接说出来，我把这种行为理解成了直接坦率，这便成了我对她的第二个深刻印象。</p>\n<p>人和人之间，需要发生多少事情才算是彻底了解呢？也许一两次，也许一辈子，不一而足，无法界定。她做到只是自己生活中的样子，并不是特意做给谁看的，但是于我而言，意义就多了起来。</p>\n<h1 id=\"离别\"><a href=\"#离别\" class=\"headerlink\" title=\"离别\"></a>离别</h1><p>在和她再次相遇之后，因为她还要上课，所以我自己一个人去了兵马俑，回来的第二天，也就是留在陕西的最后一天，我去了她的学校。自从大学毕业之后，就再没有回到过大学课堂了，遇见了她的同学，她的老师，然后一起随便吃了一顿也就结束了在陕西的行程。唯一的意外应该是离开的时候，差点儿就赶不上离开的火车了，以及她们学校的厕所超级破，还不如我们村里面的茅坑。</p>\n<p>她是把我作为一个久别重逢的老同学来招待的，我也没有想太多，甚至中午的时候，她把我丢在一边跑去午休去了，是啊，那个时候谁会想到后面会发生那么多事情，也就是简简单单地一次相遇罢了，估计结束之后也不会有更多的交集，何必在意那么多呢。晚上我接到了我妈妈的电话，点名要吃凉粉，还被她吐槽。</p>\n<p>离别的来临，也没什么特别的伤感，也没什么特别的惊讶，蛮平淡的一天。但很意外地，离别的来临，我居然多了一丝留恋，说不清道不明，回味与遗忘开始有了冲突，故事也就有了开始。</p>\n<h1 id=\"心结\"><a href=\"#心结\" class=\"headerlink\" title=\"心结\"></a>心结</h1><p>心结的答案呢？没有办法写出来，也无法知道写出来的究竟还是不是一个合格的心结。期待能够续写心结。或者说，这篇文章的第三部分，我不知道该怎么写，还是戛然而止吧。</p>"},{"title":"花开有时，路遇白花","comments":0,"date":"2018-06-12T16:10:55.000Z","_content":"这又是一篇想了好久不知道要不要写下去的文章，总是带着那么多的问题前行，总是在实践中犯错，总是一片茫然，活着或者死去，这真的是一个问题吗？也许，忠于自己的内心应该有一个肯定的答案，可是这个肯定的答案我是否还有必要再肯定一次呢？\n<!--more-->\n近来换了工作，如果在去年十月份我就决定换工作的话，也许会比现在好很多，但是，世间没有那么多的也许，也没有那么多的重来，仔细思考当然的决策，当时是为图一个长期的发展，虽然当时公司已然颓势尽显，但我还是决定观察一段时间。当时的决策，换来的不过是今年4月份的离职。\n\n离职之后的5月初回去参加同学的婚礼，然后开着车玩了有半个月的时间，该想清楚的问题，我真的想清楚了吗？该作的决定，我真的下定决心了吗？艰难困苦，生活本就是一场修炼，最近在看一本神书《程序员之禅》，你能想到把程序员和禅修结合起来吗？你能想到这一个德国人写的关于程序员禅修的书吗？难以置信，对不对？是的，我买了，这就是一种冲动，一种最原始的冲动，人生来就是一场苦修，苦修是没有尽头的，路有千变，花各相同，问清楚自己到底想要的是什么。\n\n说来惭愧，我无数次地问自己这个问题，我到底想要什么。我想要的其实很简单，一杯简单粗茶，一本薄薄的书纸，一把走遍天涯的锈刀，这就是我想要的生活，但是这样的生活是有代价的，出世和入世中，入世应该挡在前面，没有历经千辛的繁华，怎了解薄如淡水的出世？当我终于想通了这个问题的时候，不知觉间尽长出一口气，是啊，入世更比出世难。\n\n这是去年，我在公司里合同到期时写的总结：\n>一年的时光总是很短暂，从刚开始的寥寥数人到现在的人才济济。一年的时间里，从刚开始APP上的一无所有演变到现在拥有一个稳定的版本，团队成员之间一起努力，共同进步。一年间有很多人离开，也有很多人加入，坚持下来的和新加入我们的都是对这个团队保有期望的人，也希望自己怀着一种不要让这个团队失望、不要让这个团队碌碌无为的心态继续走下去。\n我们身处在一个不断变化的市场，逼迫着我们更快的前进、更快的提高自己，除了死亡不会有任何东西会一直等着你，抓紧时间学习、不断适应变化才是生存下来最佳的办法。\n一年的时间里，APP开发、相互之间的争吵、面试各种技术问题、转化思考问题的维度、面对质疑、面临挑战、维护一个技术人的尊严，时间总是那么短，要做的事情总是那么多。压力，责难，阻碍，人终究是要成长的，每天发生的事都是一个成长的脚印，走下去，柳暗花明。\n\n现在回头看这段写在续签合同时的工作总结，生活真的是一个圆圈啊，到了终点，也留在了起点。说来，我是一个有野心的人，这种野心时而很强大，时而不知所措，繁华世界何处立足？花开有时，前行的路总是磕磕绊绊的，flag我就不乱立了。新买的书又到了，新的文章题库又放了好多，什么时候补完这些新书，什么时候补完这些文章，问自己，问众生，问无物。\n\n---\n>valar morghulis\n","source":"_posts/花开有时，路遇白花.md","raw":"---\ntitle: 花开有时，路遇白花\ntags: 随笔\ncomments: false\ncategories: 随笔\ndate: 2018-06-13 00:10:55\n---\n这又是一篇想了好久不知道要不要写下去的文章，总是带着那么多的问题前行，总是在实践中犯错，总是一片茫然，活着或者死去，这真的是一个问题吗？也许，忠于自己的内心应该有一个肯定的答案，可是这个肯定的答案我是否还有必要再肯定一次呢？\n<!--more-->\n近来换了工作，如果在去年十月份我就决定换工作的话，也许会比现在好很多，但是，世间没有那么多的也许，也没有那么多的重来，仔细思考当然的决策，当时是为图一个长期的发展，虽然当时公司已然颓势尽显，但我还是决定观察一段时间。当时的决策，换来的不过是今年4月份的离职。\n\n离职之后的5月初回去参加同学的婚礼，然后开着车玩了有半个月的时间，该想清楚的问题，我真的想清楚了吗？该作的决定，我真的下定决心了吗？艰难困苦，生活本就是一场修炼，最近在看一本神书《程序员之禅》，你能想到把程序员和禅修结合起来吗？你能想到这一个德国人写的关于程序员禅修的书吗？难以置信，对不对？是的，我买了，这就是一种冲动，一种最原始的冲动，人生来就是一场苦修，苦修是没有尽头的，路有千变，花各相同，问清楚自己到底想要的是什么。\n\n说来惭愧，我无数次地问自己这个问题，我到底想要什么。我想要的其实很简单，一杯简单粗茶，一本薄薄的书纸，一把走遍天涯的锈刀，这就是我想要的生活，但是这样的生活是有代价的，出世和入世中，入世应该挡在前面，没有历经千辛的繁华，怎了解薄如淡水的出世？当我终于想通了这个问题的时候，不知觉间尽长出一口气，是啊，入世更比出世难。\n\n这是去年，我在公司里合同到期时写的总结：\n>一年的时光总是很短暂，从刚开始的寥寥数人到现在的人才济济。一年的时间里，从刚开始APP上的一无所有演变到现在拥有一个稳定的版本，团队成员之间一起努力，共同进步。一年间有很多人离开，也有很多人加入，坚持下来的和新加入我们的都是对这个团队保有期望的人，也希望自己怀着一种不要让这个团队失望、不要让这个团队碌碌无为的心态继续走下去。\n我们身处在一个不断变化的市场，逼迫着我们更快的前进、更快的提高自己，除了死亡不会有任何东西会一直等着你，抓紧时间学习、不断适应变化才是生存下来最佳的办法。\n一年的时间里，APP开发、相互之间的争吵、面试各种技术问题、转化思考问题的维度、面对质疑、面临挑战、维护一个技术人的尊严，时间总是那么短，要做的事情总是那么多。压力，责难，阻碍，人终究是要成长的，每天发生的事都是一个成长的脚印，走下去，柳暗花明。\n\n现在回头看这段写在续签合同时的工作总结，生活真的是一个圆圈啊，到了终点，也留在了起点。说来，我是一个有野心的人，这种野心时而很强大，时而不知所措，繁华世界何处立足？花开有时，前行的路总是磕磕绊绊的，flag我就不乱立了。新买的书又到了，新的文章题库又放了好多，什么时候补完这些新书，什么时候补完这些文章，问自己，问众生，问无物。\n\n---\n>valar morghulis\n","slug":"花开有时，路遇白花","published":1,"updated":"2018-06-12T16:12:34.315Z","layout":"post","photos":[],"link":"","_id":"cjr66widy0021metpxhkewklg","content":"<p>这又是一篇想了好久不知道要不要写下去的文章，总是带着那么多的问题前行，总是在实践中犯错，总是一片茫然，活着或者死去，这真的是一个问题吗？也许，忠于自己的内心应该有一个肯定的答案，可是这个肯定的答案我是否还有必要再肯定一次呢？<br><a id=\"more\"></a><br>近来换了工作，如果在去年十月份我就决定换工作的话，也许会比现在好很多，但是，世间没有那么多的也许，也没有那么多的重来，仔细思考当然的决策，当时是为图一个长期的发展，虽然当时公司已然颓势尽显，但我还是决定观察一段时间。当时的决策，换来的不过是今年4月份的离职。</p>\n<p>离职之后的5月初回去参加同学的婚礼，然后开着车玩了有半个月的时间，该想清楚的问题，我真的想清楚了吗？该作的决定，我真的下定决心了吗？艰难困苦，生活本就是一场修炼，最近在看一本神书《程序员之禅》，你能想到把程序员和禅修结合起来吗？你能想到这一个德国人写的关于程序员禅修的书吗？难以置信，对不对？是的，我买了，这就是一种冲动，一种最原始的冲动，人生来就是一场苦修，苦修是没有尽头的，路有千变，花各相同，问清楚自己到底想要的是什么。</p>\n<p>说来惭愧，我无数次地问自己这个问题，我到底想要什么。我想要的其实很简单，一杯简单粗茶，一本薄薄的书纸，一把走遍天涯的锈刀，这就是我想要的生活，但是这样的生活是有代价的，出世和入世中，入世应该挡在前面，没有历经千辛的繁华，怎了解薄如淡水的出世？当我终于想通了这个问题的时候，不知觉间尽长出一口气，是啊，入世更比出世难。</p>\n<p>这是去年，我在公司里合同到期时写的总结：</p>\n<blockquote>\n<p>一年的时光总是很短暂，从刚开始的寥寥数人到现在的人才济济。一年的时间里，从刚开始APP上的一无所有演变到现在拥有一个稳定的版本，团队成员之间一起努力，共同进步。一年间有很多人离开，也有很多人加入，坚持下来的和新加入我们的都是对这个团队保有期望的人，也希望自己怀着一种不要让这个团队失望、不要让这个团队碌碌无为的心态继续走下去。<br>我们身处在一个不断变化的市场，逼迫着我们更快的前进、更快的提高自己，除了死亡不会有任何东西会一直等着你，抓紧时间学习、不断适应变化才是生存下来最佳的办法。<br>一年的时间里，APP开发、相互之间的争吵、面试各种技术问题、转化思考问题的维度、面对质疑、面临挑战、维护一个技术人的尊严，时间总是那么短，要做的事情总是那么多。压力，责难，阻碍，人终究是要成长的，每天发生的事都是一个成长的脚印，走下去，柳暗花明。</p>\n</blockquote>\n<p>现在回头看这段写在续签合同时的工作总结，生活真的是一个圆圈啊，到了终点，也留在了起点。说来，我是一个有野心的人，这种野心时而很强大，时而不知所措，繁华世界何处立足？花开有时，前行的路总是磕磕绊绊的，flag我就不乱立了。新买的书又到了，新的文章题库又放了好多，什么时候补完这些新书，什么时候补完这些文章，问自己，问众生，问无物。</p>\n<hr>\n<blockquote>\n<p>valar morghulis</p>\n</blockquote>\n","excerpt":"<p>这又是一篇想了好久不知道要不要写下去的文章，总是带着那么多的问题前行，总是在实践中犯错，总是一片茫然，活着或者死去，这真的是一个问题吗？也许，忠于自己的内心应该有一个肯定的答案，可是这个肯定的答案我是否还有必要再肯定一次呢？<br>","more":"<br>近来换了工作，如果在去年十月份我就决定换工作的话，也许会比现在好很多，但是，世间没有那么多的也许，也没有那么多的重来，仔细思考当然的决策，当时是为图一个长期的发展，虽然当时公司已然颓势尽显，但我还是决定观察一段时间。当时的决策，换来的不过是今年4月份的离职。</p>\n<p>离职之后的5月初回去参加同学的婚礼，然后开着车玩了有半个月的时间，该想清楚的问题，我真的想清楚了吗？该作的决定，我真的下定决心了吗？艰难困苦，生活本就是一场修炼，最近在看一本神书《程序员之禅》，你能想到把程序员和禅修结合起来吗？你能想到这一个德国人写的关于程序员禅修的书吗？难以置信，对不对？是的，我买了，这就是一种冲动，一种最原始的冲动，人生来就是一场苦修，苦修是没有尽头的，路有千变，花各相同，问清楚自己到底想要的是什么。</p>\n<p>说来惭愧，我无数次地问自己这个问题，我到底想要什么。我想要的其实很简单，一杯简单粗茶，一本薄薄的书纸，一把走遍天涯的锈刀，这就是我想要的生活，但是这样的生活是有代价的，出世和入世中，入世应该挡在前面，没有历经千辛的繁华，怎了解薄如淡水的出世？当我终于想通了这个问题的时候，不知觉间尽长出一口气，是啊，入世更比出世难。</p>\n<p>这是去年，我在公司里合同到期时写的总结：</p>\n<blockquote>\n<p>一年的时光总是很短暂，从刚开始的寥寥数人到现在的人才济济。一年的时间里，从刚开始APP上的一无所有演变到现在拥有一个稳定的版本，团队成员之间一起努力，共同进步。一年间有很多人离开，也有很多人加入，坚持下来的和新加入我们的都是对这个团队保有期望的人，也希望自己怀着一种不要让这个团队失望、不要让这个团队碌碌无为的心态继续走下去。<br>我们身处在一个不断变化的市场，逼迫着我们更快的前进、更快的提高自己，除了死亡不会有任何东西会一直等着你，抓紧时间学习、不断适应变化才是生存下来最佳的办法。<br>一年的时间里，APP开发、相互之间的争吵、面试各种技术问题、转化思考问题的维度、面对质疑、面临挑战、维护一个技术人的尊严，时间总是那么短，要做的事情总是那么多。压力，责难，阻碍，人终究是要成长的，每天发生的事都是一个成长的脚印，走下去，柳暗花明。</p>\n</blockquote>\n<p>现在回头看这段写在续签合同时的工作总结，生活真的是一个圆圈啊，到了终点，也留在了起点。说来，我是一个有野心的人，这种野心时而很强大，时而不知所措，繁华世界何处立足？花开有时，前行的路总是磕磕绊绊的，flag我就不乱立了。新买的书又到了，新的文章题库又放了好多，什么时候补完这些新书，什么时候补完这些文章，问自己，问众生，问无物。</p>\n<hr>\n<blockquote>\n<p>valar morghulis</p>\n</blockquote>"},{"title":"Android共享元素","date":"2018-06-22T06:10:28.000Z","comments":0,"_content":"在这里记录一下android共享元素的方法，踩了满多坑的，其实蛮简单的，Android共享是从Android5.0开始提供的，之前的版本我没有去碰兼容，但是其实是有解决方法的。这里只是记录一下踩过的坑，不对共享元素做深入的分析。\n\n<!--more-->\n首先从页面A跳转到页面B，那么页面A只需要调用\n```kotlin\nActivityCompat.startActivity(context, intent, ActivityOptionsCompat.makeSceneTransitionAnimation(context, view, \"zoomImageView\").toBundle())\n```\n需要注意的是，需要传入要共享的view和共享view的transitionName的。然后在页面B对要共享的view设置一样的transitionName就好了。\n\n踩过坑，如果使用的是fresco的话，在页面被销毁的情况下，需要让view保持在页面上。\n```kotlin\nActivityCompat.setExitSharedElementCallback(context, object : SharedElementCallback() {\n                    override fun onSharedElementEnd(sharedElementNames: List<String>?,\n                                                    sharedElements: MutableList<View>?, sharedElementSnapshots: MutableList<View>?) {\n                        super.onSharedElementEnd(sharedElementNames, sharedElements, sharedElementSnapshots)\n                        for (view in sharedElements!!) {\n                            if (view is SimpleDraweeView) {\n                                view.show()\n                            }\n                        }\n                    }\n                })\n```\n如果还是不行的话，在页面B的onCreate添加如下代码就可以了，话说fresco还是蛮反人类的，各种奇怪的问题。\n```kotlin\nif (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {\n         window.sharedElementEnterTransition = AutoTransition() // 进入\n         window.sharedElementReturnTransition = AutoTransition()// 返回\n         ActivityCompat.setEnterSharedElementCallback(this, object : SharedElementCallback() {\n             override fun onSharedElementEnd(sharedElementNames: List<String>?,\n                                             sharedElements: List<View>?, sharedElementSnapshots: List<View>?) {\n                 for (view in sharedElements!!) {\n                     if (view is PhotoDraweeView) {\n                         (view as PhotoDraweeView).setScale(1f, true)\n                     }\n                 }\n             }\n         })\n     }\n```\n要想在结束的时候依然能够有共享元素的动画效果，需要调用的是\n``` kotlin  \nfinishAfterTransition()\n```\n\n如果需要在页面B退出的时候，回调结果像`startActivityForResult`一样的话，需要的在`finishAfterTransition`方法之后，去调用`setResult`，在页面B的代码如下\n```kotlin\noverride fun finishAfterTransition() {\n      val resultData = Intent()\n      resultData.putExtra(CURRENT_ITEM,“要回调的值”)\n      setResult(Activity.RESULT_OK, resultData)\n      super.finishAfterTransition()\n   }\n```\n在页面A接受的方法是，需要注意的是，如果是fragment的话，是没有`onActivityReenter`方法的，不过你可以选择自定义一个接口，然后在下面的代码调用它\n```kotlin\noverride fun onActivityReenter(resultCode: Int, data: Intent) {\n     super.onActivityReenter(resultCode, data)\n     val list = supportFragmentManager.fragments\n     list.forEach {\n         if (it is MyFragment) {\n             it.onReenter(resultCode, data)\n         }\n     }\n }\n\n//MyFragment中定义的方法\n open fun onReenter(resultCode: Int, data: Intent) {\n   }\n```\n\n差不多就是这些吧，这些就能满足基本的共享元素动画了。需要注意的是，一定要设置正确的transitionName。\n还有一个fresco的坑，如果发现回到页面A的时候共享元素消失了话，可以设置\n```\nsetLegacyVisibilityHandlingEnabled(true)\n```\n这是fresco1.4添加的关于共享u元素的bug修复。\n\n贴一个我觉得做的不错的\n- https://github.com/kitek/android-gallery.git\n- https://github.com/ongakuer/PhotoDraweeView\n\n对于我，因为第二页使用的是ViewPager，导致因为ViewPgaer的缓存问题每次返回的item都不对，所以我直接把transitionName设置到ViewPager上就好了，虽然这不是最佳的解决方案，但是也解决问题了。\n","source":"_posts/SharedElement.md","raw":"---\ntitle: Android共享元素\ndate: 2018-06-22 14:10:28\ntags: Android\ncomments: false\n---\n在这里记录一下android共享元素的方法，踩了满多坑的，其实蛮简单的，Android共享是从Android5.0开始提供的，之前的版本我没有去碰兼容，但是其实是有解决方法的。这里只是记录一下踩过的坑，不对共享元素做深入的分析。\n\n<!--more-->\n首先从页面A跳转到页面B，那么页面A只需要调用\n```kotlin\nActivityCompat.startActivity(context, intent, ActivityOptionsCompat.makeSceneTransitionAnimation(context, view, \"zoomImageView\").toBundle())\n```\n需要注意的是，需要传入要共享的view和共享view的transitionName的。然后在页面B对要共享的view设置一样的transitionName就好了。\n\n踩过坑，如果使用的是fresco的话，在页面被销毁的情况下，需要让view保持在页面上。\n```kotlin\nActivityCompat.setExitSharedElementCallback(context, object : SharedElementCallback() {\n                    override fun onSharedElementEnd(sharedElementNames: List<String>?,\n                                                    sharedElements: MutableList<View>?, sharedElementSnapshots: MutableList<View>?) {\n                        super.onSharedElementEnd(sharedElementNames, sharedElements, sharedElementSnapshots)\n                        for (view in sharedElements!!) {\n                            if (view is SimpleDraweeView) {\n                                view.show()\n                            }\n                        }\n                    }\n                })\n```\n如果还是不行的话，在页面B的onCreate添加如下代码就可以了，话说fresco还是蛮反人类的，各种奇怪的问题。\n```kotlin\nif (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {\n         window.sharedElementEnterTransition = AutoTransition() // 进入\n         window.sharedElementReturnTransition = AutoTransition()// 返回\n         ActivityCompat.setEnterSharedElementCallback(this, object : SharedElementCallback() {\n             override fun onSharedElementEnd(sharedElementNames: List<String>?,\n                                             sharedElements: List<View>?, sharedElementSnapshots: List<View>?) {\n                 for (view in sharedElements!!) {\n                     if (view is PhotoDraweeView) {\n                         (view as PhotoDraweeView).setScale(1f, true)\n                     }\n                 }\n             }\n         })\n     }\n```\n要想在结束的时候依然能够有共享元素的动画效果，需要调用的是\n``` kotlin  \nfinishAfterTransition()\n```\n\n如果需要在页面B退出的时候，回调结果像`startActivityForResult`一样的话，需要的在`finishAfterTransition`方法之后，去调用`setResult`，在页面B的代码如下\n```kotlin\noverride fun finishAfterTransition() {\n      val resultData = Intent()\n      resultData.putExtra(CURRENT_ITEM,“要回调的值”)\n      setResult(Activity.RESULT_OK, resultData)\n      super.finishAfterTransition()\n   }\n```\n在页面A接受的方法是，需要注意的是，如果是fragment的话，是没有`onActivityReenter`方法的，不过你可以选择自定义一个接口，然后在下面的代码调用它\n```kotlin\noverride fun onActivityReenter(resultCode: Int, data: Intent) {\n     super.onActivityReenter(resultCode, data)\n     val list = supportFragmentManager.fragments\n     list.forEach {\n         if (it is MyFragment) {\n             it.onReenter(resultCode, data)\n         }\n     }\n }\n\n//MyFragment中定义的方法\n open fun onReenter(resultCode: Int, data: Intent) {\n   }\n```\n\n差不多就是这些吧，这些就能满足基本的共享元素动画了。需要注意的是，一定要设置正确的transitionName。\n还有一个fresco的坑，如果发现回到页面A的时候共享元素消失了话，可以设置\n```\nsetLegacyVisibilityHandlingEnabled(true)\n```\n这是fresco1.4添加的关于共享u元素的bug修复。\n\n贴一个我觉得做的不错的\n- https://github.com/kitek/android-gallery.git\n- https://github.com/ongakuer/PhotoDraweeView\n\n对于我，因为第二页使用的是ViewPager，导致因为ViewPgaer的缓存问题每次返回的item都不对，所以我直接把transitionName设置到ViewPager上就好了，虽然这不是最佳的解决方案，但是也解决问题了。\n","slug":"SharedElement","published":1,"updated":"2018-06-25T04:27:40.382Z","layout":"post","photos":[],"link":"","_id":"cjr66wie00025metp7g8iehdz","content":"<p>在这里记录一下android共享元素的方法，踩了满多坑的，其实蛮简单的，Android共享是从Android5.0开始提供的，之前的版本我没有去碰兼容，但是其实是有解决方法的。这里只是记录一下踩过的坑，不对共享元素做深入的分析。</p>\n<a id=\"more\"></a>\n<p>首先从页面A跳转到页面B，那么页面A只需要调用<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ActivityCompat.startActivity(context, intent, ActivityOptionsCompat.makeSceneTransitionAnimation(context, view, <span class=\"string\">\"zoomImageView\"</span>).toBundle())</div></pre></td></tr></table></figure></p>\n<p>需要注意的是，需要传入要共享的view和共享view的transitionName的。然后在页面B对要共享的view设置一样的transitionName就好了。</p>\n<p>踩过坑，如果使用的是fresco的话，在页面被销毁的情况下，需要让view保持在页面上。<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">ActivityCompat.setExitSharedElementCallback(context, <span class=\"keyword\">object</span> : SharedElementCallback() &#123;</div><div class=\"line\">                    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onSharedElementEnd</span><span class=\"params\">(sharedElementNames: <span class=\"type\">List</span>&lt;<span class=\"type\">String</span>&gt;?,</span></span></div><div class=\"line\">                                                    sharedElements: <span class=\"type\">MutableList</span>&lt;<span class=\"type\">View</span>&gt;?, sharedElementSnapshots: <span class=\"type\">MutableList</span>&lt;<span class=\"type\">View</span>&gt;?) &#123;</div><div class=\"line\">                        <span class=\"keyword\">super</span>.onSharedElementEnd(sharedElementNames, sharedElements, sharedElementSnapshots)</div><div class=\"line\">                        <span class=\"keyword\">for</span> (view <span class=\"keyword\">in</span> sharedElements!!) &#123;</div><div class=\"line\">                            <span class=\"keyword\">if</span> (view <span class=\"keyword\">is</span> SimpleDraweeView) &#123;</div><div class=\"line\">                                view.show()</div><div class=\"line\">                            &#125;</div><div class=\"line\">                        &#125;</div><div class=\"line\">                    &#125;</div><div class=\"line\">                &#125;)</div></pre></td></tr></table></figure></p>\n<p>如果还是不行的话，在页面B的onCreate添加如下代码就可以了，话说fresco还是蛮反人类的，各种奇怪的问题。<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123;</div><div class=\"line\">         window.sharedElementEnterTransition = AutoTransition() <span class=\"comment\">// 进入</span></div><div class=\"line\">         window.sharedElementReturnTransition = AutoTransition()<span class=\"comment\">// 返回</span></div><div class=\"line\">         ActivityCompat.setEnterSharedElementCallback(<span class=\"keyword\">this</span>, <span class=\"keyword\">object</span> : SharedElementCallback() &#123;</div><div class=\"line\">             <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onSharedElementEnd</span><span class=\"params\">(sharedElementNames: <span class=\"type\">List</span>&lt;<span class=\"type\">String</span>&gt;?,</span></span></div><div class=\"line\">                                             sharedElements: <span class=\"type\">List</span>&lt;<span class=\"type\">View</span>&gt;?, sharedElementSnapshots: <span class=\"type\">List</span>&lt;<span class=\"type\">View</span>&gt;?) &#123;</div><div class=\"line\">                 <span class=\"keyword\">for</span> (view <span class=\"keyword\">in</span> sharedElements!!) &#123;</div><div class=\"line\">                     <span class=\"keyword\">if</span> (view <span class=\"keyword\">is</span> PhotoDraweeView) &#123;</div><div class=\"line\">                         (view <span class=\"keyword\">as</span> PhotoDraweeView).setScale(<span class=\"number\">1</span>f, <span class=\"literal\">true</span>)</div><div class=\"line\">                     &#125;</div><div class=\"line\">                 &#125;</div><div class=\"line\">             &#125;</div><div class=\"line\">         &#125;)</div><div class=\"line\">     &#125;</div></pre></td></tr></table></figure></p>\n<p>要想在结束的时候依然能够有共享元素的动画效果，需要调用的是<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">finishAfterTransition()</div></pre></td></tr></table></figure></p>\n<p>如果需要在页面B退出的时候，回调结果像<code>startActivityForResult</code>一样的话，需要的在<code>finishAfterTransition</code>方法之后，去调用<code>setResult</code>，在页面B的代码如下<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">finishAfterTransition</span><span class=\"params\">()</span></span> &#123;</div><div class=\"line\">      <span class=\"keyword\">val</span> resultData = Intent()</div><div class=\"line\">      resultData.putExtra(CURRENT_ITEM,“要回调的值”)</div><div class=\"line\">      setResult(Activity.RESULT_OK, resultData)</div><div class=\"line\">      <span class=\"keyword\">super</span>.finishAfterTransition()</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure></p>\n<p>在页面A接受的方法是，需要注意的是，如果是fragment的话，是没有<code>onActivityReenter</code>方法的，不过你可以选择自定义一个接口，然后在下面的代码调用它<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityReenter</span><span class=\"params\">(resultCode: <span class=\"type\">Int</span>, <span class=\"keyword\">data</span>: <span class=\"type\">Intent</span>)</span></span> &#123;</div><div class=\"line\">     <span class=\"keyword\">super</span>.onActivityReenter(resultCode, <span class=\"keyword\">data</span>)</div><div class=\"line\">     <span class=\"keyword\">val</span> list = supportFragmentManager.fragments</div><div class=\"line\">     list.forEach &#123;</div><div class=\"line\">         <span class=\"keyword\">if</span> (it <span class=\"keyword\">is</span> MyFragment) &#123;</div><div class=\"line\">             it.onReenter(resultCode, <span class=\"keyword\">data</span>)</div><div class=\"line\">         &#125;</div><div class=\"line\">     &#125;</div><div class=\"line\"> &#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//MyFragment中定义的方法</span></div><div class=\"line\"> <span class=\"keyword\">open</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onReenter</span><span class=\"params\">(resultCode: <span class=\"type\">Int</span>, <span class=\"keyword\">data</span>: <span class=\"type\">Intent</span>)</span></span> &#123;</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure></p>\n<p>差不多就是这些吧，这些就能满足基本的共享元素动画了。需要注意的是，一定要设置正确的transitionName。<br>还有一个fresco的坑，如果发现回到页面A的时候共享元素消失了话，可以设置<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">setLegacyVisibilityHandlingEnabled(true)</div></pre></td></tr></table></figure></p>\n<p>这是fresco1.4添加的关于共享u元素的bug修复。</p>\n<p>贴一个我觉得做的不错的</p>\n<ul>\n<li><a href=\"https://github.com/kitek/android-gallery.git\" target=\"_blank\" rel=\"external\">https://github.com/kitek/android-gallery.git</a></li>\n<li><a href=\"https://github.com/ongakuer/PhotoDraweeView\" target=\"_blank\" rel=\"external\">https://github.com/ongakuer/PhotoDraweeView</a></li>\n</ul>\n<p>对于我，因为第二页使用的是ViewPager，导致因为ViewPgaer的缓存问题每次返回的item都不对，所以我直接把transitionName设置到ViewPager上就好了，虽然这不是最佳的解决方案，但是也解决问题了。</p>\n","excerpt":"<p>在这里记录一下android共享元素的方法，踩了满多坑的，其实蛮简单的，Android共享是从Android5.0开始提供的，之前的版本我没有去碰兼容，但是其实是有解决方法的。这里只是记录一下踩过的坑，不对共享元素做深入的分析。</p>","more":"<p>首先从页面A跳转到页面B，那么页面A只需要调用<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ActivityCompat.startActivity(context, intent, ActivityOptionsCompat.makeSceneTransitionAnimation(context, view, <span class=\"string\">\"zoomImageView\"</span>).toBundle())</div></pre></td></tr></table></figure></p>\n<p>需要注意的是，需要传入要共享的view和共享view的transitionName的。然后在页面B对要共享的view设置一样的transitionName就好了。</p>\n<p>踩过坑，如果使用的是fresco的话，在页面被销毁的情况下，需要让view保持在页面上。<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">ActivityCompat.setExitSharedElementCallback(context, <span class=\"keyword\">object</span> : SharedElementCallback() &#123;</div><div class=\"line\">                    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onSharedElementEnd</span><span class=\"params\">(sharedElementNames: <span class=\"type\">List</span>&lt;<span class=\"type\">String</span>&gt;?,</div><div class=\"line\">                                                    sharedElements: <span class=\"type\">MutableList</span>&lt;<span class=\"type\">View</span>&gt;?, sharedElementSnapshots: <span class=\"type\">MutableList</span>&lt;<span class=\"type\">View</span>&gt;?)</span></span> &#123;</div><div class=\"line\">                        <span class=\"keyword\">super</span>.onSharedElementEnd(sharedElementNames, sharedElements, sharedElementSnapshots)</div><div class=\"line\">                        <span class=\"keyword\">for</span> (view <span class=\"keyword\">in</span> sharedElements!!) &#123;</div><div class=\"line\">                            <span class=\"keyword\">if</span> (view <span class=\"keyword\">is</span> SimpleDraweeView) &#123;</div><div class=\"line\">                                view.show()</div><div class=\"line\">                            &#125;</div><div class=\"line\">                        &#125;</div><div class=\"line\">                    &#125;</div><div class=\"line\">                &#125;)</div></pre></td></tr></table></figure></p>\n<p>如果还是不行的话，在页面B的onCreate添加如下代码就可以了，话说fresco还是蛮反人类的，各种奇怪的问题。<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123;</div><div class=\"line\">         window.sharedElementEnterTransition = AutoTransition() <span class=\"comment\">// 进入</span></div><div class=\"line\">         window.sharedElementReturnTransition = AutoTransition()<span class=\"comment\">// 返回</span></div><div class=\"line\">         ActivityCompat.setEnterSharedElementCallback(<span class=\"keyword\">this</span>, <span class=\"keyword\">object</span> : SharedElementCallback() &#123;</div><div class=\"line\">             <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onSharedElementEnd</span><span class=\"params\">(sharedElementNames: <span class=\"type\">List</span>&lt;<span class=\"type\">String</span>&gt;?,</div><div class=\"line\">                                             sharedElements: <span class=\"type\">List</span>&lt;<span class=\"type\">View</span>&gt;?, sharedElementSnapshots: <span class=\"type\">List</span>&lt;<span class=\"type\">View</span>&gt;?)</span></span> &#123;</div><div class=\"line\">                 <span class=\"keyword\">for</span> (view <span class=\"keyword\">in</span> sharedElements!!) &#123;</div><div class=\"line\">                     <span class=\"keyword\">if</span> (view <span class=\"keyword\">is</span> PhotoDraweeView) &#123;</div><div class=\"line\">                         (view <span class=\"keyword\">as</span> PhotoDraweeView).setScale(<span class=\"number\">1</span>f, <span class=\"literal\">true</span>)</div><div class=\"line\">                     &#125;</div><div class=\"line\">                 &#125;</div><div class=\"line\">             &#125;</div><div class=\"line\">         &#125;)</div><div class=\"line\">     &#125;</div></pre></td></tr></table></figure></p>\n<p>要想在结束的时候依然能够有共享元素的动画效果，需要调用的是<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">finishAfterTransition()</div></pre></td></tr></table></figure></p>\n<p>如果需要在页面B退出的时候，回调结果像<code>startActivityForResult</code>一样的话，需要的在<code>finishAfterTransition</code>方法之后，去调用<code>setResult</code>，在页面B的代码如下<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">finishAfterTransition</span><span class=\"params\">()</span></span> &#123;</div><div class=\"line\">      <span class=\"keyword\">val</span> resultData = Intent()</div><div class=\"line\">      resultData.putExtra(CURRENT_ITEM,“要回调的值”)</div><div class=\"line\">      setResult(Activity.RESULT_OK, resultData)</div><div class=\"line\">      <span class=\"keyword\">super</span>.finishAfterTransition()</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure></p>\n<p>在页面A接受的方法是，需要注意的是，如果是fragment的话，是没有<code>onActivityReenter</code>方法的，不过你可以选择自定义一个接口，然后在下面的代码调用它<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityReenter</span><span class=\"params\">(resultCode: <span class=\"type\">Int</span>, <span class=\"keyword\">data</span>: <span class=\"type\">Intent</span>)</span></span> &#123;</div><div class=\"line\">     <span class=\"keyword\">super</span>.onActivityReenter(resultCode, <span class=\"keyword\">data</span>)</div><div class=\"line\">     <span class=\"keyword\">val</span> list = supportFragmentManager.fragments</div><div class=\"line\">     list.forEach &#123;</div><div class=\"line\">         <span class=\"keyword\">if</span> (it <span class=\"keyword\">is</span> MyFragment) &#123;</div><div class=\"line\">             it.onReenter(resultCode, <span class=\"keyword\">data</span>)</div><div class=\"line\">         &#125;</div><div class=\"line\">     &#125;</div><div class=\"line\"> &#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//MyFragment中定义的方法</span></div><div class=\"line\"> <span class=\"keyword\">open</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onReenter</span><span class=\"params\">(resultCode: <span class=\"type\">Int</span>, <span class=\"keyword\">data</span>: <span class=\"type\">Intent</span>)</span></span> &#123;</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure></p>\n<p>差不多就是这些吧，这些就能满足基本的共享元素动画了。需要注意的是，一定要设置正确的transitionName。<br>还有一个fresco的坑，如果发现回到页面A的时候共享元素消失了话，可以设置<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">setLegacyVisibilityHandlingEnabled(true)</div></pre></td></tr></table></figure></p>\n<p>这是fresco1.4添加的关于共享u元素的bug修复。</p>\n<p>贴一个我觉得做的不错的</p>\n<ul>\n<li><a href=\"https://github.com/kitek/android-gallery.git\">https://github.com/kitek/android-gallery.git</a></li>\n<li><a href=\"https://github.com/ongakuer/PhotoDraweeView\">https://github.com/ongakuer/PhotoDraweeView</a></li>\n</ul>\n<p>对于我，因为第二页使用的是ViewPager，导致因为ViewPgaer的缓存问题每次返回的item都不对，所以我直接把transitionName设置到ViewPager上就好了，虽然这不是最佳的解决方案，但是也解决问题了。</p>"},{"title":"Android上的生命周期监控","comments":0,"date":"2018-07-23T05:36:11.000Z","_content":"做Android开发总是避免不了要处理各种生命周期，那么有没有什么优雅的方法呢？现在我就记录几种方法。\n<!-- more -->\n# Lifecycle  \n`Lifecycle`是Google在[Jetpack](https://developer.android.google.cn/jetpack/)中提出的，在包[`android.arch.lifecycle`](https://developer.android.com/reference/android/arch/lifecycle/package-summary.html)下面，如果使用的是suppor包中的SupportActivity或者FragmentActivity已经继承了Lifecycle。使用的方法如下：\n```kotlin\nclass myFragmentActivity(val fragmentActivity: FragmentActivity) : LifecycleObserver {\n    init {\n     //在这里注册一下\n      fragmentActivity.lifecycle.addObserver(this)\n    }\n    @OnLifecycleEvent(Lifecycle.Event.ON_RESUME)\n    fun onResume(){\n        Timber.tag(\"xx\").i(\"ON_RESUME\")\n    }\n    @OnLifecycleEvent(Lifecycle.Event.ON_PAUSE)\n    fun onPause(){\n        Timber.tag(\"xx\").i(\"ON_PAUSE\")\n    }\n    @OnLifecycleEvent(Lifecycle.Event.ON_STOP)\n    fun onStop(){\n        Timber.tag(\"xx\").i(\"ON_STOP\")\n    }\n    @OnLifecycleEvent(Lifecycle.Event.ON_DESTROY)\n    fun onDestroy(){\n        Timber.tag(\"xx\").i(\"ON_DESTROY\")\n    }\n}\n```\n这样就可以很方便去管理生命周期，也可以和原来的activity的方法解耦。也可以通过LifecycleOwner来管理生命周期\n```kotlin\nclass MyActivity : Activity(), LifecycleOwner {\n    lateinit var mLifecycleRegistry: LifecycleRegistry\n\n    override fun onCreate(savedInstanceState: Bundle) {\n        super.onCreate(savedInstanceState)\n\n        mLifecycleRegistry = LifecycleRegistry(this)\n        mLifecycleRegistry.markState(Lifecycle.State.CREATED)\n    }\n\n    override fun onStart() {\n        super.onStart()\n        mLifecycleRegistry.markState(Lifecycle.State.STARTED)\n    }\n\n    //这里得到的就是生命周期的结果\n    override fun getLifecycle(): Lifecycle = mLifecycleRegistry\n}\n```\n这里不详细赘述里面的细节，只是记录一下使用的方法，有关细节可以查看官方文档。\n\n# FragmentLifecycleCallbacks\n如果使用的是fragment，那么这里提供另一种获取生命周期的方法，通过`FragmentLifecycleCallbacks`可以获取到fragment的生命周期回调\n```kotlin\n  fragment.requireFragmentManager().registerFragmentLifecycleCallbacks(object : FragmentManager.FragmentLifecycleCallbacks() {\n    override fun onFragmentResumed(fm: FragmentManager, f: Fragment) {\n      Timber.tag(\"xx\").i(\"onFragmentResumed\")\n    }\n\n    override fun onFragmentPaused(fm: FragmentManager, f: Fragment) {\n      Timber.tag(\"xx\").i(\"onFragmentPaused\")\n    }\n\n    override fun onFragmentStopped(fm: FragmentManager, f: Fragment) {\n      Timber.tag(\"xx\").i(\"onFragmentStopped\")\n      //fragment.requireFragmentManager().unregisterFragmentLifecycleCallbacks(this)\n    }\n\n    override fun onFragmentDestroyed(fm: FragmentManager, f: Fragment) {\n      Timber.tag(\"xx\").i(\"onFragmentDestroyed\")\n    }\n}, true)\n```\n所以，通过为activity添加一个空白的fragment也是一种方法，然后fragment就可以获取到activity的生命周期了，Glide就是通过添加一个fragment来管理生命周期的。\n\n# ActivityLifecycleCallbacks\n如果要全局管理生命周期有没有什么办法呢？当然还是有的，可以设置全局的Application，然后在application里面注册监听，就可以处理所有的activity的生命周期了。记得及时释放掉。\n```kotlin\nregisterActivityLifecycleCallbacks(object : Application.ActivityLifecycleCallbacks {\n    override fun onActivityPaused(activity: Activity?) {\n    }\n\n    override fun onActivityResumed(activity: Activity?) {\n    }\n\n    override fun onActivityStarted(activity: Activity?) {\n    }\n\n    override fun onActivityDestroyed(activity: Activity?) {\n    }\n\n    override fun onActivitySaveInstanceState(activity: Activity?, outState: Bundle?) {\n    }\n\n    override fun onActivityStopped(activity: Activity?) {\n    }\n\n    override fun onActivityCreated(activity: Activity?, savedInstanceState: Bundle?) {\n    }\n})\n```\n\n就记录这么多的方法，然后基于上面的进行封装处理就可以了，如果你有更好的方法，也欢迎来一起讨论。\n","source":"_posts/Android上的生命周期监控.md","raw":"---\ntitle: Android上的生命周期监控\ntags: Android\ncomments: false\ndate: 2018-07-23 13:36:11\n---\n做Android开发总是避免不了要处理各种生命周期，那么有没有什么优雅的方法呢？现在我就记录几种方法。\n<!-- more -->\n# Lifecycle  \n`Lifecycle`是Google在[Jetpack](https://developer.android.google.cn/jetpack/)中提出的，在包[`android.arch.lifecycle`](https://developer.android.com/reference/android/arch/lifecycle/package-summary.html)下面，如果使用的是suppor包中的SupportActivity或者FragmentActivity已经继承了Lifecycle。使用的方法如下：\n```kotlin\nclass myFragmentActivity(val fragmentActivity: FragmentActivity) : LifecycleObserver {\n    init {\n     //在这里注册一下\n      fragmentActivity.lifecycle.addObserver(this)\n    }\n    @OnLifecycleEvent(Lifecycle.Event.ON_RESUME)\n    fun onResume(){\n        Timber.tag(\"xx\").i(\"ON_RESUME\")\n    }\n    @OnLifecycleEvent(Lifecycle.Event.ON_PAUSE)\n    fun onPause(){\n        Timber.tag(\"xx\").i(\"ON_PAUSE\")\n    }\n    @OnLifecycleEvent(Lifecycle.Event.ON_STOP)\n    fun onStop(){\n        Timber.tag(\"xx\").i(\"ON_STOP\")\n    }\n    @OnLifecycleEvent(Lifecycle.Event.ON_DESTROY)\n    fun onDestroy(){\n        Timber.tag(\"xx\").i(\"ON_DESTROY\")\n    }\n}\n```\n这样就可以很方便去管理生命周期，也可以和原来的activity的方法解耦。也可以通过LifecycleOwner来管理生命周期\n```kotlin\nclass MyActivity : Activity(), LifecycleOwner {\n    lateinit var mLifecycleRegistry: LifecycleRegistry\n\n    override fun onCreate(savedInstanceState: Bundle) {\n        super.onCreate(savedInstanceState)\n\n        mLifecycleRegistry = LifecycleRegistry(this)\n        mLifecycleRegistry.markState(Lifecycle.State.CREATED)\n    }\n\n    override fun onStart() {\n        super.onStart()\n        mLifecycleRegistry.markState(Lifecycle.State.STARTED)\n    }\n\n    //这里得到的就是生命周期的结果\n    override fun getLifecycle(): Lifecycle = mLifecycleRegistry\n}\n```\n这里不详细赘述里面的细节，只是记录一下使用的方法，有关细节可以查看官方文档。\n\n# FragmentLifecycleCallbacks\n如果使用的是fragment，那么这里提供另一种获取生命周期的方法，通过`FragmentLifecycleCallbacks`可以获取到fragment的生命周期回调\n```kotlin\n  fragment.requireFragmentManager().registerFragmentLifecycleCallbacks(object : FragmentManager.FragmentLifecycleCallbacks() {\n    override fun onFragmentResumed(fm: FragmentManager, f: Fragment) {\n      Timber.tag(\"xx\").i(\"onFragmentResumed\")\n    }\n\n    override fun onFragmentPaused(fm: FragmentManager, f: Fragment) {\n      Timber.tag(\"xx\").i(\"onFragmentPaused\")\n    }\n\n    override fun onFragmentStopped(fm: FragmentManager, f: Fragment) {\n      Timber.tag(\"xx\").i(\"onFragmentStopped\")\n      //fragment.requireFragmentManager().unregisterFragmentLifecycleCallbacks(this)\n    }\n\n    override fun onFragmentDestroyed(fm: FragmentManager, f: Fragment) {\n      Timber.tag(\"xx\").i(\"onFragmentDestroyed\")\n    }\n}, true)\n```\n所以，通过为activity添加一个空白的fragment也是一种方法，然后fragment就可以获取到activity的生命周期了，Glide就是通过添加一个fragment来管理生命周期的。\n\n# ActivityLifecycleCallbacks\n如果要全局管理生命周期有没有什么办法呢？当然还是有的，可以设置全局的Application，然后在application里面注册监听，就可以处理所有的activity的生命周期了。记得及时释放掉。\n```kotlin\nregisterActivityLifecycleCallbacks(object : Application.ActivityLifecycleCallbacks {\n    override fun onActivityPaused(activity: Activity?) {\n    }\n\n    override fun onActivityResumed(activity: Activity?) {\n    }\n\n    override fun onActivityStarted(activity: Activity?) {\n    }\n\n    override fun onActivityDestroyed(activity: Activity?) {\n    }\n\n    override fun onActivitySaveInstanceState(activity: Activity?, outState: Bundle?) {\n    }\n\n    override fun onActivityStopped(activity: Activity?) {\n    }\n\n    override fun onActivityCreated(activity: Activity?, savedInstanceState: Bundle?) {\n    }\n})\n```\n\n就记录这么多的方法，然后基于上面的进行封装处理就可以了，如果你有更好的方法，也欢迎来一起讨论。\n","slug":"Android上的生命周期监控","published":1,"updated":"2018-07-23T05:42:37.054Z","layout":"post","photos":[],"link":"","_id":"cjr66wie20028metpq7igzsux","content":"<p>做Android开发总是避免不了要处理各种生命周期，那么有没有什么优雅的方法呢？现在我就记录几种方法。<br><a id=\"more\"></a></p>\n<h1 id=\"Lifecycle\"><a href=\"#Lifecycle\" class=\"headerlink\" title=\"Lifecycle\"></a>Lifecycle</h1><p><code>Lifecycle</code>是Google在<a href=\"https://developer.android.google.cn/jetpack/\" target=\"_blank\" rel=\"external\">Jetpack</a>中提出的，在包<a href=\"https://developer.android.com/reference/android/arch/lifecycle/package-summary.html\" target=\"_blank\" rel=\"external\"><code>android.arch.lifecycle</code></a>下面，如果使用的是suppor包中的SupportActivity或者FragmentActivity已经继承了Lifecycle。使用的方法如下：<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">myFragmentActivity</span></span>(<span class=\"keyword\">val</span> fragmentActivity: FragmentActivity) : LifecycleObserver &#123;</div><div class=\"line\">    init &#123;</div><div class=\"line\">     <span class=\"comment\">//在这里注册一下</span></div><div class=\"line\">      fragmentActivity.lifecycle.addObserver(<span class=\"keyword\">this</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"meta\">@OnLifecycleEvent(Lifecycle.Event.ON_RESUME)</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onResume</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"ON_RESUME\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"meta\">@OnLifecycleEvent(Lifecycle.Event.ON_PAUSE)</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onPause</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"ON_PAUSE\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"meta\">@OnLifecycleEvent(Lifecycle.Event.ON_STOP)</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onStop</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"ON_STOP\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"meta\">@OnLifecycleEvent(Lifecycle.Event.ON_DESTROY)</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onDestroy</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"ON_DESTROY\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>这样就可以很方便去管理生命周期，也可以和原来的activity的方法解耦。也可以通过LifecycleOwner来管理生命周期<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyActivity</span> : <span class=\"type\">Activity</span></span>(), LifecycleOwner &#123;</div><div class=\"line\">    lateinit <span class=\"keyword\">var</span> mLifecycleRegistry: LifecycleRegistry</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onCreate</span><span class=\"params\">(savedInstanceState: <span class=\"type\">Bundle</span>)</span></span> &#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onCreate(savedInstanceState)</div><div class=\"line\"></div><div class=\"line\">        mLifecycleRegistry = LifecycleRegistry(<span class=\"keyword\">this</span>)</div><div class=\"line\">        mLifecycleRegistry.markState(Lifecycle.State.CREATED)</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onStart</span><span class=\"params\">()</span></span> &#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onStart()</div><div class=\"line\">        mLifecycleRegistry.markState(Lifecycle.State.STARTED)</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//这里得到的就是生命周期的结果</span></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getLifecycle</span><span class=\"params\">()</span></span>: Lifecycle = mLifecycleRegistry</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>这里不详细赘述里面的细节，只是记录一下使用的方法，有关细节可以查看官方文档。</p>\n<h1 id=\"FragmentLifecycleCallbacks\"><a href=\"#FragmentLifecycleCallbacks\" class=\"headerlink\" title=\"FragmentLifecycleCallbacks\"></a>FragmentLifecycleCallbacks</h1><p>如果使用的是fragment，那么这里提供另一种获取生命周期的方法，通过<code>FragmentLifecycleCallbacks</code>可以获取到fragment的生命周期回调<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\">  fragment.requireFragmentManager().registerFragmentLifecycleCallbacks(<span class=\"keyword\">object</span> : FragmentManager.FragmentLifecycleCallbacks() &#123;</div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onFragmentResumed</span><span class=\"params\">(fm: <span class=\"type\">FragmentManager</span>, f: <span class=\"type\">Fragment</span>)</span></span> &#123;</div><div class=\"line\">      Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"onFragmentResumed\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onFragmentPaused</span><span class=\"params\">(fm: <span class=\"type\">FragmentManager</span>, f: <span class=\"type\">Fragment</span>)</span></span> &#123;</div><div class=\"line\">      Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"onFragmentPaused\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onFragmentStopped</span><span class=\"params\">(fm: <span class=\"type\">FragmentManager</span>, f: <span class=\"type\">Fragment</span>)</span></span> &#123;</div><div class=\"line\">      Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"onFragmentStopped\"</span>)</div><div class=\"line\">      <span class=\"comment\">//fragment.requireFragmentManager().unregisterFragmentLifecycleCallbacks(this)</span></div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onFragmentDestroyed</span><span class=\"params\">(fm: <span class=\"type\">FragmentManager</span>, f: <span class=\"type\">Fragment</span>)</span></span> &#123;</div><div class=\"line\">      Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"onFragmentDestroyed\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;, <span class=\"literal\">true</span>)</div></pre></td></tr></table></figure></p>\n<p>所以，通过为activity添加一个空白的fragment也是一种方法，然后fragment就可以获取到activity的生命周期了，Glide就是通过添加一个fragment来管理生命周期的。</p>\n<h1 id=\"ActivityLifecycleCallbacks\"><a href=\"#ActivityLifecycleCallbacks\" class=\"headerlink\" title=\"ActivityLifecycleCallbacks\"></a>ActivityLifecycleCallbacks</h1><p>如果要全局管理生命周期有没有什么办法呢？当然还是有的，可以设置全局的Application，然后在application里面注册监听，就可以处理所有的activity的生命周期了。记得及时释放掉。<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">registerActivityLifecycleCallbacks(<span class=\"keyword\">object</span> : Application.ActivityLifecycleCallbacks &#123;</div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityPaused</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityResumed</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityStarted</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityDestroyed</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivitySaveInstanceState</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?, outState: <span class=\"type\">Bundle</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityStopped</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityCreated</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?, savedInstanceState: <span class=\"type\">Bundle</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure></p>\n<p>就记录这么多的方法，然后基于上面的进行封装处理就可以了，如果你有更好的方法，也欢迎来一起讨论。</p>\n","excerpt":"<p>做Android开发总是避免不了要处理各种生命周期，那么有没有什么优雅的方法呢？现在我就记录几种方法。<br>","more":"</p>\n<h1 id=\"Lifecycle\"><a href=\"#Lifecycle\" class=\"headerlink\" title=\"Lifecycle\"></a>Lifecycle</h1><p><code>Lifecycle</code>是Google在<a href=\"https://developer.android.google.cn/jetpack/\">Jetpack</a>中提出的，在包<a href=\"https://developer.android.com/reference/android/arch/lifecycle/package-summary.html\"><code>android.arch.lifecycle</code></a>下面，如果使用的是suppor包中的SupportActivity或者FragmentActivity已经继承了Lifecycle。使用的方法如下：<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">myFragmentActivity</span></span>(<span class=\"keyword\">val</span> fragmentActivity: FragmentActivity) : LifecycleObserver &#123;</div><div class=\"line\">    init &#123;</div><div class=\"line\">     <span class=\"comment\">//在这里注册一下</span></div><div class=\"line\">      fragmentActivity.lifecycle.addObserver(<span class=\"keyword\">this</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"meta\">@OnLifecycleEvent(Lifecycle.Event.ON_RESUME)</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onResume</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"ON_RESUME\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"meta\">@OnLifecycleEvent(Lifecycle.Event.ON_PAUSE)</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onPause</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"ON_PAUSE\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"meta\">@OnLifecycleEvent(Lifecycle.Event.ON_STOP)</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onStop</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"ON_STOP\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"meta\">@OnLifecycleEvent(Lifecycle.Event.ON_DESTROY)</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onDestroy</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"ON_DESTROY\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>这样就可以很方便去管理生命周期，也可以和原来的activity的方法解耦。也可以通过LifecycleOwner来管理生命周期<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyActivity</span> : <span class=\"type\">Activity</span></span>(), LifecycleOwner &#123;</div><div class=\"line\">    lateinit <span class=\"keyword\">var</span> mLifecycleRegistry: LifecycleRegistry</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onCreate</span><span class=\"params\">(savedInstanceState: <span class=\"type\">Bundle</span>)</span></span> &#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onCreate(savedInstanceState)</div><div class=\"line\"></div><div class=\"line\">        mLifecycleRegistry = LifecycleRegistry(<span class=\"keyword\">this</span>)</div><div class=\"line\">        mLifecycleRegistry.markState(Lifecycle.State.CREATED)</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onStart</span><span class=\"params\">()</span></span> &#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onStart()</div><div class=\"line\">        mLifecycleRegistry.markState(Lifecycle.State.STARTED)</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//这里得到的就是生命周期的结果</span></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getLifecycle</span><span class=\"params\">()</span></span>: Lifecycle = mLifecycleRegistry</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>这里不详细赘述里面的细节，只是记录一下使用的方法，有关细节可以查看官方文档。</p>\n<h1 id=\"FragmentLifecycleCallbacks\"><a href=\"#FragmentLifecycleCallbacks\" class=\"headerlink\" title=\"FragmentLifecycleCallbacks\"></a>FragmentLifecycleCallbacks</h1><p>如果使用的是fragment，那么这里提供另一种获取生命周期的方法，通过<code>FragmentLifecycleCallbacks</code>可以获取到fragment的生命周期回调<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\">  fragment.requireFragmentManager().registerFragmentLifecycleCallbacks(<span class=\"keyword\">object</span> : FragmentManager.FragmentLifecycleCallbacks() &#123;</div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onFragmentResumed</span><span class=\"params\">(fm: <span class=\"type\">FragmentManager</span>, f: <span class=\"type\">Fragment</span>)</span></span> &#123;</div><div class=\"line\">      Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"onFragmentResumed\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onFragmentPaused</span><span class=\"params\">(fm: <span class=\"type\">FragmentManager</span>, f: <span class=\"type\">Fragment</span>)</span></span> &#123;</div><div class=\"line\">      Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"onFragmentPaused\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onFragmentStopped</span><span class=\"params\">(fm: <span class=\"type\">FragmentManager</span>, f: <span class=\"type\">Fragment</span>)</span></span> &#123;</div><div class=\"line\">      Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"onFragmentStopped\"</span>)</div><div class=\"line\">      <span class=\"comment\">//fragment.requireFragmentManager().unregisterFragmentLifecycleCallbacks(this)</span></div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onFragmentDestroyed</span><span class=\"params\">(fm: <span class=\"type\">FragmentManager</span>, f: <span class=\"type\">Fragment</span>)</span></span> &#123;</div><div class=\"line\">      Timber.tag(<span class=\"string\">\"xx\"</span>).i(<span class=\"string\">\"onFragmentDestroyed\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;, <span class=\"literal\">true</span>)</div></pre></td></tr></table></figure></p>\n<p>所以，通过为activity添加一个空白的fragment也是一种方法，然后fragment就可以获取到activity的生命周期了，Glide就是通过添加一个fragment来管理生命周期的。</p>\n<h1 id=\"ActivityLifecycleCallbacks\"><a href=\"#ActivityLifecycleCallbacks\" class=\"headerlink\" title=\"ActivityLifecycleCallbacks\"></a>ActivityLifecycleCallbacks</h1><p>如果要全局管理生命周期有没有什么办法呢？当然还是有的，可以设置全局的Application，然后在application里面注册监听，就可以处理所有的activity的生命周期了。记得及时释放掉。<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">registerActivityLifecycleCallbacks(<span class=\"keyword\">object</span> : Application.ActivityLifecycleCallbacks &#123;</div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityPaused</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityResumed</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityStarted</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityDestroyed</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivitySaveInstanceState</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?, outState: <span class=\"type\">Bundle</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityStopped</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityCreated</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>?, savedInstanceState: <span class=\"type\">Bundle</span>?)</span></span> &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure></p>\n<p>就记录这么多的方法，然后基于上面的进行封装处理就可以了，如果你有更好的方法，也欢迎来一起讨论。</p>"},{"title":"思考篇：1","date":"2016-04-10T13:51:15.000Z","updated":"2016-09-03T06:45:13.000Z","comments":0,"_content":"\n创立博客已数日有余，然，心中杂念繁多，无法静思，直达今日，方下定决心写写感悟。长路漫漫，悠悠数载，狗血淋漓，失尽江山。纵有千古奇谋，难敌花落谁家，吾辈亦何如。\n\n究竟什么是技术呢？什么又是程序员呢？之前我对于技术的理解是业务驱动型的，就是说，只有在有了需求再来考虑技术的实现。这的确是技术的发展轨迹，历来如此。可是对于程序员却不是，最好的程序员，一定是那个热爱技术，追求技术细节，刨根问底的人。这便是我理解的定义。\n<!--more-->\n近来，自己面临毕业后的第一个十字路口，一边是成为上述的合格的程序员，刨根问底，夜以继日。另一种，就是学习新的技术，为了我现在的新的业务需求花费更大的精力。不论哪一种都是痛苦的，关键是我的选择究竟是什么。自己究竟该怎么办？\n\n我还要不要做一个努力的人，为了逃避选择，我已经沉沦很久了，我已经不是那个热爱学习的少年了。遍寻思索，我究竟得到了什么？除了增长饭后的谈资，所获无多，尽于寥寥。对于仰慕的作者们，川端康成、春上春树、加西亚·马尔克斯、余秋雨、麦尔维尔等等，我还是否保留一颗热爱的灵魂，我有多久没有阅读他们的著作了。上一周开始阅读《看不见的城市》，读了一半就束之高阁了，再没有拿起来，我真的是没有时间吗？不是的，不是没有，一天的时间表大概就是，九点上班，晚上六点下班，回家、吃饭算上两个小时也就是八点，那八点之后到晚上十二点，我就有四个小时，这四个小时，我在干嘛呢？仔细想想，我在玩游戏，我在逃避，我连认真看一部经典电影的心态都做不到，我用各种娱乐节目来让自己忘记我还要去做选择。\n\n我想要的生活究竟是什么呢？我热爱写诗，纵使我两个多月没有写了，可是有时候兴趣上来了，我还是想要写点儿什么的。诗人的世界是不需要理性的，需要一个感性的认识，程序员的世界，是需要逻辑思维能力的，把现实逻辑抽象出来的能力。仔细想来，我在思考的是我想要的是什么样子的生活？读读书、游游世界、抒发抒发感慨、写写文章，策马扬鞭，纵横四海，这是理想的美好生活。生活只是生活，工作只是工作，这是我花了很多时间得出的结论，为了做好我的工作，我愿意去花苦功，也愿意去压缩生活。人生而有一个伟大的理想，甚至多数人的理想就是用来无法实现的。哪怕已经放弃为了理想去奋斗，哪怕永远无法去实现理想，但人还是要给自己留下这么一株火苗，生生不息。\n\n接下来就说到工作了，理想的工作状态是什么呢？做自己想做的事情，学习不止，奋斗不停。我知道自己不能永远只是一个初级程序员，后面的路还有很长的时间要去走。\n\n今天，这篇文章，是在上午和一群小伙伴愉快地聊天，以及下午给了我很大打击的一个人的点醒之后，最终决定还是写点儿什么来的好。毕竟，我不能一直逃避，不能一直做加减法，我必须为之后的工作和生活做出安排的计划。**以及，我明确我要做一个程序员，如果精力充足也许不只是程序员，这是我的工作目标**。\n\n以及最后，关于上面放的三篇文章的解释，那是[《冰与火之歌：凛冬的寒风》J.R.R·马丁释出的唯一三篇节选](http://www.georgerrmartin.com/excerpt-from-the-winds-of-winter/ \"官网\")，新书也许明年能够读到吧。\n","source":"_posts/Thinking1.md","raw":"---\ntitle: 思考篇：1\ndate: 2016-04-10 21:51:15\nupdated: 2016-09-03 14:45:13\ntags: 随笔\ncategories: 随笔\ncomments: false\n---\n\n创立博客已数日有余，然，心中杂念繁多，无法静思，直达今日，方下定决心写写感悟。长路漫漫，悠悠数载，狗血淋漓，失尽江山。纵有千古奇谋，难敌花落谁家，吾辈亦何如。\n\n究竟什么是技术呢？什么又是程序员呢？之前我对于技术的理解是业务驱动型的，就是说，只有在有了需求再来考虑技术的实现。这的确是技术的发展轨迹，历来如此。可是对于程序员却不是，最好的程序员，一定是那个热爱技术，追求技术细节，刨根问底的人。这便是我理解的定义。\n<!--more-->\n近来，自己面临毕业后的第一个十字路口，一边是成为上述的合格的程序员，刨根问底，夜以继日。另一种，就是学习新的技术，为了我现在的新的业务需求花费更大的精力。不论哪一种都是痛苦的，关键是我的选择究竟是什么。自己究竟该怎么办？\n\n我还要不要做一个努力的人，为了逃避选择，我已经沉沦很久了，我已经不是那个热爱学习的少年了。遍寻思索，我究竟得到了什么？除了增长饭后的谈资，所获无多，尽于寥寥。对于仰慕的作者们，川端康成、春上春树、加西亚·马尔克斯、余秋雨、麦尔维尔等等，我还是否保留一颗热爱的灵魂，我有多久没有阅读他们的著作了。上一周开始阅读《看不见的城市》，读了一半就束之高阁了，再没有拿起来，我真的是没有时间吗？不是的，不是没有，一天的时间表大概就是，九点上班，晚上六点下班，回家、吃饭算上两个小时也就是八点，那八点之后到晚上十二点，我就有四个小时，这四个小时，我在干嘛呢？仔细想想，我在玩游戏，我在逃避，我连认真看一部经典电影的心态都做不到，我用各种娱乐节目来让自己忘记我还要去做选择。\n\n我想要的生活究竟是什么呢？我热爱写诗，纵使我两个多月没有写了，可是有时候兴趣上来了，我还是想要写点儿什么的。诗人的世界是不需要理性的，需要一个感性的认识，程序员的世界，是需要逻辑思维能力的，把现实逻辑抽象出来的能力。仔细想来，我在思考的是我想要的是什么样子的生活？读读书、游游世界、抒发抒发感慨、写写文章，策马扬鞭，纵横四海，这是理想的美好生活。生活只是生活，工作只是工作，这是我花了很多时间得出的结论，为了做好我的工作，我愿意去花苦功，也愿意去压缩生活。人生而有一个伟大的理想，甚至多数人的理想就是用来无法实现的。哪怕已经放弃为了理想去奋斗，哪怕永远无法去实现理想，但人还是要给自己留下这么一株火苗，生生不息。\n\n接下来就说到工作了，理想的工作状态是什么呢？做自己想做的事情，学习不止，奋斗不停。我知道自己不能永远只是一个初级程序员，后面的路还有很长的时间要去走。\n\n今天，这篇文章，是在上午和一群小伙伴愉快地聊天，以及下午给了我很大打击的一个人的点醒之后，最终决定还是写点儿什么来的好。毕竟，我不能一直逃避，不能一直做加减法，我必须为之后的工作和生活做出安排的计划。**以及，我明确我要做一个程序员，如果精力充足也许不只是程序员，这是我的工作目标**。\n\n以及最后，关于上面放的三篇文章的解释，那是[《冰与火之歌：凛冬的寒风》J.R.R·马丁释出的唯一三篇节选](http://www.georgerrmartin.com/excerpt-from-the-winds-of-winter/ \"官网\")，新书也许明年能够读到吧。\n","slug":"Thinking1","published":1,"layout":"post","photos":[],"link":"","_id":"cjr66wie4002bmetp2a6pljhy","content":"<p>创立博客已数日有余，然，心中杂念繁多，无法静思，直达今日，方下定决心写写感悟。长路漫漫，悠悠数载，狗血淋漓，失尽江山。纵有千古奇谋，难敌花落谁家，吾辈亦何如。</p>\n<p>究竟什么是技术呢？什么又是程序员呢？之前我对于技术的理解是业务驱动型的，就是说，只有在有了需求再来考虑技术的实现。这的确是技术的发展轨迹，历来如此。可是对于程序员却不是，最好的程序员，一定是那个热爱技术，追求技术细节，刨根问底的人。这便是我理解的定义。<br><a id=\"more\"></a><br>近来，自己面临毕业后的第一个十字路口，一边是成为上述的合格的程序员，刨根问底，夜以继日。另一种，就是学习新的技术，为了我现在的新的业务需求花费更大的精力。不论哪一种都是痛苦的，关键是我的选择究竟是什么。自己究竟该怎么办？</p>\n<p>我还要不要做一个努力的人，为了逃避选择，我已经沉沦很久了，我已经不是那个热爱学习的少年了。遍寻思索，我究竟得到了什么？除了增长饭后的谈资，所获无多，尽于寥寥。对于仰慕的作者们，川端康成、春上春树、加西亚·马尔克斯、余秋雨、麦尔维尔等等，我还是否保留一颗热爱的灵魂，我有多久没有阅读他们的著作了。上一周开始阅读《看不见的城市》，读了一半就束之高阁了，再没有拿起来，我真的是没有时间吗？不是的，不是没有，一天的时间表大概就是，九点上班，晚上六点下班，回家、吃饭算上两个小时也就是八点，那八点之后到晚上十二点，我就有四个小时，这四个小时，我在干嘛呢？仔细想想，我在玩游戏，我在逃避，我连认真看一部经典电影的心态都做不到，我用各种娱乐节目来让自己忘记我还要去做选择。</p>\n<p>我想要的生活究竟是什么呢？我热爱写诗，纵使我两个多月没有写了，可是有时候兴趣上来了，我还是想要写点儿什么的。诗人的世界是不需要理性的，需要一个感性的认识，程序员的世界，是需要逻辑思维能力的，把现实逻辑抽象出来的能力。仔细想来，我在思考的是我想要的是什么样子的生活？读读书、游游世界、抒发抒发感慨、写写文章，策马扬鞭，纵横四海，这是理想的美好生活。生活只是生活，工作只是工作，这是我花了很多时间得出的结论，为了做好我的工作，我愿意去花苦功，也愿意去压缩生活。人生而有一个伟大的理想，甚至多数人的理想就是用来无法实现的。哪怕已经放弃为了理想去奋斗，哪怕永远无法去实现理想，但人还是要给自己留下这么一株火苗，生生不息。</p>\n<p>接下来就说到工作了，理想的工作状态是什么呢？做自己想做的事情，学习不止，奋斗不停。我知道自己不能永远只是一个初级程序员，后面的路还有很长的时间要去走。</p>\n<p>今天，这篇文章，是在上午和一群小伙伴愉快地聊天，以及下午给了我很大打击的一个人的点醒之后，最终决定还是写点儿什么来的好。毕竟，我不能一直逃避，不能一直做加减法，我必须为之后的工作和生活做出安排的计划。<strong>以及，我明确我要做一个程序员，如果精力充足也许不只是程序员，这是我的工作目标</strong>。</p>\n<p>以及最后，关于上面放的三篇文章的解释，那是<a href=\"http://www.georgerrmartin.com/excerpt-from-the-winds-of-winter/\" title=\"官网\" target=\"_blank\" rel=\"external\">《冰与火之歌：凛冬的寒风》J.R.R·马丁释出的唯一三篇节选</a>，新书也许明年能够读到吧。</p>\n","excerpt":"<p>创立博客已数日有余，然，心中杂念繁多，无法静思，直达今日，方下定决心写写感悟。长路漫漫，悠悠数载，狗血淋漓，失尽江山。纵有千古奇谋，难敌花落谁家，吾辈亦何如。</p>\n<p>究竟什么是技术呢？什么又是程序员呢？之前我对于技术的理解是业务驱动型的，就是说，只有在有了需求再来考虑技术的实现。这的确是技术的发展轨迹，历来如此。可是对于程序员却不是，最好的程序员，一定是那个热爱技术，追求技术细节，刨根问底的人。这便是我理解的定义。<br>","more":"<br>近来，自己面临毕业后的第一个十字路口，一边是成为上述的合格的程序员，刨根问底，夜以继日。另一种，就是学习新的技术，为了我现在的新的业务需求花费更大的精力。不论哪一种都是痛苦的，关键是我的选择究竟是什么。自己究竟该怎么办？</p>\n<p>我还要不要做一个努力的人，为了逃避选择，我已经沉沦很久了，我已经不是那个热爱学习的少年了。遍寻思索，我究竟得到了什么？除了增长饭后的谈资，所获无多，尽于寥寥。对于仰慕的作者们，川端康成、春上春树、加西亚·马尔克斯、余秋雨、麦尔维尔等等，我还是否保留一颗热爱的灵魂，我有多久没有阅读他们的著作了。上一周开始阅读《看不见的城市》，读了一半就束之高阁了，再没有拿起来，我真的是没有时间吗？不是的，不是没有，一天的时间表大概就是，九点上班，晚上六点下班，回家、吃饭算上两个小时也就是八点，那八点之后到晚上十二点，我就有四个小时，这四个小时，我在干嘛呢？仔细想想，我在玩游戏，我在逃避，我连认真看一部经典电影的心态都做不到，我用各种娱乐节目来让自己忘记我还要去做选择。</p>\n<p>我想要的生活究竟是什么呢？我热爱写诗，纵使我两个多月没有写了，可是有时候兴趣上来了，我还是想要写点儿什么的。诗人的世界是不需要理性的，需要一个感性的认识，程序员的世界，是需要逻辑思维能力的，把现实逻辑抽象出来的能力。仔细想来，我在思考的是我想要的是什么样子的生活？读读书、游游世界、抒发抒发感慨、写写文章，策马扬鞭，纵横四海，这是理想的美好生活。生活只是生活，工作只是工作，这是我花了很多时间得出的结论，为了做好我的工作，我愿意去花苦功，也愿意去压缩生活。人生而有一个伟大的理想，甚至多数人的理想就是用来无法实现的。哪怕已经放弃为了理想去奋斗，哪怕永远无法去实现理想，但人还是要给自己留下这么一株火苗，生生不息。</p>\n<p>接下来就说到工作了，理想的工作状态是什么呢？做自己想做的事情，学习不止，奋斗不停。我知道自己不能永远只是一个初级程序员，后面的路还有很长的时间要去走。</p>\n<p>今天，这篇文章，是在上午和一群小伙伴愉快地聊天，以及下午给了我很大打击的一个人的点醒之后，最终决定还是写点儿什么来的好。毕竟，我不能一直逃避，不能一直做加减法，我必须为之后的工作和生活做出安排的计划。<strong>以及，我明确我要做一个程序员，如果精力充足也许不只是程序员，这是我的工作目标</strong>。</p>\n<p>以及最后，关于上面放的三篇文章的解释，那是<a href=\"http://www.georgerrmartin.com/excerpt-from-the-winds-of-winter/\" title=\"官网\">《冰与火之歌：凛冬的寒风》J.R.R·马丁释出的唯一三篇节选</a>，新书也许明年能够读到吧。</p>"},{"title":"思考篇5：过去的2017年","comments":0,"date":"2018-01-26T09:23:38.000Z","_content":"\n2017已经过去了，回顾与展望，究竟该如何进行\n","source":"_drafts/20180126.md","raw":"---\ntitle: 思考篇5：过去的2017年\ntags: 随笔\ncomments: false\ndate: 2018-01-26 17:23:38\n---\n\n2017已经过去了，回顾与展望，究竟该如何进行\n","slug":"20180126","published":0,"updated":"2018-01-26T06:57:26.191Z","layout":"post","photos":[],"link":"","_id":"cjr66wie5002emetpwn6olcis","content":"<p>2017已经过去了，回顾与展望，究竟该如何进行</p>\n","excerpt":"","more":"<p>2017已经过去了，回顾与展望，究竟该如何进行</p>\n"},{"title":"一个程序员的自我修养","_content":"","source":"_drafts/a-developer-prepares.md","raw":"---\ntitle: 一个程序员的自我修养\ntags:\n---\n","slug":"a-developer-prepares","published":0,"date":"2017-07-10T07:29:00.000Z","updated":"2017-07-10T07:33:15.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjr66wie6002gmetp64ws393h","content":"","excerpt":"","more":""},{"title":"思考篇5：过去的2017年","comments":0,"date":"2017-12-19T09:23:38.000Z","_content":"2017年就要结束了，不得不面对一个惨痛的事实，又空空虚度了一年，虽然这一年有了很多成长，但是这一年的成就的确是空空如也，说到底我的试错成本还是有点儿高，我也的确需要认真反省一下了。这一篇就当作过去2017的总结了。时间总是那么仓促，如白驹过隙，现在是毕业的第二年了，马上就要到第三年了，这必然成为一个过往经历的一个转折。反思未必是最好的前行方式，但是反思的确是前行路上必须经历的过程。今年也一度在公司内部开了一些技术分享的内容的，也有一些本来打算整理成文章出来的。只是一拖再拖就导致有些话题终究还是没有开坑。\n\n今年12月10日上午，中兴一位42岁的工程师被裁员然后选择了跳楼，一时间关于程序员的中年危机此起彼伏。出现这个问题，究竟是因为什么呢？可以有很多种解读，但是这些解读和我自己的生活又有多大的关系呢？这是一件悲剧，人到中年，按照八十岁来算的话，其实已经活了一半了，按照退休年纪来算的话，其实还有20年，再过二十年也许就可以安心地享受退休生活了，可是这位工程师选择了提前结束了自己的生命，说到底在他看来已经看不到未来的希望了。想想我自己，我希望在什么时候退休呢？如果按照法定的65算的话，那我就有距离这一天就还有40年，这40年如何走，才不至于走到看不到希望的一天呢？年初的时候，年初的时候野心勃勃的希望有一番作为，可是到了年底终究还是一事无成吗？不知道从什么时候开始这种一事无成的感觉来的非常的深刻。大概是我野心太大了。\n\n先说说，过去的一年所做的事情吧。在这一年的时间里，做了一些和后端架构相关的工作，也涉足了一些管理上的事情，上半年基本还是作为一个Android开发者的，也在Android的架构历程上走了很多，下半年就基本全是和后端架构相关的工作了，筛选简历、寻找简历、推进架构工作，研究新的技术，从无人可以依靠，到渐渐成长起来，痛苦地发现发际线也变高了。但是在有些事情上始终困惑不已。不知道各位有没有问过自己一些关于关乎职场上的问题。以下记录一些自己的问题。\n\n首先，第一个问题：“工作是什么？”。工作是什么呢？这是一个非常见仁见智的问题，回答好这个问题是很重要的。在维基上，针对工作有四个消歧义的选项，分别是：就业、职业、劳动、作品，基本代表了工作所能代表的含义。接下来我要说说一些自己的理解。\n","source":"_drafts/Thinking5.md","raw":"---\ntitle: 思考篇5：过去的2017年\ntags: 随笔\ncomments: false\ndate: 2017-12-19 17:23:38\n---\n2017年就要结束了，不得不面对一个惨痛的事实，又空空虚度了一年，虽然这一年有了很多成长，但是这一年的成就的确是空空如也，说到底我的试错成本还是有点儿高，我也的确需要认真反省一下了。这一篇就当作过去2017的总结了。时间总是那么仓促，如白驹过隙，现在是毕业的第二年了，马上就要到第三年了，这必然成为一个过往经历的一个转折。反思未必是最好的前行方式，但是反思的确是前行路上必须经历的过程。今年也一度在公司内部开了一些技术分享的内容的，也有一些本来打算整理成文章出来的。只是一拖再拖就导致有些话题终究还是没有开坑。\n\n今年12月10日上午，中兴一位42岁的工程师被裁员然后选择了跳楼，一时间关于程序员的中年危机此起彼伏。出现这个问题，究竟是因为什么呢？可以有很多种解读，但是这些解读和我自己的生活又有多大的关系呢？这是一件悲剧，人到中年，按照八十岁来算的话，其实已经活了一半了，按照退休年纪来算的话，其实还有20年，再过二十年也许就可以安心地享受退休生活了，可是这位工程师选择了提前结束了自己的生命，说到底在他看来已经看不到未来的希望了。想想我自己，我希望在什么时候退休呢？如果按照法定的65算的话，那我就有距离这一天就还有40年，这40年如何走，才不至于走到看不到希望的一天呢？年初的时候，年初的时候野心勃勃的希望有一番作为，可是到了年底终究还是一事无成吗？不知道从什么时候开始这种一事无成的感觉来的非常的深刻。大概是我野心太大了。\n\n先说说，过去的一年所做的事情吧。在这一年的时间里，做了一些和后端架构相关的工作，也涉足了一些管理上的事情，上半年基本还是作为一个Android开发者的，也在Android的架构历程上走了很多，下半年就基本全是和后端架构相关的工作了，筛选简历、寻找简历、推进架构工作，研究新的技术，从无人可以依靠，到渐渐成长起来，痛苦地发现发际线也变高了。但是在有些事情上始终困惑不已。不知道各位有没有问过自己一些关于关乎职场上的问题。以下记录一些自己的问题。\n\n首先，第一个问题：“工作是什么？”。工作是什么呢？这是一个非常见仁见智的问题，回答好这个问题是很重要的。在维基上，针对工作有四个消歧义的选项，分别是：就业、职业、劳动、作品，基本代表了工作所能代表的含义。接下来我要说说一些自己的理解。\n","slug":"Thinking5","published":0,"updated":"2017-12-20T08:28:35.094Z","layout":"post","photos":[],"link":"","_id":"cjr66wie8002kmetplm23qisn","content":"<p>2017年就要结束了，不得不面对一个惨痛的事实，又空空虚度了一年，虽然这一年有了很多成长，但是这一年的成就的确是空空如也，说到底我的试错成本还是有点儿高，我也的确需要认真反省一下了。这一篇就当作过去2017的总结了。时间总是那么仓促，如白驹过隙，现在是毕业的第二年了，马上就要到第三年了，这必然成为一个过往经历的一个转折。反思未必是最好的前行方式，但是反思的确是前行路上必须经历的过程。今年也一度在公司内部开了一些技术分享的内容的，也有一些本来打算整理成文章出来的。只是一拖再拖就导致有些话题终究还是没有开坑。</p>\n<p>今年12月10日上午，中兴一位42岁的工程师被裁员然后选择了跳楼，一时间关于程序员的中年危机此起彼伏。出现这个问题，究竟是因为什么呢？可以有很多种解读，但是这些解读和我自己的生活又有多大的关系呢？这是一件悲剧，人到中年，按照八十岁来算的话，其实已经活了一半了，按照退休年纪来算的话，其实还有20年，再过二十年也许就可以安心地享受退休生活了，可是这位工程师选择了提前结束了自己的生命，说到底在他看来已经看不到未来的希望了。想想我自己，我希望在什么时候退休呢？如果按照法定的65算的话，那我就有距离这一天就还有40年，这40年如何走，才不至于走到看不到希望的一天呢？年初的时候，年初的时候野心勃勃的希望有一番作为，可是到了年底终究还是一事无成吗？不知道从什么时候开始这种一事无成的感觉来的非常的深刻。大概是我野心太大了。</p>\n<p>先说说，过去的一年所做的事情吧。在这一年的时间里，做了一些和后端架构相关的工作，也涉足了一些管理上的事情，上半年基本还是作为一个Android开发者的，也在Android的架构历程上走了很多，下半年就基本全是和后端架构相关的工作了，筛选简历、寻找简历、推进架构工作，研究新的技术，从无人可以依靠，到渐渐成长起来，痛苦地发现发际线也变高了。但是在有些事情上始终困惑不已。不知道各位有没有问过自己一些关于关乎职场上的问题。以下记录一些自己的问题。</p>\n<p>首先，第一个问题：“工作是什么？”。工作是什么呢？这是一个非常见仁见智的问题，回答好这个问题是很重要的。在维基上，针对工作有四个消歧义的选项，分别是：就业、职业、劳动、作品，基本代表了工作所能代表的含义。接下来我要说说一些自己的理解。</p>\n","excerpt":"","more":"<p>2017年就要结束了，不得不面对一个惨痛的事实，又空空虚度了一年，虽然这一年有了很多成长，但是这一年的成就的确是空空如也，说到底我的试错成本还是有点儿高，我也的确需要认真反省一下了。这一篇就当作过去2017的总结了。时间总是那么仓促，如白驹过隙，现在是毕业的第二年了，马上就要到第三年了，这必然成为一个过往经历的一个转折。反思未必是最好的前行方式，但是反思的确是前行路上必须经历的过程。今年也一度在公司内部开了一些技术分享的内容的，也有一些本来打算整理成文章出来的。只是一拖再拖就导致有些话题终究还是没有开坑。</p>\n<p>今年12月10日上午，中兴一位42岁的工程师被裁员然后选择了跳楼，一时间关于程序员的中年危机此起彼伏。出现这个问题，究竟是因为什么呢？可以有很多种解读，但是这些解读和我自己的生活又有多大的关系呢？这是一件悲剧，人到中年，按照八十岁来算的话，其实已经活了一半了，按照退休年纪来算的话，其实还有20年，再过二十年也许就可以安心地享受退休生活了，可是这位工程师选择了提前结束了自己的生命，说到底在他看来已经看不到未来的希望了。想想我自己，我希望在什么时候退休呢？如果按照法定的65算的话，那我就有距离这一天就还有40年，这40年如何走，才不至于走到看不到希望的一天呢？年初的时候，年初的时候野心勃勃的希望有一番作为，可是到了年底终究还是一事无成吗？不知道从什么时候开始这种一事无成的感觉来的非常的深刻。大概是我野心太大了。</p>\n<p>先说说，过去的一年所做的事情吧。在这一年的时间里，做了一些和后端架构相关的工作，也涉足了一些管理上的事情，上半年基本还是作为一个Android开发者的，也在Android的架构历程上走了很多，下半年就基本全是和后端架构相关的工作了，筛选简历、寻找简历、推进架构工作，研究新的技术，从无人可以依靠，到渐渐成长起来，痛苦地发现发际线也变高了。但是在有些事情上始终困惑不已。不知道各位有没有问过自己一些关于关乎职场上的问题。以下记录一些自己的问题。</p>\n<p>首先，第一个问题：“工作是什么？”。工作是什么呢？这是一个非常见仁见智的问题，回答好这个问题是很重要的。在维基上，针对工作有四个消歧义的选项，分别是：就业、职业、劳动、作品，基本代表了工作所能代表的含义。接下来我要说说一些自己的理解。</p>\n"},{"_content":"关于gradle的使用，Android老早就支持gradle了，但是一直一知半解，也是一只\n","source":"_drafts/gradle学习.md","raw":"关于gradle的使用，Android老早就支持gradle了，但是一直一知半解，也是一只\n","slug":"gradle学习","published":0,"date":"2018-04-02T10:23:39.000Z","updated":"2018-04-16T09:07:23.878Z","title":"","comments":1,"layout":"post","photos":[],"link":"","_id":"cjr66wie9002mmetps7ezdd60","content":"<p>关于gradle的使用，Android老早就支持gradle了，但是一直一知半解，也是一只</p>\n","excerpt":"","more":"<p>关于gradle的使用，Android老早就支持gradle了，但是一直一知半解，也是一只</p>\n"},{"title":"Docker下的日志管理","_content":"今天来记录下Docker中日志的管理问题，作为一个可用的系统，日志是必须要有的。在Docker中是，日志的输出形式有两种，一种是标准输出`STDOUT`，一种是文件输出。\n\n文件输出，是指输出到日志文件，每个应用的日志文件保存在不一样的地方。\n\n标准输出`STDOUT`，Unix和Linux在程序运行的时候，都会产生[三个文件](Linux Documentation Project article on I/O redirection.)，分别是`STDIN`、`STDOUT`和`STDERR`，默认情况下，docker是打开`STDOUT`和`STDERR`的。\n\n容器有一个处理标准输出的模块LogDriver来处理日志，[Docker本身支持很多的LogDriver](https://docs.docker.com/engine/admin/logging/overview/#supported-logging-drivers)。容器默认支持的`json-file`的方式所谓的LogDriver就是一个日志的转发模块，转发到其他地方进行处理，之所以这样子做，是为了不在所有的容器或者节点机器上去配置日志的处理，这样可有做到统一处理了。我这里讲两种配置方式，一种是直接配置容器的`daemon.josn`文件![image.png](http://upload-images.jianshu.io/upload_images/8433-515b929b67fbc355.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n另一种是在Dockerfile中增加\n```docker\nCMD run --log-driver syslog --log-opt syslog-address=udp://1.2.3.4:1111\n```\n# 在阿里云的容器服务中\n在阿里云的容器服务中，可以直接打开容器集群的日志服务，然后就会直接投递到阿里云上面的日志服务，见[连接](https://help.aliyun.com/document_detail/26036.html?spm=5176.doc55339.6.650.lrKXid)，需要注意的是，在编排文件中添加标签的格式为 `aliyun.log_store_{name}: {logpath}`。其中 `name` 为阿里云日志服务 `logstore` 的名字，实际创建的 `logstore` 的名字为`acslog-${app}-${name}`。`app` 为应用名称；`logpath`为容器中日志的路径；`stdout` 是一个特殊的 `logpath`，表示标准输出。然后有了这个标签之后，日志会自动投递到日志服务中。\n\n# ELK（Elasticsearch, Logstash, Kibana）\n\n这个没有去试过，后续更新\n","source":"_drafts/docker-log.md","raw":"---\ntitle: Docker下的日志管理\ntags: Docker\n---\n今天来记录下Docker中日志的管理问题，作为一个可用的系统，日志是必须要有的。在Docker中是，日志的输出形式有两种，一种是标准输出`STDOUT`，一种是文件输出。\n\n文件输出，是指输出到日志文件，每个应用的日志文件保存在不一样的地方。\n\n标准输出`STDOUT`，Unix和Linux在程序运行的时候，都会产生[三个文件](Linux Documentation Project article on I/O redirection.)，分别是`STDIN`、`STDOUT`和`STDERR`，默认情况下，docker是打开`STDOUT`和`STDERR`的。\n\n容器有一个处理标准输出的模块LogDriver来处理日志，[Docker本身支持很多的LogDriver](https://docs.docker.com/engine/admin/logging/overview/#supported-logging-drivers)。容器默认支持的`json-file`的方式所谓的LogDriver就是一个日志的转发模块，转发到其他地方进行处理，之所以这样子做，是为了不在所有的容器或者节点机器上去配置日志的处理，这样可有做到统一处理了。我这里讲两种配置方式，一种是直接配置容器的`daemon.josn`文件![image.png](http://upload-images.jianshu.io/upload_images/8433-515b929b67fbc355.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n另一种是在Dockerfile中增加\n```docker\nCMD run --log-driver syslog --log-opt syslog-address=udp://1.2.3.4:1111\n```\n# 在阿里云的容器服务中\n在阿里云的容器服务中，可以直接打开容器集群的日志服务，然后就会直接投递到阿里云上面的日志服务，见[连接](https://help.aliyun.com/document_detail/26036.html?spm=5176.doc55339.6.650.lrKXid)，需要注意的是，在编排文件中添加标签的格式为 `aliyun.log_store_{name}: {logpath}`。其中 `name` 为阿里云日志服务 `logstore` 的名字，实际创建的 `logstore` 的名字为`acslog-${app}-${name}`。`app` 为应用名称；`logpath`为容器中日志的路径；`stdout` 是一个特殊的 `logpath`，表示标准输出。然后有了这个标签之后，日志会自动投递到日志服务中。\n\n# ELK（Elasticsearch, Logstash, Kibana）\n\n这个没有去试过，后续更新\n","slug":"docker-log","published":0,"date":"2017-11-07T02:41:22.297Z","updated":"2017-11-13T06:33:41.995Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjr66wie9002ometp78reppr7","content":"<p>今天来记录下Docker中日志的管理问题，作为一个可用的系统，日志是必须要有的。在Docker中是，日志的输出形式有两种，一种是标准输出<code>STDOUT</code>，一种是文件输出。</p>\n<p>文件输出，是指输出到日志文件，每个应用的日志文件保存在不一样的地方。</p>\n<p>标准输出<code>STDOUT</code>，Unix和Linux在程序运行的时候，都会产生<a href=\"Linux Documentation Project article on I/O redirection.\">三个文件</a>，分别是<code>STDIN</code>、<code>STDOUT</code>和<code>STDERR</code>，默认情况下，docker是打开<code>STDOUT</code>和<code>STDERR</code>的。</p>\n<p>容器有一个处理标准输出的模块LogDriver来处理日志，<a href=\"https://docs.docker.com/engine/admin/logging/overview/#supported-logging-drivers\" target=\"_blank\" rel=\"external\">Docker本身支持很多的LogDriver</a>。容器默认支持的<code>json-file</code>的方式所谓的LogDriver就是一个日志的转发模块，转发到其他地方进行处理，之所以这样子做，是为了不在所有的容器或者节点机器上去配置日志的处理，这样可有做到统一处理了。我这里讲两种配置方式，一种是直接配置容器的<code>daemon.josn</code>文件<img src=\"http://upload-images.jianshu.io/upload_images/8433-515b929b67fbc355.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"image.png\"></p>\n<p>另一种是在Dockerfile中增加<br><figure class=\"highlight docker\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CMD</span> run --log-driver syslog --log-opt syslog-address=udp://1.2.3.4:1111</div></pre></td></tr></table></figure></p>\n<h1 id=\"在阿里云的容器服务中\"><a href=\"#在阿里云的容器服务中\" class=\"headerlink\" title=\"在阿里云的容器服务中\"></a>在阿里云的容器服务中</h1><p>在阿里云的容器服务中，可以直接打开容器集群的日志服务，然后就会直接投递到阿里云上面的日志服务，见<a href=\"https://help.aliyun.com/document_detail/26036.html?spm=5176.doc55339.6.650.lrKXid\" target=\"_blank\" rel=\"external\">连接</a>，需要注意的是，在编排文件中添加标签的格式为 <code>aliyun.log_store_{name}: {logpath}</code>。其中 <code>name</code> 为阿里云日志服务 <code>logstore</code> 的名字，实际创建的 <code>logstore</code> 的名字为<code>acslog-${app}-${name}</code>。<code>app</code> 为应用名称；<code>logpath</code>为容器中日志的路径；<code>stdout</code> 是一个特殊的 <code>logpath</code>，表示标准输出。然后有了这个标签之后，日志会自动投递到日志服务中。</p>\n<h1 id=\"ELK（Elasticsearch-Logstash-Kibana）\"><a href=\"#ELK（Elasticsearch-Logstash-Kibana）\" class=\"headerlink\" title=\"ELK（Elasticsearch, Logstash, Kibana）\"></a>ELK（Elasticsearch, Logstash, Kibana）</h1><p>这个没有去试过，后续更新</p>\n","excerpt":"","more":"<p>今天来记录下Docker中日志的管理问题，作为一个可用的系统，日志是必须要有的。在Docker中是，日志的输出形式有两种，一种是标准输出<code>STDOUT</code>，一种是文件输出。</p>\n<p>文件输出，是指输出到日志文件，每个应用的日志文件保存在不一样的地方。</p>\n<p>标准输出<code>STDOUT</code>，Unix和Linux在程序运行的时候，都会产生<a href=\"Linux Documentation Project article on I/O redirection.\">三个文件</a>，分别是<code>STDIN</code>、<code>STDOUT</code>和<code>STDERR</code>，默认情况下，docker是打开<code>STDOUT</code>和<code>STDERR</code>的。</p>\n<p>容器有一个处理标准输出的模块LogDriver来处理日志，<a href=\"https://docs.docker.com/engine/admin/logging/overview/#supported-logging-drivers\">Docker本身支持很多的LogDriver</a>。容器默认支持的<code>json-file</code>的方式所谓的LogDriver就是一个日志的转发模块，转发到其他地方进行处理，之所以这样子做，是为了不在所有的容器或者节点机器上去配置日志的处理，这样可有做到统一处理了。我这里讲两种配置方式，一种是直接配置容器的<code>daemon.josn</code>文件<img src=\"http://upload-images.jianshu.io/upload_images/8433-515b929b67fbc355.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"image.png\"></p>\n<p>另一种是在Dockerfile中增加<br><figure class=\"highlight docker\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CMD</span> run --log-driver syslog --log-opt syslog-address=udp://1.2.3.4:1111</div></pre></td></tr></table></figure></p>\n<h1 id=\"在阿里云的容器服务中\"><a href=\"#在阿里云的容器服务中\" class=\"headerlink\" title=\"在阿里云的容器服务中\"></a>在阿里云的容器服务中</h1><p>在阿里云的容器服务中，可以直接打开容器集群的日志服务，然后就会直接投递到阿里云上面的日志服务，见<a href=\"https://help.aliyun.com/document_detail/26036.html?spm=5176.doc55339.6.650.lrKXid\">连接</a>，需要注意的是，在编排文件中添加标签的格式为 <code>aliyun.log_store_{name}: {logpath}</code>。其中 <code>name</code> 为阿里云日志服务 <code>logstore</code> 的名字，实际创建的 <code>logstore</code> 的名字为<code>acslog-${app}-${name}</code>。<code>app</code> 为应用名称；<code>logpath</code>为容器中日志的路径；<code>stdout</code> 是一个特殊的 <code>logpath</code>，表示标准输出。然后有了这个标签之后，日志会自动投递到日志服务中。</p>\n<h1 id=\"ELK（Elasticsearch-Logstash-Kibana）\"><a href=\"#ELK（Elasticsearch-Logstash-Kibana）\" class=\"headerlink\" title=\"ELK（Elasticsearch, Logstash, Kibana）\"></a>ELK（Elasticsearch, Logstash, Kibana）</h1><p>这个没有去试过，后续更新</p>\n"},{"title":"认知科学","date":"2018-04-02T07:35:55.000Z","_content":"现在描述一下是认知科学，所谓认知科学就是通过各种方式来研究人类如何认知的一门科学，涉及到学科有，语言学、神经科学、哲学、心理学、人类学、人工智能、教育学。\n\n\n1. 要理解人类的各种认知活动，离不开心理表征这样一个基本的理论设定，认知活动可以看作各种心理表征（符号、规则、图像等）进行加工的过程，心理表征提供了一个既不依赖生物学和神经科学，也有别于社会和文化层面的独立的分析层面。\n\n2. 计算机为理解人类心智提供了一个强有力的模型，计算和算法是理解认知活动如何运作的核心，思维和认知即在心理表征上运行的心理计算。\n\n3. 将认知和情感、意识、文化和历史等因素分离开来，认知活动主要包括知觉、记忆、思维、语言、推理、决策\n、问题求解、学习和行为控制等，这些是认知科学的主要研究对象。\n\n4. 艰辛多学科、跨学科的研究是探索人类心智奥秘的必由之路，终将达成一门统一的认知科学。\n\n5. 认知科学所探讨的基本问题来源于从古希腊哲学到笛卡尔再到康德的西方哲学传统，认知科学试图运用当代科学的方法和理论来回答传统的哲学问题。\n\n\n\n认知科学可以扩展到对意识、情绪、自我、社会、文化、宗教、道德、艺术等等的研究上面去。\n\n要理解人类心智的认知还需要很长的路要走，认知科学也具有极大的发展前景。\n","source":"_drafts/cognitive-science.md","raw":"---\ntitle: 认知科学\ndate: 2018-04-02 15:35:55\ntags:\ncategories: cognitive-science\n---\n现在描述一下是认知科学，所谓认知科学就是通过各种方式来研究人类如何认知的一门科学，涉及到学科有，语言学、神经科学、哲学、心理学、人类学、人工智能、教育学。\n\n\n1. 要理解人类的各种认知活动，离不开心理表征这样一个基本的理论设定，认知活动可以看作各种心理表征（符号、规则、图像等）进行加工的过程，心理表征提供了一个既不依赖生物学和神经科学，也有别于社会和文化层面的独立的分析层面。\n\n2. 计算机为理解人类心智提供了一个强有力的模型，计算和算法是理解认知活动如何运作的核心，思维和认知即在心理表征上运行的心理计算。\n\n3. 将认知和情感、意识、文化和历史等因素分离开来，认知活动主要包括知觉、记忆、思维、语言、推理、决策\n、问题求解、学习和行为控制等，这些是认知科学的主要研究对象。\n\n4. 艰辛多学科、跨学科的研究是探索人类心智奥秘的必由之路，终将达成一门统一的认知科学。\n\n5. 认知科学所探讨的基本问题来源于从古希腊哲学到笛卡尔再到康德的西方哲学传统，认知科学试图运用当代科学的方法和理论来回答传统的哲学问题。\n\n\n\n认知科学可以扩展到对意识、情绪、自我、社会、文化、宗教、道德、艺术等等的研究上面去。\n\n要理解人类心智的认知还需要很长的路要走，认知科学也具有极大的发展前景。\n","slug":"cognitive-science","published":0,"updated":"2018-04-02T09:40:16.793Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjr66wiea002qmetpkhkmna8o","content":"<p>现在描述一下是认知科学，所谓认知科学就是通过各种方式来研究人类如何认知的一门科学，涉及到学科有，语言学、神经科学、哲学、心理学、人类学、人工智能、教育学。</p>\n<ol>\n<li><p>要理解人类的各种认知活动，离不开心理表征这样一个基本的理论设定，认知活动可以看作各种心理表征（符号、规则、图像等）进行加工的过程，心理表征提供了一个既不依赖生物学和神经科学，也有别于社会和文化层面的独立的分析层面。</p>\n</li>\n<li><p>计算机为理解人类心智提供了一个强有力的模型，计算和算法是理解认知活动如何运作的核心，思维和认知即在心理表征上运行的心理计算。</p>\n</li>\n<li><p>将认知和情感、意识、文化和历史等因素分离开来，认知活动主要包括知觉、记忆、思维、语言、推理、决策<br>、问题求解、学习和行为控制等，这些是认知科学的主要研究对象。</p>\n</li>\n<li><p>艰辛多学科、跨学科的研究是探索人类心智奥秘的必由之路，终将达成一门统一的认知科学。</p>\n</li>\n<li><p>认知科学所探讨的基本问题来源于从古希腊哲学到笛卡尔再到康德的西方哲学传统，认知科学试图运用当代科学的方法和理论来回答传统的哲学问题。</p>\n</li>\n</ol>\n<p>认知科学可以扩展到对意识、情绪、自我、社会、文化、宗教、道德、艺术等等的研究上面去。</p>\n<p>要理解人类心智的认知还需要很长的路要走，认知科学也具有极大的发展前景。</p>\n","excerpt":"","more":"<p>现在描述一下是认知科学，所谓认知科学就是通过各种方式来研究人类如何认知的一门科学，涉及到学科有，语言学、神经科学、哲学、心理学、人类学、人工智能、教育学。</p>\n<ol>\n<li><p>要理解人类的各种认知活动，离不开心理表征这样一个基本的理论设定，认知活动可以看作各种心理表征（符号、规则、图像等）进行加工的过程，心理表征提供了一个既不依赖生物学和神经科学，也有别于社会和文化层面的独立的分析层面。</p>\n</li>\n<li><p>计算机为理解人类心智提供了一个强有力的模型，计算和算法是理解认知活动如何运作的核心，思维和认知即在心理表征上运行的心理计算。</p>\n</li>\n<li><p>将认知和情感、意识、文化和历史等因素分离开来，认知活动主要包括知觉、记忆、思维、语言、推理、决策<br>、问题求解、学习和行为控制等，这些是认知科学的主要研究对象。</p>\n</li>\n<li><p>艰辛多学科、跨学科的研究是探索人类心智奥秘的必由之路，终将达成一门统一的认知科学。</p>\n</li>\n<li><p>认知科学所探讨的基本问题来源于从古希腊哲学到笛卡尔再到康德的西方哲学传统，认知科学试图运用当代科学的方法和理论来回答传统的哲学问题。</p>\n</li>\n</ol>\n<p>认知科学可以扩展到对意识、情绪、自我、社会、文化、宗教、道德、艺术等等的研究上面去。</p>\n<p>要理解人类心智的认知还需要很长的路要走，认知科学也具有极大的发展前景。</p>\n"},{"_content":"1. Spring Cloud各个模块的作用\n2. Spring boot各个模块的作用\n","source":"_drafts/plan.md","raw":"1. Spring Cloud各个模块的作用\n2. Spring boot各个模块的作用\n","slug":"plan","published":0,"date":"2017-09-15T11:07:58.000Z","updated":"2017-11-13T06:40:22.052Z","title":"","comments":1,"layout":"post","photos":[],"link":"","_id":"cjr66wied002smetpq9z1mv7n","content":"<ol>\n<li>Spring Cloud各个模块的作用</li>\n<li>Spring boot各个模块的作用</li>\n</ol>\n","excerpt":"","more":"<ol>\n<li>Spring Cloud各个模块的作用</li>\n<li>Spring boot各个模块的作用</li>\n</ol>\n"},{"title":"spring","_content":"\nhttps://docs.spring.io/spring-boot/docs/2.0.0.M5/reference/htmlsingle/#production-ready-endpoints\n\nhttps://docs.spring.io/spring-boot/docs/2.0.0.M5/reference/htmlsingle/#production-ready-jmx\n今天介绍一个spring boot使用的监控\n","source":"_drafts/spring-boot-actuator.md","raw":"---\ntitle: spring\ntags:\n---\n\nhttps://docs.spring.io/spring-boot/docs/2.0.0.M5/reference/htmlsingle/#production-ready-endpoints\n\nhttps://docs.spring.io/spring-boot/docs/2.0.0.M5/reference/htmlsingle/#production-ready-jmx\n今天介绍一个spring boot使用的监控\n","slug":"spring-boot-actuator","published":0,"date":"2017-10-24T07:13:06.811Z","updated":"2017-10-24T09:29:59.165Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjr66wiee002vmetpv2i879cg","content":"<p><a href=\"https://docs.spring.io/spring-boot/docs/2.0.0.M5/reference/htmlsingle/#production-ready-endpoints\" target=\"_blank\" rel=\"external\">https://docs.spring.io/spring-boot/docs/2.0.0.M5/reference/htmlsingle/#production-ready-endpoints</a></p>\n<p><a href=\"https://docs.spring.io/spring-boot/docs/2.0.0.M5/reference/htmlsingle/#production-ready-jmx\" target=\"_blank\" rel=\"external\">https://docs.spring.io/spring-boot/docs/2.0.0.M5/reference/htmlsingle/#production-ready-jmx</a><br>今天介绍一个spring boot使用的监控</p>\n","excerpt":"","more":"<p><a href=\"https://docs.spring.io/spring-boot/docs/2.0.0.M5/reference/htmlsingle/#production-ready-endpoints\">https://docs.spring.io/spring-boot/docs/2.0.0.M5/reference/htmlsingle/#production-ready-endpoints</a></p>\n<p><a href=\"https://docs.spring.io/spring-boot/docs/2.0.0.M5/reference/htmlsingle/#production-ready-jmx\">https://docs.spring.io/spring-boot/docs/2.0.0.M5/reference/htmlsingle/#production-ready-jmx</a><br>今天介绍一个spring boot使用的监控</p>\n"},{"title":"位置","_content":"每个人都有自己的故事，一个故事的长短，有着有很多的描述。活着其实并不容易，有的人选择活的很轻松，有的人选择获得很累，得到的都是自己所想要的，\n","source":"_drafts/位置.md","raw":"---\ntitle: 位置\ntags:\n---\n每个人都有自己的故事，一个故事的长短，有着有很多的描述。活着其实并不容易，有的人选择活的很轻松，有的人选择获得很累，得到的都是自己所想要的，\n","slug":"位置","published":0,"date":"2018-05-23T05:14:28.844Z","updated":"2018-05-23T05:20:15.533Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjr66wief002xmetpdp2aqxim","content":"<p>每个人都有自己的故事，一个故事的长短，有着有很多的描述。活着其实并不容易，有的人选择活的很轻松，有的人选择获得很累，得到的都是自己所想要的，</p>\n","excerpt":"","more":"<p>每个人都有自己的故事，一个故事的长短，有着有很多的描述。活着其实并不容易，有的人选择活的很轻松，有的人选择获得很累，得到的都是自己所想要的，</p>\n"},{"title":"低效人生","comments":0,"date":"2018-04-03T02:08:50.000Z","_content":"","source":"_drafts/低效人生.md","raw":"---\ntitle: 低效人生\ntags: 随笔\ncomments: false\ncategories: \ndate: 2018-04-03 10:08:50\n---\n","slug":"低效人生","published":0,"updated":"2018-04-03T02:09:05.879Z","layout":"post","photos":[],"link":"","_id":"cjr66wieg002zmetpxlf3fs0j","content":"","excerpt":"","more":""},{"title":"记录思考","comments":0,"date":"2018-03-26T04:36:27.000Z","_content":"最近草稿箱中放的文章有点儿多，都是写了半截儿，刚好公司断网，就继续写下去吧。\n\n试着问自己一个问题，过往人生中学习到的内容，有多少是可以拿来著书立说的呢？我想有相当一部分人会认为虽然不能著新但是立旧还是可以分享一些的。问题就在于如何分享？说到底分享就意味着有受众，受众的水平决定了分享的方式。而我选了一种写东西来保持自己有一个良好的思路来分享自己的内容，虽然是不是很有价值的干货，但愿积少成多。\n\n\n\n#  效率\n\n首先，不得不承认，我们大部分的人生都是一种低效的状态的，我称之为低效人生。无论是关于人生试错，还是关于学习的效率，其实大多数人都是很低效的，所以我们永远都在打转。质和量，可以是完全不相冲的概念，积少可以成多，高效可以节约成本。决定一件事的效率的关键点有很多，作为现代社会的人类，我们面临着多方合作的局面，这个时候合作伙伴的效率觉决定了，我们走下去的效率\n\n低效人生\n\n\n焦虑始终伴随着我们，如果不能把所思所想写下来，注定会渐渐忘记。\n学会记录下来这些东西，我们的目标并不是成为身边同伴中的佼佼者，而是能够吸引更多的佼佼者来结识。\n不要再过分的追求大而全，这件事并非没有意义，而是与个人而言，穷极一生都未必能够所有成就。关注当下的问题也许才是我们应该做的。\n\n\n结论，学着去记录下自己的学习与思考吧。\n\n观点有，工作的意义在于帮我们融入这个社会，但是并不能简单\n\n\n\n哪怕是低等级的观点，也是有存在的价值的。\n\n安排一天的时间，我的时间总是那么的不固定。\n\n\n先安排结论，然后安排观点\n","source":"_drafts/记录思考.md","raw":"---\ntitle: 记录思考\ntags: 随笔\ncomments: false\ndate: 2018-03-26 12:36:27\n---\n最近草稿箱中放的文章有点儿多，都是写了半截儿，刚好公司断网，就继续写下去吧。\n\n试着问自己一个问题，过往人生中学习到的内容，有多少是可以拿来著书立说的呢？我想有相当一部分人会认为虽然不能著新但是立旧还是可以分享一些的。问题就在于如何分享？说到底分享就意味着有受众，受众的水平决定了分享的方式。而我选了一种写东西来保持自己有一个良好的思路来分享自己的内容，虽然是不是很有价值的干货，但愿积少成多。\n\n\n\n#  效率\n\n首先，不得不承认，我们大部分的人生都是一种低效的状态的，我称之为低效人生。无论是关于人生试错，还是关于学习的效率，其实大多数人都是很低效的，所以我们永远都在打转。质和量，可以是完全不相冲的概念，积少可以成多，高效可以节约成本。决定一件事的效率的关键点有很多，作为现代社会的人类，我们面临着多方合作的局面，这个时候合作伙伴的效率觉决定了，我们走下去的效率\n\n低效人生\n\n\n焦虑始终伴随着我们，如果不能把所思所想写下来，注定会渐渐忘记。\n学会记录下来这些东西，我们的目标并不是成为身边同伴中的佼佼者，而是能够吸引更多的佼佼者来结识。\n不要再过分的追求大而全，这件事并非没有意义，而是与个人而言，穷极一生都未必能够所有成就。关注当下的问题也许才是我们应该做的。\n\n\n结论，学着去记录下自己的学习与思考吧。\n\n观点有，工作的意义在于帮我们融入这个社会，但是并不能简单\n\n\n\n哪怕是低等级的观点，也是有存在的价值的。\n\n安排一天的时间，我的时间总是那么的不固定。\n\n\n先安排结论，然后安排观点\n","slug":"记录思考","published":0,"updated":"2018-04-12T02:58:23.227Z","layout":"post","photos":[],"link":"","_id":"cjr66wiei0031metpnmmvcbiw","content":"<p>最近草稿箱中放的文章有点儿多，都是写了半截儿，刚好公司断网，就继续写下去吧。</p>\n<p>试着问自己一个问题，过往人生中学习到的内容，有多少是可以拿来著书立说的呢？我想有相当一部分人会认为虽然不能著新但是立旧还是可以分享一些的。问题就在于如何分享？说到底分享就意味着有受众，受众的水平决定了分享的方式。而我选了一种写东西来保持自己有一个良好的思路来分享自己的内容，虽然是不是很有价值的干货，但愿积少成多。</p>\n<h1 id=\"效率\"><a href=\"#效率\" class=\"headerlink\" title=\"效率\"></a>效率</h1><p>首先，不得不承认，我们大部分的人生都是一种低效的状态的，我称之为低效人生。无论是关于人生试错，还是关于学习的效率，其实大多数人都是很低效的，所以我们永远都在打转。质和量，可以是完全不相冲的概念，积少可以成多，高效可以节约成本。决定一件事的效率的关键点有很多，作为现代社会的人类，我们面临着多方合作的局面，这个时候合作伙伴的效率觉决定了，我们走下去的效率</p>\n<p>低效人生</p>\n<p>焦虑始终伴随着我们，如果不能把所思所想写下来，注定会渐渐忘记。<br>学会记录下来这些东西，我们的目标并不是成为身边同伴中的佼佼者，而是能够吸引更多的佼佼者来结识。<br>不要再过分的追求大而全，这件事并非没有意义，而是与个人而言，穷极一生都未必能够所有成就。关注当下的问题也许才是我们应该做的。</p>\n<p>结论，学着去记录下自己的学习与思考吧。</p>\n<p>观点有，工作的意义在于帮我们融入这个社会，但是并不能简单</p>\n<p>哪怕是低等级的观点，也是有存在的价值的。</p>\n<p>安排一天的时间，我的时间总是那么的不固定。</p>\n<p>先安排结论，然后安排观点</p>\n","excerpt":"","more":"<p>最近草稿箱中放的文章有点儿多，都是写了半截儿，刚好公司断网，就继续写下去吧。</p>\n<p>试着问自己一个问题，过往人生中学习到的内容，有多少是可以拿来著书立说的呢？我想有相当一部分人会认为虽然不能著新但是立旧还是可以分享一些的。问题就在于如何分享？说到底分享就意味着有受众，受众的水平决定了分享的方式。而我选了一种写东西来保持自己有一个良好的思路来分享自己的内容，虽然是不是很有价值的干货，但愿积少成多。</p>\n<h1 id=\"效率\"><a href=\"#效率\" class=\"headerlink\" title=\"效率\"></a>效率</h1><p>首先，不得不承认，我们大部分的人生都是一种低效的状态的，我称之为低效人生。无论是关于人生试错，还是关于学习的效率，其实大多数人都是很低效的，所以我们永远都在打转。质和量，可以是完全不相冲的概念，积少可以成多，高效可以节约成本。决定一件事的效率的关键点有很多，作为现代社会的人类，我们面临着多方合作的局面，这个时候合作伙伴的效率觉决定了，我们走下去的效率</p>\n<p>低效人生</p>\n<p>焦虑始终伴随着我们，如果不能把所思所想写下来，注定会渐渐忘记。<br>学会记录下来这些东西，我们的目标并不是成为身边同伴中的佼佼者，而是能够吸引更多的佼佼者来结识。<br>不要再过分的追求大而全，这件事并非没有意义，而是与个人而言，穷极一生都未必能够所有成就。关注当下的问题也许才是我们应该做的。</p>\n<p>结论，学着去记录下自己的学习与思考吧。</p>\n<p>观点有，工作的意义在于帮我们融入这个社会，但是并不能简单</p>\n<p>哪怕是低等级的观点，也是有存在的价值的。</p>\n<p>安排一天的时间，我的时间总是那么的不固定。</p>\n<p>先安排结论，然后安排观点</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cjr66wicf0001metpalnuf0dq","category_id":"cjr66wico0004metpr43x0du7","_id":"cjr66wicw000dmetpcoxys60u"},{"post_id":"cjr66wicm0003metpfu458ppx","category_id":"cjr66wico0004metpr43x0du7","_id":"cjr66wid2000jmetpcbkl6n0a"},{"post_id":"cjr66wicx000emetpfet62jp0","category_id":"cjr66wico0004metpr43x0du7","_id":"cjr66wid4000nmetpftg1jo3q"},{"post_id":"cjr66wid1000imetpozmha1w7","category_id":"cjr66wico0004metpr43x0du7","_id":"cjr66wid6000qmetpm63sl5fn"},{"post_id":"cjr66wicq0006metp7usrim7o","category_id":"cjr66wico0004metpr43x0du7","_id":"cjr66wid7000umetpijetutbp"},{"post_id":"cjr66wid5000pmetph4ffjhbw","category_id":"cjr66wico0004metpr43x0du7","_id":"cjr66wid8000xmetpagr3my5c"},{"post_id":"cjr66wids001tmetp1egdidym","category_id":"cjr66wico0004metpr43x0du7","_id":"cjr66widy001zmetpb0a8lyhj"},{"post_id":"cjr66widt001vmetpavvo8sk0","category_id":"cjr66wico0004metpr43x0du7","_id":"cjr66widz0022metppgh8xvcu"},{"post_id":"cjr66widu001ymetpud8u2tdz","category_id":"cjr66wico0004metpr43x0du7","_id":"cjr66wie20026metplmvq5ay3"},{"post_id":"cjr66widy0021metpxhkewklg","category_id":"cjr66wico0004metpr43x0du7","_id":"cjr66wie30029metp1v14rbdi"},{"post_id":"cjr66wie4002bmetp2a6pljhy","category_id":"cjr66wico0004metpr43x0du7","_id":"cjr66wie8002imetppu5n4cym"},{"post_id":"cjr66wiea002qmetpkhkmna8o","category_id":"cjr66wiee002tmetpjbaxbi9j","_id":"cjr66wiei0032metphcz5uulk"}],"PostTag":[{"post_id":"cjr66wicf0001metpalnuf0dq","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wicv000bmetpv2pwpzp8"},{"post_id":"cjr66wicm0003metpfu458ppx","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wid1000hmetphhqrh93a"},{"post_id":"cjr66wicx000emetpfet62jp0","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wid3000kmetpal06le73"},{"post_id":"cjr66wid1000imetpozmha1w7","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wid4000ometpqvozyt8w"},{"post_id":"cjr66wicq0006metp7usrim7o","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wid6000rmetpg4modn48"},{"post_id":"cjr66wid5000pmetph4ffjhbw","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wid7000vmetp18dtnlsu"},{"post_id":"cjr66wics0007metpe81i2u10","tag_id":"cjr66wid4000mmetpam2hh5jg","_id":"cjr66wid8000ymetpxn9gx66t"},{"post_id":"cjr66wid6000smetpemjdngzd","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wid90011metp3jih0rka"},{"post_id":"cjr66wics0008metpax2f0pg2","tag_id":"cjr66wid7000tmetpofkm00wa","_id":"cjr66wida0013metpbky74tmr"},{"post_id":"cjr66wid8000zmetp2a4s5cl6","tag_id":"cjr66wid4000mmetpam2hh5jg","_id":"cjr66widb0016metpq7i80lbp"},{"post_id":"cjr66wid90012metp3usnylyj","tag_id":"cjr66wid4000mmetpam2hh5jg","_id":"cjr66widc0018metpacrvewqi"},{"post_id":"cjr66wicv000cmetph18pxox5","tag_id":"cjr66wid7000tmetpofkm00wa","_id":"cjr66widf001bmetpxretcdei"},{"post_id":"cjr66widb0017metps4wxprjz","tag_id":"cjr66wid7000tmetpofkm00wa","_id":"cjr66widi001dmetp3uegz05y"},{"post_id":"cjr66wid3000lmetpmrbjdyil","tag_id":"cjr66wid4000mmetpam2hh5jg","_id":"cjr66widk001gmetppe9lch00"},{"post_id":"cjr66widf001cmetpm0k1vp8u","tag_id":"cjr66wid4000mmetpam2hh5jg","_id":"cjr66widl001imetppsk9jmmc"},{"post_id":"cjr66wid7000wmetpexxcbupk","tag_id":"cjr66widd001ametpiqtcc34s","_id":"cjr66widm001kmetpd3jxg6fj"},{"post_id":"cjr66widi001emetpmh1unefs","tag_id":"cjr66wid4000mmetpam2hh5jg","_id":"cjr66wido001nmetpluq09zcu"},{"post_id":"cjr66wida0014metp4zy595oo","tag_id":"cjr66widk001fmetp28lpj2ke","_id":"cjr66widp001pmetpo6l6z4sb"},{"post_id":"cjr66widn001lmetpt5c5t9lh","tag_id":"cjr66widd001ametpiqtcc34s","_id":"cjr66widr001smetpe0jb9pmh"},{"post_id":"cjr66widd0019metpdl30a8wa","tag_id":"cjr66widn001mmetp0ahm76lx","_id":"cjr66wids001umetphcua6rpn"},{"post_id":"cjr66widp001qmetpzet2d0ke","tag_id":"cjr66wid4000mmetpam2hh5jg","_id":"cjr66widu001xmetpnrba9zbw"},{"post_id":"cjr66wids001tmetp1egdidym","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66widy0020metp1y3u15s8"},{"post_id":"cjr66widk001hmetpkp04r9pt","tag_id":"cjr66widr001rmetpfzyhyv5k","_id":"cjr66wie00024metpbxwnavrd"},{"post_id":"cjr66widt001vmetpavvo8sk0","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wie20027metpmkoklbud"},{"post_id":"cjr66widu001ymetpud8u2tdz","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wie4002ametpv9txwib7"},{"post_id":"cjr66widy0021metpxhkewklg","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wie5002dmetp52cshamg"},{"post_id":"cjr66wie00025metp7g8iehdz","tag_id":"cjr66widd001ametpiqtcc34s","_id":"cjr66wie6002fmetp22bncog9"},{"post_id":"cjr66wie20028metpq7igzsux","tag_id":"cjr66widd001ametpiqtcc34s","_id":"cjr66wie8002jmetplxmnt3s3"},{"post_id":"cjr66wie4002bmetp2a6pljhy","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wie8002lmetpl6zc4cwh"},{"post_id":"cjr66wie5002emetpwn6olcis","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wie9002nmetpltzus6k5"},{"post_id":"cjr66widl001jmetpps7ylvxb","tag_id":"cjr66widu001wmetpvsl1lgvy","_id":"cjr66wiea002pmetpd01h8ruz"},{"post_id":"cjr66widl001jmetpps7ylvxb","tag_id":"cjr66wie00023metpui500f1g","_id":"cjr66wiec002rmetpfw2njxmv"},{"post_id":"cjr66widl001jmetpps7ylvxb","tag_id":"cjr66wie4002cmetp8mp0avno","_id":"cjr66wiee002umetpgoqic7jn"},{"post_id":"cjr66wie8002kmetplm23qisn","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wief002wmetpeffbgfz0"},{"post_id":"cjr66wido001ometp9a1qe34g","tag_id":"cjr66wie7002hmetpjd4sti73","_id":"cjr66wieg002ymetp7rali1uw"},{"post_id":"cjr66wie9002ometp78reppr7","tag_id":"cjr66widn001mmetp0ahm76lx","_id":"cjr66wieh0030metpmfkgo316"},{"post_id":"cjr66wieg002zmetpxlf3fs0j","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wiei0033metpg0c82pfj"},{"post_id":"cjr66wiei0031metpnmmvcbiw","tag_id":"cjr66wicq0005metpfy2vxz8k","_id":"cjr66wiej0034metp0bn81ngy"}],"Tag":[{"name":"随笔","_id":"cjr66wicq0005metpfy2vxz8k"},{"name":"android","_id":"cjr66wid4000mmetpam2hh5jg"},{"name":"冰与火之歌","_id":"cjr66wid7000tmetpofkm00wa"},{"name":"Android","_id":"cjr66widd001ametpiqtcc34s"},{"name":"docker","_id":"cjr66widk001fmetp28lpj2ke"},{"name":"Docker","_id":"cjr66widn001mmetp0ahm76lx"},{"name":"操作","_id":"cjr66widr001rmetpfzyhyv5k"},{"name":"Node.js","_id":"cjr66widu001wmetpvsl1lgvy"},{"name":"mysql","_id":"cjr66wie00023metpui500f1g"},{"name":"Express","_id":"cjr66wie4002cmetp8mp0avno"},{"name":"spring boot","_id":"cjr66wie7002hmetpjd4sti73"}]}}